This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.claude/settings.local.json
.cursor/rules/global.mdc
.cursorignore
.gitignore
CLAUDE.md
components.json
cookie.txt
docs/clean-code-rule.txt
docs/database-complete.sql
docs/deployment-guide.md
docs/fix-storage-policies.sql
docs/logging-rules.md
docs/prd.txt
docs/progress-log.md
docs/session-comments-schema.sql
docs/setup-guide.md
docs/step-by-step-rule.txt
docs/storage-setup.sql
docs/trd.txt
eslint.config.mjs
messages/en.json
messages/ko.json
next.config.ts
package.json
postcss.config.mjs
README.md
scripts/fix-admin-permissions.js
src/app/[locale]/about/page.tsx
src/app/[locale]/admin/categories/page.tsx
src/app/[locale]/admin/comments/page.tsx
src/app/[locale]/admin/page.tsx
src/app/[locale]/admin/posts/[id]/edit/page.tsx
src/app/[locale]/admin/posts/new/page.tsx
src/app/[locale]/admin/posts/page.tsx
src/app/[locale]/admin/settings/page.tsx
src/app/[locale]/auth/login/page.tsx
src/app/[locale]/categories/[slug]/page.tsx
src/app/[locale]/categories/page.tsx
src/app/[locale]/home-page-client.tsx
src/app/[locale]/layout.tsx
src/app/[locale]/manifest.ts
src/app/[locale]/page.tsx
src/app/[locale]/page.tsx.backup
src/app/[locale]/posts/[slug]/page.tsx
src/app/[locale]/posts/page.tsx
src/app/[locale]/providers.tsx
src/app/[locale]/search/page.tsx
src/app/[locale]/tags/[slug]/page.tsx
src/app/[locale]/unauthorized/page.tsx
src/app/api/admin/analytics/route.ts
src/app/api/admin/comments/route.ts
src/app/api/captcha/math/route.ts
src/app/api/comments/[id]/reactions/route.ts
src/app/api/comments/[id]/route.ts
src/app/api/comments/route.ts
src/app/api/comments/session/route.ts
src/app/api/posts/[id]/views/route.ts
src/app/api/test-post/route.ts
src/app/error.tsx
src/app/global-error.tsx
src/app/globals.css
src/app/layout.tsx
src/app/loading.tsx
src/app/manifest.ts.backup
src/app/not-found.tsx
src/app/opengraph-image.tsx
src/app/page.tsx
src/app/providers.tsx
src/app/robots.ts
src/app/rss/route.ts
src/app/sitemap.ts
src/components/admin/analytics-dashboard.tsx
src/components/admin/image-upload.tsx
src/components/admin/post-delete-button.tsx
src/components/admin/recent-comments.tsx
src/components/admin/rich-text-editor-enhanced.tsx
src/components/auth/mfa-setup.tsx
src/components/auth/mfa-verify.tsx
src/components/auth/password-strength.tsx
src/components/blog/admin-actions.tsx
src/components/blog/comment-form.tsx
src/components/blog/comment-section.tsx
src/components/blog/enhanced-comment-section.tsx
src/components/blog/html-content.tsx
src/components/blog/math-captcha.tsx
src/components/blog/post-card.tsx
src/components/blog/post-content.tsx
src/components/blog/post-footer.tsx
src/components/blog/post-header.tsx
src/components/blog/view-tracker.tsx
src/components/motion/motion-provider.tsx
src/components/no-ssr.tsx
src/components/search/search-filters.tsx
src/components/search/search-input.tsx
src/components/search/search-results.tsx
src/components/seo/json-ld.tsx
src/components/shared/footer.tsx
src/components/shared/header.tsx
src/components/shared/language-toggle.tsx
src/components/theme/theme-provider.tsx
src/components/theme/theme-toggle.tsx
src/components/ui/accordion.tsx
src/components/ui/alert-dialog.tsx
src/components/ui/alert.tsx
src/components/ui/avatar.tsx
src/components/ui/badge.tsx
src/components/ui/button.tsx
src/components/ui/card.tsx
src/components/ui/checkbox.tsx
src/components/ui/dialog.tsx
src/components/ui/dropdown-menu.tsx
src/components/ui/file-upload.tsx
src/components/ui/form.tsx
src/components/ui/input.tsx
src/components/ui/label.tsx
src/components/ui/lazy-image.tsx
src/components/ui/loading-spinner.tsx
src/components/ui/motion-badge.tsx
src/components/ui/motion-button.tsx
src/components/ui/popover.tsx
src/components/ui/select.tsx
src/components/ui/separator.tsx
src/components/ui/sheet.tsx
src/components/ui/skeleton.tsx
src/components/ui/tabs.tsx
src/components/ui/textarea.tsx
src/components/ui/toast.tsx
src/components/ui/toaster.tsx
src/components/ui/toggle.tsx
src/components/web-vitals.tsx
src/hooks/use-auth.ts
src/hooks/use-autosave.ts
src/hooks/use-scroll.ts
src/hooks/use-toast.ts
src/hooks/use-view-tracker.ts
src/i18n/config.ts
src/i18n/routing.ts
src/lib/animations.ts
src/lib/auth/admin-guard.ts
src/lib/blog-server.ts
src/lib/blog.ts
src/lib/ip-hash.ts
src/lib/security/input-validation.ts
src/lib/session.ts
src/lib/supabase/client.ts
src/lib/supabase/middleware.ts
src/lib/supabase/server.ts
src/lib/translations.ts
src/lib/utils.ts
src/lib/utils/__tests__/html-utils.test.ts
src/lib/utils/date.ts
src/lib/utils/html-utils.ts
src/lib/utils/slug.ts
src/lib/validations/post.ts
src/lib/web-vitals.ts
src/middleware.ts
src/styles/tiptap.css
src/types/database.ts
src/types/global.d.ts
tailwind.config.ts
tests/scripts/create-admin-demo.js
tests/scripts/test-admin-function.js
tests/scripts/test-login.js
tests/scripts/test-workflow.js
tsconfig.json
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="src/lib/ip-hash.ts">
import { createHmac } from 'crypto';

/**
 * Hash IP address for privacy protection while maintaining uniqueness for functionality
 * Uses HMAC-SHA256 with a server-side secret to prevent rainbow table attacks
 */
export function hashIpAddress(ipAddress: string): string {
  const secret = process.env.IP_HASH_SECRET || 'default-dev-secret-change-in-production';
  
  return createHmac('sha256', secret)
    .update(ipAddress)
    .digest('hex');
}

/**
 * Extract IP address from request headers
 */
export function getClientIpAddress(headers: Headers): string {
  const forwarded = headers.get('x-forwarded-for');
  const realIp = headers.get('x-real-ip');
  
  return forwarded?.split(',')[0] || realIp || '127.0.0.1';
}
</file>

<file path=".cursor/rules/global.mdc">
---
description: Common Guideline
globs: 
alwaysApply: true
---


# Senior Developer Guidelines

## Must

- always use client component for all components. (use `use client` directive)
- always use promise for page.tsx params props.
- use valid picsum.photos stock image for placeholder image

## Library

use following libraries for specific functionalities:

1. `date-fns`: For efficient date and time handling.
2. `ts-pattern`: For clean and type-safe branching logic.
3. `@tanstack/react-query`: For server state management.
4. `zustand`: For lightweight global state management.
5. `react-use`: For commonly needed React hooks.
6. `es-toolkit`: For robust utility functions.
7. `lucide-react`: For customizable icons.
8. `zod`: For schema validation and data integrity.
9. `shadcn-ui`: For pre-built accessible UI components.
10. `tailwindcss`: For utility-first CSS styling.
11. `supabase`: For a backend-as-a-service solution.
12. `react-hook-form`: For form validation and state management.

## Directory Structure

- src
- src/app: Next.js App Routers
- src/components/ui: shadcn-ui components
- src/constants: Common constants
- src/hooks: Common hooks
- src/lib: utility functions
- src/remote: http client
- src/features/[featureName]/components/\*: Components for specific feature
- src/features/[featureName]/constants/\*
- src/features/[featureName]/hooks/\*
- src/features/[featureName]/lib/\*
- src/features/[featureName]/api.ts: api fetch functions

## Solution Process:

1. Rephrase Input: Transform to clear, professional prompt.
2. Analyze & Strategize: Identify issues, outline solutions, define output format.
3. Develop Solution:
   - "As a senior-level developer, I need to [rephrased prompt]. To accomplish this, I need to:"
   - List steps numerically.
   - "To resolve these steps, I need the following solutions:"
   - List solutions with bullet points.
4. Validate Solution: Review, refine, test against edge cases.
5. Evaluate Progress:
   - If incomplete: Pause, inform user, await input.
   - If satisfactory: Proceed to final output.
6. Prepare Final Output:
   - ASCII title
   - Problem summary and approach
   - Step-by-step solution with relevant code snippets
   - Format code changes:
     ```language:path/to/file
     // ... existing code ...
     function exampleFunction() {
         // Modified or new code here
     }
     // ... existing code ...
     ```
   - Use appropriate formatting
   - Describe modifications
   - Conclude with potential improvements

## Key Mindsets:

1. Simplicity
2. Readability
3. Maintainability
4. Testability
5. Reusability
6. Functional Paradigm
7. Pragmatism

## Code Guidelines:

1. Early Returns
2. Conditional Classes over ternary
3. Descriptive Names
4. Constants > Functions
5. DRY
6. Functional & Immutable
7. Minimal Changes
8. Pure Functions
9. Composition over inheritance

## Functional Programming:

- Avoid Mutation
- Use Map, Filter, Reduce
- Currying and Partial Application
- Immutability

## Code-Style Guidelines

- Use TypeScript for type safety.
- Follow the coding standards defined in the ESLint configuration.
- Ensure all components are responsive and accessible.
- Use Tailwind CSS for styling, adhering to the defined color palette.
- When generating code, prioritize TypeScript and React best practices.
- Ensure that any new components are reusable and follow the existing design patterns.
- Minimize the use of AI generated comments, instead use clearly named variables and functions.
- Always validate user inputs and handle errors gracefully.
- Use the existing components and pages as a reference for the new components and pages.

## Performance:

- Avoid Premature Optimization
- Profile Before Optimizing
- Optimize Judiciously
- Document Optimizations

## Comments & Documentation:

- Comment function purpose
- Use JSDoc for JS
- Document "why" not "what"

## Function Ordering:

- Higher-order functionality first
- Group related functions

## Handling Bugs:

- Use TODO: and FIXME: comments

## Error Handling:

- Use appropriate techniques
- Prefer returning errors over exceptions

## Testing:

- Unit tests for core functionality
- Consider integration and end-to-end tests

## Next.js

- you must use promise for page.tsx params props.

## Shadcn-ui

- if you need to add new component, please show me the installation instructions. I'll paste it into terminal.
- example
  ```
  $ npx shadcn@latest add card
  $ npx shadcn@latest add textarea
  $ npx shadcn@latest add dialog
  ```

## Supabase

- if you need to add new table, please create migration. I'll paste it into supabase.
- do not run supabase locally
- store migration query for `.sql` file. in /supabase/migrations/

## Package Manager

- use npm as package manager.

## Korean Text

- ì½”ë“œë¥¼ ìƒì„±í•œ í›„ì— utf-8 ê¸°ì¤€ìœ¼ë¡œ ê¹¨ì§€ëŠ” í•œê¸€ì´ ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”. ë§Œì•½ ìˆë‹¤ë©´ ìˆ˜ì •í•´ì£¼ì„¸ìš”.

You are a senior full-stack developer, one of those rare 10x devs. Your focus: clean, maintainable, high-quality code.
Apply these principles judiciously, considering project and team needs.
</file>

<file path=".cursorignore">
pnpm-lock.yaml
yarn.lock
package-lock.json
</file>

<file path=".gitignore">
# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# dependencies
/node_modules
/.pnp
.pnp.*
.yarn/*
!.yarn/patches
!.yarn/plugins
!.yarn/releases
!.yarn/versions

# testing
/coverage

# next.js
/.next/
/out/

# production
/build

# misc
.DS_Store
*.pem

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*
.pnpm-debug.log*

# env files (can opt-in for committing if needed)
.env*

# vercel
.vercel

# EasyNext
.easynext

# typescript
*.tsbuildinfo
next-env.d.ts
</file>

<file path="components.json">
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "default",
  "rsc": true,
  "tsx": true,
  "tailwind": {
    "config": "tailwind.config.ts",
    "css": "src/app/globals.css",
    "baseColor": "neutral",
    "cssVariables": true,
    "prefix": ""
  },
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  }
}
</file>

<file path="cookie.txt">
# Netscape HTTP Cookie File
# https://curl.se/docs/http-cookies.html
# This file was generated by libcurl! Edit at your own risk.
</file>

<file path="docs/clean-code-rule.txt">
# Clean Code Guidelines

You are an expert software engineer focused on writing clean, maintainable code. Follow these principles rigorously:

## Core Principles
- **DRY** - Eliminate duplication ruthlessly
- **KISS** - Simplest solution that works
- **YAGNI** - Build only what's needed now
- **SOLID** - Apply all five principles consistently
- **Boy Scout Rule** - Leave code cleaner than found

## Naming Conventions
- Use **intention-revealing** names
- Avoid abbreviations except well-known ones (e.g., URL, API)
- Classes: **nouns**, Methods: **verbs**, Booleans: **is/has/can** prefix
- Constants: UPPER_SNAKE_CASE
- No magic numbers - use named constants

## Functions & Methods
- **Single Responsibility** - one reason to change
- Maximum 20 lines (prefer under 10)
- Maximum 3 parameters (use objects for more)
- No side effects in pure functions
- Early returns over nested conditions

## Code Structure
- **Cyclomatic complexity** < 10
- Maximum nesting depth: 3 levels
- Organize by feature, not by type
- Dependencies point inward (Clean Architecture)
- Interfaces over implementations

## Comments & Documentation
- Code should be self-documenting
- Comments explain **why**, not what
- Update comments with code changes
- Delete commented-out code immediately
- Document public APIs thoroughly

## Error Handling
- Fail fast with clear messages
- Use exceptions over error codes
- Handle errors at appropriate levels
- Never catch generic exceptions
- Log errors with context

## Testing
- **TDD** when possible
- Test behavior, not implementation
- One assertion per test
- Descriptive test names: `should_X_when_Y`
- **AAA pattern**: Arrange, Act, Assert
- Maintain test coverage > 80%

## Performance & Optimization
- Profile before optimizing
- Optimize algorithms before micro-optimizations
- Cache expensive operations
- Lazy load when appropriate
- Avoid premature optimization

## Security
- Never trust user input
- Sanitize all inputs
- Use parameterized queries
- Follow **principle of least privilege**
- Keep dependencies updated
- No secrets in code

## Version Control
- Atomic commits - one logical change
- Imperative mood commit messages
- Reference issue numbers
- Branch names: `type/description`
- Rebase feature branches before merging

## Code Reviews
- Review for correctness first
- Check edge cases
- Verify naming clarity
- Ensure consistent style
- Suggest improvements constructively

## Refactoring Triggers
- Duplicate code (Rule of Three)
- Long methods/classes
- Feature envy
- Data clumps
- Divergent change
- Shotgun surgery

## Final Checklist
Before committing, ensure:
- [ ] All tests pass
- [ ] No linting errors
- [ ] No console logs
- [ ] No commented code
- [ ] No TODOs without tickets
- [ ] Performance acceptable
- [ ] Security considered
- [ ] Documentation updated

Remember: **Clean code reads like well-written prose**. Optimize for readability and maintainability over cleverness.
</file>

<file path="docs/deployment-guide.md">
# ë°°í¬ ê°€ì´ë“œ (Deployment Guide)

## ğŸ“‹ ë°°í¬ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

### 1. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
```bash
# .env.local íŒŒì¼ ìƒì„±
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
NEXT_PUBLIC_SITE_URL=https://your-domain.com
```

### 2. Supabase í”„ë¡œì íŠ¸ ì„¤ì •
1. [Supabase](https://supabase.com)ì—ì„œ ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±
2. `docs/database-schema.sql` íŒŒì¼ ì‹¤í–‰
3. Row Level Security (RLS) ì •ì±… í™œì„±í™”
4. ê´€ë¦¬ì ê³„ì • ìƒì„± (ìˆ˜ë™ìœ¼ë¡œ roleì„ 'admin'ìœ¼ë¡œ ì„¤ì •)

---

## ğŸš€ ë°°í¬ ì˜µì…˜

### Option 1: Vercel (ì¶”ì²œ)

#### ì¥ì 
- Next.js ìµœì í™”
- ìë™ ë°°í¬
- ë¬´ë£Œ í”Œëœ ì œê³µ
- ë„ë©”ì¸ ë° SSL ìë™ ì„¤ì •

#### ë°°í¬ ë‹¨ê³„
1. **GitHub ì €ì¥ì†Œ ìƒì„±**
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git remote add origin https://github.com/username/your-blog.git
   git push -u origin main
   ```

2. **Vercel ë°°í¬**
   - [Vercel](https://vercel.com)ì—ì„œ GitHub ì—°ê²°
   - ì €ì¥ì†Œ ì„ íƒ í›„ ë°°í¬
   - í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (Settings > Environment Variables)

3. **í™˜ê²½ ë³€ìˆ˜ ì„¤ì •**
   ```
   NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
   NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
   NEXT_PUBLIC_SITE_URL=https://your-domain.vercel.app
   ```

### Option 2: Netlify

#### ë°°í¬ ë‹¨ê³„
1. **ë¹Œë“œ ì„¤ì •**
   ```toml
   # netlify.toml
   [build]
     command = "npm run build"
     publish = ".next"
   
   [[plugins]]
     package = "@netlify/plugin-nextjs"
   ```

2. **í™˜ê²½ ë³€ìˆ˜ ì„¤ì •**
   - Site settings > Environment variablesì—ì„œ ì„¤ì •

### Option 3: ìì²´ ì„œë²„ (VPS/Docker)

#### Docker ë°°í¬
```dockerfile
# Dockerfile
FROM node:18-alpine AS base
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production

FROM base AS build
COPY . .
RUN npm run build

FROM base AS runtime
COPY --from=build /app/.next ./.next
COPY --from=build /app/public ./public
EXPOSE 3000
CMD ["npm", "start"]
```

```bash
# ë°°í¬ ëª…ë ¹ì–´
docker build -t devblog .
docker run -p 3000:3000 --env-file .env.local devblog
```

---

## ğŸ”§ ë°°í¬ í›„ ì„¤ì •

### 1. ê´€ë¦¬ì ê³„ì • ìƒì„±
```sql
-- Supabase SQL Editorì—ì„œ ì‹¤í–‰
UPDATE users 
SET role = 'admin' 
WHERE email = 'your-admin@email.com';
```

### 2. ë„ë©”ì¸ ì„¤ì •
- DNS ì„¤ì •ì—ì„œ A ë ˆì½”ë“œ ë˜ëŠ” CNAME ì„¤ì •
- SSL ì¸ì¦ì„œ ìë™ ë°œê¸‰ í™•ì¸

### 3. ì„±ëŠ¥ ìµœì í™”
- Vercel Analytics í™œì„±í™”
- Core Web Vitals ëª¨ë‹ˆí„°ë§
- CDN ìµœì í™” í™•ì¸

### 4. SEO ì„¤ì •
- Google Search Console ë“±ë¡
- ì‚¬ì´íŠ¸ë§µ ì œì¶œ (ìë™ ìƒì„±ë¨)
- robots.txt í™•ì¸

---

## ğŸ“Š ëª¨ë‹ˆí„°ë§ ë° ìœ ì§€ë³´ìˆ˜

### 1. ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
- **Web Vitals**: ê°œë°œì ë„êµ¬ ì½˜ì†”ì—ì„œ í™•ì¸
- **Lighthouse**: ì„±ëŠ¥ ì ìˆ˜ ì •ê¸° í™•ì¸
- **Vercel Analytics**: íŠ¸ë˜í”½ ë° ì„±ëŠ¥ ë¶„ì„

### 2. ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬
- **ì •ê¸° ë°±ì—…**: Supabase ëŒ€ì‹œë³´ë“œì—ì„œ ì„¤ì •
- **RLS ì •ì±…**: ë³´ì•ˆ ê·œì¹™ ì •ê¸° ì ê²€
- **ì¸ë±ìŠ¤ ìµœì í™”**: ê²€ìƒ‰ ì„±ëŠ¥ í–¥ìƒ

### 3. ì½˜í…ì¸  ê´€ë¦¬
- **ì •ê¸° í¬ìŠ¤íŒ…**: SEO ë° ì‚¬ìš©ì ìœ ì§€
- **ì´ë¯¸ì§€ ìµœì í™”**: ë¡œë”© ì†ë„ í–¥ìƒ
- **ì¹´í…Œê³ ë¦¬ ì •ë¦¬**: ì½˜í…ì¸  êµ¬ì¡°í™”

---

## ğŸ› ï¸ ë¬¸ì œ í•´ê²°

### ì¼ë°˜ì ì¸ ë¬¸ì œë“¤

#### 1. ë¹Œë“œ ì˜¤ë¥˜
```bash
# TypeScript ì˜¤ë¥˜ í™•ì¸
npm run build
npx tsc --noEmit

# ì˜ì¡´ì„± ë¬¸ì œ í•´ê²°
npm install
npm audit fix

# ë¹Œë“œ ìºì‹œ ì •ë¦¬ (Turbopack ì˜¤ë¥˜ ì‹œ)
rm -rf .next
npm run dev
```

#### 2. Supabase ì—°ê²° ì˜¤ë¥˜
- í™˜ê²½ ë³€ìˆ˜ í™•ì¸
- RLS ì •ì±… ê²€í† 
- ë„¤íŠ¸ì›Œí¬ ì„¤ì • í™•ì¸

#### 3. ì´ë¯¸ì§€ ë¡œë”© ë¬¸ì œ
- Next.js Image ì»´í¬ë„ŒíŠ¸ ì‚¬ìš©
- ì´ë¯¸ì§€ ìµœì í™” ì„¤ì •
- CDN ì„¤ì • í™•ì¸

#### 4. ê²€ìƒ‰ ê¸°ëŠ¥ ì˜¤ë¥˜
- PostgreSQL ì „ë¬¸ ê²€ìƒ‰ ì„¤ì •
- ì¸ë±ìŠ¤ ìƒì„± í™•ì¸
- ê²€ìƒ‰ ë²¡í„° ì—…ë°ì´íŠ¸

---

## ğŸ“ˆ ì„±ëŠ¥ ìµœì í™” íŒ

### 1. ì´ë¯¸ì§€ ìµœì í™”
```javascript
// next.config.js
module.exports = {
  images: {
    formats: ['image/webp', 'image/avif'],
    domains: ['your-supabase-url.supabase.co'],
  },
}
```

### 2. ìºì‹± ì „ëµ
- Static Generation (SSG) í™œìš©
- Incremental Static Regeneration (ISR)
- CDN ìºì‹± ì„¤ì •

### 3. ë²ˆë“¤ í¬ê¸° ìµœì í™”
```bash
# ë²ˆë“¤ ë¶„ì„
npm run build
npx @next/bundle-analyzer
```

---

## ğŸ”’ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### 1. í™˜ê²½ ë³€ìˆ˜ ë³´ì•ˆ
- ë¯¼ê°í•œ ì •ë³´ëŠ” ì„œë²„ì‚¬ì´ë“œì—ì„œë§Œ ì‚¬ìš©
- `.env.local`ì„ `.gitignore`ì— ì¶”ê°€
- í”„ë¡œë•ì…˜ í™˜ê²½ë³€ìˆ˜ ë³„ë„ ê´€ë¦¬

### 2. Supabase ë³´ì•ˆ
- RLS ì •ì±… ì—„ê²©íˆ ì„¤ì •
- API í‚¤ ì •ê¸° ê°±ì‹ 
- ì ‘ê·¼ ë¡œê·¸ ëª¨ë‹ˆí„°ë§

### 3. ì½˜í…ì¸  ë³´ì•ˆ
- XSS ë°©ì§€ (react-markdown ì‚¬ìš©)
- CSRF í† í° í™œìš©
- ì…ë ¥ ë°ì´í„° ê²€ì¦

---

## ğŸ“ ì§€ì› ë° ë¬¸ì˜

### ë¬¸ì„œ ì°¸ê³ 
- [Next.js ê³µì‹ ë¬¸ì„œ](https://nextjs.org/docs)
- [Supabase ê³µì‹ ë¬¸ì„œ](https://supabase.com/docs)
- [Vercel ë°°í¬ ê°€ì´ë“œ](https://vercel.com/docs)

### ì¶”ê°€ ê°œë°œ ë° ì»¤ìŠ¤í„°ë§ˆì´ì§•
- ì´ë¯¸ì§€ ì—…ë¡œë“œ ê¸°ëŠ¥ ì¶”ê°€
- ëŒ“ê¸€ ì‹œìŠ¤í…œ êµ¬í˜„
- ë‰´ìŠ¤ë ˆí„° êµ¬ë… ê¸°ëŠ¥
- ê³ ê¸‰ SEO ìµœì í™”

---

## ğŸ¯ ë§ˆë¬´ë¦¬

ì´ ê°€ì´ë“œë¥¼ ë”°ë¼ ì„±ê³µì ìœ¼ë¡œ ë°°í¬í•˜ë©´ ì™„ì „íˆ ê¸°ëŠ¥í•˜ëŠ” ëª¨ë˜ ë¸”ë¡œê·¸ í”Œë«í¼ì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¶”ê°€ ê¸°ëŠ¥ì´ë‚˜ ì»¤ìŠ¤í„°ë§ˆì´ì§•ì´ í•„ìš”í•˜ë©´ CLAUDE.md íŒŒì¼ì„ ì°¸ê³ í•˜ì—¬ ê°œë°œì„ ê³„ì†í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ğŸš€ Happy Blogging!**
</file>

<file path="docs/fix-storage-policies.sql">
/* ============================================================================
   Storage Policy Fix - Resolve RLS Issues
   ============================================================================ */

-- 1. First, drop existing policies
DROP POLICY IF EXISTS "blog_images_public_read" ON storage.objects;
DROP POLICY IF EXISTS "blog_images_admin_upload" ON storage.objects;
DROP POLICY IF EXISTS "blog_images_admin_update" ON storage.objects;
DROP POLICY IF EXISTS "blog_images_admin_delete" ON storage.objects;

-- 2. Create simplified policies for testing
-- Public read access to all images
CREATE POLICY "blog_images_public_read"
ON storage.objects FOR SELECT
USING (bucket_id = 'blog-images');

-- Allow authenticated users to upload images
CREATE POLICY "blog_images_auth_upload"
ON storage.objects FOR INSERT
WITH CHECK (
  bucket_id = 'blog-images' AND
  auth.role() = 'authenticated'
);

-- Allow authenticated users to update their own images
CREATE POLICY "blog_images_auth_update"
ON storage.objects FOR UPDATE
USING (
  bucket_id = 'blog-images' AND
  auth.role() = 'authenticated'
);

-- Allow authenticated users to delete their own images
CREATE POLICY "blog_images_auth_delete"
ON storage.objects FOR DELETE
USING (
  bucket_id = 'blog-images' AND
  auth.role() = 'authenticated'
);

-- 3. Alternative: If you want admin-only access, use this instead
-- (Comment out the above policies and uncomment these)

/*
-- Admin-only upload access with proper admin check
CREATE POLICY "blog_images_admin_upload"
ON storage.objects FOR INSERT
WITH CHECK (
  bucket_id = 'blog-images' AND
  (
    -- Email-based admin check
    auth.jwt() ->> 'email' = 'admin@devblog.com' OR
    -- Database admin check (bypass RLS by using security definer function)
    EXISTS (
      SELECT 1 FROM admins 
      WHERE user_id = auth.uid()
    )
  )
);

-- Admin-only update access
CREATE POLICY "blog_images_admin_update"
ON storage.objects FOR UPDATE
USING (
  bucket_id = 'blog-images' AND
  (
    auth.jwt() ->> 'email' = 'admin@devblog.com' OR
    EXISTS (
      SELECT 1 FROM admins 
      WHERE user_id = auth.uid()
    )
  )
);

-- Admin-only delete access
CREATE POLICY "blog_images_admin_delete"
ON storage.objects FOR DELETE
USING (
  bucket_id = 'blog-images' AND
  (
    auth.jwt() ->> 'email' = 'admin@devblog.com' OR
    EXISTS (
      SELECT 1 FROM admins 
      WHERE user_id = auth.uid()
    )
  )
);
*/

-- 4. Verify bucket exists and is properly configured
-- Check if bucket exists
SELECT * FROM storage.buckets WHERE id = 'blog-images';

-- If bucket doesn't exist, create it
INSERT INTO storage.buckets (id, name, public, file_size_limit, allowed_mime_types)
VALUES (
  'blog-images',
  'blog-images',
  true,
  52428800, -- 50MB limit
  ARRAY['image/jpeg', 'image/png', 'image/gif', 'image/webp']
)
ON CONFLICT (id) DO UPDATE SET
  public = EXCLUDED.public,
  file_size_limit = EXCLUDED.file_size_limit,
  allowed_mime_types = EXCLUDED.allowed_mime_types;

-- 5. Test query to check current user
SELECT 
  auth.uid() as user_id,
  auth.role() as user_role,
  auth.jwt() ->> 'email' as user_email,
  EXISTS (SELECT 1 FROM admins WHERE user_id = auth.uid()) as is_admin_db;

DO $$
BEGIN
  RAISE NOTICE 'âœ… Storage policies updated!';
  RAISE NOTICE 'ğŸ“‹ Current policies:';
  RAISE NOTICE '   - Public read access for all images';
  RAISE NOTICE '   - Authenticated users can upload/update/delete';
  RAISE NOTICE '   - Uncomment admin-only policies if needed';
  RAISE NOTICE '';
  RAISE NOTICE 'ğŸ”§ Test the policies now!';
END $$;
</file>

<file path="docs/logging-rules.md">
# í”„ë¡œì íŠ¸ ì§„í–‰ ìƒí™© ë¡œê¹… ê·œì¹™

## ê°œìš”
ëª¨ë“  ì‘ì—… ê³„íš, ì§„í–‰ ìƒí™©, ì¤‘ìš”í•œ ì»¨í…ìŠ¤íŠ¸ ì •ë³´ë¥¼ `docs/progress-log.md`ì— ì²´ê³„ì ìœ¼ë¡œ ê¸°ë¡í•©ë‹ˆë‹¤.

## ë¡œê¹… ê·œì¹™

### 1. í•„ìˆ˜ ë¡œê¹… ì‹œì 
- **ì‘ì—… ì‹œì‘ ì‹œ**: ì‘ì—… ê³„íš ë° ëª©í‘œ ê¸°ë¡
- **ì¤‘ìš” ê²°ì • ì‹œ**: ì•„í‚¤í…ì²˜, ê¸°ìˆ  ì„ íƒ, ì„¤ê³„ ê²°ì •
- **ì‘ì—… ì™„ë£Œ ì‹œ**: ê²°ê³¼ë¬¼ ë° ë‹¤ìŒ ë‹¨ê³„ ê¸°ë¡
- **ë¬¸ì œ ë°œìƒ ì‹œ**: ì´ìŠˆ ë° í•´ê²° ë°©ë²• ê¸°ë¡
- **ì»¨í…ìŠ¤íŠ¸ ë³€ê²½ ì‹œ**: ìš”êµ¬ì‚¬í•­ ë³€ê²½, ë°©í–¥ì„± ìˆ˜ì •

### 2. ë¡œê·¸ ì—”íŠ¸ë¦¬ í˜•ì‹
```markdown
### [YYYY-MM-DD HH:MM] ì‘ì—… ì œëª©
**ì‘ì—…**: ì‘ì—… ë‚´ìš© ìš”ì•½
- êµ¬ì²´ì ì¸ ì‘ì—… í•­ëª© 1
- êµ¬ì²´ì ì¸ ì‘ì—… í•­ëª© 2

**ì¤‘ìš” ì»¨í…ìŠ¤íŠ¸**:
- ë†“ì¹˜ë©´ ì•ˆ ë˜ëŠ” ì •ë³´ 1
- ë†“ì¹˜ë©´ ì•ˆ ë˜ëŠ” ì •ë³´ 2

**ê²°ê³¼/ê²°ì •ì‚¬í•­**:
- ì£¼ìš” ê²°ê³¼ë¬¼
- ì¤‘ìš”í•œ ê²°ì •ì‚¬í•­

**ë‹¤ìŒ ë‹¨ê³„**: ë‹¤ìŒì— í•´ì•¼ í•  ì‘ì—…
```

### 3. íƒ€ì„ìŠ¤íƒ¬í”„ í˜•ì‹
- **ë‚ ì§œ**: YYYY-MM-DD
- **ì‹œê°„**: HH:MM (24ì‹œê°„ í˜•ì‹)
- **ì˜ˆì‹œ**: [2025-01-10 17:30]

### 4. ìˆœì„œ ê´€ë¦¬
- ì‹œê°„ìˆœìœ¼ë¡œ ìƒë‹¨ì— ìµœì‹  ë¡œê·¸ ì¶”ê°€
- ê° ë‚ ì§œë³„ë¡œ ì„¹ì…˜ êµ¬ë¶„
- ì‘ì—… ìˆœì„œë¥¼ ëª…í™•íˆ ì¶”ì  ê°€ëŠ¥í•˜ë„ë¡ êµ¬ì„±

### 5. í•„ìˆ˜ ê¸°ë¡ í•­ëª©

#### ì‘ì—… ê³„íš
- ì „ì²´ ì‘ì—… ë¡œë“œë§µ
- ìš°ì„ ìˆœìœ„ ë° Phase êµ¬ë¶„
- ì˜ˆìƒ ì†Œìš” ì‹œê°„

#### ê¸°ìˆ ì  ê²°ì •
- ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„ íƒ ì´ìœ 
- ì•„í‚¤í…ì²˜ ì„¤ê³„ ê²°ì •
- ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì„¤ê³„

#### ì§„í–‰ ìƒí™©
- ì™„ë£Œëœ ì‘ì—… í•­ëª©
- í˜„ì¬ ì§„í–‰ ì¤‘ì¸ ì‘ì—…
- ì˜ˆì •ëœ ë‹¤ìŒ ì‘ì—…

#### ì¤‘ìš” ì»¨í…ìŠ¤íŠ¸
- ìš”êµ¬ì‚¬í•­ ë³€ê²½ì‚¬í•­
- ì„±ëŠ¥ ëª©í‘œ ë° ì œì•½ì‚¬í•­
- ì™¸ë¶€ ë„êµ¬ ì‚¬ìš© (Gemini í”¼ë“œë°± ë“±)

#### ë¬¸ì œ í•´ê²°
- ë°œìƒí•œ ë¬¸ì œ ë° ì›ì¸
- í•´ê²° ë°©ë²•
- ì˜ˆë°© ë°©ì•ˆ

### 6. ì²´í¬ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬
- ì „ì²´ ì‘ì—… ì§„í–‰ë¥  ì¶”ì 
- Phaseë³„ ì™„ë£Œ ìƒíƒœ í‘œì‹œ
- ë¯¸ì™„ë£Œ ì‘ì—… ìš°ì„ ìˆœìœ„ ê´€ë¦¬

### 7. ì£¼ìš” ê²°ì •ì‚¬í•­ ì„¹ì…˜
- í”„ë¡œì íŠ¸ ì „ë°˜ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ê²°ì •ì‚¬í•­
- í–¥í›„ ì°¸ì¡°ê°€ í•„ìš”í•œ ì„¤ê³„ ì •ë³´
- ì„±ëŠ¥ ëª©í‘œ ë° í’ˆì§ˆ ê¸°ì¤€

## ì‚¬ìš© ë°©ë²•

### Claude Code ì‚¬ìš© ì‹œ
1. ì‘ì—… ì‹œì‘ ì „: í˜„ì¬ ìƒí™© í™•ì¸ ë° ê³„íš ê¸°ë¡
2. ì‘ì—… ì¤‘: ì¤‘ìš”í•œ ê²°ì •ì‚¬í•­ ì‹¤ì‹œê°„ ê¸°ë¡
3. ì‘ì—… ì™„ë£Œ í›„: ê²°ê³¼ë¬¼ ë° ë‹¤ìŒ ë‹¨ê³„ ê¸°ë¡

### ì»¨í…ìŠ¤íŠ¸ ìœ ì§€
- ìƒˆë¡œìš´ Claude Code ì¸ìŠ¤í„´ìŠ¤ ì‹œì‘ ì‹œ progress-log.md ìš°ì„  í™•ì¸
- ì´ì „ ì‘ì—… ë‚´ìš© ë° ê²°ì •ì‚¬í•­ íŒŒì•…
- í˜„ì¬ ìœ„ì¹˜ ë° ë‹¤ìŒ ë‹¨ê³„ ëª…í™•íˆ ì¸ì‹

## ì˜ˆì‹œ

```markdown
### [2025-01-10 17:45] Supabase ì„¤ì • ì™„ë£Œ
**ì‘ì—…**: Supabase í”„ë¡œì íŠ¸ ìƒì„± ë° í™˜ê²½ ì„¤ì •
- Supabase í”„ë¡œì íŠ¸ ìƒì„±
- í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (.env.local)
- ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ìƒì„±

**ì¤‘ìš” ì»¨í…ìŠ¤íŠ¸**:
- í”„ë¡œì íŠ¸ URL: https://xxx.supabase.co
- RLS ì •ì±… ì ìš© í•„ìš”
- ì´ë¯¸ì§€ ìŠ¤í† ë¦¬ì§€ ë²„í‚· 'post-images' ìƒì„± ì™„ë£Œ

**ê²°ê³¼/ê²°ì •ì‚¬í•­**:
- posts, categories, tags, post_tags í…Œì´ë¸” ìƒì„±
- ê´€ë¦¬ì ê³„ì •ì€ ë‹¨ì¼ ì‚¬ìš©ìë¡œ ì œí•œ
- ì´ë¯¸ì§€ ì—…ë¡œë“œ í¬ê¸° ì œí•œ: 5MB

**ë‹¤ìŒ ë‹¨ê³„**: ì¸ì¦ ì‹œìŠ¤í…œ êµ¬í˜„
```

ì´ ê·œì¹™ì— ë”°ë¼ ëª¨ë“  ì‘ì—…ì„ ì²´ê³„ì ìœ¼ë¡œ ê¸°ë¡í•˜ì—¬ í”„ë¡œì íŠ¸ ì§„í–‰ ìƒí™©ì„ íˆ¬ëª…í•˜ê²Œ ê´€ë¦¬í•©ë‹ˆë‹¤.
</file>

<file path="docs/prd.txt">
Product Requirements Document

1. Executive Summary
   Build a modern, responsive blog web application that allows a single administrator to create, manage, and publish Markdown-based articles while offering visitors an elegant reading and discovery experience comparable to services such as Tistory, Naver Blog, and Velog.

2. Problem Statement
   Independent writers often rely on large blogging platforms that restrict design, ownership, or monetization options. A lightweight, self-hosted solution with an intuitive editor, robust search, and professional presentation is needed to empower authors while delivering fast, SEO-friendly content to readers.

3. Goals and Objectives
   Primary Goal: Enable the admin to quickly publish and maintain high-quality blog posts through an easy, secure interface.
   Secondary Goals:
   Deliver seamless reading, filtering, and sharing for visitors.
   Provide a stylish, responsive UI supporting light/dark modes.
   Optimize SEO and performance for organic traffic growth.
   Success Metrics:
   Admin time to publish new post <5 min.
   â‰¥1,000 monthly unique visitors within 3 months of launch.
   Average page load â‰¤1 s (LCP 1.5 s P75).
   Bounce rate <50 %, repeat visitor rate >25 %.
4. Target Audience
   Primary Users
   Individual content creators, developers, designers, and hobby bloggers (age 20-45) seeking ownership of their content, basic analytics, and custom styling without heavy CMS overhead.
   Secondary Users
   Readers interested in the blogâ€™s domain topics, recruiters assessing author expertise, and partners sharing posts.
5. User Stories
   As an admin, I want to log in securely so that only I can edit content.
   As an admin, I want a Markdown editor with image upload so that I can format posts easily.
   As an admin, I want to add tags and categories so that posts are organized.
   As a visitor, I want to browse the latest posts on the home page so that I discover new content quickly.
   As a visitor, I want to click a tag to see all related posts so that I can deep-dive into a topic.
   As a visitor, I want to search by title or tag so that I find specific information fast.
   As a visitor, I want to switch to dark mode so that I can read comfortably at night.
   As a visitor, I want to copy a share link so that I can post articles on social media.
6. Functional Requirements
   Core Features
   Admin Authentication

Single admin account via Supabase Auth (Email/Password or OAuth).
JWT session stored in http-only cookies; auto-refresh tokens.
Content Management

CRUD for posts using a Markdown WYSIWYG editor (e.g., TipTap, Toast UI).
Image upload to Supabase Storage or AWS S3 with automatic CDN URLs.
Tag autocomplete (fuzzy search) and category selection/creation.
Draft / Publish status, slug auto-generation, and preview mode.
Acceptance: Admin can create a post with at least one image, save as draft, publish, then view it publicly.
Public Blog Pages

Home: intro banner + paginated latest posts.
Post Detail: lazy-loaded images, code syntax highlighting, social share button.
Category & Tag Pages: server-side filtered lists.
Search: title + tag full-text search with debounce (â‰¤300 ms).
Routing via Next.js App Router with SEO-friendly dynamic paths.
Visitor Interactions

Light/Dark mode toggle (prefers-color-scheme default).
Optional comments (config flag; default off) via third-party widget (e.g., Giscus).
Visitor counter (unique page views per post).
RSS 2.0 feed (auto-generated nightly).
Supporting Features
About/Profile page with avatar, bio, external links.
Open Graph & Twitter meta tags per post.
404 and 500 custom error pages.
Admin dashboard analytics: total posts, monthly views, top tags. 7. Non-Functional Requirements
Performance: SSR or SSG with CDN; TTFB <200 ms, CLS <0.1.
Security: OWASP Top-10 compliance, HTTPS only, XSS sanitation on Markdown.
Usability: WCAG 2.1 AA contrast, keyboard navigation.
Scalability: Horizontal scaling via Vercel or Netlify; Supabase scales to 10k concurrent reads.
Compatibility: Latest 2 versions of Chrome, Safari, Firefox, Edge; mobile Safari iOS 15+. 8. Technical Considerations
Frontend Framework: Next.js (App Router, React 18)
Language & Typing: TypeScript (type safety, maintainability)
Styling: Tailwind CSS (utility-first), shadcn-ui (accessible prebuilt UI components)
State & Data Management: zustand (global state), react-hook-form (form state/validation), zod (schema validation/data integrity), supabase (BaaS: auth/DB/storage)
Utilities & Libraries: date-fns (date/time), ts-pattern (pattern matching), es-toolkit (utility functions), lucide-react (icons), react-use (common hooks)
Build & Dev Tools: ESLint (linting), PostCSS (CSS post-processing), Next.js built-in dev server
Directory Structure: src/app (App Router), src/components/ui (shadcn-ui), src/constants, src/hooks, src/lib, src/remote, src/features, etc.
Miscellaneous: picsum.photos (stock image placeholder), UTF-8 encoding for Korean text support
Backend: Supabase (PostgreSQL, Auth, Storage) with Row Level Security.
Image CDN: Supabase or Cloudflare Images.
Deployment: Vercel (preview builds per PR, production main branch).
CI/CD: GitHub Actions for lint, tests, schema migration (Prisma).
Analytics: Plausible or Simple Analytics (cookie-less).
SEO: next-sitemap, structured data JSON-LD.
Backup: Daily DB dump to S3; versioned image storage.
3rd-Party Dependencies: TipTap Editor, remark/rehype plugins, Giscus (optional comments). 9. Success Metrics and KPIs
Content KPIs: Posts published per month, average read time.
Visitor KPIs: Unique visitors, pages/session, subscriber RSS count.
Business KPIs: Newsletter signups (if later added), referral traffic growth.
Technical KPIs: CI pass rate 100 %, uptime â‰¥99.9 %, average API latency <100 ms. 10. Timeline and Milestones
Phase 0 (Week 1): Requirements finalization, design system, repo setup.
Phase 1 â€“ MVP (Weeks 2-5): Auth, post CRUD, home & detail pages, SSG, basic SEO.
Phase 2 â€“ Usability (Weeks 6-7): Search, tags/categories, dark mode, visitor counter.
Phase 3 â€“ Growth (Weeks 8-9): RSS feed, about page, OG tags, optional comments.
Phase 4 â€“ Polish & Launch (Week 10): QA, accessibility audit, content seeding, production release.
Post-Launch (Week 11+): Analytics review, backlog grooming. 11. Risks and Mitigation
Data Loss: Mitigate with nightly backups and versioned storage.
Performance Regression: Integrate Lighthouse CI in PR pipeline.
Single Admin Account Compromise: Enforce strong password + 2FA; monitor unusual logins.
Adoption Risk: Market via social platforms and SEO; monitor KPIs, iterate UI.
Scope Creep: Lock feature list per phase; any new request assessed via Change Control Board. 12. Future Considerations
Multi-author support with role-based permissions.
Monetization (ads or subscription).
Internationalization (i18n) using Next-Intl.
Static export for offline hosting.
Mobile app (React Native) consuming the same Supabase backend.
</file>

<file path="docs/session-comments-schema.sql">
-- Session Comments í…Œì´ë¸” (ì‚¬ìš©ì ëŒ“ê¸€ ì‚­ì œ ê¶Œí•œ ê´€ë¦¬)
-- ëŒ“ê¸€ ì‘ì„± í›„ 30ë¶„ ë‚´ì— ë³¸ì¸ì´ ì‚­ì œí•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ìœ„í•œ í…Œì´ë¸”

CREATE TABLE IF NOT EXISTS session_comments (
    id              UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    created_at      TIMESTAMPTZ DEFAULT now(),
    session_id      VARCHAR(128) NOT NULL,
    comment_id      UUID NOT NULL REFERENCES comments(id) ON DELETE CASCADE,
    expires_at      TIMESTAMPTZ NOT NULL,
    
    UNIQUE(session_id, comment_id)
);

-- Session comments ì¸ë±ìŠ¤
CREATE INDEX IF NOT EXISTS idx_session_comments_session_id
  ON session_comments(session_id);

CREATE INDEX IF NOT EXISTS idx_session_comments_expires_at
  ON session_comments(expires_at);

-- ì •ë¦¬ìš© í•¨ìˆ˜ (ì„ íƒì‚¬í•­ - ë§Œë£Œëœ ì„¸ì…˜ ì •ë¦¬)
CREATE OR REPLACE FUNCTION cleanup_expired_session_comments()
RETURNS void AS $$
BEGIN
  DELETE FROM session_comments 
  WHERE expires_at < now();
END;
$$ LANGUAGE plpgsql;

-- ì£¼ê¸°ì ìœ¼ë¡œ ë§Œë£Œëœ ì„¸ì…˜ ì •ë¦¬ (ì˜ˆ: ë§¤ì¼ ìì •)
-- SELECT cron.schedule('cleanup-expired-sessions', '0 0 * * *', 'SELECT cleanup_expired_session_comments();');
</file>

<file path="docs/setup-guide.md">
# Dev-Eloper4 Blog Setup Guide

Complete setup guide for the Dev-Eloper4 blog application.

## Quick Start

### 1. Database Setup

Run the main database setup script in Supabase SQL Editor:

```sql
-- Run this file: docs/database-complete.sql
```

### 2. Storage Setup

Run the storage setup script:

```sql
-- Run this file: docs/storage-setup.sql
```

### 3. Admin User Setup

Add your admin user to the database:

```sql
-- Replace 'your-user-uuid' with your actual Supabase auth user UUID
INSERT INTO admins (user_id) VALUES ('your-user-uuid');
```

### 4. Environment Variables

Create a `.env.local` file with:

```env
NEXT_PUBLIC_SUPABASE_URL=your-supabase-url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-supabase-anon-key
```

### 5. Install Dependencies

```bash
npm install
```

### 6. Run Development Server

```bash
npm run dev
```

## Database Schema

The database includes the following tables:

### Core Tables
- **admins**: Admin user management
- **categories**: Post categories
- **tags**: Post tags
- **posts**: Blog posts
- **post_tags**: Post-tag relationships

### Security Tables
- **security_logs**: Security event logging
- **login_attempts**: Login attempt tracking

### Key Features
- **Row Level Security (RLS)**: Enabled on all tables
- **Full-text Search**: Implemented with PostgreSQL tsvector
- **Soft Delete**: Posts can be soft-deleted
- **Admin Functions**: `is_admin()` function for permission checks

## Security Features

### Admin Authentication
- Email-based admin identification
- Database-level admin table for permissions
- RLS policies for data protection

### Security Logging
- All admin actions are logged
- Login attempts are tracked
- IP address and user agent logging

### Storage Security
- Admin-only upload permissions
- Public read access for images
- File type and size restrictions

## Development Features

### Available Scripts
- `npm run dev`: Start development server
- `npm run build`: Build for production
- `npm run start`: Start production server
- `npm run lint`: Run ESLint

### Admin Features
- Post management (create, edit, delete)
- Category management
- Tag management
- Image upload
- Draft/publish workflow

## File Structure

```
src/
â”œâ”€â”€ app/                     # Next.js App Router pages
â”‚   â”œâ”€â”€ admin/              # Admin dashboard
â”‚   â””â”€â”€ ...
â”œâ”€â”€ components/             # React components
â”‚   â”œâ”€â”€ ui/                # shadcn-ui components
â”‚   â””â”€â”€ admin/             # Admin-specific components
â”œâ”€â”€ lib/                   # Utilities and configurations
â”‚   â”œâ”€â”€ supabase/          # Supabase client
â”‚   â””â”€â”€ validations/       # Zod schemas
â”œâ”€â”€ types/                 # TypeScript type definitions
â””â”€â”€ hooks/                 # Custom React hooks

docs/
â”œâ”€â”€ database-complete.sql  # Main database setup
â”œâ”€â”€ storage-setup.sql      # Storage configuration
â””â”€â”€ setup-guide.md         # This file

tests/
â””â”€â”€ scripts/               # Test and demo scripts
```

## Troubleshooting

### Common Issues

1. **RLS Permission Denied**
   - Ensure your user is in the `admins` table
   - Check if RLS policies are properly configured

2. **Storage Upload Fails**
   - Verify storage policies are set up
   - Check file type and size limits

3. **Database Connection Issues**
   - Verify environment variables
   - Check Supabase project URL and keys

### Testing Admin Functions

```sql
-- Test admin function
SELECT is_admin();

-- Check if user is admin
SELECT EXISTS (SELECT 1 FROM admins WHERE user_id = auth.uid());
```

## Next Steps

After setup:
1. Create your first blog post
2. Configure categories and tags
3. Set up custom domain (if needed)
4. Configure analytics
5. Set up automated backups

## Support

For issues or questions:
1. Check the troubleshooting section
2. Review the database schema
3. Check Supabase logs
4. Verify RLS policies
</file>

<file path="docs/step-by-step-rule.txt">
## Core Directive
You are a senior software engineer AI assistant. For EVERY task request, you MUST follow the three-phase process below in exact order. Each phase must be completed with expert-level precision and detail.

## Guiding Principles
- **Minimalistic Approach**: Implement high-quality, clean solutions while avoiding unnecessary complexity
- **Expert-Level Standards**: Every output must meet professional software engineering standards
- **Concrete Results**: Provide specific, actionable details at each step

---

## Phase 1: Codebase Exploration & Analysis
**REQUIRED ACTIONS:**
1. **Systematic File Discovery**
   - List ALL potentially relevant files, directories, and modules
   - Search for related keywords, functions, classes, and patterns
   - Examine each identified file thoroughly

2. **Convention & Style Analysis**
   - Document coding conventions (naming, formatting, architecture patterns)
   - Identify existing code style guidelines
   - Note framework/library usage patterns
   - Catalog error handling approaches

**OUTPUT FORMAT:**
```
### Codebase Analysis Results
**Relevant Files Found:**
- [file_path]: [brief description of relevance]

**Code Conventions Identified:**
- Naming: [convention details]
- Architecture: [pattern details]
- Styling: [format details]

**Key Dependencies & Patterns:**
- [library/framework]: [usage pattern]
```

---

## Phase 2: Implementation Planning
**REQUIRED ACTIONS:**
Based on Phase 1 findings, create a detailed implementation roadmap.

**OUTPUT FORMAT:**
```markdown
## Implementation Plan

### Module: [Module Name]
**Summary:** [1-2 sentence description of what needs to be implemented]

**Tasks:**
- [ ] [Specific implementation task]
- [ ] [Specific implementation task]

**Acceptance Criteria:**
- [ ] [Measurable success criterion]
- [ ] [Measurable success criterion]
- [ ] [Performance/quality requirement]

### Module: [Next Module Name]
[Repeat structure above]
```

---

## Phase 3: Implementation Execution
**REQUIRED ACTIONS:**
1. Implement each module following the plan from Phase 2
2. Verify ALL acceptance criteria are met before proceeding
3. Ensure code adheres to conventions identified in Phase 1

**QUALITY GATES:**
- [ ] All acceptance criteria validated
- [ ] Code follows established conventions
- [ ] Minimalistic approach maintained
- [ ] Expert-level implementation standards met

---

## Success Validation
Before completing any task, confirm:
- âœ… All three phases completed sequentially
- âœ… Each phase output meets specified format requirements
- âœ… Implementation satisfies all acceptance criteria
- âœ… Code quality meets professional standards

## Response Structure
Always structure your response as:
1. **Phase 1 Results**: [Codebase analysis findings]
2. **Phase 2 Plan**: [Implementation roadmap]  
3. **Phase 3 Implementation**: [Actual code with validation]
</file>

<file path="docs/storage-setup.sql">
/* ============================================================================
   Storage Setup for Dev-Eloper4 Blog
   ============================================================================
   
   This file sets up Supabase Storage buckets and policies for the blog.
   Run this after the main database setup.
   
   ============================================================================ */

/* ============================================================================
   1. Storage Buckets
   ============================================================================ */

-- Create blog-images bucket if it doesn't exist
INSERT INTO storage.buckets (id, name, public, file_size_limit, allowed_mime_types)
VALUES (
  'blog-images',
  'blog-images',
  true,
  52428800, -- 50MB limit
  ARRAY['image/jpeg', 'image/png', 'image/gif', 'image/webp']
)
ON CONFLICT (id) DO NOTHING;

/* ============================================================================
   2. Storage Policies
   ============================================================================ */

-- Public read access to all images
CREATE POLICY IF NOT EXISTS "blog_images_public_read"
ON storage.objects FOR SELECT
USING (bucket_id = 'blog-images');

-- Admin upload access
CREATE POLICY IF NOT EXISTS "blog_images_admin_upload"
ON storage.objects FOR INSERT
WITH CHECK (
  bucket_id = 'blog-images' AND
  (
    -- Check if user is admin (email-based for now)
    auth.jwt() ->> 'email' = 'admin@devblog.com' OR
    -- Or use database admin check if available
    (SELECT EXISTS (SELECT 1 FROM admins WHERE user_id = auth.uid()))
  )
);

-- Admin update access
CREATE POLICY IF NOT EXISTS "blog_images_admin_update"
ON storage.objects FOR UPDATE
USING (
  bucket_id = 'blog-images' AND
  (
    auth.jwt() ->> 'email' = 'admin@devblog.com' OR
    (SELECT EXISTS (SELECT 1 FROM admins WHERE user_id = auth.uid()))
  )
);

-- Admin delete access
CREATE POLICY IF NOT EXISTS "blog_images_admin_delete"
ON storage.objects FOR DELETE
USING (
  bucket_id = 'blog-images' AND
  (
    auth.jwt() ->> 'email' = 'admin@devblog.com' OR
    (SELECT EXISTS (SELECT 1 FROM admins WHERE user_id = auth.uid()))
  )
);

/* ============================================================================
   3. Completion Notice
   ============================================================================ */

DO $$
BEGIN
  RAISE NOTICE 'âœ… Storage setup completed!';
  RAISE NOTICE 'ğŸ“ Created bucket: blog-images';
  RAISE NOTICE 'ğŸ” Storage policies configured for admin access';
  RAISE NOTICE '';
  RAISE NOTICE 'ğŸ“ Notes:';
  RAISE NOTICE '   - Images are publicly readable';
  RAISE NOTICE '   - Only admins can upload/modify images';
  RAISE NOTICE '   - 50MB file size limit';
  RAISE NOTICE '   - Supported formats: JPEG, PNG, GIF, WebP';
END $$;
</file>

<file path="docs/trd.txt">
Technical Requirements Document (TRD)
1. Executive Technical Summary
Project Overview: Deliver a self-hosted, SEO-optimized blog platform where one administrator can author Markdown posts through a secure dashboard while readers enjoy fast, responsive browsing with light/dark theming.
Core Technology Stack: Next.js (App Router, React 18, TypeScript), Supabase (PostgreSQL, Auth, Storage), Tailwind CSS, shadcn-ui, TipTap, Vercel.
Key Technical Objectives:
Time To First Byte < 200 ms (CDN-backed SSR/SSG)
Largest Contentful Paint â‰¤ 1.5 s P75
Admin publication flow â‰¤ 5 min
â‰¥ 99.9 % uptime (Supabase + Vercel SLA)
Critical Technical Assumptions:
Single-admin model (no multi-tenant complexity)
Traffic fits within free/entry-level tiers during first twelve months
Supabase scaling automatically covers 10k concurrent reads without manual sharding
2. Tech Stack
Category	Technology / Library	Reasoning (Why it's chosen for this project)
Frontend Framework	Next.js 14 (App Router)	Out-of-the-box SSR/SSG, file-based routing, edge ISR, Vercel native deployment.
Language & Typing	TypeScript	Compile-time safety, IDE support, wide adoption in React ecosystem.
Styling	Tailwind CSS	Utility-first, fast theming (light/dark) with minimal custom CSS.
UI Components	shadcn-ui	Accessible, unstyled primitives that pair well with Tailwind.
State Management	zustand	Tiny footprint, avoids Redux boilerplate; adequate for small app state.
Form Handling	react-hook-form + zod	Performant uncontrolled inputs with schema validation.
Content Editor	TipTap (Markdown mode)	Modern WYSIWYG/Markdown hybrid; extensible image upload hooks.
Authentication / BaaS	Supabase Auth	Managed JWT auth, Row Level Security, email/OAuth ready.
Database	Supabase PostgreSQL	Relational, full-text search, free tier backups, SQL familiarly.
Storage & CDN	Supabase Storage	Direct image uploads with automatic global CDN URLs.
Hosting / CDN	Vercel	Zero-config Next.js hosting, preview URLs per PR, edge network.
Analytics	Plausible (cookie-less)	Lightweight, privacy-focused metrics aligned with European regulations.
Icons	lucide-react	Open-source icon set, tree-shakable.
Linting & Formatting	ESLint (next), Prettier	Enforce code quality, consistent formatting.
Testing	Jest + React Testing Library (unit)	Familiar toolchain, minimal config for component tests.
CI/CD	GitHub Actions	Free minutes, easy integration for lint/test/build pipeline.
Comments (optional)	Giscus	GitHub-based comments toggled via config flag; no backend maintenance.
SEO Utilities	next-sitemap, Open Graph tags	Automated sitemaps, social previews for better discoverability.
Date Utilities	date-fns	Small footprint, immutable helpers.
3. System Architecture Design
Top-Level Building Blocks
Web Client (Next.js)
Pages (Home, Post, Tag, Category, Search, About)
Admin dashboard (editor, post list, analytics)
Supabase Backend
Auth (JWT, RLS policies)
PostgreSQL DB (posts, tags, views)
Storage (images)
Edge Functions (optional: nightly RSS generation)
CDN & Hosting
Vercel Edge Network for static/SSR pages
Supabase CDN for images
Third-Party Services
Plausible (analytics)
Giscus (comments, toggled)
Top-Level Component Interaction Diagram
graph TD
    A[Browser] -->|HTTPS| B[Next.js App (Vercel Edge)]
    B -->|REST/GraphQL over HTTPS| C[Supabase API]
    C --> D[PostgreSQL]
    C --> E[Storage (Images)]
    B --> F[Plausible Analytics]
    B --Comments (optional)--> G[Giscus]
Diagram description:

Browser requests pages; Vercel serves SSG/SSR responses.
Next.js fetches data via Supabase client SDK (row-level policy enforced).
Supabase proxies to PostgreSQL for data and to Storage for image objects.
Analytics events sent directly from client to Plausible.
If enabled, comment widget communicates with GitHub via Giscus.
Code Organization & Convention
Domain-Driven Organization Strategy

Domains: auth, content, taxonomy, analytics, settings.
Layers: UI (components/pages), Application (hooks, services), Infrastructure (supabase, analytics).
Universal File & Folder Structure

/
â”œâ”€â”€ prisma/                  # DB schema & migrations (optional)
â”œâ”€â”€ scripts/                 # one-off utilities (e.g., RSS generator)
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                 # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ (public pages)/
â”‚   â”‚   â”œâ”€â”€ dashboard/       # admin routes (protected)
â”‚   â”‚   â””â”€â”€ sitemap.xml/route.ts
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ ui/              # shadcn components
â”‚   â”‚   â””â”€â”€ shared/          # site-wide widgets (navbar, footer, etc.)
â”‚   â”œâ”€â”€ features/
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”œâ”€â”€ content/
â”‚   â”‚   â”œâ”€â”€ taxonomy/
â”‚   â”‚   â””â”€â”€ analytics/
â”‚   â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ lib/                 # supabase client, markdown utils, SEO helpers
â”‚   â”œâ”€â”€ constants/
â”‚   â”œâ”€â”€ store/               # zustand slices
â”‚   â””â”€â”€ types/
â”œâ”€â”€ public/                  # static assets
â”œâ”€â”€ .github/workflows/       # CI pipelines
â””â”€â”€ package.json
Data Flow & Communication Patterns
Client-Server Communication: Supabase JS client uses HTTPS REST (authenticated with JWT) for CRUD and full-text search; ISR revalidates pages on demand.
Database Interaction: PostgreSQL accessed via Supabase RPC/select; Prisma optional for type-safe queries in edge functions.
External Service Integration: Plausible script loaded in <Head>; outbound events batched.
Real-Time Communication: Not required; live preview relies on local state.
Data Synchronization: ISR + client revalidation ensures consistency between published content and cached pages.
4. Performance & Optimization Strategy
Leverage Incremental Static Regeneration for posts/home to serve from edge cache with near-real-time updates.
Lazy-load images with next/image + native browser loading="lazy"; serve optimized formats (WebP/AVIF).
Bundle splitting & tree-shaking: keep JS payload < 150 kB by importing TipTap extensions on demand.
Use Supabase row-level policies to push auth filtering server side, reducing over-the-wire payload.
5. Implementation Roadmap & Milestones
Phase 1: Foundation (MVP Implementation) â€“ Weeks 1-4
Repository bootstrap, CI pipeline, Vercel & Supabase projects
Auth flow, protected dashboard route
Post CRUD with Markdown editor & image upload
Home & Post pages (SSR/SSG), basic SEO tags
Baseline security (HTTPS, RLS, XSS sanitation)
Phase 2: Feature Enhancement â€“ Weeks 5-7
Tag & category management with filtering pages
Full-text search with debounce
Light/dark mode, responsive design finishing
Visitor counter & simple analytics dashboard
Lighthouse CI integration
Phase 3: Scaling & Optimization â€“ Weeks 8-10
RSS feed generation via edge function or script
Optional comments toggle (Giscus)
Performance tuning (bundle analysis, caching headers)
Daily DB backup automation to S3
Pre-launch QA, accessibility audit, content seeding
6. Risk Assessment & Mitigation Strategies
Technical Risk Analysis
Technology Risks: Next.js or Supabase major version changes
Mitigation: lock minor versions; monthly dependency review.
Performance Risks: Large images slowing LCP
Mitigation: enforce 1 MB upload limit; automatic image resizing on upload.
Security Risks: XSS in Markdown content
Mitigation: remark-sanitize, CSP headers.
Integration Risks: Third-party service outage (Plausible, Giscus)
Mitigation: Fail-soft (non-blocking script), feature flag toggle.
Project Delivery Risks
Timeline Risks: Slip due to unfamiliar TipTap configuration
Mitigation: allocate spike day, reuse community starter kit.
Resource Risks: Single developer bandwidth
Mitigation: prioritize MVP scope; automate tests and CI.
Quality Risks: Low test coverage leading to regressions
Mitigation: enforce unit tests on critical utilities & components.
Deployment Risks: Supabase region latency
Mitigation: choose same region as Vercel; fallback to edge cache.
</file>

<file path="eslint.config.mjs">
import { dirname } from 'path';
import { fileURLToPath } from 'url';
import { FlatCompat } from '@eslint/eslintrc';

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

const compat = new FlatCompat({
  baseDirectory: __dirname,
});

const eslintConfig = [
  ...compat.extends('next/core-web-vitals', 'next/typescript'),
  {
    rules: {
      '@typescript-eslint/no-empty-object-type': 'off',
      '@typescript-eslint/no-explicit-any': 'off',
      '@typescript-eslint/no-unused-vars': 'off',
    },
  },
];

export default eslintConfig;
</file>

<file path="postcss.config.mjs">
/** @type {import('postcss-load-config').Config} */
const config = {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
};

export default config;
</file>

<file path="scripts/fix-admin-permissions.js">
#!/usr/bin/env node
/**
 * ê´€ë¦¬ì ê¶Œí•œ ë³µêµ¬ ìŠ¤í¬ë¦½íŠ¸
 * 
 * ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” admin@devblog.com ê³„ì •ì— ê´€ë¦¬ì ê¶Œí•œì„ ë¶€ì—¬í•©ë‹ˆë‹¤.
 */

import { createClient } from "@supabase/supabase-js";
import { config } from "dotenv";

// í™˜ê²½ ë³€ìˆ˜ ë¡œë“œ
config({ path: '.env.local' });

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;

if (!supabaseUrl || !supabaseServiceKey) {
  console.error("âŒ í™˜ê²½ ë³€ìˆ˜ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
  console.error("NEXT_PUBLIC_SUPABASE_URLê³¼ SUPABASE_SERVICE_ROLE_KEYë¥¼ í™•ì¸í•˜ì„¸ìš”.");
  process.exit(1);
}

const supabase = createClient(supabaseUrl, supabaseServiceKey);

async function fixAdminPermissions() {
  console.log("ğŸ”§ ê´€ë¦¬ì ê¶Œí•œ ë³µêµ¬ ì¤‘...");
  
  const testEmail = "admin@devblog.com";
  
  try {
    // 1. ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ
    console.log("1. ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ ì¤‘...");
    const { data: users, error: userError } = await supabase.auth.admin.listUsers();
    
    if (userError) {
      console.error("âŒ ì‚¬ìš©ì ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨:", userError.message);
      return;
    }
    
    const adminUser = users.users.find(user => user.email === testEmail);
    
    if (!adminUser) {
      console.error("âŒ admin@devblog.com ê³„ì •ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
      console.log("ğŸ“ ë¨¼ì € scripts/create-admin-demo.jsë¥¼ ì‹¤í–‰í•˜ì„¸ìš”.");
      return;
    }
    
    console.log("âœ… ì‚¬ìš©ì ì°¾ìŒ:", adminUser.email);
    console.log("   ì‚¬ìš©ì ID:", adminUser.id);
    
    // 2. í˜„ì¬ ê´€ë¦¬ì ê¶Œí•œ í™•ì¸
    console.log("\n2. í˜„ì¬ ê´€ë¦¬ì ê¶Œí•œ í™•ì¸ ì¤‘...");
    const { data: existingAdmin, error: checkError } = await supabase
      .from("admins")
      .select("user_id")
      .eq("user_id", adminUser.id)
      .single();
    
    if (checkError && checkError.code !== 'PGRST116') { // PGRST116ëŠ” "not found" ì—ëŸ¬
      console.error("âŒ ê´€ë¦¬ì ê¶Œí•œ í™•ì¸ ì‹¤íŒ¨:", checkError.message);
      return;
    }
    
    if (existingAdmin) {
      console.log("âœ… ì´ë¯¸ ê´€ë¦¬ì ê¶Œí•œì´ ìˆìŠµë‹ˆë‹¤.");
      
      // 3. ê´€ë¦¬ì í…Œì´ë¸”ì˜ ëª¨ë“  ë ˆì½”ë“œ í™•ì¸
      console.log("\n3. ê´€ë¦¬ì í…Œì´ë¸” ë‚´ìš© í™•ì¸...");
      const { data: allAdmins, error: allAdminsError } = await supabase
        .from("admins")
        .select("*");
      
      if (allAdminsError) {
        console.error("âŒ ê´€ë¦¬ì í…Œì´ë¸” ì¡°íšŒ ì‹¤íŒ¨:", allAdminsError.message);
      } else {
        console.log("ğŸ“‹ ê´€ë¦¬ì í…Œì´ë¸” ë‚´ìš©:");
        allAdmins.forEach(admin => {
          console.log(`   - ${admin.user_id} (${admin.added_at})`);
        });
      }
      
      return;
    }
    
    // 4. ê´€ë¦¬ì ê¶Œí•œ ë¶€ì—¬
    console.log("\n4. ê´€ë¦¬ì ê¶Œí•œ ë¶€ì—¬ ì¤‘...");
    const { error: adminError } = await supabase
      .from("admins")
      .insert([{ user_id: adminUser.id }]);
    
    if (adminError) {
      console.error("âŒ ê´€ë¦¬ì ê¶Œí•œ ë¶€ì—¬ ì‹¤íŒ¨:", adminError.message);
      return;
    }
    
    console.log("âœ… ê´€ë¦¬ì ê¶Œí•œ ë¶€ì—¬ ì„±ê³µ!");
    
    // 5. ê¶Œí•œ í™•ì¸
    console.log("\n5. ê¶Œí•œ ë¶€ì—¬ í™•ì¸ ì¤‘...");
    const { data: newAdmin, error: verifyError } = await supabase
      .from("admins")
      .select("*")
      .eq("user_id", adminUser.id)
      .single();
    
    if (verifyError) {
      console.error("âŒ ê¶Œí•œ í™•ì¸ ì‹¤íŒ¨:", verifyError.message);
      return;
    }
    
    console.log("âœ… ê¶Œí•œ í™•ì¸ ì„±ê³µ:");
    console.log(`   ì‚¬ìš©ì ID: ${newAdmin.user_id}`);
    console.log(`   ë“±ë¡ ì¼ì‹œ: ${newAdmin.added_at}`);
    
    console.log("\nğŸ‰ ê´€ë¦¬ì ê¶Œí•œ ë³µêµ¬ ì™„ë£Œ!");
    console.log("=".repeat(50));
    console.log("ğŸ“§ ì´ë©”ì¼:", testEmail);
    console.log("ğŸ” ë¹„ë°€ë²ˆí˜¸: [í™˜ê²½ ë³€ìˆ˜ì—ì„œ ì„¤ì •]");
    console.log("ğŸ”— ë¡œê·¸ì¸ URL: http://localhost:3001/auth/login");
    console.log("ğŸ  ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ: http://localhost:3001/admin");
    console.log("=".repeat(50));
    
  } catch (error) {
    console.error("âŒ ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜:", error.message);
    console.error("ì „ì²´ ì˜¤ë¥˜ ì •ë³´:", error);
  }
}

fixAdminPermissions();
</file>

<file path="src/app/[locale]/admin/comments/page.tsx">
'use client';

import { useState, useEffect, useCallback } from 'react';
import { useTranslations } from 'next-intl';
import { useAuth } from '@/hooks/use-auth';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
import { Alert, AlertDescription } from '@/components/ui/alert';
import { 
  MessageCircle, 
  Trash2, 
  ExternalLink, 
  Calendar, 
  User, 
  Hash,
  ThumbsUp,
  ThumbsDown,
  Reply,
  RefreshCw,
  ChevronLeft,
  ChevronRight,
  AlertCircle,
  Loader2
} from 'lucide-react';
import { formatDistanceToNow } from 'date-fns';
import { ko, enUS } from 'date-fns/locale';
import { useToast } from '@/hooks/use-toast';
import { motion, AnimatePresence } from 'framer-motion';
import Link from 'next/link';

interface Comment {
  id: string;
  content: string;
  author_name: string;
  created_at: string;
  updated_at: string;
  parent_id?: string;
  posts: {
    id: string;
    title: string;
    slug: string;
  };
  parent_comment?: {
    id: string;
    content: string;
    author_name: string;
  };
  reactionCounts: {
    like: number;
    dislike: number;
    total: number;
  };
}

interface CommentsPagination {
  page: number;
  limit: number;
  total: number;
  totalPages: number;
  hasNext: boolean;
  hasPrev: boolean;
}

interface CommentsResponse {
  comments: Comment[];
  pagination: CommentsPagination;
}

export default function CommentsManagementPage() {
  const [comments, setComments] = useState<Comment[]>([]);
  const [pagination, setPagination] = useState<CommentsPagination>({
    page: 1,
    limit: 20,
    total: 0,
    totalPages: 0,
    hasNext: false,
    hasPrev: false
  });
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [sortBy, setSortBy] = useState('newest');
  const [deleting, setDeleting] = useState<string | null>(null);

  const { user, isAdmin, loading: authLoading } = useAuth();
  const { toast } = useToast();
  const t = useTranslations('admin');
  const tComments = useTranslations('comments');
  const tCommon = useTranslations('common');

  const fetchComments = useCallback(async (page: number = 1, sort: string = 'newest') => {
    setLoading(true);
    setError(null);
    
    try {
      const response = await fetch(`/api/admin/comments?page=${page}&limit=${pagination.limit}&sort=${sort}`);
      
      if (!response.ok) {
        throw new Error('Failed to fetch comments');
      }

      const data: CommentsResponse = await response.json();
      setComments(data.comments);
      setPagination(data.pagination);
    } catch (err) {
      setError(err instanceof Error ? err.message : 'An error occurred');
    } finally {
      setLoading(false);
    }
  }, [pagination.limit]);

  const handleSortChange = (newSort: string) => {
    setSortBy(newSort);
    fetchComments(1, newSort);
  };

  const handlePageChange = (newPage: number) => {
    fetchComments(newPage, sortBy);
  };

  const handleDeleteComment = async (commentId: string) => {
    if (!confirm(tComments('confirmDeleteComment'))) {
      return;
    }

    setDeleting(commentId);
    
    try {
      const response = await fetch('/api/admin/comments', {
        method: 'DELETE',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ commentId }),
      });

      if (!response.ok) {
        throw new Error('Failed to delete comment');
      }

      // Remove comment from local state
      setComments(prev => prev.filter(comment => comment.id !== commentId));
      setPagination(prev => ({ ...prev, total: prev.total - 1 }));
      
      toast({
        title: tComments('commentDeleted'),
        description: tComments('commentDeletedSuccess'),
      });
    } catch (err) {
      toast({
        title: tComments('deleteFailed'),
        description: tComments('deleteCommentFailed'),
        variant: 'destructive',
      });
    } finally {
      setDeleting(null);
    }
  };

  const truncateContent = (content: string, maxLength: number = 100) => {
    if (content.length <= maxLength) return content;
    return content.substring(0, maxLength) + '...';
  };

  const getCommentUrl = (comment: Comment) => {
    return `/posts/${comment.posts.slug}#comment-${comment.id}`;
  };

  useEffect(() => {
    if (user && isAdmin) {
      fetchComments();
    }
  }, [user, isAdmin, fetchComments]);

  if (authLoading) {
    return (
      <div className="container py-8">
        <div className="flex items-center justify-center min-h-[200px]">
          <Loader2 className="h-8 w-8 animate-spin" />
        </div>
      </div>
    );
  }

  if (!isAdmin) {
    return (
      <div className="container py-8">
        <div className="text-center">
          <h1 className="text-2xl font-bold mb-4">ì ‘ê·¼ ê±°ë¶€</h1>
          <p className="text-muted-foreground">ì´ í˜ì´ì§€ì— ì ‘ê·¼í•  ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.</p>
        </div>
      </div>
    );
  }

  return (
    <div className="container py-8">
      {/* Header */}
      <div className="flex items-center justify-between mb-8">
        <div>
          <h1 className="text-3xl font-bold flex items-center gap-2">
            <MessageCircle className="w-8 h-8" />
            ëŒ“ê¸€ ê´€ë¦¬
          </h1>
          <p className="text-muted-foreground mt-2">
            ë¸”ë¡œê·¸ì˜ ëª¨ë“  ëŒ“ê¸€ì„ ê´€ë¦¬í•˜ê³  ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
          </p>
        </div>
        
        <div className="flex items-center gap-4">
          <Select value={sortBy} onValueChange={handleSortChange}>
            <SelectTrigger className="w-[180px]">
              <SelectValue placeholder="ì •ë ¬ ë°©ì‹" />
            </SelectTrigger>
            <SelectContent>
              <SelectItem value="newest">ìµœì‹ ìˆœ</SelectItem>
              <SelectItem value="oldest">ì˜¤ë˜ëœìˆœ</SelectItem>
              <SelectItem value="post">ê²Œì‹œë¬¼ë³„</SelectItem>
            </SelectContent>
          </Select>
          
          <Button 
            variant="outline" 
            size="sm" 
            onClick={() => fetchComments(pagination.page, sortBy)}
            disabled={loading}
          >
            <RefreshCw className={`w-4 h-4 mr-2 ${loading ? 'animate-spin' : ''}`} />
            {tCommon('refresh')}
          </Button>
        </div>
      </div>

      {/* Stats */}
      <div className="grid gap-4 md:grid-cols-3 mb-8">
        <Card>
          <CardHeader className="pb-3">
            <CardTitle className="text-sm font-medium">ì´ ëŒ“ê¸€ ìˆ˜</CardTitle>
          </CardHeader>
          <CardContent>
            <div className="text-2xl font-bold">{pagination.total}</div>
          </CardContent>
        </Card>
        
        <Card>
          <CardHeader className="pb-3">
            <CardTitle className="text-sm font-medium">ì´ í˜ì´ì§€</CardTitle>
          </CardHeader>
          <CardContent>
            <div className="text-2xl font-bold">{comments.length}</div>
          </CardContent>
        </Card>
        
        <Card>
          <CardHeader className="pb-3">
            <CardTitle className="text-sm font-medium">ì „ì²´ í˜ì´ì§€</CardTitle>
          </CardHeader>
          <CardContent>
            <div className="text-2xl font-bold">{pagination.totalPages}</div>
          </CardContent>
        </Card>
      </div>

      {/* Comments List */}
      <Card>
        <CardHeader>
          <CardTitle>ëŒ“ê¸€ ëª©ë¡</CardTitle>
          <CardDescription>
            ëŒ“ê¸€ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ê²Œì‹œë¬¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.
          </CardDescription>
        </CardHeader>
        <CardContent>
          {loading ? (
            <div className="flex items-center justify-center py-8">
              <Loader2 className="h-8 w-8 animate-spin" />
            </div>
          ) : error ? (
            <Alert variant="destructive">
              <AlertCircle className="h-4 w-4" />
              <AlertDescription>{error}</AlertDescription>
            </Alert>
          ) : comments.length === 0 ? (
            <div className="text-center py-8">
              <MessageCircle className="w-12 h-12 text-muted-foreground mx-auto mb-4" />
              <p className="text-muted-foreground">ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p>
            </div>
          ) : (
            <div className="space-y-4">
              <AnimatePresence>
                {comments.map((comment) => (
                  <motion.div
                    key={comment.id}
                    initial={{ opacity: 0, y: 20 }}
                    animate={{ opacity: 1, y: 0 }}
                    exit={{ opacity: 0, y: -20 }}
                    transition={{ duration: 0.2 }}
                  >
                    <Card className="hover:shadow-md transition-shadow">
                      <CardContent className="p-4">
                        <div className="flex items-start justify-between">
                          <div className="flex-1 min-w-0">
                            {/* Comment header */}
                            <div className="flex items-center gap-2 mb-2">
                              <User className="w-4 h-4 text-muted-foreground" />
                              <span className="font-medium">{comment.author_name}</span>
                              <span className="text-muted-foreground">â€¢</span>
                              <span className="text-sm text-muted-foreground flex items-center gap-1">
                                <Calendar className="w-3 h-3" />
                                {formatDistanceToNow(new Date(comment.created_at), { 
                                  addSuffix: true,
                                  locale: ko 
                                })}
                              </span>
                              {comment.parent_id && (
                                <Badge variant="secondary" className="text-xs">
                                  <Reply className="w-3 h-3 mr-1" />
                                  ë‹µê¸€
                                </Badge>
                              )}
                            </div>

                            {/* Parent comment (if reply) */}
                            {comment.parent_comment && (
                              <div className="bg-muted/50 rounded-lg p-3 mb-3 border-l-4 border-muted">
                                <p className="text-sm text-muted-foreground mb-1">
                                  {comment.parent_comment.author_name}ë‹˜ì˜ ëŒ“ê¸€ì— ë‹µê¸€:
                                </p>
                                <p className="text-sm">
                                  {truncateContent(comment.parent_comment.content, 80)}
                                </p>
                              </div>
                            )}

                            {/* Comment content */}
                            <Link
                              href={getCommentUrl(comment)}
                              className="block hover:text-primary transition-colors"
                            >
                              <p className="text-sm leading-relaxed mb-3 cursor-pointer">
                                {comment.content}
                              </p>
                            </Link>

                            {/* Post info */}
                            <div className="flex items-center gap-4 text-sm text-muted-foreground">
                              <div className="flex items-center gap-1">
                                <Hash className="w-3 h-3" />
                                <Link 
                                  href={`/posts/${comment.posts.slug}`}
                                  className="hover:text-primary transition-colors"
                                >
                                  {comment.posts.title}
                                </Link>
                                <ExternalLink className="w-3 h-3" />
                              </div>
                              
                              {comment.reactionCounts.total > 0 && (
                                <div className="flex items-center gap-2">
                                  <div className="flex items-center gap-1">
                                    <ThumbsUp className="w-3 h-3" />
                                    <span>{comment.reactionCounts.like}</span>
                                  </div>
                                  <div className="flex items-center gap-1">
                                    <ThumbsDown className="w-3 h-3" />
                                    <span>{comment.reactionCounts.dislike}</span>
                                  </div>
                                </div>
                              )}
                            </div>
                          </div>

                          {/* Actions */}
                          <div className="flex items-center gap-2 ml-4">
                            <Button
                              variant="ghost"
                              size="sm"
                              onClick={() => handleDeleteComment(comment.id)}
                              disabled={deleting === comment.id}
                              className="text-red-500 hover:text-red-700 hover:bg-red-50"
                            >
                              {deleting === comment.id ? (
                                <Loader2 className="w-4 h-4 animate-spin" />
                              ) : (
                                <Trash2 className="w-4 h-4" />
                              )}
                            </Button>
                          </div>
                        </div>
                      </CardContent>
                    </Card>
                  </motion.div>
                ))}
              </AnimatePresence>
            </div>
          )}
        </CardContent>
      </Card>

      {/* Pagination */}
      {pagination.totalPages > 1 && (
        <div className="flex items-center justify-center gap-2 mt-8">
          <Button
            variant="outline"
            size="sm"
            onClick={() => handlePageChange(pagination.page - 1)}
            disabled={!pagination.hasPrev}
          >
            <ChevronLeft className="w-4 h-4 mr-1" />
            {tCommon('previous')}
          </Button>
          
          <div className="flex items-center gap-2">
            {Array.from({ length: pagination.totalPages }, (_, i) => i + 1).map((page) => (
              <Button
                key={page}
                variant={page === pagination.page ? "default" : "outline"}
                size="sm"
                onClick={() => handlePageChange(page)}
                className="w-8 h-8 p-0"
              >
                {page}
              </Button>
            ))}
          </div>
          
          <Button
            variant="outline"
            size="sm"
            onClick={() => handlePageChange(pagination.page + 1)}
            disabled={!pagination.hasNext}
          >
            {tCommon('next')}
            <ChevronRight className="w-4 h-4 ml-1" />
          </Button>
        </div>
      )}
    </div>
  );
}
</file>

<file path="src/app/[locale]/admin/settings/page.tsx">
'use client';

import { useState, useEffect } from 'react';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Badge } from '@/components/ui/badge';
import { Alert, AlertDescription } from '@/components/ui/alert';
import { Separator } from '@/components/ui/separator';
import { Shield, Smartphone, AlertTriangle, CheckCircle, Settings } from 'lucide-react';
import { useAuth } from '@/hooks/use-auth';
import { createClient } from '@/lib/supabase/client';
import { useToast } from '@/hooks/use-toast';
import { MFASetup } from '@/components/auth/mfa-setup';
import { PasswordStrength } from '@/components/auth/password-strength';

export default function AdminSettingsPage() {
  const [mfaEnabled, setMfaEnabled] = useState(false);
  const [showMFASetup, setShowMFASetup] = useState(false);
  const [loading, setLoading] = useState(true);
  const [securityStats, setSecurityStats] = useState<any>(null);
  const { user, isAdmin } = useAuth();
  const { toast } = useToast();
  const supabase = createClient();

  useEffect(() => {
    if (user && isAdmin) {
      checkMFAStatus();
      loadSecurityStats();
    }
  }, [user, isAdmin]);

  const checkMFAStatus = async () => {
    try {
      const { data } = await supabase.auth.mfa.listFactors();
      setMfaEnabled(data && data.totp && data.totp.length > 0);
    } catch (error) {
      console.error('MFA ìƒíƒœ í™•ì¸ ì˜¤ë¥˜:', error);
    } finally {
      setLoading(false);
    }
  };

  const loadSecurityStats = async () => {
    try {
      const { data } = await supabase
        .from('security_dashboard')
        .select('*')
        .single();
      setSecurityStats(data);
    } catch (error) {
      console.error('ë³´ì•ˆ í†µê³„ ë¡œë“œ ì˜¤ë¥˜:', error);
    }
  };

  const disableMFA = async () => {
    try {
      const { data: factors } = await supabase.auth.mfa.listFactors();
      if (factors && factors.totp && factors.totp.length > 0) {
        await supabase.auth.mfa.unenroll({ factorId: factors.totp[0].id });
        setMfaEnabled(false);
        toast({
          title: 'MFA ë¹„í™œì„±í™” ì™„ë£Œ',
          description: 'ë‹¤ë‹¨ê³„ ì¸ì¦ì´ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.',
        });
      }
    } catch (error) {
      toast({
        title: 'ì˜¤ë¥˜ ë°œìƒ',
        description: 'MFA ë¹„í™œì„±í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.',
        variant: 'destructive',
      });
    }
  };

  const handleMFASetupComplete = () => {
    setShowMFASetup(false);
    setMfaEnabled(true);
  };

  if (!isAdmin) {
    return (
      <div className="container py-8">
        <Alert variant="destructive">
          <AlertTriangle className="h-4 w-4" />
          <AlertDescription>
            ê´€ë¦¬ì ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.
          </AlertDescription>
        </Alert>
        <div className="mt-4 p-4 bg-muted rounded-lg">
          <p className="text-sm">ë””ë²„ê·¸ ì •ë³´:</p>
          <p className="text-sm">ì‚¬ìš©ì: {user?.email || 'Not logged in'}</p>
          <p className="text-sm">ê´€ë¦¬ì ì—¬ë¶€: {isAdmin ? 'Yes' : 'No'}</p>
        </div>
      </div>
    );
  }

  if (showMFASetup) {
    return (
      <div className="container py-8">
        <MFASetup onComplete={handleMFASetupComplete} />
      </div>
    );
  }

  return (
    <div className="container py-8 max-w-4xl">
      <div className="mb-8">
        <h1 className="text-3xl font-bold tracking-tight">ê´€ë¦¬ì ì„¤ì •</h1>
        <p className="text-muted-foreground">
          ê³„ì • ë³´ì•ˆ ë° ì‹œìŠ¤í…œ ì„¤ì •ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.
        </p>
      </div>

      <div className="grid gap-6">
        {/* ë³´ì•ˆ ì„¤ì • */}
        <Card>
          <CardHeader>
            <CardTitle className="flex items-center gap-2">
              <Shield className="h-5 w-5" />
              ë³´ì•ˆ ì„¤ì •
            </CardTitle>
            <CardDescription>
              ê³„ì • ë³´ì•ˆì„ ê°•í™”í•˜ê¸° ìœ„í•œ ì„¤ì •ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.
            </CardDescription>
          </CardHeader>
          <CardContent className="space-y-6">
            {/* MFA ì„¤ì • */}
            <div className="flex items-center justify-between">
              <div className="space-y-2">
                <div className="flex items-center gap-2">
                  <Smartphone className="h-4 w-4" />
                  <span className="font-medium">ë‹¤ë‹¨ê³„ ì¸ì¦ (MFA)</span>
                  {mfaEnabled ? (
                    <Badge variant="default" className="bg-green-100 text-green-800">
                      <CheckCircle className="h-3 w-3 mr-1" />
                      í™œì„±í™”
                    </Badge>
                  ) : (
                    <Badge variant="outline" className="border-orange-500 text-orange-600">
                      ë¹„í™œì„±í™”
                    </Badge>
                  )}
                </div>
                <p className="text-sm text-muted-foreground">
                  {mfaEnabled 
                    ? 'ê³„ì •ì´ ë‹¤ë‹¨ê³„ ì¸ì¦ìœ¼ë¡œ ë³´í˜¸ë˜ê³  ìˆìŠµë‹ˆë‹¤.'
                    : 'ì¶”ê°€ ë³´ì•ˆ ê³„ì¸µì„ ìœ„í•´ MFAë¥¼ í™œì„±í™”í•˜ì„¸ìš”.'
                  }
                </p>
              </div>
              <div className="flex gap-2">
                {mfaEnabled ? (
                  <Button 
                    variant="outline" 
                    onClick={disableMFA}
                    className="text-red-600 hover:text-red-700"
                  >
                    ë¹„í™œì„±í™”
                  </Button>
                ) : (
                  <Button onClick={() => setShowMFASetup(true)}>
                    ì„¤ì •í•˜ê¸°
                  </Button>
                )}
              </div>
            </div>

            <Separator />

            {/* ë³´ì•ˆ í†µê³„ */}
            {securityStats && (
              <div className="grid gap-4 md:grid-cols-2">
                <div className="space-y-2">
                  <h4 className="font-medium">ìµœê·¼ 24ì‹œê°„ í™œë™</h4>
                  <div className="grid grid-cols-2 gap-2 text-sm">
                    <div className="flex justify-between">
                      <span>ë¡œê·¸ì¸ ì‹œë„:</span>
                      <span className="font-mono">{securityStats.login_attempts_24h}</span>
                    </div>
                    <div className="flex justify-between">
                      <span>ë¡œê·¸ì¸ ì‹¤íŒ¨:</span>
                      <span className="font-mono text-red-600">{securityStats.login_failures_24h}</span>
                    </div>
                    <div className="flex justify-between">
                      <span>ê´€ë¦¬ì ì‘ì—…:</span>
                      <span className="font-mono">{securityStats.admin_actions_24h}</span>
                    </div>
                    <div className="flex justify-between">
                      <span>ì°¨ë‹¨ëœ IP:</span>
                      <span className="font-mono">{securityStats.blocked_ips_count}</span>
                    </div>
                  </div>
                </div>
                <div className="space-y-2">
                  <h4 className="font-medium">ë³´ì•ˆ ìƒíƒœ</h4>
                  <div className="space-y-1">
                    <div className="flex items-center gap-2">
                      {mfaEnabled ? (
                        <CheckCircle className="h-4 w-4 text-green-600" />
                      ) : (
                        <AlertTriangle className="h-4 w-4 text-yellow-600" />
                      )}
                      <span className="text-sm">ë‹¤ë‹¨ê³„ ì¸ì¦</span>
                    </div>
                    <div className="flex items-center gap-2">
                      <CheckCircle className="h-4 w-4 text-green-600" />
                      <span className="text-sm">ë¡œê·¸ì¸ ì œí•œ í™œì„±í™”</span>
                    </div>
                    <div className="flex items-center gap-2">
                      <CheckCircle className="h-4 w-4 text-green-600" />
                      <span className="text-sm">ë³´ì•ˆ ë¡œê¹… í™œì„±í™”</span>
                    </div>
                  </div>
                </div>
              </div>
            )}
          </CardContent>
        </Card>

        {/* ê³„ì • ì •ë³´ */}
        <Card>
          <CardHeader>
            <CardTitle className="flex items-center gap-2">
              <Settings className="h-5 w-5" />
              ê³„ì • ì •ë³´
            </CardTitle>
            <CardDescription>
              í˜„ì¬ ë¡œê·¸ì¸ëœ ê³„ì •ì˜ ì •ë³´ì…ë‹ˆë‹¤.
            </CardDescription>
          </CardHeader>
          <CardContent className="space-y-4">
            <div className="grid gap-2">
              <div className="flex justify-between">
                <span className="text-sm font-medium">ì´ë©”ì¼:</span>
                <span className="text-sm">{user?.email}</span>
              </div>
              <div className="flex justify-between">
                <span className="text-sm font-medium">ì‚¬ìš©ì ID:</span>
                <span className="text-sm font-mono">{user?.id}</span>
              </div>
              <div className="flex justify-between">
                <span className="text-sm font-medium">ê³„ì • ìƒì„±ì¼:</span>
                <span className="text-sm">
                  {user?.created_at ? new Date(user.created_at).toLocaleDateString('ko-KR') : 'N/A'}
                </span>
              </div>
              <div className="flex justify-between">
                <span className="text-sm font-medium">ìµœì¢… ë¡œê·¸ì¸:</span>
                <span className="text-sm">
                  {user?.last_sign_in_at ? new Date(user.last_sign_in_at).toLocaleDateString('ko-KR') : 'N/A'}
                </span>
              </div>
            </div>
          </CardContent>
        </Card>

        {/* ë³´ì•ˆ ê¶Œì¥ì‚¬í•­ */}
        <Card>
          <CardHeader>
            <CardTitle>ë³´ì•ˆ ê¶Œì¥ì‚¬í•­</CardTitle>
          </CardHeader>
          <CardContent>
            <div className="space-y-3">
              <div className="flex items-start gap-2">
                <CheckCircle className="h-4 w-4 text-green-600 mt-0.5" />
                <div>
                  <p className="text-sm font-medium">ê°•ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ ì‚¬ìš©</p>
                  <p className="text-sm text-muted-foreground">
                    ìµœì†Œ 8ì ì´ìƒ, ëŒ€ì†Œë¬¸ì, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ìë¥¼ í¬í•¨í•˜ì„¸ìš”.
                  </p>
                </div>
              </div>
              <div className="flex items-start gap-2">
                <CheckCircle className="h-4 w-4 text-green-600 mt-0.5" />
                <div>
                  <p className="text-sm font-medium">ë‹¤ë‹¨ê³„ ì¸ì¦ í™œì„±í™”</p>
                  <p className="text-sm text-muted-foreground">
                    ê³„ì • ë³´ì•ˆì„ ìœ„í•´ MFAë¥¼ ë°˜ë“œì‹œ í™œì„±í™”í•˜ì„¸ìš”.
                  </p>
                </div>
              </div>
              <div className="flex items-start gap-2">
                <CheckCircle className="h-4 w-4 text-green-600 mt-0.5" />
                <div>
                  <p className="text-sm font-medium">ì •ê¸°ì ì¸ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</p>
                  <p className="text-sm text-muted-foreground">
                    3-6ê°œì›”ë§ˆë‹¤ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.
                  </p>
                </div>
              </div>
              <div className="flex items-start gap-2">
                <CheckCircle className="h-4 w-4 text-green-600 mt-0.5" />
                <div>
                  <p className="text-sm font-medium">ë³´ì•ˆ ë¡œê·¸ ëª¨ë‹ˆí„°ë§</p>
                  <p className="text-sm text-muted-foreground">
                    ì •ê¸°ì ìœ¼ë¡œ ë³´ì•ˆ ë¡œê·¸ë¥¼ í™•ì¸í•˜ì—¬ ì˜ì‹¬ìŠ¤ëŸ¬ìš´ í™œë™ì„ ê°ì§€í•˜ì„¸ìš”.
                  </p>
                </div>
              </div>
            </div>
          </CardContent>
        </Card>
      </div>
    </div>
  );
}
</file>

<file path="src/app/[locale]/auth/login/page.tsx">
'use client';

import { useState } from 'react';
import { useRouter, useSearchParams } from 'next/navigation';
import { useAuth } from '@/hooks/use-auth';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Alert, AlertDescription } from '@/components/ui/alert';
import { useToast } from '@/hooks/use-toast';
import { LogIn, Loader2, Shield } from 'lucide-react';
import Link from 'next/link';
import { MFAVerify } from '@/components/auth/mfa-verify';
import { createClient } from '@/lib/supabase/client';

export default function LoginPage() {
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');
  const [needsMFA, setNeedsMFA] = useState(false);
  const [attemptCount, setAttemptCount] = useState(0);
  
  const { signIn } = useAuth();
  const router = useRouter();
  const searchParams = useSearchParams();
  const { toast } = useToast();
  const supabase = createClient();
  
  const redirectTo = searchParams.get('redirectTo') || '/admin';

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    console.log('ğŸ“ Login form submitted');
    setLoading(true);
    setError('');
    setAttemptCount(prev => prev + 1);

    try {
      // ë¡œê·¸ì¸ ì‹œë„ ì œí•œ í™•ì¸ ì„ì‹œ ë¹„í™œì„±í™”
      console.log('ğŸ“ Skipping login rate limit check for debugging');

      console.log('ğŸ“ Calling signIn function...');
      // Direct Supabase call for debugging
      const { data, error: signInError } = await supabase.auth.signInWithPassword({
        email,
        password,
      });
      console.log('ğŸ“ SignIn completed:', { hasData: !!data, hasError: !!signInError });

      if (signInError) {
        console.log('ğŸ“ SignIn error:', signInError.message);
        setError(signInError.message);
        setLoading(false);
        return;
      }

      if (data.user) {
        console.log('ğŸ“ Login successful, checking admin status...');
        
        // If this is admin@devblog.com, ensure they're in the admins table
        if (data.user.email === 'admin@devblog.com') {
          try {
            const { data: existingAdmin } = await supabase
              .from('admins')
              .select('user_id')
              .eq('user_id', data.user.id)
              .single();
            
            if (!existingAdmin) {
              console.log('ğŸ“ Adding admin@devblog.com to admins table...');
              await supabase
                .from('admins')
                .insert({ user_id: data.user.id });
              console.log('ğŸ“ Admin user added to admins table');
            }
          } catch (error) {
            console.error('ğŸ“ Error managing admin status:', error);
          }
        }

        toast({
          description: 'Successfully signed in!',
        });
        router.push(redirectTo);
        router.refresh();
      }
    } catch (error) {
      console.error('Login error:', error);
      setError('ë¡œê·¸ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    } finally {
      setLoading(false);
    }
  };

  const handleMFASuccess = () => {
    toast({
      description: 'Successfully signed in with MFA!',
    });
    router.push(redirectTo);
    router.refresh();
  };

  const handleMFACancel = () => {
    setNeedsMFA(false);
    // ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬
    supabase.auth.signOut();
  };

  // MFA ì¸ì¦ ë‹¨ê³„
  if (needsMFA) {
    return (
      <div className="container flex items-center justify-center min-h-[calc(100vh-200px)] py-8">
        <MFAVerify 
          onSuccess={handleMFASuccess}
          onCancel={handleMFACancel}
        />
      </div>
    );
  }

  return (
    <div className="container flex items-center justify-center min-h-[calc(100vh-200px)] py-8">
      <Card className="w-full max-w-md">
        <CardHeader className="space-y-1">
          <CardTitle className="text-2xl text-center">Admin Login</CardTitle>
          <CardDescription className="text-center">
            Enter your credentials to access the admin dashboard
          </CardDescription>
        </CardHeader>
        <CardContent>
          <form onSubmit={handleSubmit} className="space-y-4">
            {error && (
              <Alert variant="destructive">
                <AlertDescription>{error}</AlertDescription>
              </Alert>
            )}
            
            {attemptCount >= 3 && (
              <Alert>
                <Shield className="h-4 w-4" />
                <AlertDescription>
                  ë³´ì•ˆì„ ìœ„í•´ ë¡œê·¸ì¸ ì‹œë„ê°€ ì œí•œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </AlertDescription>
              </Alert>
            )}
            
            <div className="space-y-2">
              <Label htmlFor="email">Email</Label>
              <Input
                id="email"
                type="email"
                placeholder="admin@example.com"
                value={email}
                onChange={(e) => setEmail(e.target.value)}
                required
                disabled={loading}
              />
            </div>
            
            <div className="space-y-2">
              <Label htmlFor="password">Password</Label>
              <Input
                id="password"
                type="password"
                value={password}
                onChange={(e) => setPassword(e.target.value)}
                required
                disabled={loading}
              />
            </div>
            
            <Button type="submit" className="w-full" disabled={loading}>
              {loading ? (
                <>
                  <Loader2 className="mr-2 h-4 w-4 animate-spin" />
                  Signing in...
                </>
              ) : (
                <>
                  <LogIn className="mr-2 h-4 w-4" />
                  Sign In
                </>
              )}
            </Button>
          </form>
          
          <div className="mt-4 text-center text-sm text-muted-foreground">
            <Link href="/" className="hover:text-primary underline">
              â† Back to Home
            </Link>
          </div>
        </CardContent>
      </Card>
    </div>
  );
}
</file>

<file path="src/app/[locale]/page.tsx.backup">
import { Suspense } from 'react';
import { getPublishedPosts } from '@/lib/blog';
import { PostCard } from '@/components/blog/post-card';
import { Button } from '@/components/ui/button';
import { ArrowRight, BookOpen } from 'lucide-react';
import { Link } from '@/i18n/routing';
import { JsonLd } from '@/components/seo/json-ld';
import { getTranslations } from 'next-intl/server';

interface HomePageProps {
  params: Promise<{ locale: string }>;
}

export default async function HomePage({ params }: HomePageProps) {
  const { locale } = await params;
  const { posts, total } = await getPublishedPosts(6);
  
  const t = await getTranslations({ locale, namespace: 'blog' });
  const tNav = await getTranslations({ locale, namespace: 'navigation' });

  return (
    <>
      <JsonLd type="website" />
      <JsonLd type="blog" />
      <div className="container py-8 lg:py-12">
      {/* Hero Section */}
      <div className="flex flex-col items-center text-center space-y-4 pb-8 lg:pb-12">
        <div className="space-y-2">
          <h1 className="text-3xl font-bold tracking-tighter sm:text-4xl md:text-5xl lg:text-6xl">
            Welcome to DevBlog
          </h1>
          <p className="mx-auto max-w-[700px] text-muted-foreground md:text-xl">
            Discover articles about web development, programming, and technology.
            Stay updated with the latest trends and best practices.
          </p>
        </div>
        <div className="flex items-center space-x-4">
          <Button asChild size="lg">
            <Link href="/posts">
              <BookOpen className="mr-2 h-4 w-4" />
              {t('allPosts')}
            </Link>
          </Button>
          <Button variant="outline" size="lg" asChild>
            <Link href="/categories">
              {tNav('categories')}
              <ArrowRight className="ml-2 h-4 w-4" />
            </Link>
          </Button>
        </div>
      </div>

      {/* Latest Posts Section */}
      <section className="space-y-6">
        <div className="flex items-center justify-between">
          <h2 className="text-2xl font-bold tracking-tighter sm:text-3xl">
            {t('recentPosts')}
          </h2>
          {total > 6 && (
            <Button variant="outline" asChild>
              <Link href="/posts">
                {t('allPosts')}
                <ArrowRight className="ml-2 h-4 w-4" />
              </Link>
            </Button>
          )}
        </div>

        {posts.length === 0 ? (
          <div className="flex flex-col items-center justify-center py-12 text-center">
            <BookOpen className="h-12 w-12 text-muted-foreground mb-4" />
            <h3 className="text-lg font-semibold mb-2">{t('noPostsFound')}</h3>
            <p className="text-muted-foreground max-w-sm">
              There are no published articles yet. Check back soon for new content!
            </p>
          </div>
        ) : (
          <div className="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
            {posts.map((post: any, index: number) => (
              <PostCard key={post.id} post={post} priority={index === 0} />
            ))}
          </div>
        )}
      </section>

      {/* Newsletter/CTA Section */}
      <section className="py-12 lg:py-16">
        <div className="mx-auto max-w-2xl text-center space-y-4">
          <h2 className="text-2xl font-bold tracking-tighter sm:text-3xl">
            Stay Updated
          </h2>
          <p className="text-muted-foreground">
            Follow us for the latest articles and insights in web development.
          </p>
          <div className="flex justify-center space-x-4">
            <Button variant="outline" asChild>
              <Link href="/rss">
                RSS Feed
              </Link>
            </Button>
            <Button variant="outline" asChild>
              <Link href="/about">
                {tNav('about')}
              </Link>
            </Button>
          </div>
        </div>
      </section>
      </div>
    </>
  );
}
</file>

<file path="src/app/[locale]/unauthorized/page.tsx">
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { AlertTriangle, Home, LogOut } from 'lucide-react';
import Link from 'next/link';

export default function UnauthorizedPage() {
  return (
    <div className="container flex items-center justify-center min-h-[calc(100vh-200px)] py-8">
      <Card className="w-full max-w-md text-center">
        <CardHeader className="space-y-4">
          <div className="mx-auto w-16 h-16 rounded-full bg-destructive/10 flex items-center justify-center">
            <AlertTriangle className="w-8 h-8 text-destructive" />
          </div>
          <CardTitle className="text-2xl">Access Denied</CardTitle>
          <CardDescription>
            You don&apos;t have permission to access this page. Only administrators can access the admin dashboard.
          </CardDescription>
        </CardHeader>
        <CardContent className="space-y-4">
          <p className="text-sm text-muted-foreground">
            If you believe this is an error, please contact the administrator.
          </p>
          <div className="flex flex-col gap-2">
            <Button asChild>
              <Link href="/">
                <Home className="mr-2 h-4 w-4" />
                Back to Home
              </Link>
            </Button>
            <Button variant="outline" asChild>
              <Link href="/auth/login">
                <LogOut className="mr-2 h-4 w-4" />
                Login with Different Account
              </Link>
            </Button>
          </div>
        </CardContent>
      </Card>
    </div>
  );
}
</file>

<file path="src/app/api/admin/analytics/route.ts">
import { NextRequest, NextResponse } from 'next/server';
import { createClient } from '@/lib/supabase/server';

export async function GET(request: NextRequest) {
  try {
    const supabase = await createClient();

    // Check if user is admin
    const { data: user, error: userError } = await supabase.auth.getUser();
    if (userError || !user?.user) {
      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
    }

    const { data: adminCheck } = await supabase
      .from('admins')
      .select('user_id')
      .eq('user_id', user.user.id)
      .single();

    if (!adminCheck) {
      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
    }

    // Get analytics data
    const [
      totalPostsResult,
      publishedPostsResult,
      totalViewsResult,
      totalCommentsResult,
      popularPostsResult,
      recentViewsResult,
      categoryStatsResult,
    ] = await Promise.all([
      // Total posts
      supabase
        .from('posts')
        .select('*', { count: 'exact', head: true })
        .is('deleted_at', null),

      // Published posts
      supabase
        .from('posts')
        .select('*', { count: 'exact', head: true })
        .eq('status', 'published')
        .is('deleted_at', null),

      // Total views
      supabase
        .from('post_views')
        .select('*', { count: 'exact', head: true }),

      // Total comments
      supabase
        .from('comments')
        .select('*', { count: 'exact', head: true })
        .is('deleted_at', null),

      // Popular posts (most viewed)
      supabase
        .from('post_views')
        .select(`
          post_id,
          posts!inner(
            id,
            title,
            slug,
            created_at
          )
        `)
        .limit(5),

      // Views in last 7 days
      supabase
        .from('post_views')
        .select('created_at')
        .gte('created_at', new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString()),

      // Category stats
      supabase
        .from('posts')
        .select(`
          category_id,
          categories!inner(
            id,
            name,
            slug
          )
        `)
        .eq('status', 'published')
        .is('deleted_at', null),
    ]);

    // Process popular posts data
    const popularPostsMap = new Map<string, any>();
    popularPostsResult.data?.forEach((view: any) => {
      const postId = view.post_id;
      if (!popularPostsMap.has(postId)) {
        popularPostsMap.set(postId, {
          ...view.posts,
          viewCount: 0,
        });
      }
      popularPostsMap.get(postId).viewCount += 1;
    });

    const popularPosts = Array.from(popularPostsMap.values())
      .sort((a, b) => b.viewCount - a.viewCount)
      .slice(0, 5);

    // Process recent views for chart data
    const viewsByDay = new Map<string, number>();
    recentViewsResult.data?.forEach((view: any) => {
      const day = new Date(view.created_at).toISOString().split('T')[0];
      viewsByDay.set(day, (viewsByDay.get(day) || 0) + 1);
    });

    const chartData = Array.from(viewsByDay.entries())
      .map(([date, views]) => ({ date, views }))
      .sort((a, b) => a.date.localeCompare(b.date));

    // Process category stats
    const categoryMap = new Map<string, any>();
    categoryStatsResult.data?.forEach((post: any) => {
      if (post.categories) {
        const categoryId = post.categories.id;
        if (!categoryMap.has(categoryId)) {
          categoryMap.set(categoryId, {
            ...post.categories,
            postCount: 0,
          });
        }
        categoryMap.get(categoryId).postCount += 1;
      }
    });

    const categoryStats = Array.from(categoryMap.values())
      .sort((a, b) => b.postCount - a.postCount);

    const analytics = {
      overview: {
        totalPosts: totalPostsResult.count || 0,
        publishedPosts: publishedPostsResult.count || 0,
        totalViews: totalViewsResult.count || 0,
        totalComments: totalCommentsResult.count || 0,
      },
      popularPosts,
      chartData,
      categoryStats,
    };

    return NextResponse.json(analytics);
  } catch (error) {
    console.error('Error fetching analytics:', error);
    return NextResponse.json(
      { error: 'Failed to fetch analytics' },
      { status: 500 }
    );
  }
}
</file>

<file path="src/app/api/admin/comments/route.ts">
import { NextRequest, NextResponse } from 'next/server';
import { createClient } from '@/lib/supabase/server';

export async function GET(request: NextRequest) {
  try {
    const supabase = await createClient();
    
    // Check if user is admin
    const { data: user, error: userError } = await supabase.auth.getUser();
    if (userError || !user?.user) {
      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
    }

    const { data: adminCheck } = await supabase
      .from('admins')
      .select('user_id')
      .eq('user_id', user.user.id)
      .single();

    if (!adminCheck) {
      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
    }

    // Get query parameters
    const { searchParams } = new URL(request.url);
    const page = parseInt(searchParams.get('page') || '1');
    const limit = parseInt(searchParams.get('limit') || '20');
    const sort = searchParams.get('sort') || 'newest'; // newest, oldest, post

    // Calculate offset
    const offset = (page - 1) * limit;

    // Build query for comments with post information and parent comment info
    let query = supabase
      .from('comments')
      .select(`
        *,
        posts!inner (
          id,
          title,
          slug
        ),
        parent_comment:parent_id (
          id,
          content,
          author_name
        ),
        reactions:comment_reactions (
          reaction_type
        )
      `)
      .is('deleted_at', null);

    // Apply sorting
    switch (sort) {
      case 'oldest':
        query = query.order('created_at', { ascending: true });
        break;
      case 'post':
        query = query.order('post_id', { ascending: true }).order('created_at', { ascending: false });
        break;
      case 'newest':
      default:
        query = query.order('created_at', { ascending: false });
        break;
    }

    // Get total count for pagination
    const { count: totalCount } = await supabase
      .from('comments')
      .select('*', { count: 'exact', head: true })
      .is('deleted_at', null);

    // Apply pagination
    const { data: comments, error } = await query
      .range(offset, offset + limit - 1);

    if (error) {
      console.error('Error fetching comments:', error);
      return NextResponse.json(
        { error: 'Failed to fetch comments' },
        { status: 500 }
      );
    }

    // Process comments to include reaction counts
    const processedComments = comments?.map(comment => {
      const reactions = comment.reactions || [];
      const reactionCounts = reactions.reduce((acc: any, reaction: any) => {
        acc[reaction.reaction_type] = (acc[reaction.reaction_type] || 0) + 1;
        return acc;
      }, {});

      return {
        ...comment,
        reactions: undefined, // Remove the raw reactions array
        reactionCounts: {
          like: reactionCounts.like || 0,
          dislike: reactionCounts.dislike || 0,
          total: reactions.length
        }
      };
    });

    // Calculate pagination info
    const totalPages = Math.ceil((totalCount || 0) / limit);
    const hasNext = page < totalPages;
    const hasPrev = page > 1;

    return NextResponse.json({
      comments: processedComments || [],
      pagination: {
        page,
        limit,
        total: totalCount || 0,
        totalPages,
        hasNext,
        hasPrev
      }
    });

  } catch (error) {
    console.error('Error in GET /api/admin/comments:', error);
    return NextResponse.json(
      { error: 'Internal server error' },
      { status: 500 }
    );
  }
}

export async function DELETE(request: NextRequest) {
  try {
    const supabase = await createClient();
    
    // Check if user is admin
    const { data: user, error: userError } = await supabase.auth.getUser();
    if (userError || !user?.user) {
      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
    }

    const { data: adminCheck } = await supabase
      .from('admins')
      .select('user_id')
      .eq('user_id', user.user.id)
      .single();

    if (!adminCheck) {
      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
    }

    // Get comment ID from request body
    const { commentId } = await request.json();
    
    if (!commentId) {
      return NextResponse.json(
        { error: 'Comment ID is required' },
        { status: 400 }
      );
    }

    // Soft delete the comment (set deleted_at timestamp)
    const { error } = await supabase
      .from('comments')
      .update({ 
        deleted_at: new Date().toISOString(),
        content: '[ì‚­ì œëœ ëŒ“ê¸€ì…ë‹ˆë‹¤]'
      })
      .eq('id', commentId);

    if (error) {
      console.error('Error deleting comment:', error);
      return NextResponse.json(
        { error: 'Failed to delete comment' },
        { status: 500 }
      );
    }

    return NextResponse.json({ 
      success: true, 
      message: 'Comment deleted successfully' 
    });

  } catch (error) {
    console.error('Error in DELETE /api/admin/comments:', error);
    return NextResponse.json(
      { error: 'Internal server error' },
      { status: 500 }
    );
  }
}
</file>

<file path="src/app/api/captcha/math/route.ts">
import { NextRequest, NextResponse } from 'next/server';
import { cookies } from 'next/headers';
import { createHmac } from 'crypto';

interface MathProblem {
  question: string;
  answer: number;
}

function generateMathProblem(): MathProblem {
  const operations = ['+', '-', 'Ã—'];
  const operation = operations[Math.floor(Math.random() * operations.length)];
  
  let num1: number, num2: number, answer: number, question: string;
  
  switch (operation) {
    case '+':
      num1 = Math.floor(Math.random() * 10) + 1; // 1-10
      num2 = Math.floor(Math.random() * 10) + 1; // 1-10
      answer = num1 + num2;
      question = `${num1} + ${num2} = ?`;
      break;
    case '-':
      num1 = Math.floor(Math.random() * 10) + 5; // 5-14
      num2 = Math.floor(Math.random() * (num1 - 1)) + 1; // 1 to (num1-1)
      answer = num1 - num2;
      question = `${num1} - ${num2} = ?`;
      break;
    case 'Ã—':
      num1 = Math.floor(Math.random() * 5) + 2; // 2-6
      num2 = Math.floor(Math.random() * 5) + 2; // 2-6
      answer = num1 * num2;
      question = `${num1} Ã— ${num2} = ?`;
      break;
    default:
      num1 = 3;
      num2 = 4;
      answer = 7;
      question = `${num1} + ${num2} = ?`;
  }
  
  return { question, answer };
}

export async function GET(request: NextRequest) {
  try {
    const problem = generateMathProblem();
    
    // Create session ID
    const sessionId = crypto.randomUUID();
    
    // Get CAPTCHA secret from environment variable
    const captchaSecret = process.env.CAPTCHA_SECRET || 'default-dev-secret-change-in-production';
    
    // Hash the answer for secure storage
    const answerHash = createHmac('sha256', captchaSecret)
      .update(String(problem.answer))
      .digest('hex');
    
    // Store hashed answer in cookie
    const cookieStore = await cookies();
    cookieStore.set(`captcha_${sessionId}`, JSON.stringify({
      answerHash,
      expires: Date.now() + 10 * 60 * 1000, // 10 minutes
    }), {
      httpOnly: true,
      secure: process.env.NODE_ENV === 'production',
      sameSite: 'lax',
      maxAge: 10 * 60, // 10 minutes
    });
    
    return NextResponse.json({
      sessionId,
      question: problem.question,
    });
  } catch (error) {
    console.error('Error generating math CAPTCHA:', error);
    return NextResponse.json(
      { error: 'Failed to generate CAPTCHA' },
      { status: 500 }
    );
  }
}

export async function POST(request: NextRequest) {
  try {
    const { sessionId, userAnswer } = await request.json();
    
    if (!sessionId || userAnswer === undefined) {
      return NextResponse.json(
        { error: 'Session ID and answer are required' },
        { status: 400 }
      );
    }
    
    // Get stored answer from cookie
    const cookieStore = await cookies();
    const storedData = cookieStore.get(`captcha_${sessionId}`);
    
    if (!storedData) {
      return NextResponse.json(
        { error: 'CAPTCHA session not found or expired' },
        { status: 400 }
      );
    }
    
    const { answerHash, expires } = JSON.parse(storedData.value);
    
    // Check if session expired
    if (Date.now() > expires) {
      // Clean up expired cookie
      cookieStore.delete(`captcha_${sessionId}`);
      return NextResponse.json(
        { error: 'CAPTCHA session expired' },
        { status: 400 }
      );
    }
    
    // Get CAPTCHA secret from environment variable
    const captchaSecret = process.env.CAPTCHA_SECRET || 'default-dev-secret-change-in-production';
    
    // Hash the user's answer and compare with stored hash
    const userAnswerHash = createHmac('sha256', captchaSecret)
      .update(String(parseInt(userAnswer)))
      .digest('hex');
    
    const isCorrect = userAnswerHash === answerHash;
    
    if (isCorrect) {
      // Mark as verified but keep cookie for comment submission
      cookieStore.set(`captcha_${sessionId}`, JSON.stringify({
        answerHash: answerHash,
        expires: expires,
        verified: true, // Mark as verified
      }), {
        httpOnly: true,
        secure: process.env.NODE_ENV === 'production',
        sameSite: 'lax',
        maxAge: 10 * 60, // 10 minutes
      });
      
      return NextResponse.json({ success: true });
    } else {
      return NextResponse.json(
        { error: 'Incorrect answer' },
        { status: 400 }
      );
    }
  } catch (error) {
    console.error('Error verifying CAPTCHA:', error);
    return NextResponse.json(
      { error: 'Failed to verify CAPTCHA' },
      { status: 500 }
    );
  }
}
</file>

<file path="src/app/api/comments/[id]/reactions/route.ts">
import { NextRequest, NextResponse } from 'next/server';
import { createClient } from '@/lib/supabase/server';
import { headers } from 'next/headers';
import { hashIpAddress, getClientIpAddress } from '@/lib/ip-hash';

export async function GET(
  request: NextRequest,
  { params }: { params: Promise<{ id: string }> }
) {
  try {
    const { id: commentId } = await params;
    const supabase = await createClient();

    // Get reaction counts for the comment
    const { data: reactions, error } = await supabase
      .from('comment_reactions')
      .select('reaction_type')
      .eq('comment_id', commentId);

    if (error) {
      throw error;
    }

    // Count reactions by type
    const reactionCounts = reactions?.reduce((acc, reaction) => {
      acc[reaction.reaction_type] = (acc[reaction.reaction_type] || 0) + 1;
      return acc;
    }, {} as Record<string, number>) || {};

    return NextResponse.json({
      commentId,
      reactions: {
        like: reactionCounts.like || 0,
        dislike: reactionCounts.dislike || 0,
      },
    });
  } catch (error) {
    console.error('Error fetching reactions:', error);
    return NextResponse.json(
      { error: 'Failed to fetch reactions' },
      { status: 500 }
    );
  }
}

export async function POST(
  request: NextRequest,
  { params }: { params: Promise<{ id: string }> }
) {
  try {
    const { id: commentId } = await params;
    const supabase = await createClient();
    const { reactionType } = await request.json();

    // Validate reaction type
    if (!['like', 'dislike'].includes(reactionType)) {
      return NextResponse.json(
        { error: 'Invalid reaction type' },
        { status: 400 }
      );
    }

    // Get IP address
    const headersList = await headers();
    const ip = getClientIpAddress(headersList);
    const hashedIp = hashIpAddress(ip);

    // Check if user already reacted to this comment
    const { data: existingReaction, error: checkError } = await supabase
      .from('comment_reactions')
      .select('*')
      .eq('comment_id', commentId)
      .eq('ip_address', hashedIp)
      .single();

    if (checkError && checkError.code !== 'PGRST116') {
      throw checkError;
    }

    if (existingReaction) {
      // If same reaction, remove it (toggle off)
      if (existingReaction.reaction_type === reactionType) {
        const { error: deleteError } = await supabase
          .from('comment_reactions')
          .delete()
          .eq('id', existingReaction.id);

        if (deleteError) {
          throw deleteError;
        }

        return NextResponse.json({
          success: true,
          message: 'Reaction removed',
          action: 'removed',
        });
      } else {
        // If different reaction, update it
        const { error: updateError } = await supabase
          .from('comment_reactions')
          .update({ reaction_type: reactionType })
          .eq('id', existingReaction.id);

        if (updateError) {
          throw updateError;
        }

        return NextResponse.json({
          success: true,
          message: 'Reaction updated',
          action: 'updated',
        });
      }
    } else {
      // Create new reaction
      const { error: insertError } = await supabase
        .from('comment_reactions')
        .insert({
          comment_id: commentId,
          ip_address: hashedIp,
          reaction_type: reactionType,
        });

      if (insertError) {
        throw insertError;
      }

      return NextResponse.json({
        success: true,
        message: 'Reaction added',
        action: 'added',
      });
    }
  } catch (error) {
    console.error('Error handling reaction:', error);
    return NextResponse.json(
      { error: 'Failed to handle reaction' },
      { status: 500 }
    );
  }
}

export async function DELETE(
  request: NextRequest,
  { params }: { params: Promise<{ id: string }> }
) {
  try {
    const { id: commentId } = await params;
    const supabase = await createClient();

    // Get IP address
    const headersList = await headers();
    const ip = getClientIpAddress(headersList);
    const hashedIp = hashIpAddress(ip);

    // Delete user's reaction
    const { error } = await supabase
      .from('comment_reactions')
      .delete()
      .eq('comment_id', commentId)
      .eq('ip_address', hashedIp);

    if (error) {
      throw error;
    }

    return NextResponse.json({
      success: true,
      message: 'Reaction removed',
    });
  } catch (error) {
    console.error('Error deleting reaction:', error);
    return NextResponse.json(
      { error: 'Failed to delete reaction' },
      { status: 500 }
    );
  }
}
</file>

<file path="src/app/api/comments/[id]/route.ts">
import { NextRequest, NextResponse } from 'next/server';
import { createClient } from '@/lib/supabase/server';
import { canDeleteComment, revokeCommentDeletionRights } from '@/lib/session';

// DELETE - Soft delete a comment (admin or user within 30 min)
export async function DELETE(
  request: NextRequest,
  { params }: { params: Promise<{ id: string }> }
) {
  try {
    const { id } = await params;
    
    if (!id) {
      return NextResponse.json(
        { error: 'Comment ID is required' },
        { status: 400 }
      );
    }
    
    const supabase = await createClient();
    
    // Check if comment exists
    const { data: comment, error: commentError } = await supabase
      .from('comments')
      .select('*')
      .eq('id', id)
      .is('deleted_at', null)
      .single();
    
    if (commentError || !comment) {
      return NextResponse.json(
        { error: 'Comment not found' },
        { status: 404 }
      );
    }

    // Check if user is admin
    const { data: { user } } = await supabase.auth.getUser();
    let isAdmin = false;
    
    if (user) {
      const { data: adminData } = await supabase
        .from('admins')
        .select('id')
        .eq('user_id', user.id)
        .single();
      
      isAdmin = !!adminData;
    }

    // Check if user can delete this comment (admin or within 30 min window)
    const canDelete = isAdmin || await canDeleteComment(id);
    
    if (!canDelete) {
      return NextResponse.json(
        { error: 'You do not have permission to delete this comment' },
        { status: 403 }
      );
    }
    
    // Soft delete comment
    const { error: deleteError } = await supabase
      .from('comments')
      .update({ deleted_at: new Date().toISOString() })
      .eq('id', id);
    
    if (deleteError) {
      console.error('Error deleting comment:', deleteError);
      return NextResponse.json(
        { error: 'Failed to delete comment' },
        { status: 500 }
      );
    }

    // Revoke deletion rights (cleanup)
    try {
      await revokeCommentDeletionRights(id);
    } catch (error) {
      console.error('Error revoking deletion rights:', error);
      // This is not a fatal error, comment was deleted successfully
    }
    
    return NextResponse.json({ 
      success: true,
      message: 'Comment deleted successfully' 
    });
  } catch (error) {
    console.error('Error in DELETE /api/comments/[id]:', error);
    return NextResponse.json(
      { error: 'Internal server error' },
      { status: 500 }
    );
  }
}
</file>

<file path="src/app/api/comments/session/route.ts">
import { NextRequest, NextResponse } from 'next/server';
import { getCommentSessionId } from '@/lib/session';

export async function POST(request: NextRequest) {
  try {
    // ì„¸ì…˜ ID ìƒì„± ë˜ëŠ” ê¸°ì¡´ ì„¸ì…˜ ë°˜í™˜
    const sessionId = await getCommentSessionId();
    
    return NextResponse.json({
      success: true,
      sessionId,
    });
  } catch (error) {
    console.error('Error creating comment session:', error);
    return NextResponse.json(
      { error: 'Failed to create comment session' },
      { status: 500 }
    );
  }
}

export async function GET(request: NextRequest) {
  try {
    // í˜„ì¬ ì„¸ì…˜ ID ë°˜í™˜ (ìƒì„±í•˜ì§€ ì•ŠìŒ)
    const sessionId = await getCommentSessionId();
    
    return NextResponse.json({
      success: true,
      sessionId,
    });
  } catch (error) {
    console.error('Error getting comment session:', error);
    return NextResponse.json(
      { error: 'Failed to get comment session' },
      { status: 500 }
    );
  }
}
</file>

<file path="src/app/api/posts/[id]/views/route.ts">
import { NextRequest, NextResponse } from 'next/server';
import { createClient } from '@/lib/supabase/server';
import { headers } from 'next/headers';
import { hashIpAddress, getClientIpAddress } from '@/lib/ip-hash';

export async function POST(
  request: NextRequest,
  { params }: { params: Promise<{ id: string }> }
) {
  try {
    const { id: postId } = await params;
    const supabase = await createClient();

    // Get IP address and user agent
    const headersList = await headers();
    const ip = getClientIpAddress(headersList);
    const hashedIp = hashIpAddress(ip);
    const userAgent = headersList.get('user-agent') || '';

    // Get session ID from request (if provided)
    const { sessionId } = await request.json().catch(() => ({}));

    // Insert view record (will be ignored if already exists for today)
    const { error } = await supabase
      .from('post_views')
      .insert({
        post_id: postId,
        ip_address: hashedIp,
        user_agent: userAgent,
        session_id: sessionId,
      });

    if (error) {
      // If it's a duplicate key error, it's fine (one view per IP per day)
      if (error.code === '23505') {
        return NextResponse.json({ success: true, message: 'View already recorded today' });
      }
      throw error;
    }

    return NextResponse.json({ success: true, message: 'View recorded' });
  } catch (error) {
    console.error('Error recording view:', error);
    return NextResponse.json(
      { success: false, error: 'Failed to record view' },
      { status: 500 }
    );
  }
}

export async function GET(
  request: NextRequest,
  { params }: { params: Promise<{ id: string }> }
) {
  try {
    const { id: postId } = await params;
    const supabase = await createClient();

    // Get view count for the post
    const { count, error } = await supabase
      .from('post_views')
      .select('*', { count: 'exact', head: true })
      .eq('post_id', postId);

    if (error) {
      throw error;
    }

    return NextResponse.json({ viewCount: count || 0 });
  } catch (error) {
    console.error('Error fetching view count:', error);
    return NextResponse.json(
      { error: 'Failed to fetch view count' },
      { status: 500 }
    );
  }
}
</file>

<file path="src/app/api/test-post/route.ts">
import { NextRequest, NextResponse } from "next/server";
import { getPostBySlug } from "@/lib/blog-server";

export async function GET(request: NextRequest) {
  try {
    const { searchParams } = new URL(request.url);
    const slug = searchParams.get("slug") || "test";

    console.log(`Attempting to fetch post with slug: ${slug}`);

    const post = await getPostBySlug(slug);

    if (!post) {
      console.log(`Post not found for slug: ${slug}`);
      return NextResponse.json(
        { error: "Post not found", slug },
        { status: 404 }
      );
    }

    console.log(`Successfully fetched post: ${post.title}`);

    return NextResponse.json({
      success: true,
      post: {
        id: post.id,
        title: post.title,
        slug: post.slug,
        status: post.status,
        published_at: post.published_at,
        category: post.category?.name,
        tags_count: post.tags?.length || 0,
      },
    });
  } catch (error) {
    console.error("API error:", error);
    return NextResponse.json(
      {
        error: "Internal server error",
        message: error instanceof Error ? error.message : "Unknown error",
        stack: error instanceof Error ? error.stack : undefined,
      },
      { status: 500 }
    );
  }
}
</file>

<file path="src/app/error.tsx">
'use client';

import { useEffect } from 'react';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { AlertCircle, Home, RefreshCw } from 'lucide-react';

export default function Error({
  error,
  reset,
}: {
  error: Error & { digest?: string };
  reset: () => void;
}) {
  useEffect(() => {
    console.error('Application error:', error);
  }, [error]);

  return (
    <div className="container flex items-center justify-center min-h-[calc(100vh-200px)] py-8">
      <Card className="w-full max-w-md text-center">
        <CardHeader className="space-y-4">
          <div className="mx-auto w-16 h-16 rounded-full bg-destructive/10 flex items-center justify-center">
            <AlertCircle className="w-8 h-8 text-destructive" />
          </div>
          <CardTitle className="text-2xl">Something went wrong</CardTitle>
          <CardDescription>
            An error occurred while loading this page. Please try again.
          </CardDescription>
        </CardHeader>
        <CardContent className="space-y-4">
          {process.env.NODE_ENV === 'development' && (
            <div className="p-4 bg-muted rounded-lg text-left">
              <p className="text-sm font-medium text-destructive mb-2">
                Error Details:
              </p>
              <code className="text-xs text-muted-foreground break-all">
                {error.message}
              </code>
            </div>
          )}
          <div className="flex flex-col gap-2">
            <Button onClick={reset}>
              <RefreshCw className="mr-2 h-4 w-4" />
              Try Again
            </Button>
            <Button variant="outline" onClick={() => window.location.href = '/'}>
              <Home className="mr-2 h-4 w-4" />
              Back to Home
            </Button>
          </div>
        </CardContent>
      </Card>
    </div>
  );
}
</file>

<file path="src/app/global-error.tsx">
'use client';

import { useEffect } from 'react';

export default function GlobalError({
  error,
  reset,
}: {
  error: Error & { digest?: string };
  reset: () => void;
}) {
  useEffect(() => {
    console.error('Global error:', error);
  }, [error]);

  return (
    <html>
      <body>
        <div style={{ 
          minHeight: '100vh', 
          display: 'flex', 
          alignItems: 'center', 
          justifyContent: 'center',
          fontFamily: 'system-ui, -apple-system, sans-serif',
          backgroundColor: '#f9fafb',
          color: '#374151'
        }}>
          <div style={{
            maxWidth: '400px',
            padding: '2rem',
            backgroundColor: 'white',
            borderRadius: '8px',
            boxShadow: '0 1px 3px rgba(0, 0, 0, 0.1)',
            textAlign: 'center'
          }}>
            <h2 style={{ marginBottom: '1rem', fontSize: '1.25rem', fontWeight: 'bold' }}>
              Something went wrong!
            </h2>
            <p style={{ marginBottom: '1.5rem', color: '#6b7280' }}>
              A critical error occurred. Please try refreshing the page.
            </p>
            <button
              onClick={reset}
              style={{
                padding: '0.5rem 1rem',
                backgroundColor: '#3b82f6',
                color: 'white',
                border: 'none',
                borderRadius: '4px',
                cursor: 'pointer',
                marginRight: '0.5rem'
              }}
            >
              Try again
            </button>
            <button
              onClick={() => window.location.href = '/'}
              style={{
                padding: '0.5rem 1rem',
                backgroundColor: '#f3f4f6',
                color: '#374151',
                border: '1px solid #d1d5db',
                borderRadius: '4px',
                cursor: 'pointer'
              }}
            >
              Go home
            </button>
          </div>
        </div>
      </body>
    </html>
  );
}
</file>

<file path="src/app/loading.tsx">
import { Skeleton } from '@/components/ui/skeleton';

export default function Loading() {
  return (
    <div className="container py-8">
      <div className="space-y-8">
        {/* Header Skeleton */}
        <div className="space-y-4">
          <Skeleton className="h-8 w-48" />
          <Skeleton className="h-4 w-96" />
        </div>

        {/* Content Skeleton */}
        <div className="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
          {Array.from({ length: 6 }).map((_, i) => (
            <div key={i} className="space-y-4">
              <Skeleton className="h-48 w-full" />
              <div className="space-y-2">
                <Skeleton className="h-4 w-full" />
                <Skeleton className="h-4 w-2/3" />
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
}
</file>

<file path="src/app/manifest.ts.backup">
import { MetadataRoute } from 'next';

export default function manifest(): MetadataRoute.Manifest {
  return {
    name: 'DevBlog - Modern Blog Platform',
    short_name: 'DevBlog',
    description: 'A modern blog platform built with Next.js and Supabase',
    start_url: '/',
    display: 'standalone',
    background_color: '#ffffff',
    theme_color: '#000000',
    icons: [
      {
        src: '/easynext.png',
        sizes: '192x192',
        type: 'image/png',
        purpose: 'maskable',
      },
      {
        src: '/easynext.png',
        sizes: '512x512',
        type: 'image/png',
        purpose: 'maskable',
      },
    ],
    categories: ['blog', 'productivity', 'education'],
    lang: 'en-US',
    orientation: 'portrait-primary',
  };
}
</file>

<file path="src/app/not-found.tsx">
import Link from 'next/link';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { FileQuestion, Home, Search } from 'lucide-react';

export default function NotFound() {
  return (
    <div className="container flex items-center justify-center min-h-[calc(100vh-200px)] py-8">
      <Card className="w-full max-w-md text-center">
        <CardHeader className="space-y-4">
          <div className="mx-auto w-16 h-16 rounded-full bg-muted flex items-center justify-center">
            <FileQuestion className="w-8 h-8 text-muted-foreground" />
          </div>
          <CardTitle className="text-2xl">Page Not Found</CardTitle>
          <CardDescription>
            The page you&apos;re looking for doesn&apos;t exist or has been moved.
          </CardDescription>
        </CardHeader>
        <CardContent className="space-y-4">
          <p className="text-sm text-muted-foreground">
            You might want to check the URL or browse our available content.
          </p>
          <div className="flex flex-col gap-2">
            <Button asChild>
              <Link href="/">
                <Home className="mr-2 h-4 w-4" />
                Back to Home
              </Link>
            </Button>
            <Button variant="outline" asChild>
              <Link href="/posts">
                <Search className="mr-2 h-4 w-4" />
                Browse Posts
              </Link>
            </Button>
          </div>
        </CardContent>
      </Card>
    </div>
  );
}
</file>

<file path="src/app/robots.ts">
import { MetadataRoute } from 'next';

export default function robots(): MetadataRoute.Robots {
  const baseUrl = process.env.NEXT_PUBLIC_SITE_URL || 'http://localhost:3000';
  
  return {
    rules: {
      userAgent: '*',
      allow: '/',
      disallow: ['/admin/', '/auth/'],
    },
    sitemap: `${baseUrl}/sitemap.xml`,
  };
}
</file>

<file path="src/app/sitemap.ts">
import { MetadataRoute } from 'next';
import { createClient } from '@/lib/supabase/server';

export default async function sitemap(): Promise<MetadataRoute.Sitemap> {
  const supabase = await createClient();
  const baseUrl = process.env.NEXT_PUBLIC_SITE_URL || 'http://localhost:3000';

  // Get all published posts
  const { data: posts } = await supabase
    .from('posts')
    .select('slug, updated_at, created_at')
    .eq('status', 'published')
    .order('created_at', { ascending: false });

  // Get all categories
  const { data: categories } = await supabase
    .from('categories')
    .select('slug, updated_at, created_at')
    .order('created_at', { ascending: false });

  const postUrls = posts?.map((post) => ({
    url: `${baseUrl}/posts/${post.slug}`,
    lastModified: new Date(post.updated_at || post.created_at),
    changeFrequency: 'weekly' as const,
    priority: 0.8,
  })) || [];

  const categoryUrls = categories?.map((category) => ({
    url: `${baseUrl}/categories/${category.slug}`,
    lastModified: new Date(category.updated_at || category.created_at),
    changeFrequency: 'weekly' as const,
    priority: 0.6,
  })) || [];

  return [
    {
      url: baseUrl,
      lastModified: new Date(),
      changeFrequency: 'daily',
      priority: 1,
    },
    {
      url: `${baseUrl}/categories`,
      lastModified: new Date(),
      changeFrequency: 'weekly',
      priority: 0.7,
    },
    {
      url: `${baseUrl}/about`,
      lastModified: new Date(),
      changeFrequency: 'monthly',
      priority: 0.5,
    },
    ...postUrls,
    ...categoryUrls,
  ];
}
</file>

<file path="src/components/admin/analytics-dashboard.tsx">
'use client';

import { useState, useEffect } from 'react';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';
import { Eye, MessageCircle, FileText, TrendingUp, Users, Calendar } from 'lucide-react';
import { useTranslations } from 'next-intl';
import { motion } from 'framer-motion';

interface AnalyticsData {
  overview: {
    totalPosts: number;
    publishedPosts: number;
    totalViews: number;
    totalComments: number;
  };
  popularPosts: Array<{
    id: string;
    title: string;
    slug: string;
    viewCount: number;
    created_at: string;
  }>;
  chartData: Array<{
    date: string;
    views: number;
  }>;
  categoryStats: Array<{
    id: number;
    name: string;
    slug: string;
    postCount: number;
  }>;
}

export function AnalyticsDashboard() {
  const [data, setData] = useState<AnalyticsData | null>(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const t = useTranslations('admin');
  const tCommon = useTranslations('common');

  useEffect(() => {
    const fetchAnalytics = async () => {
      try {
        const response = await fetch('/api/admin/analytics');
        if (!response.ok) {
          throw new Error('Failed to fetch analytics');
        }
        const analyticsData = await response.json();
        setData(analyticsData);
      } catch (err) {
        setError(err instanceof Error ? err.message : 'An error occurred');
      } finally {
        setLoading(false);
      }
    };

    fetchAnalytics();
  }, []);

  if (loading) {
    return (
      <div className="space-y-6">
        <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-4">
          {[...Array(4)].map((_, i) => (
            <Card key={i} className="animate-pulse">
              <CardHeader className="pb-3">
                <div className="h-4 bg-gray-200 rounded w-3/4"></div>
              </CardHeader>
              <CardContent>
                <div className="h-8 bg-gray-200 rounded w-1/2"></div>
              </CardContent>
            </Card>
          ))}
        </div>
      </div>
    );
  }

  if (error) {
    return (
      <Card className="border-red-200">
        <CardHeader>
          <CardTitle className="text-red-600">Error</CardTitle>
          <CardDescription>{error}</CardDescription>
        </CardHeader>
      </Card>
    );
  }

  if (!data) {
    return null;
  }

  const cardVariants = {
    hidden: { opacity: 0, y: 20 },
    visible: { opacity: 1, y: 0 },
  };

  return (
    <div className="space-y-6">
      {/* Overview Cards */}
      <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-4">
        <motion.div
          variants={cardVariants}
          initial="hidden"
          animate="visible"
          transition={{ duration: 0.5, delay: 0.1 }}
        >
          <Card>
            <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
              <CardTitle className="text-sm font-medium">ì´ ê²Œì‹œë¬¼</CardTitle>
              <FileText className="h-4 w-4 text-muted-foreground" />
            </CardHeader>
            <CardContent>
              <div className="text-2xl font-bold">{data.overview.totalPosts}</div>
              <p className="text-xs text-muted-foreground">
                {data.overview.publishedPosts}ê°œ ê²Œì‹œë¨
              </p>
            </CardContent>
          </Card>
        </motion.div>

        <motion.div
          variants={cardVariants}
          initial="hidden"
          animate="visible"
          transition={{ duration: 0.5, delay: 0.2 }}
        >
          <Card>
            <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
              <CardTitle className="text-sm font-medium">ì´ ì¡°íšŒìˆ˜</CardTitle>
              <Eye className="h-4 w-4 text-muted-foreground" />
            </CardHeader>
            <CardContent>
              <div className="text-2xl font-bold">{data.overview.totalViews.toLocaleString()}</div>
              <p className="text-xs text-muted-foreground">
                ëˆ„ì  ì¡°íšŒìˆ˜
              </p>
            </CardContent>
          </Card>
        </motion.div>

        <motion.div
          variants={cardVariants}
          initial="hidden"
          animate="visible"
          transition={{ duration: 0.5, delay: 0.3 }}
        >
          <Card>
            <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
              <CardTitle className="text-sm font-medium">ì´ ëŒ“ê¸€ìˆ˜</CardTitle>
              <MessageCircle className="h-4 w-4 text-muted-foreground" />
            </CardHeader>
            <CardContent>
              <div className="text-2xl font-bold">{data.overview.totalComments}</div>
              <p className="text-xs text-muted-foreground">
                ëˆ„ì  ëŒ“ê¸€ìˆ˜
              </p>
            </CardContent>
          </Card>
        </motion.div>

        <motion.div
          variants={cardVariants}
          initial="hidden"
          animate="visible"
          transition={{ duration: 0.5, delay: 0.4 }}
        >
          <Card>
            <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
              <CardTitle className="text-sm font-medium">í‰ê·  ì¡°íšŒìˆ˜</CardTitle>
              <TrendingUp className="h-4 w-4 text-muted-foreground" />
            </CardHeader>
            <CardContent>
              <div className="text-2xl font-bold">
                {data.overview.publishedPosts > 0 
                  ? Math.round(data.overview.totalViews / data.overview.publishedPosts)
                  : 0
                }
              </div>
              <p className="text-xs text-muted-foreground">
                ê²Œì‹œë¬¼ë‹¹ í‰ê· 
              </p>
            </CardContent>
          </Card>
        </motion.div>
      </div>

      {/* Charts and Lists */}
      <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-7">
        {/* Popular Posts */}
        <motion.div
          variants={cardVariants}
          initial="hidden"
          animate="visible"
          transition={{ duration: 0.5, delay: 0.5 }}
          className="col-span-4"
        >
          <Card>
            <CardHeader>
              <CardTitle>ì¸ê¸° ê²Œì‹œë¬¼</CardTitle>
              <CardDescription>ì¡°íšŒìˆ˜ê°€ ë§ì€ ê²Œì‹œë¬¼ ìˆœìœ„</CardDescription>
            </CardHeader>
            <CardContent>
              <div className="space-y-4">
                {data.popularPosts.map((post, index) => (
                  <div key={post.id} className="flex items-center justify-between">
                    <div className="flex items-center space-x-4">
                      <Badge variant="secondary" className="w-8 h-8 flex items-center justify-center">
                        {index + 1}
                      </Badge>
                      <div>
                        <p className="font-medium line-clamp-1">{post.title}</p>
                        <p className="text-sm text-muted-foreground">
                          {new Date(post.created_at).toLocaleDateString()}
                        </p>
                      </div>
                    </div>
                    <div className="flex items-center space-x-2">
                      <Eye className="h-4 w-4 text-muted-foreground" />
                      <span className="font-medium">{post.viewCount}</span>
                    </div>
                  </div>
                ))}
                {data.popularPosts.length === 0 && (
                  <p className="text-muted-foreground text-center py-4">
                    ì•„ì§ ì¡°íšŒìˆ˜ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤
                  </p>
                )}
              </div>
            </CardContent>
          </Card>
        </motion.div>

        {/* Category Stats */}
        <motion.div
          variants={cardVariants}
          initial="hidden"
          animate="visible"
          transition={{ duration: 0.5, delay: 0.6 }}
          className="col-span-3"
        >
          <Card>
            <CardHeader>
              <CardTitle>ì¹´í…Œê³ ë¦¬ë³„ í†µê³„</CardTitle>
              <CardDescription>ì¹´í…Œê³ ë¦¬ë³„ ê²Œì‹œë¬¼ ìˆ˜</CardDescription>
            </CardHeader>
            <CardContent>
              <div className="space-y-3">
                {data.categoryStats.map((category) => (
                  <div key={category.id} className="flex items-center justify-between">
                    <div className="flex items-center space-x-2">
                      <div className="w-3 h-3 bg-primary rounded-full"></div>
                      <span className="font-medium">{category.name}</span>
                    </div>
                    <Badge variant="outline">{category.postCount}</Badge>
                  </div>
                ))}
                {data.categoryStats.length === 0 && (
                  <p className="text-muted-foreground text-center py-4">
                    ì¹´í…Œê³ ë¦¬ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤
                  </p>
                )}
              </div>
            </CardContent>
          </Card>
        </motion.div>
      </div>

      {/* Recent Activity */}
      {data.chartData.length > 0 && (
        <motion.div
          variants={cardVariants}
          initial="hidden"
          animate="visible"
          transition={{ duration: 0.5, delay: 0.7 }}
        >
          <Card>
            <CardHeader>
              <CardTitle>ìµœê·¼ 7ì¼ ì¡°íšŒìˆ˜</CardTitle>
              <CardDescription>ì¼ë³„ ì¡°íšŒìˆ˜ ì¶”ì´</CardDescription>
            </CardHeader>
            <CardContent>
              <div className="space-y-2">
                {data.chartData.map((item) => (
                  <div key={item.date} className="flex items-center justify-between">
                    <span className="text-sm">{new Date(item.date).toLocaleDateString()}</span>
                    <div className="flex items-center space-x-2">
                      <div 
                        className="bg-primary h-2 rounded-full"
                        style={{ 
                          width: `${Math.max(20, (item.views / Math.max(...data.chartData.map(d => d.views))) * 100)}px` 
                        }}
                      ></div>
                      <span className="text-sm font-medium w-8 text-right">{item.views}</span>
                    </div>
                  </div>
                ))}
              </div>
            </CardContent>
          </Card>
        </motion.div>
      )}
    </div>
  );
}
</file>

<file path="src/components/admin/image-upload.tsx">
'use client';

import { useState, useRef } from 'react';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Card, CardContent } from '@/components/ui/card';
import { Alert, AlertDescription } from '@/components/ui/alert';
import { createClient } from '@/lib/supabase/client';
import { useToast } from '@/hooks/use-toast';
import { Upload, X, ExternalLink, Loader2, Image as ImageIcon } from 'lucide-react';

interface ImageUploadProps {
  value?: string | null;
  onChange: (url: string | null) => void;
  label?: string;
  disabled?: boolean;
}

export function ImageUpload({ value, onChange, label = "Cover Image", disabled = false }: ImageUploadProps) {
  const [uploading, setUploading] = useState(false);
  const [dragActive, setDragActive] = useState(false);
  const fileInputRef = useRef<HTMLInputElement>(null);
  const { toast } = useToast();
  const supabase = createClient();

  const handleFileUpload = async (file: File) => {
    if (!file) return;

    // Validate file type
    const validTypes = ['image/jpeg', 'image/png', 'image/webp', 'image/gif'];
    if (!validTypes.includes(file.type)) {
      toast({
        variant: 'destructive',
        description: 'Please select a valid image file (JPEG, PNG, WebP, or GIF).',
      });
      return;
    }

    // Validate file size (max 5MB)
    const maxSize = 5 * 1024 * 1024; // 5MB
    if (file.size > maxSize) {
      toast({
        variant: 'destructive',
        description: 'File size must be less than 5MB.',
      });
      return;
    }

    setUploading(true);

    try {
      // Generate unique filename
      const fileExt = file.name.split('.').pop();
      const fileName = `${Date.now()}-${Math.random().toString(36).substring(2)}.${fileExt}`;
      const filePath = `posts/${fileName}`;

      // Upload to Supabase Storage
      const { data, error } = await supabase.storage
        .from('images')
        .upload(filePath, file, {
          cacheControl: '3600',
          upsert: false
        });

      if (error) {
        throw error;
      }

      // Get public URL
      const { data: { publicUrl } } = supabase.storage
        .from('images')
        .getPublicUrl(filePath);

      onChange(publicUrl);
      
      toast({
        description: 'Image uploaded successfully!',
      });
    } catch (error: any) {
      console.error('Upload error:', error);
      
      if (error.message?.includes('The resource already exists')) {
        toast({
          variant: 'destructive',
          description: 'An image with this name already exists. Please try again.',
        });
      } else if (error.message?.includes('Bucket not found')) {
        toast({
          variant: 'destructive',
          description: 'Image storage is not configured. Please contact administrator.',
        });
      } else {
        toast({
          variant: 'destructive',
          description: 'Failed to upload image. Please try again.',
        });
      }
    } finally {
      setUploading(false);
      if (fileInputRef.current) {
        fileInputRef.current.value = '';
      }
    }
  };

  const handleDrag = (e: React.DragEvent) => {
    e.preventDefault();
    e.stopPropagation();
    if (e.type === 'dragenter' || e.type === 'dragover') {
      setDragActive(true);
    } else if (e.type === 'dragleave') {
      setDragActive(false);
    }
  };

  const handleDrop = (e: React.DragEvent) => {
    e.preventDefault();
    e.stopPropagation();
    setDragActive(false);
    
    if (disabled || uploading) return;

    const files = e.dataTransfer.files;
    if (files && files[0]) {
      handleFileUpload(files[0]);
    }
  };

  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {
    const files = e.target.files;
    if (files && files[0]) {
      handleFileUpload(files[0]);
    }
  };

  const handleRemove = () => {
    onChange(null);
  };

  return (
    <div className="space-y-4">
      <Label>{label}</Label>
      
      {/* Current Image Display */}
      {value && (
        <Card>
          <CardContent className="p-4">
            <div className="space-y-3">
              <div className="relative">
                <img
                  src={value}
                  alt="Uploaded image"
                  className="w-full h-48 object-cover rounded-lg border"
                />
                <Button
                  type="button"
                  variant="destructive"
                  size="sm"
                  className="absolute top-2 right-2"
                  onClick={handleRemove}
                  disabled={disabled || uploading}
                >
                  <X className="h-4 w-4" />
                </Button>
              </div>
              <div className="flex items-center gap-2">
                <Button
                  type="button"
                  variant="outline"
                  size="sm"
                  onClick={() => window.open(value, '_blank')}
                >
                  <ExternalLink className="h-4 w-4 mr-2" />
                  View Full Size
                </Button>
              </div>
            </div>
          </CardContent>
        </Card>
      )}

      {/* Upload Area */}
      <Card
        className={`border-2 border-dashed transition-colors ${
          dragActive 
            ? 'border-primary bg-primary/5' 
            : 'border-muted-foreground/25'
        } ${disabled ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}`}
        onDragEnter={handleDrag}
        onDragLeave={handleDrag}
        onDragOver={handleDrag}
        onDrop={handleDrop}
        onClick={() => !disabled && !uploading && fileInputRef.current?.click()}
      >
        <CardContent className="p-8">
          <div className="flex flex-col items-center justify-center space-y-3">
            {uploading ? (
              <>
                <Loader2 className="h-8 w-8 animate-spin text-primary" />
                <p className="text-sm text-muted-foreground">Uploading...</p>
              </>
            ) : (
              <>
                <ImageIcon className="h-8 w-8 text-muted-foreground" />
                <div className="text-center">
                  <p className="text-sm font-medium">
                    Click to upload or drag and drop
                  </p>
                  <p className="text-xs text-muted-foreground">
                    PNG, JPG, WebP or GIF (max 5MB)
                  </p>
                </div>
              </>
            )}
          </div>
        </CardContent>
      </Card>

      {/* Hidden File Input */}
      <input
        ref={fileInputRef}
        type="file"
        accept="image/*"
        onChange={handleFileSelect}
        className="hidden"
        disabled={disabled || uploading}
      />

      {/* Manual URL Input */}
      <div className="space-y-2">
        <Label htmlFor="image-url">Or enter image URL manually</Label>
        <Input
          id="image-url"
          type="url"
          placeholder="https://example.com/image.jpg"
          value={value || ''}
          onChange={(e) => onChange(e.target.value || null)}
          disabled={disabled}
        />
      </div>

      {/* Storage Info */}
      <Alert>
        <AlertDescription>
          <strong>Note:</strong> Images are stored in Supabase Storage. Make sure the storage bucket is properly configured.
        </AlertDescription>
      </Alert>
    </div>
  );
}
</file>

<file path="src/components/admin/recent-comments.tsx">
'use client';

import { useState, useEffect } from 'react';
import { useTranslations } from 'next-intl';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Badge } from '@/components/ui/badge';
import { 
  MessageCircle, 
  ExternalLink, 
  Calendar, 
  User, 
  Reply,
  Eye,
  Loader2,
  AlertCircle 
} from 'lucide-react';
import { formatDistanceToNow } from 'date-fns';
import { ko } from 'date-fns/locale';
import { motion, AnimatePresence } from 'framer-motion';
import Link from 'next/link';

interface Comment {
  id: string;
  content: string;
  author_name: string;
  created_at: string;
  parent_id?: string;
  posts: {
    id: string;
    title: string;
    slug: string;
  };
  parent_comment?: {
    id: string;
    content: string;
    author_name: string;
  };
  reactionCounts: {
    like: number;
    dislike: number;
    total: number;
  };
}

interface RecentCommentsProps {
  limit?: number;
  showViewAll?: boolean;
}

export function RecentComments({ limit = 5, showViewAll = true }: RecentCommentsProps) {
  const [comments, setComments] = useState<Comment[]>([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const t = useTranslations('admin');

  const fetchRecentComments = async () => {
    setLoading(true);
    setError(null);
    
    try {
      const response = await fetch(`/api/admin/comments?page=1&limit=${limit}&sort=newest`);
      
      if (!response.ok) {
        throw new Error('Failed to fetch comments');
      }

      const data = await response.json();
      setComments(data.comments);
    } catch (err) {
      setError(err instanceof Error ? err.message : 'An error occurred');
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    fetchRecentComments();
  }, [limit]);

  const truncateContent = (content: string, maxLength: number = 60) => {
    if (content.length <= maxLength) return content;
    return content.substring(0, maxLength) + '...';
  };

  const getCommentUrl = (comment: Comment) => {
    return `/posts/${comment.posts.slug}#comment-${comment.id}`;
  };

  const cardVariants = {
    hidden: { opacity: 0, y: 20 },
    visible: { opacity: 1, y: 0 },
  };

  return (
    <Card>
      <CardHeader>
        <div className="flex items-center justify-between">
          <div>
            <CardTitle className="flex items-center gap-2">
              <MessageCircle className="w-5 h-5" />
              {t('recentComments')}
            </CardTitle>
            <CardDescription>
              {t('recentActivity')}
            </CardDescription>
          </div>
          {showViewAll && (
            <Button variant="ghost" size="sm" asChild>
              <Link href="/admin/comments">
                <Eye className="w-4 h-4 mr-2" />
                {t('viewAllComments')}
              </Link>
            </Button>
          )}
        </div>
      </CardHeader>
      <CardContent>
        {loading ? (
          <div className="flex items-center justify-center py-8">
            <Loader2 className="h-6 w-6 animate-spin" />
          </div>
        ) : error ? (
          <div className="flex items-center justify-center py-8 text-red-500">
            <AlertCircle className="w-5 h-5 mr-2" />
            <span className="text-sm">{error}</span>
          </div>
        ) : comments.length === 0 ? (
          <div className="text-center py-8">
            <MessageCircle className="w-8 h-8 text-muted-foreground mx-auto mb-2" />
            <p className="text-sm text-muted-foreground">{t('noRecentComments')}</p>
          </div>
        ) : (
          <div className="space-y-4">
            <AnimatePresence>
              {comments.map((comment, index) => (
                <motion.div
                  key={comment.id}
                  variants={cardVariants}
                  initial="hidden"
                  animate="visible"
                  transition={{ duration: 0.3, delay: index * 0.1 }}
                >
                  <div className="flex items-start space-x-3 p-3 rounded-lg hover:bg-muted/50 transition-colors">
                    <div className="flex-shrink-0">
                      <div className="w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center">
                        <User className="w-4 h-4 text-primary" />
                      </div>
                    </div>
                    
                    <div className="flex-1 min-w-0">
                      <div className="flex items-center gap-2 mb-1">
                        <span className="font-medium text-sm">{comment.author_name}</span>
                        <span className="text-xs text-muted-foreground">
                          {formatDistanceToNow(new Date(comment.created_at), { 
                            addSuffix: true,
                            locale: ko 
                          })}
                        </span>
                        {comment.parent_id && (
                          <Badge variant="outline" className="text-xs">
                            <Reply className="w-2 h-2 mr-1" />
                            ë‹µê¸€
                          </Badge>
                        )}
                      </div>

                      {/* Parent comment preview (if reply) */}
                      {comment.parent_comment && (
                        <div className="bg-muted/30 rounded p-2 mb-2 border-l-2 border-muted">
                          <p className="text-xs text-muted-foreground">
                            {t('replyToUser', { author: comment.parent_comment.author_name })}
                          </p>
                          <p className="text-xs">
                            {truncateContent(comment.parent_comment.content, 40)}
                          </p>
                        </div>
                      )}

                      {/* Comment content */}
                      <Link
                        href={getCommentUrl(comment)}
                        className="block hover:text-primary transition-colors"
                      >
                        <p className="text-sm text-muted-foreground mb-2 cursor-pointer">
                          {truncateContent(comment.content, 80)}
                        </p>
                      </Link>

                      {/* Post info */}
                      <div className="flex items-center justify-between">
                        <div className="flex items-center gap-1 text-xs text-muted-foreground">
                          <Link 
                            href={`/posts/${comment.posts.slug}`}
                            className="hover:text-primary transition-colors flex items-center gap-1"
                          >
                            <span>{truncateContent(comment.posts.title, 30)}</span>
                            <ExternalLink className="w-3 h-3" />
                          </Link>
                        </div>
                        
                        {comment.reactionCounts.total > 0 && (
                          <div className="text-xs text-muted-foreground">
                            {comment.reactionCounts.total} {t('reactions')}
                          </div>
                        )}
                      </div>
                    </div>
                  </div>
                </motion.div>
              ))}
            </AnimatePresence>
          </div>
        )}
      </CardContent>
    </Card>
  );
}
</file>

<file path="src/components/admin/rich-text-editor-enhanced.tsx">
"use client";

import {
  useEditor,
  EditorContent,
  BubbleMenu,
  FloatingMenu,
} from "@tiptap/react";
import StarterKit from "@tiptap/starter-kit";
import Image from "@tiptap/extension-image";
import Link from "@tiptap/extension-link";
import TextStyle from "@tiptap/extension-text-style";
import Color from "@tiptap/extension-color";
import Highlight from "@tiptap/extension-highlight";
import TextAlign from "@tiptap/extension-text-align";
import Table from "@tiptap/extension-table";
import TableRow from "@tiptap/extension-table-row";
import TableCell from "@tiptap/extension-table-cell";
import TableHeader from "@tiptap/extension-table-header";
import Dropcursor from "@tiptap/extension-dropcursor";
import Gapcursor from "@tiptap/extension-gapcursor";
import Placeholder from "@tiptap/extension-placeholder";
import CharacterCount from "@tiptap/extension-character-count";

import { Button } from "@/components/ui/button";
import { Separator } from "@/components/ui/separator";
import { Toggle } from "@/components/ui/toggle";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import {
  Popover,
  PopoverContent,
  PopoverTrigger,
} from "@/components/ui/popover";
import {
  Bold,
  Italic,
  Underline,
  Strikethrough,
  Code,
  Heading1,
  Heading2,
  Heading3,
  List,
  ListOrdered,
  Quote,
  Undo,
  Redo,
  Link as LinkIcon,
  Image as ImageIcon,
  AlignLeft,
  AlignCenter,
  AlignRight,
  Palette,
  Highlighter,
  Table as TableIcon,
  Plus,
  Minus,
  RotateCcw,
  Eye,
  EyeOff,
} from "lucide-react";
import { useState, useCallback } from "react";
import { createClient } from "@/lib/supabase/client";
import { useToast } from "@/hooks/use-toast";

interface RichTextEditorEnhancedProps {
  value: string;
  onChange: (value: string) => void;
  placeholder?: string;
  className?: string;
  showWordCount?: boolean;
  maxLength?: number;
}

export function RichTextEditorEnhanced({
  value,
  onChange,
  placeholder = "Start writing your post...",
  className = "",
  showWordCount = true,
  maxLength,
}: RichTextEditorEnhancedProps) {
  const [linkUrl, setLinkUrl] = useState("");
  const [showLinkInput, setShowLinkInput] = useState(false);
  const [uploading, setUploading] = useState(false);
  const [showToolbar, setShowToolbar] = useState(true);
  const { toast } = useToast();
  const supabase = createClient();

  const editor = useEditor({
    extensions: [
      StarterKit.configure({
        heading: {
          levels: [1, 2, 3],
        },
      }),
      Placeholder.configure({
        placeholder: placeholder,
        showOnlyWhenEditable: true,
        showOnlyCurrent: false,
      }),
      Image.configure({
        HTMLAttributes: {
          class:
            "max-w-full h-auto rounded-lg cursor-pointer transition-all hover:shadow-md",
        },
        allowBase64: true,
        inline: false,
      }),
      Link.configure({
        openOnClick: false,
        HTMLAttributes: {
          class: "text-blue-500 underline cursor-pointer hover:text-blue-600",
        },
      }),
      TextStyle,
      Color.configure({
        types: ["textStyle"],
      }),
      Highlight.configure({
        multicolor: true,
      }),
      TextAlign.configure({
        types: ["heading", "paragraph"],
      }),
      Table.configure({
        resizable: true,
        HTMLAttributes: {
          class: "table-auto w-full border-collapse",
        },
      }),
      TableRow,
      TableHeader.configure({
        HTMLAttributes: {
          class: "bg-gray-50 font-semibold",
        },
      }),
      TableCell.configure({
        HTMLAttributes: {
          class: "border border-gray-300 px-3 py-2",
        },
      }),
      Dropcursor.configure({
        color: "#3b82f6",
        width: 3,
      }),
      Gapcursor,
      CharacterCount.configure({
        limit: maxLength,
      }),
    ],
    content: value,
    onUpdate: ({ editor }) => {
      onChange(editor.getHTML());
    },
    editorProps: {
      attributes: {
        class:
          "prose prose-sm sm:prose lg:prose-lg xl:prose-xl mx-auto focus:outline-none min-h-[500px] p-6 max-w-none",
      },
      handleDrop: (view, event, slice, moved) => {
        if (
          !moved &&
          event.dataTransfer &&
          event.dataTransfer.files &&
          event.dataTransfer.files[0]
        ) {
          const file = event.dataTransfer.files[0];
          if (file.type.startsWith("image/")) {
            handleImageUpload(file);
            return true;
          }
        }
        return false;
      },
      handlePaste: (view, event, slice) => {
        const items = Array.from(event.clipboardData?.items || []);
        const imageItem = items.find((item) => item.type.startsWith("image/"));

        if (imageItem) {
          const file = imageItem.getAsFile();
          if (file) {
            handleImageUpload(file);
            return true;
          }
        }
        return false;
      },
    },
  });

  const handleImageUpload = useCallback(
    async (file: File) => {
      if (!editor || uploading) return;

      // Validate file type
      const validTypes = ["image/jpeg", "image/png", "image/webp", "image/gif"];
      if (!validTypes.includes(file.type)) {
        toast({
          variant: "destructive",
          description:
            "Please select a valid image file (JPEG, PNG, WebP, or GIF).",
        });
        return;
      }

      // Validate file size (max 10MB)
      const maxSize = 10 * 1024 * 1024; // 10MB
      if (file.size > maxSize) {
        toast({
          variant: "destructive",
          description: "File size must be less than 10MB.",
        });
        return;
      }

      setUploading(true);

      try {
        // Generate unique filename
        const fileExt = file.name.split(".").pop();
        const fileName = `${Date.now()}-${Math.random()
          .toString(36)
          .substring(2)}.${fileExt}`;
        const filePath = `editor-images/${fileName}`;

        // Upload to Supabase Storage
        const { data, error } = await supabase.storage
          .from("blog-images")
          .upload(filePath, file, {
            cacheControl: "3600",
            upsert: false,
          });

        if (error) {
          throw error;
        }

        // Get public URL
        const {
          data: { publicUrl },
        } = supabase.storage.from("blog-images").getPublicUrl(filePath);

        // Insert image into editor at current position
        editor
          .chain()
          .focus()
          .setImage({ src: publicUrl, alt: file.name.split(".")[0] })
          .run();

        toast({
          description: "Image uploaded successfully!",
        });
      } catch (error: any) {
        console.error("Upload error:", error);
        toast({
          variant: "destructive",
          description: "Failed to upload image. Please try again.",
        });
      } finally {
        setUploading(false);
      }
    },
    [editor, uploading, supabase, toast]
  );

  const addImageFromUrl = () => {
    const url = prompt("Enter image URL:");
    if (url && editor) {
      const alt = prompt("Enter image description (optional):") || "";
      editor.chain().focus().setImage({ src: url, alt }).run();
    }
  };

  const addImageFromFile = () => {
    const input = document.createElement("input");
    input.type = "file";
    input.accept = "image/*";
    input.onchange = (e) => {
      const file = (e.target as HTMLInputElement).files?.[0];
      if (file) {
        handleImageUpload(file);
      }
    };
    input.click();
  };

  const addLink = () => {
    const url = editor?.getAttributes("link").href || "";
    const newUrl = prompt("Enter URL:", url);

    if (newUrl === null) {
      return;
    }

    if (newUrl === "") {
      editor?.chain().focus().extendMarkRange("link").unsetLink().run();
      return;
    }

    editor
      ?.chain()
      .focus()
      .extendMarkRange("link")
      .setLink({ href: newUrl })
      .run();
  };

  const addTable = () => {
    if (editor) {
      editor
        .chain()
        .focus()
        .insertTable({ rows: 3, cols: 3, withHeaderRow: true })
        .run();
    }
  };

  const getWordCount = () => {
    if (!editor) return 0;
    return editor.storage.characterCount?.words() || 0;
  };

  const getCharacterCount = () => {
    if (!editor) return 0;
    return editor.storage.characterCount?.characters() || 0;
  };

  if (!editor) {
    return (
      <div className="border rounded-lg p-6 min-h-[500px] flex items-center justify-center">
        <div className="text-muted-foreground">Loading editor...</div>
      </div>
    );
  }

  return (
    <div className={`border rounded-lg ${className}`}>
      {/* Toolbar Toggle */}
      <div className="border-b p-2 flex justify-between items-center bg-muted/50">
        <div className="text-sm text-muted-foreground">Rich Text Editor</div>
        <Button
          variant="ghost"
          size="sm"
          onClick={() => setShowToolbar(!showToolbar)}
        >
          {showToolbar ? (
            <EyeOff className="h-4 w-4" />
          ) : (
            <Eye className="h-4 w-4" />
          )}
        </Button>
      </div>

      {/* Main Toolbar */}
      {showToolbar && (
        <div className="border-b p-3">
          <div className="flex flex-wrap items-center gap-2">
            {/* Undo/Redo */}
            <div className="flex items-center gap-1">
              <Button
                variant="ghost"
                size="sm"
                onClick={() => editor.chain().focus().undo().run()}
                disabled={!editor.can().undo()}
                title="Undo"
              >
                <Undo className="h-4 w-4" />
              </Button>

              <Button
                variant="ghost"
                size="sm"
                onClick={() => editor.chain().focus().redo().run()}
                disabled={!editor.can().redo()}
                title="Redo"
              >
                <Redo className="h-4 w-4" />
              </Button>
            </div>

            <Separator orientation="vertical" className="h-6" />

            {/* Text formatting */}
            <div className="flex items-center gap-1">
              <Toggle
                size="sm"
                pressed={editor.isActive("bold")}
                onPressedChange={() =>
                  editor.chain().focus().toggleBold().run()
                }
                title="Bold"
              >
                <Bold className="h-4 w-4" />
              </Toggle>

              <Toggle
                size="sm"
                pressed={editor.isActive("italic")}
                onPressedChange={() =>
                  editor.chain().focus().toggleItalic().run()
                }
                title="Italic"
              >
                <Italic className="h-4 w-4" />
              </Toggle>

              <Toggle
                size="sm"
                pressed={editor.isActive("strike")}
                onPressedChange={() =>
                  editor.chain().focus().toggleStrike().run()
                }
                title="Strikethrough"
              >
                <Strikethrough className="h-4 w-4" />
              </Toggle>

              <Toggle
                size="sm"
                pressed={editor.isActive("code")}
                onPressedChange={() =>
                  editor.chain().focus().toggleCode().run()
                }
                title="Inline Code"
              >
                <Code className="h-4 w-4" />
              </Toggle>
            </div>

            <Separator orientation="vertical" className="h-6" />

            {/* Headings */}
            <div className="flex items-center gap-1">
              <Toggle
                size="sm"
                pressed={editor.isActive("heading", { level: 1 })}
                onPressedChange={() =>
                  editor.chain().focus().toggleHeading({ level: 1 }).run()
                }
                title="Heading 1"
              >
                <Heading1 className="h-4 w-4" />
              </Toggle>

              <Toggle
                size="sm"
                pressed={editor.isActive("heading", { level: 2 })}
                onPressedChange={() =>
                  editor.chain().focus().toggleHeading({ level: 2 }).run()
                }
                title="Heading 2"
              >
                <Heading2 className="h-4 w-4" />
              </Toggle>

              <Toggle
                size="sm"
                pressed={editor.isActive("heading", { level: 3 })}
                onPressedChange={() =>
                  editor.chain().focus().toggleHeading({ level: 3 }).run()
                }
                title="Heading 3"
              >
                <Heading3 className="h-4 w-4" />
              </Toggle>
            </div>

            <Separator orientation="vertical" className="h-6" />

            {/* Lists */}
            <div className="flex items-center gap-1">
              <Toggle
                size="sm"
                pressed={editor.isActive("bulletList")}
                onPressedChange={() =>
                  editor.chain().focus().toggleBulletList().run()
                }
                title="Bullet List"
              >
                <List className="h-4 w-4" />
              </Toggle>

              <Toggle
                size="sm"
                pressed={editor.isActive("orderedList")}
                onPressedChange={() =>
                  editor.chain().focus().toggleOrderedList().run()
                }
                title="Numbered List"
              >
                <ListOrdered className="h-4 w-4" />
              </Toggle>

              <Toggle
                size="sm"
                pressed={editor.isActive("blockquote")}
                onPressedChange={() =>
                  editor.chain().focus().toggleBlockquote().run()
                }
                title="Quote"
              >
                <Quote className="h-4 w-4" />
              </Toggle>
            </div>

            <Separator orientation="vertical" className="h-6" />

            {/* Alignment */}
            <div className="flex items-center gap-1">
              <Toggle
                size="sm"
                pressed={editor.isActive({ textAlign: "left" })}
                onPressedChange={() =>
                  editor.chain().focus().setTextAlign("left").run()
                }
                title="Align Left"
              >
                <AlignLeft className="h-4 w-4" />
              </Toggle>

              <Toggle
                size="sm"
                pressed={editor.isActive({ textAlign: "center" })}
                onPressedChange={() =>
                  editor.chain().focus().setTextAlign("center").run()
                }
                title="Align Center"
              >
                <AlignCenter className="h-4 w-4" />
              </Toggle>

              <Toggle
                size="sm"
                pressed={editor.isActive({ textAlign: "right" })}
                onPressedChange={() =>
                  editor.chain().focus().setTextAlign("right").run()
                }
                title="Align Right"
              >
                <AlignRight className="h-4 w-4" />
              </Toggle>
            </div>

            <Separator orientation="vertical" className="h-6" />

            {/* Media and Links */}
            <div className="flex items-center gap-1">
              <Popover>
                <PopoverTrigger asChild>
                  <Button variant="ghost" size="sm" title="Insert Image">
                    <ImageIcon className="h-4 w-4" />
                  </Button>
                </PopoverTrigger>
                <PopoverContent className="w-48">
                  <div className="space-y-2">
                    <Button
                      variant="ghost"
                      size="sm"
                      className="w-full justify-start"
                      onClick={addImageFromFile}
                      disabled={uploading}
                    >
                      {uploading ? "Uploading..." : "Upload Image"}
                    </Button>
                    <Button
                      variant="ghost"
                      size="sm"
                      className="w-full justify-start"
                      onClick={addImageFromUrl}
                    >
                      Image from URL
                    </Button>
                  </div>
                </PopoverContent>
              </Popover>

              <Button
                variant="ghost"
                size="sm"
                onClick={addLink}
                title="Add Link"
              >
                <LinkIcon className="h-4 w-4" />
              </Button>

              <Button
                variant="ghost"
                size="sm"
                onClick={addTable}
                title="Insert Table"
              >
                <TableIcon className="h-4 w-4" />
              </Button>
            </div>
          </div>
        </div>
      )}

      {/* Bubble Menu for Selection */}
      {editor && (
        <BubbleMenu
          editor={editor}
          tippyOptions={{ duration: 100 }}
          className="flex items-center gap-1 p-2 bg-background border rounded-lg shadow-md"
        >
          <Toggle
            size="sm"
            pressed={editor.isActive("bold")}
            onPressedChange={() => editor.chain().focus().toggleBold().run()}
          >
            <Bold className="h-4 w-4" />
          </Toggle>
          <Toggle
            size="sm"
            pressed={editor.isActive("italic")}
            onPressedChange={() => editor.chain().focus().toggleItalic().run()}
          >
            <Italic className="h-4 w-4" />
          </Toggle>
          <Button variant="ghost" size="sm" onClick={addLink}>
            <LinkIcon className="h-4 w-4" />
          </Button>
        </BubbleMenu>
      )}

      {/* Floating Menu for Empty Lines */}
      {editor && (
        <FloatingMenu
          editor={editor}
          tippyOptions={{ duration: 100 }}
          className="flex items-center gap-1 p-2 bg-background border rounded-lg shadow-md"
        >
          <Button
            variant="ghost"
            size="sm"
            onClick={() =>
              editor.chain().focus().toggleHeading({ level: 1 }).run()
            }
          >
            <Heading1 className="h-4 w-4" />
          </Button>
          <Button
            variant="ghost"
            size="sm"
            onClick={() => editor.chain().focus().toggleBulletList().run()}
          >
            <List className="h-4 w-4" />
          </Button>
          <Button
            variant="ghost"
            size="sm"
            onClick={addImageFromFile}
            disabled={uploading}
          >
            <ImageIcon className="h-4 w-4" />
          </Button>
        </FloatingMenu>
      )}

      {/* Editor Content */}
      <div className="relative">
        <EditorContent
          editor={editor}
          className="min-h-[500px] focus-within:outline-none"
        />

        {uploading && (
          <div className="absolute inset-0 bg-background/50 flex items-center justify-center">
            <div className="text-sm text-muted-foreground">
              Uploading image...
            </div>
          </div>
        )}
      </div>

      {/* Footer with Stats */}
      <div className="border-t p-3 flex justify-between items-center text-xs text-muted-foreground bg-muted/25">
        <div className="flex items-center gap-4">
          <span>
            ğŸ’¡ Drag & drop images, paste from clipboard, or use the toolbar
          </span>
        </div>

        {showWordCount && (
          <div className="flex items-center gap-4">
            <span>{getWordCount()} words</span>
            <span>{getCharacterCount()} characters</span>
            {maxLength && (
              <span
                className={
                  getCharacterCount() > maxLength ? "text-destructive" : ""
                }
              >
                {maxLength - getCharacterCount()} remaining
              </span>
            )}
          </div>
        )}
      </div>
    </div>
  );
}
</file>

<file path="src/components/auth/mfa-verify.tsx">
'use client';

import { useState } from 'react';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Alert, AlertDescription } from '@/components/ui/alert';
import { Shield, Smartphone } from 'lucide-react';
import { createClient } from '@/lib/supabase/client';

interface MFAVerifyProps {
  onSuccess?: () => void;
  onCancel?: () => void;
}

export function MFAVerify({ onSuccess, onCancel }: MFAVerifyProps) {
  const [verificationCode, setVerificationCode] = useState('');
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string>('');
  const supabase = createClient();

  const verifyMFA = async () => {
    if (!verificationCode || verificationCode.length !== 6) {
      setError('6ìë¦¬ ì¸ì¦ ì½”ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
      return;
    }

    setLoading(true);
    setError('');
    
    try {
      const { data, error } = await supabase.auth.mfa.verify({
        factorId: 'totp',
        challengeId: 'totp',
        code: verificationCode
      });
      
      if (error) throw error;
      
      onSuccess?.();
    } catch (err) {
      setError(err instanceof Error ? err.message : 'ì¸ì¦ ì½”ë“œê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
    } finally {
      setLoading(false);
    }
  };

  const handleKeyDown = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter') {
      verifyMFA();
    }
  };

  return (
    <Card className="w-full max-w-md mx-auto">
      <CardHeader className="text-center">
        <div className="mx-auto w-16 h-16 rounded-full bg-blue-100 flex items-center justify-center mb-4">
          <Shield className="w-8 h-8 text-blue-600" />
        </div>
        <CardTitle>ë‹¤ë‹¨ê³„ ì¸ì¦</CardTitle>
        <CardDescription>
          ì¸ì¦ ì•±ì—ì„œ ìƒì„±ëœ 6ìë¦¬ ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”.
        </CardDescription>
      </CardHeader>
      <CardContent className="space-y-4">
        <div className="space-y-2">
          <Label htmlFor="mfa-code">ì¸ì¦ ì½”ë“œ</Label>
          <Input
            id="mfa-code"
            type="text"
            placeholder="000000"
            value={verificationCode}
            onChange={(e) => setVerificationCode(e.target.value.replace(/\D/g, '').slice(0, 6))}
            onKeyDown={handleKeyDown}
            className="text-center text-lg font-mono"
            maxLength={6}
            autoComplete="one-time-code"
            autoFocus
          />
        </div>

        {error && (
          <Alert variant="destructive">
            <AlertDescription>{error}</AlertDescription>
          </Alert>
        )}

        <div className="space-y-2">
          <Button 
            onClick={verifyMFA}
            disabled={loading || verificationCode.length !== 6}
            className="w-full"
          >
            <Smartphone className="mr-2 h-4 w-4" />
            {loading ? 'í™•ì¸ ì¤‘...' : 'ì¸ì¦ í™•ì¸'}
          </Button>
          
          {onCancel && (
            <Button 
              variant="outline"
              onClick={onCancel}
              disabled={loading}
              className="w-full"
            >
              ì·¨ì†Œ
            </Button>
          )}
        </div>

        <div className="text-center">
          <p className="text-sm text-muted-foreground">
            ì¸ì¦ ì•±ì—ì„œ ìƒì„±ëœ ì½”ë“œëŠ” 30ì´ˆë§ˆë‹¤ ë³€ê²½ë©ë‹ˆë‹¤.
          </p>
        </div>
      </CardContent>
    </Card>
  );
}
</file>

<file path="src/components/auth/password-strength.tsx">
'use client';

import { useMemo } from 'react';
import { cn } from '@/lib/utils';
import { Check, X } from 'lucide-react';

interface PasswordStrengthProps {
  password: string;
  className?: string;
}

interface PasswordRequirement {
  label: string;
  test: (password: string) => boolean;
}

const PASSWORD_REQUIREMENTS: PasswordRequirement[] = [
  {
    label: 'ìµœì†Œ 8ì ì´ìƒ',
    test: (password) => password.length >= 8
  },
  {
    label: 'ëŒ€ë¬¸ì í¬í•¨',
    test: (password) => /[A-Z]/.test(password)
  },
  {
    label: 'ì†Œë¬¸ì í¬í•¨',
    test: (password) => /[a-z]/.test(password)
  },
  {
    label: 'ìˆ«ì í¬í•¨',
    test: (password) => /[0-9]/.test(password)
  },
  {
    label: 'íŠ¹ìˆ˜ë¬¸ì í¬í•¨',
    test: (password) => /[^A-Za-z0-9]/.test(password)
  }
];

export function PasswordStrength({ password, className }: PasswordStrengthProps) {
  const analysis = useMemo(() => {
    const results = PASSWORD_REQUIREMENTS.map(req => ({
      ...req,
      passed: req.test(password)
    }));
    
    const passedCount = results.filter(r => r.passed).length;
    const totalCount = results.length;
    const percentage = (passedCount / totalCount) * 100;
    
    let strength: 'weak' | 'fair' | 'good' | 'strong' = 'weak';
    let strengthText = 'ì•½í•¨';
    let strengthColor = 'bg-red-500';
    
    if (percentage >= 80) {
      strength = 'strong';
      strengthText = 'ê°•í•¨';
      strengthColor = 'bg-green-500';
    } else if (percentage >= 60) {
      strength = 'good';
      strengthText = 'ë³´í†µ';
      strengthColor = 'bg-yellow-500';
    } else if (percentage >= 40) {
      strength = 'fair';
      strengthText = 'ì•½ê°„ ì•½í•¨';
      strengthColor = 'bg-orange-500';
    }
    
    return {
      requirements: results,
      percentage,
      strength,
      strengthText,
      strengthColor,
      isValid: passedCount >= 4 // ìµœì†Œ 4ê°œ ì¡°ê±´ ë§Œì¡±
    };
  }, [password]);

  if (!password) return null;

  return (
    <div className={cn('space-y-3', className)}>
      {/* ë¹„ë°€ë²ˆí˜¸ ê°•ë„ í‘œì‹œ */}
      <div className="space-y-2">
        <div className="flex items-center justify-between text-sm">
          <span className="font-medium">ë¹„ë°€ë²ˆí˜¸ ê°•ë„</span>
          <span className={cn(
            'font-medium',
            analysis.strength === 'strong' && 'text-green-600',
            analysis.strength === 'good' && 'text-yellow-600',
            analysis.strength === 'fair' && 'text-orange-600',
            analysis.strength === 'weak' && 'text-red-600'
          )}>
            {analysis.strengthText}
          </span>
        </div>
        
        <div className="w-full bg-gray-200 rounded-full h-2">
          <div 
            className={cn('h-2 rounded-full transition-all duration-300', analysis.strengthColor)}
            style={{ width: `${analysis.percentage}%` }}
          />
        </div>
      </div>

      {/* ë¹„ë°€ë²ˆí˜¸ ìš”êµ¬ì‚¬í•­ */}
      <div className="space-y-2">
        <span className="text-sm font-medium">ë¹„ë°€ë²ˆí˜¸ ìš”êµ¬ì‚¬í•­</span>
        <div className="space-y-1">
          {analysis.requirements.map((req, index) => (
            <div 
              key={index}
              className={cn(
                'flex items-center gap-2 text-sm transition-colors',
                req.passed ? 'text-green-600' : 'text-muted-foreground'
              )}
            >
              {req.passed ? (
                <Check className="h-4 w-4" />
              ) : (
                <X className="h-4 w-4" />
              )}
              <span>{req.label}</span>
            </div>
          ))}
        </div>
      </div>

      {/* ì¶”ê°€ ë³´ì•ˆ íŒ */}
      {analysis.isValid && (
        <div className="text-sm text-green-600 bg-green-50 p-3 rounded-lg">
          âœ“ ì•ˆì „í•œ ë¹„ë°€ë²ˆí˜¸ì…ë‹ˆë‹¤. ì •ê¸°ì ìœ¼ë¡œ ë³€ê²½í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.
        </div>
      )}
    </div>
  );
}

// ë¹„ë°€ë²ˆí˜¸ ê²€ì¦ í•¨ìˆ˜
export function validatePassword(password: string): {
  isValid: boolean;
  errors: string[];
} {
  const errors: string[] = [];
  
  if (password.length < 8) {
    errors.push('ë¹„ë°€ë²ˆí˜¸ëŠ” ìµœì†Œ 8ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
  }
  
  if (!/[A-Z]/.test(password)) {
    errors.push('ëŒ€ë¬¸ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.');
  }
  
  if (!/[a-z]/.test(password)) {
    errors.push('ì†Œë¬¸ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.');
  }
  
  if (!/[0-9]/.test(password)) {
    errors.push('ìˆ«ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.');
  }
  
  if (!/[^A-Za-z0-9]/.test(password)) {
    errors.push('íŠ¹ìˆ˜ë¬¸ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.');
  }
  
  // ì¼ë°˜ì ì¸ ì•½í•œ ë¹„ë°€ë²ˆí˜¸ íŒ¨í„´ ê²€ì‚¬
  const weakPatterns = [
    /^(password|123456|qwerty|abc123)/i,
    /^(.)\1{7,}$/, // ê°™ì€ ë¬¸ì ë°˜ë³µ
    /^(012345|123456|234567|345678|456789|567890|678901|789012|890123|901234)/, // ì—°ì† ìˆ«ì
  ];
  
  if (weakPatterns.some(pattern => pattern.test(password))) {
    errors.push('ë” ë³µì¡í•œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”.');
  }
  
  return {
    isValid: errors.length === 0,
    errors
  };
}
</file>

<file path="src/components/blog/enhanced-comment-section.tsx">
'use client';

import { useState, useEffect, useCallback } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { useTranslations } from 'next-intl';
import { Button } from '@/components/ui/button';
import { Card, CardContent } from '@/components/ui/card';
import { Separator } from '@/components/ui/separator';
import { Alert, AlertDescription } from '@/components/ui/alert';
import { CommentForm } from '@/components/blog/comment-form';
import { 
  MessageCircle, 
  Calendar, 
  User, 
  Trash2, 
  AlertCircle,
  RefreshCw,
  ChevronLeft,
  ChevronRight,
  Clock,
  Reply,
  ThumbsUp,
  ThumbsDown,
  MoreHorizontal
} from 'lucide-react';
import { useAuth } from '@/hooks/use-auth';
import { useToast } from '@/hooks/use-toast';
import { formatDistanceToNow } from 'date-fns';
import { cn } from '@/lib/utils';

interface Comment {
  id: string;
  content: string;
  author_name: string;
  created_at: string;
  updated_at: string;
  parent_id?: string;
  replies?: Comment[];
}

interface CommentsPagination {
  page: number;
  limit: number;
  total: number;
  totalPages: number;
}

interface CommentSectionProps {
  postId: string;
}

interface CommentsResponse {
  comments: Comment[];
  userDeletableComments: string[];
  pagination: CommentsPagination;
}

interface CommentReactions {
  like: number;
  dislike: number;
}

interface CommentItemProps {
  comment: Comment;
  depth: number;
  isAdmin: boolean;
  userDeletableComments: string[];
  onDelete: (commentId: string) => void;
  onReply: (commentId: string, authorName: string) => void;
  deleting: string | null;
}

function CommentItem({ 
  comment, 
  depth, 
  isAdmin, 
  userDeletableComments, 
  onDelete, 
  onReply,
  deleting 
}: CommentItemProps) {
  const [reactions, setReactions] = useState<CommentReactions>({ like: 0, dislike: 0 });
  const [userReaction, setUserReaction] = useState<string | null>(null);
  const [reactionLoading, setReactionLoading] = useState(false);
  const { toast } = useToast();
  const t = useTranslations('comments');

  // Fetch reactions for this comment
  useEffect(() => {
    const fetchReactions = async () => {
      try {
        const response = await fetch(`/api/comments/${comment.id}/reactions`);
        if (response.ok) {
          const data = await response.json();
          setReactions(data.reactions);
        }
      } catch (error) {
        console.error('Error fetching reactions:', error);
      }
    };

    fetchReactions();
  }, [comment.id]);

  const handleReaction = async (reactionType: 'like' | 'dislike') => {
    setReactionLoading(true);
    try {
      const response = await fetch(`/api/comments/${comment.id}/reactions`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ reactionType }),
      });

      if (response.ok) {
        const data = await response.json();
        
        // Update local state based on action
        if (data.action === 'removed') {
          setUserReaction(null);
          setReactions(prev => ({
            ...prev,
            [reactionType]: Math.max(0, prev[reactionType] - 1)
          }));
        } else if (data.action === 'updated') {
          const oldReaction = userReaction as 'like' | 'dislike';
          setUserReaction(reactionType);
          setReactions(prev => ({
            ...prev,
            [oldReaction]: Math.max(0, prev[oldReaction] - 1),
            [reactionType]: prev[reactionType] + 1
          }));
        } else if (data.action === 'added') {
          setUserReaction(reactionType);
          setReactions(prev => ({
            ...prev,
            [reactionType]: prev[reactionType] + 1
          }));
        }
      } else {
        const errorData = await response.json();
        toast({
          title: t('reactionFailed'),
          description: errorData.error || t('reactionError'),
          variant: 'destructive',
        });
      }
    } catch (error) {
      toast({
        title: t('reactionFailed'),
        description: t('reactionError'),
        variant: 'destructive',
      });
    } finally {
      setReactionLoading(false);
    }
  };

  const maxDepth = 3;
  const indentLevel = Math.min(depth, maxDepth);

  return (
    <div className={cn('space-y-3', depth > 0 && 'ml-6 border-l-2 border-muted pl-4')}>
      <Card className="transition-all duration-200 hover:shadow-md">
        <CardContent className="p-4">
          <div className="flex items-start justify-between">
            <div className="flex-1">
              <div className="flex items-center gap-2 mb-2">
                <User className="w-4 h-4 text-muted-foreground" />
                <span className="font-medium">{comment.author_name}</span>
                <span className="text-muted-foreground">â€¢</span>
                <span className="text-sm text-muted-foreground flex items-center gap-1">
                  <Calendar className="w-3 h-3" />
                  {formatDistanceToNow(new Date(comment.created_at), { addSuffix: true })}
                </span>
              </div>
              <p className="text-sm leading-relaxed whitespace-pre-wrap mb-3">
                {comment.content}
              </p>
              
              {/* Reaction and Reply buttons */}
              <div className="flex items-center gap-4">
                <div className="flex items-center gap-2">
                  <Button
                    variant="ghost"
                    size="sm"
                    onClick={() => handleReaction('like')}
                    disabled={reactionLoading}
                    className={cn(
                      "h-8 text-xs",
                      userReaction === 'like' && "bg-green-100 text-green-600 hover:bg-green-200"
                    )}
                  >
                    <ThumbsUp className="w-3 h-3 mr-1" />
                    {reactions.like}
                  </Button>
                  <Button
                    variant="ghost"
                    size="sm"
                    onClick={() => handleReaction('dislike')}
                    disabled={reactionLoading}
                    className={cn(
                      "h-8 text-xs",
                      userReaction === 'dislike' && "bg-red-100 text-red-600 hover:bg-red-200"
                    )}
                  >
                    <ThumbsDown className="w-3 h-3 mr-1" />
                    {reactions.dislike}
                  </Button>
                </div>
                
                {depth < maxDepth && (
                  <Button
                    variant="ghost"
                    size="sm"
                    onClick={() => onReply(comment.id, comment.author_name)}
                    className="h-8 text-xs"
                  >
                    <Reply className="w-3 h-3 mr-1" />
                    {t('reply')}
                  </Button>
                )}
              </div>
            </div>
            
            {(isAdmin || userDeletableComments.includes(comment.id)) && (
              <div className="flex items-center gap-2">
                {!isAdmin && userDeletableComments.includes(comment.id) && (
                  <div className="flex items-center gap-1 text-xs text-muted-foreground">
                    <Clock className="w-3 h-3" />
                    <span>{t('canDeleteComment')}</span>
                  </div>
                )}
                <Button
                  variant="ghost"
                  size="sm"
                  onClick={() => onDelete(comment.id)}
                  disabled={deleting === comment.id}
                  className="text-red-500 hover:text-red-700 hover:bg-red-50"
                  title={isAdmin ? t('deleteCommentAdmin') : t('deleteYourComment')}
                >
                  {deleting === comment.id ? (
                    <div className="animate-spin rounded-full h-4 w-4 border-b-2 border-red-500"></div>
                  ) : (
                    <Trash2 className="w-4 h-4" />
                  )}
                </Button>
              </div>
            )}
          </div>
        </CardContent>
      </Card>
      
      {/* Render nested replies */}
      {comment.replies && comment.replies.length > 0 && (
        <AnimatePresence>
          {comment.replies.map((reply) => (
            <motion.div
              key={reply.id}
              initial={{ opacity: 0, x: -20 }}
              animate={{ opacity: 1, x: 0 }}
              exit={{ opacity: 0, x: -20 }}
              transition={{ duration: 0.3 }}
            >
              <CommentItem
                comment={reply}
                depth={depth + 1}
                isAdmin={isAdmin}
                userDeletableComments={userDeletableComments}
                onDelete={onDelete}
                onReply={onReply}
                deleting={deleting}
              />
            </motion.div>
          ))}
        </AnimatePresence>
      )}
    </div>
  );
}

export function EnhancedCommentSection({ postId }: CommentSectionProps) {
  const [comments, setComments] = useState<Comment[]>([]);
  const [userDeletableComments, setUserDeletableComments] = useState<string[]>([]);
  const [pagination, setPagination] = useState<CommentsPagination>({
    page: 1,
    limit: 10,
    total: 0,
    totalPages: 0,
  });
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [deleting, setDeleting] = useState<string | null>(null);
  const [sessionInitialized, setSessionInitialized] = useState(false);
  const [replyingTo, setReplyingTo] = useState<{ id: string; author: string } | null>(null);
  
  const { isAdmin } = useAuth();
  const { toast } = useToast();
  const t = useTranslations('comments');
  const tCommon = useTranslations('common');

  // Initialize comment session on component mount
  const initializeCommentSession = useCallback(async () => {
    try {
      const response = await fetch('/api/comments/session', {
        method: 'POST',
      });
      
      if (response.ok) {
        setSessionInitialized(true);
      }
    } catch (error) {
      console.error('Failed to initialize comment session:', error);
    }
  }, []);

  const fetchComments = useCallback(async (page: number = 1) => {
    setLoading(true);
    setError(null);
    
    try {
      const response = await fetch(`/api/comments?postId=${postId}&page=${page}&limit=${pagination.limit}`);
      const data: CommentsResponse = await response.json();
      
      if (response.ok) {
        setComments(data.comments);
        setUserDeletableComments(data.userDeletableComments);
        setPagination(data.pagination);
      } else {
        setError(t('loadCommentsFailed'));
      }
    } catch (err) {
      setError(t('loadCommentsFailed'));
    } finally {
      setLoading(false);
    }
  }, [postId, pagination.limit, t]);

  const handleDeleteComment = async (commentId: string) => {
    if (!confirm(t('confirmDeleteComment'))) {
      return;
    }

    setDeleting(commentId);
    
    try {
      const response = await fetch(`/api/comments/${commentId}`, {
        method: 'DELETE',
      });
      
      if (response.ok) {
        // Remove comment from state (works for both parent and nested comments)
        const removeComment = (comments: Comment[]): Comment[] => {
          return comments.filter(comment => {
            if (comment.id === commentId) {
              return false;
            }
            if (comment.replies) {
              comment.replies = removeComment(comment.replies);
            }
            return true;
          });
        };
        
        setComments(removeComment(comments));
        setPagination(prev => ({
          ...prev,
          total: prev.total - 1,
        }));
        
        toast({
          title: t('commentDeleted'),
          description: t('commentDeletedSuccess'),
        });
      } else {
        const data = await response.json();
        toast({
          title: t('deleteFailed'),
          description: data.error || t('deleteCommentFailed'),
          variant: 'destructive',
        });
      }
    } catch (err) {
      toast({
        title: t('deleteFailed'),
        description: t('deleteCommentFailed'),
        variant: 'destructive',
      });
    } finally {
      setDeleting(null);
    }
  };

  const handleCommentAdded = (newComment: Comment) => {
    if (replyingTo) {
      // Add reply to the parent comment
      const addReply = (comments: Comment[]): Comment[] => {
        return comments.map(comment => {
          if (comment.id === replyingTo.id) {
            return {
              ...comment,
              replies: [...(comment.replies || []), newComment]
            };
          }
          if (comment.replies) {
            return {
              ...comment,
              replies: addReply(comment.replies)
            };
          }
          return comment;
        });
      };
      
      setComments(addReply(comments));
      setReplyingTo(null);
    } else {
      // Add new parent comment
      setComments(prev => [newComment, ...prev]);
    }
    
    setUserDeletableComments(prev => [...prev, newComment.id]);
    setPagination(prev => ({
      ...prev,
      total: prev.total + 1,
    }));
  };

  const handleReply = (commentId: string, authorName: string) => {
    setReplyingTo({ id: commentId, author: authorName });
  };

  const handleCancelReply = () => {
    setReplyingTo(null);
  };

  const handlePageChange = (newPage: number) => {
    if (newPage >= 1 && newPage <= pagination.totalPages) {
      fetchComments(newPage);
    }
  };

  useEffect(() => {
    initializeCommentSession();
    fetchComments();
  }, [postId, initializeCommentSession, fetchComments]);

  const containerVariants = {
    hidden: { opacity: 0 },
    visible: {
      opacity: 1,
      transition: {
        staggerChildren: 0.1,
      },
    },
  };

  const itemVariants = {
    hidden: { y: 20, opacity: 0 },
    visible: {
      y: 0,
      opacity: 1,
      transition: {
        duration: 0.5,
      },
    },
  };

  return (
    <div className="space-y-8">
      {/* Comments Header */}
      <div className="flex items-center justify-between">
        <h2 className="text-2xl font-bold flex items-center gap-2">
          <MessageCircle className="w-6 h-6" />
          {t('comments')} ({pagination.total})
          {sessionInitialized && (
            <span className="text-xs text-green-600 dark:text-green-400 ml-2">
              {t('sessionReady')}
            </span>
          )}
        </h2>
        
        <Button
          variant="outline"
          size="sm"
          onClick={() => fetchComments(pagination.page)}
          disabled={loading}
        >
          <RefreshCw className={`w-4 h-4 mr-2 ${loading ? 'animate-spin' : ''}`} />
          {tCommon('refresh')}
        </Button>
      </div>

      {/* Comment Form */}
      <CommentForm 
        postId={postId} 
        parentId={replyingTo?.id}
        parentAuthor={replyingTo?.author}
        onCommentAdded={handleCommentAdded}
        onCancel={replyingTo ? handleCancelReply : undefined}
      />

      <Separator />

      {/* Comments List */}
      <div className="space-y-6">
        {loading && comments.length === 0 ? (
          <div className="flex items-center justify-center py-8">
            <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
          </div>
        ) : error ? (
          <Alert variant="destructive">
            <AlertCircle className="h-4 w-4" />
            <AlertDescription>{error}</AlertDescription>
          </Alert>
        ) : comments.length === 0 ? (
          <div className="text-center py-8">
            <MessageCircle className="w-12 h-12 text-muted-foreground mx-auto mb-4" />
            <p className="text-muted-foreground">{t('noComments')}</p>
          </div>
        ) : (
          <motion.div
            variants={containerVariants}
            initial="hidden"
            animate="visible"
            className="space-y-4"
          >
            <AnimatePresence>
              {comments.map((comment) => (
                <motion.div
                  key={comment.id}
                  variants={itemVariants}
                  initial="hidden"
                  animate="visible"
                  exit="hidden"
                  layout
                >
                  <CommentItem
                    comment={comment}
                    depth={0}
                    isAdmin={isAdmin}
                    userDeletableComments={userDeletableComments}
                    onDelete={handleDeleteComment}
                    onReply={handleReply}
                    deleting={deleting}
                  />
                </motion.div>
              ))}
            </AnimatePresence>
          </motion.div>
        )}
      </div>

      {/* Pagination */}
      {pagination.totalPages > 1 && (
        <div className="flex items-center justify-center gap-2">
          <Button
            variant="outline"
            size="sm"
            onClick={() => handlePageChange(pagination.page - 1)}
            disabled={pagination.page === 1}
          >
            <ChevronLeft className="w-4 h-4 mr-1" />
            {tCommon('previous')}
          </Button>
          
          <div className="flex items-center gap-2">
            {Array.from({ length: pagination.totalPages }, (_, i) => i + 1).map((page) => (
              <Button
                key={page}
                variant={page === pagination.page ? "default" : "outline"}
                size="sm"
                onClick={() => handlePageChange(page)}
                className="w-8 h-8 p-0"
              >
                {page}
              </Button>
            ))}
          </div>
          
          <Button
            variant="outline"
            size="sm"
            onClick={() => handlePageChange(pagination.page + 1)}
            disabled={pagination.page === pagination.totalPages}
          >
            {tCommon('next')}
            <ChevronRight className="w-4 h-4 ml-1" />
          </Button>
        </div>
      )}
    </div>
  );
}
</file>

<file path="src/components/blog/html-content.tsx">
'use client';

import { useEffect, useState } from 'react';
import DOMPurify from 'dompurify';

interface HtmlContentProps {
  content: string;
  className?: string;
}

export function HtmlContent({ content, className = '' }: HtmlContentProps) {
  const [sanitizedContent, setSanitizedContent] = useState<string>('');
  const [isMounted, setIsMounted] = useState(false);

  useEffect(() => {
    setIsMounted(true);
  }, []);

  useEffect(() => {
    if (isMounted && content) {
      // Configure DOMPurify to allow safe HTML elements and attributes
      const cleanContent = DOMPurify.sanitize(content, {
        ALLOWED_TAGS: [
          'h1', 'h2', 'h3', 'h4', 'h5', 'h6',
          'p', 'br', 'strong', 'em', 'u', 's', 'del', 'mark',
          'ul', 'ol', 'li', 'blockquote', 'pre', 'code',
          'a', 'img', 'table', 'thead', 'tbody', 'tr', 'th', 'td',
          'div', 'span', 'hr'
        ],
        ALLOWED_ATTR: [
          'href', 'target', 'rel', 'title', 'alt', 'src', 'width', 'height',
          'class', 'colspan', 'rowspan', 'align'
        ],
        ALLOW_DATA_ATTR: false,
        RETURN_DOM_FRAGMENT: false,
        RETURN_DOM: false
      });
      
      setSanitizedContent(cleanContent);
    }
  }, [content, isMounted]);

  // Don't render anything on the server to avoid hydration mismatches
  if (!isMounted) {
    return null;
  }

  return (
    <div 
      className={`html-content prose prose-lg max-w-none dark:prose-invert ${className}`}
      dangerouslySetInnerHTML={{ __html: sanitizedContent }}
    />
  );
}

interface HtmlPreviewProps {
  content: string;
  maxLength?: number;
  className?: string;
}

export function HtmlPreview({ content, maxLength = 150, className = '' }: HtmlPreviewProps) {
  const [preview, setPreview] = useState<string>('');
  const [isMounted, setIsMounted] = useState(false);

  useEffect(() => {
    setIsMounted(true);
  }, []);

  useEffect(() => {
    if (isMounted && content) {
      // Strip HTML tags and get text content for preview
      const textContent = content.replace(/<[^>]*>/g, '');
      const trimmedContent = textContent.length > maxLength 
        ? textContent.slice(0, maxLength) + '...'
        : textContent;
      
      setPreview(trimmedContent);
    }
  }, [content, maxLength, isMounted]);

  if (!isMounted) {
    return null;
  }

  return (
    <p className={`text-muted-foreground ${className}`}>
      {preview}
    </p>
  );
}
</file>

<file path="src/components/blog/math-captcha.tsx">
'use client';

import { useState, useEffect } from 'react';
import { motion } from 'framer-motion';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { RefreshCw, Calculator } from 'lucide-react';

interface MathCaptchaProps {
  onVerify: (sessionId: string, answer: string) => Promise<boolean>;
  onSuccess?: () => void;
  onError?: (error: string) => void;
}

interface CaptchaData {
  sessionId: string;
  question: string;
}

export function MathCaptcha({ onVerify, onSuccess, onError }: MathCaptchaProps) {
  const [captchaData, setCaptchaData] = useState<CaptchaData | null>(null);
  const [userAnswer, setUserAnswer] = useState('');
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [verifying, setVerifying] = useState(false);

  const fetchNewCaptcha = async () => {
    setLoading(true);
    setError(null);
    setUserAnswer('');
    
    try {
      const response = await fetch('/api/captcha/math');
      const data = await response.json();
      
      if (response.ok) {
        setCaptchaData(data);
      } else {
        setError(data.error || 'Failed to load CAPTCHA');
      }
    } catch (err) {
      setError('Failed to load CAPTCHA');
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    fetchNewCaptcha();
  }, []);

  const handleVerify = async () => {
    if (!captchaData || !userAnswer.trim()) {
      setError('Please enter an answer');
      return;
    }

    setVerifying(true);
    setError(null);

    try {
      const isCorrect = await onVerify(captchaData.sessionId, userAnswer);
      
      if (isCorrect) {
        onSuccess?.();
      } else {
        setError('Incorrect answer. Please try again.');
        fetchNewCaptcha();
      }
    } catch (err) {
      const errorMessage = err instanceof Error ? err.message : 'Verification failed';
      setError(errorMessage);
      onError?.(errorMessage);
    } finally {
      setVerifying(false);
    }
  };

  const handleKeyPress = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter') {
      handleVerify();
    }
  };

  return (
    <motion.div
      className="space-y-4 p-4 rounded-lg border bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-950 dark:to-indigo-950"
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.3 }}
    >
      <div className="flex items-center gap-2 text-sm font-medium text-blue-700 dark:text-blue-300">
        <Calculator className="w-4 h-4" />
        Anti-Spam Verification
      </div>
      
      {loading ? (
        <div className="flex items-center justify-center py-8">
          <div className="animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"></div>
        </div>
      ) : (
        <div className="space-y-3">
          <div className="text-center">
            <Label className="text-lg font-mono">
              {captchaData?.question || 'Loading...'}
            </Label>
          </div>
          
          <div className="flex items-center gap-2">
            <Input
              type="number"
              value={userAnswer}
              onChange={(e) => setUserAnswer(e.target.value)}
              onKeyPress={handleKeyPress}
              placeholder="Your answer"
              className="text-center font-mono text-lg"
              disabled={verifying}
            />
            <Button
              onClick={fetchNewCaptcha}
              variant="outline"
              size="icon"
              disabled={loading || verifying}
              title="Get new question"
            >
              <RefreshCw className={`w-4 h-4 ${loading ? 'animate-spin' : ''}`} />
            </Button>
          </div>
          
          {error && (
            <motion.div
              className="text-sm text-red-600 dark:text-red-400 text-center"
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
            >
              {error}
            </motion.div>
          )}
          
          <Button
            onClick={handleVerify}
            disabled={!userAnswer.trim() || verifying}
            className="w-full"
            size="sm"
          >
            {verifying ? (
              <>
                <div className="animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"></div>
                Verifying...
              </>
            ) : (
              'Verify'
            )}
          </Button>
        </div>
      )}
    </motion.div>
  );
}
</file>

<file path="src/components/blog/post-content.tsx">
'use client';

import { HtmlContent } from '@/components/blog/html-content';
import type { PostWithRelations } from '@/lib/blog';

interface PostContentProps {
  post: PostWithRelations;
}

export function PostContent({ post }: PostContentProps) {
  return (
    <div className="py-8">
      <div className="prose prose-lg dark:prose-invert max-w-none">
        <HtmlContent content={post.content} />
      </div>
    </div>
  );
}
</file>

<file path="src/components/blog/view-tracker.tsx">
'use client';

import { useViewTracker } from '@/hooks/use-view-tracker';

interface ViewTrackerProps {
  postId: string;
}

export function ViewTracker({ postId }: ViewTrackerProps) {
  useViewTracker({ postId, enabled: true });
  
  // This component is invisible and only tracks views
  return null;
}
</file>

<file path="src/components/motion/motion-provider.tsx">
'use client';

import { LazyMotion, domAnimation, MotionConfig } from 'framer-motion';
import { ReactNode } from 'react';
import { easings } from '@/lib/animations';

interface MotionProviderProps {
  children: ReactNode;
}

export function MotionProvider({ children }: MotionProviderProps) {
  return (
    <LazyMotion features={domAnimation}>
      <MotionConfig
        transition={{
          duration: 0.3,
          ease: "easeOut",
        }}
        reducedMotion="user"
      >
        {children}
      </MotionConfig>
    </LazyMotion>
  );
}
</file>

<file path="src/components/search/search-filters.tsx">
'use client';

import { useRouter, useSearchParams } from 'next/navigation';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { Badge } from '@/components/ui/badge';
import { Separator } from '@/components/ui/separator';
import { X, Filter, Folder, Tag } from 'lucide-react';

interface Category {
  id: number;
  name: string;
  slug: string;
}

interface TagType {
  id: number;
  name: string;
  slug: string;
}

interface SearchFiltersProps {
  categories: Category[];
  tags: TagType[];
  selectedCategory: string;
  selectedTag: string;
  currentQuery: string;
}

export function SearchFilters({
  categories,
  tags,
  selectedCategory,
  selectedTag,
  currentQuery,
}: SearchFiltersProps) {
  const router = useRouter();
  const searchParams = useSearchParams();

  const updateFilter = (key: string, value: string) => {
    const params = new URLSearchParams(searchParams);
    
    if (value) {
      params.set(key, value);
    } else {
      params.delete(key);
    }
    
    // Reset to first page when filters change
    params.delete('page');
    
    router.push(`/search?${params.toString()}`);
  };

  const clearFilters = () => {
    const params = new URLSearchParams();
    if (currentQuery) {
      params.set('q', currentQuery);
    }
    router.push(`/search?${params.toString()}`);
  };

  const hasActiveFilters = selectedCategory || selectedTag;

  return (
    <Card className="sticky top-8">
      <CardHeader>
        <div className="flex items-center justify-between">
          <CardTitle className="flex items-center gap-2 text-lg">
            <Filter className="h-4 w-4" />
            Filters
          </CardTitle>
          {hasActiveFilters && (
            <Button
              variant="ghost"
              size="sm"
              onClick={clearFilters}
              className="text-xs"
            >
              Clear all
            </Button>
          )}
        </div>
      </CardHeader>
      <CardContent className="space-y-6">
        {/* Active Filters */}
        {hasActiveFilters && (
          <div className="space-y-2">
            <h4 className="text-sm font-medium">Active Filters</h4>
            <div className="flex flex-wrap gap-2">
              {selectedCategory && (
                <Badge variant="secondary" className="gap-1">
                  <Folder className="h-3 w-3" />
                  {categories.find(c => c.slug === selectedCategory)?.name}
                  <Button
                    variant="ghost"
                    size="sm"
                    className="h-auto p-0 hover:bg-transparent"
                    onClick={() => updateFilter('category', '')}
                  >
                    <X className="h-3 w-3" />
                  </Button>
                </Badge>
              )}
              {selectedTag && (
                <Badge variant="secondary" className="gap-1">
                  <Tag className="h-3 w-3" />
                  {tags.find(t => t.slug === selectedTag)?.name}
                  <Button
                    variant="ghost"
                    size="sm"
                    className="h-auto p-0 hover:bg-transparent"
                    onClick={() => updateFilter('tag', '')}
                  >
                    <X className="h-3 w-3" />
                  </Button>
                </Badge>
              )}
            </div>
            <Separator />
          </div>
        )}

        {/* Categories */}
        {categories.length > 0 && (
          <div className="space-y-3">
            <h4 className="text-sm font-medium flex items-center gap-2">
              <Folder className="h-4 w-4" />
              Categories
            </h4>
            <div className="space-y-1">
              {categories.map((category) => (
                <button
                  key={category.id}
                  onClick={() => updateFilter('category', 
                    selectedCategory === category.slug ? '' : category.slug
                  )}
                  className={`w-full text-left px-2 py-1 text-sm rounded hover:bg-muted transition-colors ${
                    selectedCategory === category.slug ? 'bg-muted font-medium' : ''
                  }`}
                >
                  {category.name}
                </button>
              ))}
            </div>
          </div>
        )}

        {/* Tags */}
        {tags.length > 0 && (
          <div className="space-y-3">
            <h4 className="text-sm font-medium flex items-center gap-2">
              <Tag className="h-4 w-4" />
              Tags
            </h4>
            <div className="flex flex-wrap gap-1">
              {tags.slice(0, 20).map((tag) => (
                <button
                  key={tag.id}
                  onClick={() => updateFilter('tag', 
                    selectedTag === tag.slug ? '' : tag.slug
                  )}
                  className={`text-xs px-2 py-1 rounded border transition-colors ${
                    selectedTag === tag.slug 
                      ? 'bg-primary text-primary-foreground border-primary' 
                      : 'hover:bg-muted border-border'
                  }`}
                >
                  #{tag.name}
                </button>
              ))}
              {tags.length > 20 && (
                <span className="text-xs text-muted-foreground px-2 py-1">
                  +{tags.length - 20} more
                </span>
              )}
            </div>
          </div>
        )}

        {/* Help Text */}
        <div className="text-xs text-muted-foreground pt-4 border-t">
          <p>
            Use filters to narrow down your search results by category or tag.
          </p>
        </div>
      </CardContent>
    </Card>
  );
}
</file>

<file path="src/components/shared/language-toggle.tsx">
"use client";

import { Button } from '@/components/ui/button';
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu';
import { Languages } from 'lucide-react';
import { useLocale } from 'next-intl';
import { useRouter, usePathname } from '@/i18n/routing';
import { routing } from '@/i18n/routing';

const localeNames = {
  en: 'English',
  ko: 'í•œêµ­ì–´',
} as const;

export function LanguageToggle() {
  const locale = useLocale();
  const router = useRouter();
  const pathname = usePathname();

  const handleLocaleChange = (newLocale: string) => {
    router.replace(pathname, { locale: newLocale });
  };

  return (
    <DropdownMenu>
      <DropdownMenuTrigger asChild>
        <Button variant="ghost" size="sm">
          <Languages className="h-4 w-4" />
          <span className="sr-only">Toggle language</span>
        </Button>
      </DropdownMenuTrigger>
      <DropdownMenuContent align="end">
        {routing.locales.map((loc) => (
          <DropdownMenuItem
            key={loc}
            onClick={() => handleLocaleChange(loc)}
            className={locale === loc ? 'bg-accent' : ''}
          >
            {localeNames[loc]}
          </DropdownMenuItem>
        ))}
      </DropdownMenuContent>
    </DropdownMenu>
  );
}
</file>

<file path="src/components/theme/theme-toggle.tsx">
'use client';

import { Moon, Sun, Monitor } from 'lucide-react';
import { useTheme } from 'next-themes';
import { Button } from '@/components/ui/button';
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from '@/components/ui/dropdown-menu';
import { useEffect, useState } from 'react';

export function ThemeToggle() {
  const { setTheme, theme } = useTheme();
  const [mounted, setMounted] = useState(false);

  useEffect(() => {
    setMounted(true);
  }, []);

  if (!mounted) {
    return (
      <Button variant="ghost" size="sm" disabled>
        <Sun className="h-4 w-4" />
        <span className="sr-only">Toggle theme</span>
      </Button>
    );
  }

  return (
    <DropdownMenu>
      <DropdownMenuTrigger asChild>
        <Button variant="ghost" size="sm">
          <Sun className="h-4 w-4 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0" />
          <Moon className="absolute h-4 w-4 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100" />
          <span className="sr-only">Toggle theme</span>
        </Button>
      </DropdownMenuTrigger>
      <DropdownMenuContent align="end">
        <DropdownMenuItem onClick={() => setTheme('light')}>
          <Sun className="mr-2 h-4 w-4" />
          <span>Light</span>
        </DropdownMenuItem>
        <DropdownMenuItem onClick={() => setTheme('dark')}>
          <Moon className="mr-2 h-4 w-4" />
          <span>Dark</span>
        </DropdownMenuItem>
        <DropdownMenuItem onClick={() => setTheme('system')}>
          <Monitor className="mr-2 h-4 w-4" />
          <span>System</span>
        </DropdownMenuItem>
      </DropdownMenuContent>
    </DropdownMenu>
  );
}
</file>

<file path="src/components/ui/accordion.tsx">
"use client"

import * as React from "react"
import * as AccordionPrimitive from "@radix-ui/react-accordion"
import { ChevronDown } from "lucide-react"

import { cn } from "@/lib/utils"

const Accordion = AccordionPrimitive.Root

const AccordionItem = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>
>(({ className, ...props }, ref) => (
  <AccordionPrimitive.Item
    ref={ref}
    className={cn("border-b", className)}
    {...props}
  />
))
AccordionItem.displayName = "AccordionItem"

const AccordionTrigger = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <AccordionPrimitive.Header className="flex">
    <AccordionPrimitive.Trigger
      ref={ref}
      className={cn(
        "flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",
        className
      )}
      {...props}
    >
      {children}
      <ChevronDown className="h-4 w-4 shrink-0 transition-transform duration-200" />
    </AccordionPrimitive.Trigger>
  </AccordionPrimitive.Header>
))
AccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName

const AccordionContent = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <AccordionPrimitive.Content
    ref={ref}
    className="overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down"
    {...props}
  >
    <div className={cn("pb-4 pt-0", className)}>{children}</div>
  </AccordionPrimitive.Content>
))

AccordionContent.displayName = AccordionPrimitive.Content.displayName

export { Accordion, AccordionItem, AccordionTrigger, AccordionContent }
</file>

<file path="src/components/ui/alert-dialog.tsx">
"use client"

import * as React from "react"
import * as AlertDialogPrimitive from "@radix-ui/react-alert-dialog"

import { cn } from "@/lib/utils"
import { buttonVariants } from "@/components/ui/button"

const AlertDialog = AlertDialogPrimitive.Root

const AlertDialogTrigger = AlertDialogPrimitive.Trigger

const AlertDialogPortal = AlertDialogPrimitive.Portal

const AlertDialogOverlay = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Overlay
    className={cn(
      "fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className
    )}
    {...props}
    ref={ref}
  />
))
AlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName

const AlertDialogContent = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>
>(({ className, ...props }, ref) => (
  <AlertDialogPortal>
    <AlertDialogOverlay />
    <AlertDialogPrimitive.Content
      ref={ref}
      className={cn(
        "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",
        className
      )}
      {...props}
    />
  </AlertDialogPortal>
))
AlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName

const AlertDialogHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col space-y-2 text-center sm:text-left",
      className
    )}
    {...props}
  />
)
AlertDialogHeader.displayName = "AlertDialogHeader"

const AlertDialogFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",
      className
    )}
    {...props}
  />
)
AlertDialogFooter.displayName = "AlertDialogFooter"

const AlertDialogTitle = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Title
    ref={ref}
    className={cn("text-lg font-semibold", className)}
    {...props}
  />
))
AlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName

const AlertDialogDescription = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Description
    ref={ref}
    className={cn("text-sm text-muted-foreground", className)}
    {...props}
  />
))
AlertDialogDescription.displayName =
  AlertDialogPrimitive.Description.displayName

const AlertDialogAction = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Action>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Action
    ref={ref}
    className={cn(buttonVariants(), className)}
    {...props}
  />
))
AlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName

const AlertDialogCancel = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Cancel
    ref={ref}
    className={cn(
      buttonVariants({ variant: "outline" }),
      "mt-2 sm:mt-0",
      className
    )}
    {...props}
  />
))
AlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName

export {
  AlertDialog,
  AlertDialogPortal,
  AlertDialogOverlay,
  AlertDialogTrigger,
  AlertDialogContent,
  AlertDialogHeader,
  AlertDialogFooter,
  AlertDialogTitle,
  AlertDialogDescription,
  AlertDialogAction,
  AlertDialogCancel,
}
</file>

<file path="src/components/ui/alert.tsx">
import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const alertVariants = cva(
  "relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",
  {
    variants: {
      variant: {
        default: "bg-background text-foreground",
        destructive:
          "border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

const Alert = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>
>(({ className, variant, ...props }, ref) => (
  <div
    ref={ref}
    role="alert"
    className={cn(alertVariants({ variant }), className)}
    {...props}
  />
))
Alert.displayName = "Alert"

const AlertTitle = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLHeadingElement>
>(({ className, ...props }, ref) => (
  <h5
    ref={ref}
    className={cn("mb-1 font-medium leading-none tracking-tight", className)}
    {...props}
  />
))
AlertTitle.displayName = "AlertTitle"

const AlertDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("text-sm [&_p]:leading-relaxed", className)}
    {...props}
  />
))
AlertDescription.displayName = "AlertDescription"

export { Alert, AlertTitle, AlertDescription }
</file>

<file path="src/components/ui/avatar.tsx">
"use client"

import * as React from "react"
import * as AvatarPrimitive from "@radix-ui/react-avatar"

import { cn } from "@/lib/utils"

const Avatar = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Root
    ref={ref}
    className={cn(
      "relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",
      className
    )}
    {...props}
  />
))
Avatar.displayName = AvatarPrimitive.Root.displayName

const AvatarImage = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Image>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Image
    ref={ref}
    className={cn("aspect-square h-full w-full", className)}
    {...props}
  />
))
AvatarImage.displayName = AvatarPrimitive.Image.displayName

const AvatarFallback = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Fallback>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Fallback
    ref={ref}
    className={cn(
      "flex h-full w-full items-center justify-center rounded-full bg-muted",
      className
    )}
    {...props}
  />
))
AvatarFallback.displayName = AvatarPrimitive.Fallback.displayName

export { Avatar, AvatarImage, AvatarFallback }
</file>

<file path="src/components/ui/badge.tsx">
import * as React from "react";
import { cva, type VariantProps } from "class-variance-authority";

import { cn } from "@/lib/utils";

const badgeVariants = cva(
  "inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",
  {
    variants: {
      variant: {
        default:
          "border-transparent bg-primary text-primary-foreground hover:bg-primary/80",
        secondary:
          "border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",
        destructive:
          "border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",
        outline: "text-foreground",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  },
);

export interface BadgeProps
  extends React.HTMLAttributes<HTMLDivElement>,
    VariantProps<typeof badgeVariants> {}

function Badge({ className, variant, ...props }: BadgeProps) {
  return (
    <div className={cn(badgeVariants({ variant }), className)} {...props} />
  );
}

export { Badge, badgeVariants };
</file>

<file path="src/components/ui/card.tsx">
import * as React from "react"

import { cn } from "@/lib/utils"

const Card = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn(
      "rounded-lg border bg-card text-card-foreground shadow-sm",
      className
    )}
    {...props}
  />
))
Card.displayName = "Card"

const CardHeader = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("flex flex-col space-y-1.5 p-6", className)}
    {...props}
  />
))
CardHeader.displayName = "CardHeader"

const CardTitle = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn(
      "text-2xl font-semibold leading-none tracking-tight",
      className
    )}
    {...props}
  />
))
CardTitle.displayName = "CardTitle"

const CardDescription = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("text-sm text-muted-foreground", className)}
    {...props}
  />
))
CardDescription.displayName = "CardDescription"

const CardContent = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("p-6 pt-0", className)} {...props} />
))
CardContent.displayName = "CardContent"

const CardFooter = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("flex items-center p-6 pt-0", className)}
    {...props}
  />
))
CardFooter.displayName = "CardFooter"

export { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }
</file>

<file path="src/components/ui/checkbox.tsx">
"use client";

import * as React from "react";
import * as CheckboxPrimitive from "@radix-ui/react-checkbox";
import { Check } from "lucide-react";

import { cn } from "@/lib/utils";

const Checkbox = React.forwardRef<
  React.ElementRef<typeof CheckboxPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>
>(({ className, ...props }, ref) => (
  <CheckboxPrimitive.Root
    ref={ref}
    className={cn(
      "peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",
      className,
    )}
    {...props}
  >
    <CheckboxPrimitive.Indicator
      className={cn("flex items-center justify-center text-current")}
    >
      <Check className="h-4 w-4" />
    </CheckboxPrimitive.Indicator>
  </CheckboxPrimitive.Root>
));
Checkbox.displayName = CheckboxPrimitive.Root.displayName;

export { Checkbox };
</file>

<file path="src/components/ui/dialog.tsx">
"use client"

import * as React from "react"
import * as DialogPrimitive from "@radix-ui/react-dialog"
import { X } from "lucide-react"

import { cn } from "@/lib/utils"

const Dialog = DialogPrimitive.Root

const DialogTrigger = DialogPrimitive.Trigger

const DialogPortal = DialogPrimitive.Portal

const DialogClose = DialogPrimitive.Close

const DialogOverlay = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Overlay
    ref={ref}
    className={cn(
      "fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className
    )}
    {...props}
  />
))
DialogOverlay.displayName = DialogPrimitive.Overlay.displayName

const DialogContent = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DialogPortal>
    <DialogOverlay />
    <DialogPrimitive.Content
      ref={ref}
      className={cn(
        "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",
        className
      )}
      {...props}
    >
      {children}
      <DialogPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </DialogPrimitive.Close>
    </DialogPrimitive.Content>
  </DialogPortal>
))
DialogContent.displayName = DialogPrimitive.Content.displayName

const DialogHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col space-y-1.5 text-center sm:text-left",
      className
    )}
    {...props}
  />
)
DialogHeader.displayName = "DialogHeader"

const DialogFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      "flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",
      className
    )}
    {...props}
  />
)
DialogFooter.displayName = "DialogFooter"

const DialogTitle = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Title
    ref={ref}
    className={cn(
      "text-lg font-semibold leading-none tracking-tight",
      className
    )}
    {...props}
  />
))
DialogTitle.displayName = DialogPrimitive.Title.displayName

const DialogDescription = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Description
    ref={ref}
    className={cn("text-sm text-muted-foreground", className)}
    {...props}
  />
))
DialogDescription.displayName = DialogPrimitive.Description.displayName

export {
  Dialog,
  DialogPortal,
  DialogOverlay,
  DialogClose,
  DialogTrigger,
  DialogContent,
  DialogHeader,
  DialogFooter,
  DialogTitle,
  DialogDescription,
}
</file>

<file path="src/components/ui/dropdown-menu.tsx">
"use client";

import * as React from "react";
import * as DropdownMenuPrimitive from "@radix-ui/react-dropdown-menu";
import { Check, ChevronRight, Circle } from "lucide-react";

import { cn } from "@/lib/utils";

const DropdownMenu = DropdownMenuPrimitive.Root;

const DropdownMenuTrigger = DropdownMenuPrimitive.Trigger;

const DropdownMenuGroup = DropdownMenuPrimitive.Group;

const DropdownMenuPortal = DropdownMenuPrimitive.Portal;

const DropdownMenuSub = DropdownMenuPrimitive.Sub;

const DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup;

const DropdownMenuSubTrigger = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {
    inset?: boolean;
  }
>(({ className, inset, children, ...props }, ref) => (
  <DropdownMenuPrimitive.SubTrigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",
      inset && "pl-8",
      className,
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </DropdownMenuPrimitive.SubTrigger>
));
DropdownMenuSubTrigger.displayName =
  DropdownMenuPrimitive.SubTrigger.displayName;

const DropdownMenuSubContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.SubContent
    ref={ref}
    className={cn(
      "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className,
    )}
    {...props}
  />
));
DropdownMenuSubContent.displayName =
  DropdownMenuPrimitive.SubContent.displayName;

const DropdownMenuContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <DropdownMenuPrimitive.Portal>
    <DropdownMenuPrimitive.Content
      ref={ref}
      sideOffset={sideOffset}
      className={cn(
        "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className,
      )}
      {...props}
    />
  </DropdownMenuPrimitive.Portal>
));
DropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName;

const DropdownMenuItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      inset && "pl-8",
      className,
    )}
    {...props}
  />
));
DropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName;

const DropdownMenuCheckboxItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <DropdownMenuPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className,
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.CheckboxItem>
));
DropdownMenuCheckboxItem.displayName =
  DropdownMenuPrimitive.CheckboxItem.displayName;

const DropdownMenuRadioItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <DropdownMenuPrimitive.RadioItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className,
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.RadioItem>
));
DropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName;

const DropdownMenuLabel = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Label
    ref={ref}
    className={cn(
      "px-2 py-1.5 text-sm font-semibold",
      inset && "pl-8",
      className,
    )}
    {...props}
  />
));
DropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName;

const DropdownMenuSeparator = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.Separator
    ref={ref}
    className={cn("-mx-1 my-1 h-px bg-muted", className)}
    {...props}
  />
));
DropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName;

const DropdownMenuShortcut = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLSpanElement>) => {
  return (
    <span
      className={cn("ml-auto text-xs tracking-widest opacity-60", className)}
      {...props}
    />
  );
};
DropdownMenuShortcut.displayName = "DropdownMenuShortcut";

export {
  DropdownMenu,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuCheckboxItem,
  DropdownMenuRadioItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuShortcut,
  DropdownMenuGroup,
  DropdownMenuPortal,
  DropdownMenuSub,
  DropdownMenuSubContent,
  DropdownMenuSubTrigger,
  DropdownMenuRadioGroup,
};
</file>

<file path="src/components/ui/file-upload.tsx">
"use client";

import { cn } from "@/lib/utils";
import { ChangeEvent, useRef } from "react";

interface FileUploadProps extends React.HTMLAttributes<HTMLDivElement> {
  onFileChange: (file: File) => void;
  accept?: string;
}

export function FileUpload({
  className,
  onFileChange,
  accept = "image/*",
  children,
  ...props
}: FileUploadProps) {
  const inputRef = useRef<HTMLInputElement>(null);

  const handleClick = () => {
    inputRef.current?.click();
  };

  const handleChange = (e: ChangeEvent<HTMLInputElement>) => {
    const file = e.target.files?.[0];
    if (file) {
      onFileChange(file);
    }
  };

  return (
    <div
      onClick={handleClick}
      className={cn(
        "cursor-pointer rounded-md border-2 border-dashed border-gray-300 p-4 hover:border-gray-400",
        className
      )}
      {...props}
    >
      <input
        type="file"
        ref={inputRef}
        onChange={handleChange}
        accept={accept}
        className="hidden"
      />
      {children}
    </div>
  );
}
</file>

<file path="src/components/ui/form.tsx">
'use client';

import * as React from 'react';
import * as LabelPrimitive from '@radix-ui/react-label';
import { Slot } from '@radix-ui/react-slot';
import {
  Controller,
  ControllerProps,
  FieldPath,
  FieldValues,
  FormProvider,
  useFormContext,
} from 'react-hook-form';

import { cn } from '@/lib/utils';
import { Label } from '@/components/ui/label';

const Form = FormProvider;

type FormFieldContextValue<
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
> = {
  name: TName;
};

const FormFieldContext = React.createContext<FormFieldContextValue>(
  {} as FormFieldContextValue,
);

const FormField = <
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
>({
  ...props
}: ControllerProps<TFieldValues, TName>) => {
  return (
    <FormFieldContext.Provider value={{ name: props.name }}>
      <Controller {...props} />
    </FormFieldContext.Provider>
  );
};

const useFormField = () => {
  const fieldContext = React.useContext(FormFieldContext);
  const itemContext = React.useContext(FormItemContext);
  const { getFieldState, formState } = useFormContext();

  const fieldState = getFieldState(fieldContext.name, formState);

  if (!fieldContext) {
    throw new Error('useFormField should be used within <FormField>');
  }

  const { id } = itemContext;

  return {
    id,
    name: fieldContext.name,
    formItemId: `${id}-form-item`,
    formDescriptionId: `${id}-form-item-description`,
    formMessageId: `${id}-form-item-message`,
    ...fieldState,
  };
};

type FormItemContextValue = {
  id: string;
};

const FormItemContext = React.createContext<FormItemContextValue>(
  {} as FormItemContextValue,
);

const FormItem = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => {
  const id = React.useId();

  return (
    <FormItemContext.Provider value={{ id }}>
      <div ref={ref} className={cn('space-y-2', className)} {...props} />
    </FormItemContext.Provider>
  );
});
FormItem.displayName = 'FormItem';

const FormLabel = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>
>(({ className, ...props }, ref) => {
  const { error, formItemId } = useFormField();

  return (
    <Label
      ref={ref}
      className={cn(error && 'text-destructive', className)}
      htmlFor={formItemId}
      {...props}
    />
  );
});
FormLabel.displayName = 'FormLabel';

const FormControl = React.forwardRef<
  React.ElementRef<typeof Slot>,
  React.ComponentPropsWithoutRef<typeof Slot>
>(({ ...props }, ref) => {
  const { error, formItemId, formDescriptionId, formMessageId } =
    useFormField();

  return (
    <Slot
      ref={ref}
      id={formItemId}
      aria-describedby={
        !error
          ? `${formDescriptionId}`
          : `${formDescriptionId} ${formMessageId}`
      }
      aria-invalid={!!error}
      {...props}
    />
  );
});
FormControl.displayName = 'FormControl';

const FormDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => {
  const { formDescriptionId } = useFormField();

  return (
    <p
      ref={ref}
      id={formDescriptionId}
      className={cn('text-sm text-muted-foreground', className)}
      {...props}
    />
  );
});
FormDescription.displayName = 'FormDescription';

const FormMessage = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, children, ...props }, ref) => {
  const { error, formMessageId } = useFormField();
  const body = error ? String(error?.message) : children;

  if (!body) {
    return null;
  }

  return (
    <p
      ref={ref}
      id={formMessageId}
      className={cn('text-sm font-medium text-destructive', className)}
      {...props}
    >
      {body}
    </p>
  );
});
FormMessage.displayName = 'FormMessage';

export {
  useFormField,
  Form,
  FormItem,
  FormLabel,
  FormControl,
  FormDescription,
  FormMessage,
  FormField,
};
</file>

<file path="src/components/ui/input.tsx">
import * as React from "react";

import { cn } from "@/lib/utils";

export interface InputProps
  extends React.InputHTMLAttributes<HTMLInputElement> {}

const Input = React.forwardRef<HTMLInputElement, InputProps>(
  ({ className, type, ...props }, ref) => {
    return (
      <input
        type={type}
        className={cn(
          "flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",
          className,
        )}
        ref={ref}
        {...props}
      />
    );
  },
);
Input.displayName = "Input";

export { Input };
</file>

<file path="src/components/ui/label.tsx">
"use client";

import * as React from "react";
import * as LabelPrimitive from "@radix-ui/react-label";
import { cva, type VariantProps } from "class-variance-authority";

import { cn } from "@/lib/utils";

const labelVariants = cva(
  "text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",
);

const Label = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &
    VariantProps<typeof labelVariants>
>(({ className, ...props }, ref) => (
  <LabelPrimitive.Root
    ref={ref}
    className={cn(labelVariants(), className)}
    {...props}
  />
));
Label.displayName = LabelPrimitive.Root.displayName;

export { Label };
</file>

<file path="src/components/ui/lazy-image.tsx">
'use client';

import { useState } from 'react';
import Image from 'next/image';
import { cn } from '@/lib/utils';

interface LazyImageProps {
  src: string;
  alt: string;
  className?: string;
  width?: number;
  height?: number;
  priority?: boolean;
  placeholder?: string;
}

export function LazyImage({ 
  src, 
  alt, 
  className, 
  width, 
  height, 
  priority = false,
  placeholder = "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI2Y3ZjdmNyIvPgogIDx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0iY2VudHJhbCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iI2NjYyIgZm9udC1zaXplPSIxNHB4Ij5Mb2FkaW5nLi4uPC90ZXh0Pgo8L3N2Zz4K"
}: LazyImageProps) {
  const [isLoaded, setIsLoaded] = useState(false);
  const [hasError, setHasError] = useState(false);

  const handleLoad = () => {
    setIsLoaded(true);
  };

  const handleError = () => {
    setHasError(true);
  };

  if (hasError) {
    return (
      <div className={cn("bg-muted flex items-center justify-center text-muted-foreground", className)}>
        <span className="text-sm">Failed to load image</span>
      </div>
    );
  }

  return (
    <div className={cn("relative overflow-hidden", className)}>
      {!isLoaded && (
        <Image
          src={placeholder}
          alt=""
          fill
          className="absolute inset-0 object-cover blur-sm"
          aria-hidden="true"
        />
      )}
      <Image
        src={src}
        alt={alt}
        width={width || 800}
        height={height || 600}
        priority={priority}
        onLoad={handleLoad}
        onError={handleError}
        className={cn(
          "w-full h-full object-cover transition-opacity duration-300",
          isLoaded ? "opacity-100" : "opacity-0"
        )}
      />
    </div>
  );
}
</file>

<file path="src/components/ui/loading-spinner.tsx">
'use client';

import { motion } from 'framer-motion';
import { cn } from '@/lib/utils';

interface LoadingSpinnerProps {
  size?: 'sm' | 'md' | 'lg';
  className?: string;
}

export function LoadingSpinner({ size = 'md', className }: LoadingSpinnerProps) {
  const sizeClasses = {
    sm: 'w-4 h-4',
    md: 'w-8 h-8',
    lg: 'w-12 h-12',
  };

  return (
    <div className={cn('flex items-center justify-center', className)}>
      <motion.div
        className={cn(
          'border-2 border-primary/20 border-t-primary rounded-full',
          sizeClasses[size]
        )}
        animate={{ rotate: 360 }}
        transition={{
          duration: 1,
          repeat: Infinity,
          ease: 'linear',
        }}
      />
    </div>
  );
}

export function LoadingSkeleton({ className }: { className?: string }) {
  return (
    <motion.div
      className={cn('bg-muted rounded animate-shimmer', className)}
      style={{
        background: 'linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent)',
        backgroundSize: '200px 100%',
      }}
      animate={{
        backgroundPosition: ['200px 0', 'calc(200px + 100%) 0'],
      }}
      transition={{
        duration: 1.5,
        repeat: Infinity,
        ease: 'linear',
      }}
    />
  );
}

export function LoadingDots({ className }: { className?: string }) {
  return (
    <div className={cn('flex space-x-1', className)}>
      {[0, 1, 2].map((index) => (
        <motion.div
          key={index}
          className="w-2 h-2 bg-primary rounded-full"
          animate={{
            scale: [1, 1.5, 1],
            opacity: [0.7, 1, 0.7],
          }}
          transition={{
            duration: 0.8,
            repeat: Infinity,
            delay: index * 0.2,
          }}
        />
      ))}
    </div>
  );
}
</file>

<file path="src/components/ui/popover.tsx">
"use client"

import * as React from "react"
import * as PopoverPrimitive from "@radix-ui/react-popover"

import { cn } from "@/lib/utils"

const Popover = PopoverPrimitive.Root

const PopoverTrigger = PopoverPrimitive.Trigger

const PopoverContent = React.forwardRef<
  React.ElementRef<typeof PopoverPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>
>(({ className, align = "center", sideOffset = 4, ...props }, ref) => (
  <PopoverPrimitive.Portal>
    <PopoverPrimitive.Content
      ref={ref}
      align={align}
      sideOffset={sideOffset}
      className={cn(
        "z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",
        className
      )}
      {...props}
    />
  </PopoverPrimitive.Portal>
))
PopoverContent.displayName = PopoverPrimitive.Content.displayName

export { Popover, PopoverTrigger, PopoverContent }
</file>

<file path="src/components/ui/select.tsx">
'use client';

import * as React from 'react';
import * as SelectPrimitive from '@radix-ui/react-select';
import { Check, ChevronDown, ChevronUp } from 'lucide-react';

import { cn } from '@/lib/utils';

const Select = SelectPrimitive.Root;

const SelectGroup = SelectPrimitive.Group;

const SelectValue = SelectPrimitive.Value;

const SelectTrigger = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Trigger
    ref={ref}
    className={cn(
      'flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1',
      className,
    )}
    {...props}
  >
    {children}
    <SelectPrimitive.Icon asChild>
      <ChevronDown className="h-4 w-4 opacity-50" />
    </SelectPrimitive.Icon>
  </SelectPrimitive.Trigger>
));
SelectTrigger.displayName = SelectPrimitive.Trigger.displayName;

const SelectScrollUpButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollUpButton
    ref={ref}
    className={cn(
      'flex cursor-default items-center justify-center py-1',
      className,
    )}
    {...props}
  >
    <ChevronUp className="h-4 w-4" />
  </SelectPrimitive.ScrollUpButton>
));
SelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName;

const SelectScrollDownButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollDownButton
    ref={ref}
    className={cn(
      'flex cursor-default items-center justify-center py-1',
      className,
    )}
    {...props}
  >
    <ChevronDown className="h-4 w-4" />
  </SelectPrimitive.ScrollDownButton>
));
SelectScrollDownButton.displayName =
  SelectPrimitive.ScrollDownButton.displayName;

const SelectContent = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>
>(({ className, children, position = 'popper', ...props }, ref) => (
  <SelectPrimitive.Portal>
    <SelectPrimitive.Content
      ref={ref}
      className={cn(
        'relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
        position === 'popper' &&
          'data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1',
        className,
      )}
      position={position}
      {...props}
    >
      <SelectScrollUpButton />
      <SelectPrimitive.Viewport
        className={cn(
          'p-1',
          position === 'popper' &&
            'h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]',
        )}
      >
        {children}
      </SelectPrimitive.Viewport>
      <SelectScrollDownButton />
    </SelectPrimitive.Content>
  </SelectPrimitive.Portal>
));
SelectContent.displayName = SelectPrimitive.Content.displayName;

const SelectLabel = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Label
    ref={ref}
    className={cn('py-1.5 pl-8 pr-2 text-sm font-semibold', className)}
    {...props}
  />
));
SelectLabel.displayName = SelectPrimitive.Label.displayName;

const SelectItem = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Item
    ref={ref}
    className={cn(
      'relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className,
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <SelectPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </SelectPrimitive.ItemIndicator>
    </span>

    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
  </SelectPrimitive.Item>
));
SelectItem.displayName = SelectPrimitive.Item.displayName;

const SelectSeparator = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Separator
    ref={ref}
    className={cn('-mx-1 my-1 h-px bg-muted', className)}
    {...props}
  />
));
SelectSeparator.displayName = SelectPrimitive.Separator.displayName;

export {
  Select,
  SelectGroup,
  SelectValue,
  SelectTrigger,
  SelectContent,
  SelectLabel,
  SelectItem,
  SelectSeparator,
  SelectScrollUpButton,
  SelectScrollDownButton,
};
</file>

<file path="src/components/ui/separator.tsx">
"use client"

import * as React from "react"
import * as SeparatorPrimitive from "@radix-ui/react-separator"

import { cn } from "@/lib/utils"

const Separator = React.forwardRef<
  React.ElementRef<typeof SeparatorPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>
>(
  (
    { className, orientation = "horizontal", decorative = true, ...props },
    ref
  ) => (
    <SeparatorPrimitive.Root
      ref={ref}
      decorative={decorative}
      orientation={orientation}
      className={cn(
        "shrink-0 bg-border",
        orientation === "horizontal" ? "h-[1px] w-full" : "h-full w-[1px]",
        className
      )}
      {...props}
    />
  )
)
Separator.displayName = SeparatorPrimitive.Root.displayName

export { Separator }
</file>

<file path="src/components/ui/sheet.tsx">
'use client';

import * as React from 'react';
import * as SheetPrimitive from '@radix-ui/react-dialog';
import { cva, type VariantProps } from 'class-variance-authority';
import { X } from 'lucide-react';

import { cn } from '@/lib/utils';

const Sheet = SheetPrimitive.Root;

const SheetTrigger = SheetPrimitive.Trigger;

const SheetClose = SheetPrimitive.Close;

const SheetPortal = SheetPrimitive.Portal;

const SheetOverlay = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Overlay
    className={cn(
      'fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0',
      className,
    )}
    {...props}
    ref={ref}
  />
));
SheetOverlay.displayName = SheetPrimitive.Overlay.displayName;

const sheetVariants = cva(
  'fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500',
  {
    variants: {
      side: {
        top: 'inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top',
        bottom:
          'inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom',
        left: 'inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm',
        right:
          'inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm',
      },
    },
    defaultVariants: {
      side: 'right',
    },
  },
);

interface SheetContentProps
  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,
    VariantProps<typeof sheetVariants> {}

const SheetContent = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Content>,
  SheetContentProps
>(({ side = 'right', className, children, ...props }, ref) => (
  <SheetPortal>
    <SheetOverlay />
    <SheetPrimitive.Content
      ref={ref}
      className={cn(sheetVariants({ side }), className)}
      {...props}
    >
      {children}
      <SheetPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </SheetPrimitive.Close>
    </SheetPrimitive.Content>
  </SheetPortal>
));
SheetContent.displayName = SheetPrimitive.Content.displayName;

const SheetHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      'flex flex-col space-y-2 text-center sm:text-left',
      className,
    )}
    {...props}
  />
);
SheetHeader.displayName = 'SheetHeader';

const SheetFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      'flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2',
      className,
    )}
    {...props}
  />
);
SheetFooter.displayName = 'SheetFooter';

const SheetTitle = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Title
    ref={ref}
    className={cn('text-lg font-semibold text-foreground', className)}
    {...props}
  />
));
SheetTitle.displayName = SheetPrimitive.Title.displayName;

const SheetDescription = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Description
    ref={ref}
    className={cn('text-sm text-muted-foreground', className)}
    {...props}
  />
));
SheetDescription.displayName = SheetPrimitive.Description.displayName;

export {
  Sheet,
  SheetPortal,
  SheetOverlay,
  SheetTrigger,
  SheetClose,
  SheetContent,
  SheetHeader,
  SheetFooter,
  SheetTitle,
  SheetDescription,
};
</file>

<file path="src/components/ui/skeleton.tsx">
import { cn } from "@/lib/utils"

function Skeleton({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) {
  return (
    <div
      className={cn("animate-pulse rounded-md bg-muted", className)}
      {...props}
    />
  )
}

export { Skeleton }
</file>

<file path="src/components/ui/tabs.tsx">
"use client"

import * as React from "react"
import * as TabsPrimitive from "@radix-ui/react-tabs"

import { cn } from "@/lib/utils"

const Tabs = TabsPrimitive.Root

const TabsList = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.List
    ref={ref}
    className={cn(
      "inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",
      className
    )}
    {...props}
  />
))
TabsList.displayName = TabsPrimitive.List.displayName

const TabsTrigger = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Trigger
    ref={ref}
    className={cn(
      "inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",
      className
    )}
    {...props}
  />
))
TabsTrigger.displayName = TabsPrimitive.Trigger.displayName

const TabsContent = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Content
    ref={ref}
    className={cn(
      "mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",
      className
    )}
    {...props}
  />
))
TabsContent.displayName = TabsPrimitive.Content.displayName

export { Tabs, TabsList, TabsTrigger, TabsContent }
</file>

<file path="src/components/ui/textarea.tsx">
import * as React from 'react';

import { cn } from '@/lib/utils';

const Textarea = React.forwardRef<
  HTMLTextAreaElement,
  React.ComponentProps<'textarea'>
>(({ className, ...props }, ref) => {
  return (
    <textarea
      className={cn(
        'flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',
        className,
      )}
      ref={ref}
      {...props}
    />
  );
});
Textarea.displayName = 'Textarea';

export { Textarea };
</file>

<file path="src/components/ui/toast.tsx">
'use client';

import * as React from 'react';
import * as ToastPrimitives from '@radix-ui/react-toast';
import { cva, type VariantProps } from 'class-variance-authority';
import { X } from 'lucide-react';

import { cn } from '@/lib/utils';

const ToastProvider = ToastPrimitives.Provider;

const ToastViewport = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Viewport>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Viewport
    ref={ref}
    className={cn(
      'fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]',
      className,
    )}
    {...props}
  />
));
ToastViewport.displayName = ToastPrimitives.Viewport.displayName;

const toastVariants = cva(
  'group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full',
  {
    variants: {
      variant: {
        default: 'border bg-background text-foreground',
        destructive:
          'destructive group border-destructive bg-destructive text-destructive-foreground',
      },
    },
    defaultVariants: {
      variant: 'default',
    },
  },
);

const Toast = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Root>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &
    VariantProps<typeof toastVariants>
>(({ className, variant, ...props }, ref) => {
  return (
    <ToastPrimitives.Root
      ref={ref}
      className={cn(toastVariants({ variant }), className)}
      {...props}
    />
  );
});
Toast.displayName = ToastPrimitives.Root.displayName;

const ToastAction = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Action>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Action
    ref={ref}
    className={cn(
      'inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive',
      className,
    )}
    {...props}
  />
));
ToastAction.displayName = ToastPrimitives.Action.displayName;

const ToastClose = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Close>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Close
    ref={ref}
    className={cn(
      'absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600',
      className,
    )}
    toast-close=""
    {...props}
  >
    <X className="h-4 w-4" />
  </ToastPrimitives.Close>
));
ToastClose.displayName = ToastPrimitives.Close.displayName;

const ToastTitle = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Title>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Title
    ref={ref}
    className={cn('text-sm font-semibold', className)}
    {...props}
  />
));
ToastTitle.displayName = ToastPrimitives.Title.displayName;

const ToastDescription = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Description>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Description
    ref={ref}
    className={cn('text-sm opacity-90', className)}
    {...props}
  />
));
ToastDescription.displayName = ToastPrimitives.Description.displayName;

type ToastProps = React.ComponentPropsWithoutRef<typeof Toast>;

type ToastActionElement = React.ReactElement<typeof ToastAction>;

export {
  type ToastProps,
  type ToastActionElement,
  ToastProvider,
  ToastViewport,
  Toast,
  ToastTitle,
  ToastDescription,
  ToastClose,
  ToastAction,
};
</file>

<file path="src/components/ui/toaster.tsx">
'use client';

import { useToast } from '@/hooks/use-toast';
import {
  Toast,
  ToastClose,
  ToastDescription,
  ToastProvider,
  ToastTitle,
  ToastViewport,
} from '@/components/ui/toast';

export function Toaster() {
  const { toasts } = useToast();

  return (
    <ToastProvider>
      {toasts.map(function ({ id, title, description, action, ...props }) {
        return (
          <Toast key={id} {...props}>
            <div className="grid gap-1">
              {title && <ToastTitle>{title}</ToastTitle>}
              {description && (
                <ToastDescription>{description}</ToastDescription>
              )}
            </div>
            {action}
            <ToastClose />
          </Toast>
        );
      })}
      <ToastViewport />
    </ToastProvider>
  );
}
</file>

<file path="src/components/ui/toggle.tsx">
"use client"

import * as React from "react"
import * as TogglePrimitive from "@radix-ui/react-toggle"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const toggleVariants = cva(
  "inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2",
  {
    variants: {
      variant: {
        default: "bg-transparent",
        outline:
          "border border-input bg-transparent hover:bg-accent hover:text-accent-foreground",
      },
      size: {
        default: "h-10 px-3 min-w-10",
        sm: "h-9 px-2.5 min-w-9",
        lg: "h-11 px-5 min-w-11",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

const Toggle = React.forwardRef<
  React.ElementRef<typeof TogglePrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &
    VariantProps<typeof toggleVariants>
>(({ className, variant, size, ...props }, ref) => (
  <TogglePrimitive.Root
    ref={ref}
    className={cn(toggleVariants({ variant, size, className }))}
    {...props}
  />
))

Toggle.displayName = TogglePrimitive.Root.displayName

export { Toggle, toggleVariants }
</file>

<file path="src/components/web-vitals.tsx">
'use client';

import { useEffect } from 'react';
import { reportWebVitals } from '@/lib/web-vitals';

export function WebVitals() {
  useEffect(() => {
    reportWebVitals();
  }, []);

  return null;
}
</file>

<file path="src/hooks/use-scroll.ts">
'use client';

import { useState, useEffect } from 'react';

interface ScrollState {
  scrollY: number;
  scrollDirection: 'up' | 'down' | null;
  isAtTop: boolean;
}

export function useScroll() {
  const [scrollState, setScrollState] = useState<ScrollState>({
    scrollY: 0,
    scrollDirection: null,
    isAtTop: true,
  });

  useEffect(() => {
    let lastScrollY = window.scrollY;

    const updateScrollState = () => {
      const scrollY = window.scrollY;
      const scrollDirection = scrollY > lastScrollY ? 'down' : 'up';
      const isAtTop = scrollY < 10;

      setScrollState({
        scrollY,
        scrollDirection,
        isAtTop,
      });

      lastScrollY = scrollY;
    };

    const handleScroll = () => {
      requestAnimationFrame(updateScrollState);
    };

    window.addEventListener('scroll', handleScroll, { passive: true });

    return () => {
      window.removeEventListener('scroll', handleScroll);
    };
  }, []);

  return scrollState;
}
</file>

<file path="src/hooks/use-toast.ts">
"use client"

// Inspired by react-hot-toast library
import * as React from "react"

import type {
  ToastActionElement,
  ToastProps,
} from "@/components/ui/toast"

const TOAST_LIMIT = 1
const TOAST_REMOVE_DELAY = 1000000

type ToasterToast = ToastProps & {
  id: string
  title?: React.ReactNode
  description?: React.ReactNode
  action?: ToastActionElement
}

const actionTypes = {
  ADD_TOAST: "ADD_TOAST",
  UPDATE_TOAST: "UPDATE_TOAST",
  DISMISS_TOAST: "DISMISS_TOAST",
  REMOVE_TOAST: "REMOVE_TOAST",
} as const

let count = 0

function genId() {
  count = (count + 1) % Number.MAX_SAFE_INTEGER
  return count.toString()
}

type ActionType = typeof actionTypes

type Action =
  | {
      type: ActionType["ADD_TOAST"]
      toast: ToasterToast
    }
  | {
      type: ActionType["UPDATE_TOAST"]
      toast: Partial<ToasterToast>
    }
  | {
      type: ActionType["DISMISS_TOAST"]
      toastId?: ToasterToast["id"]
    }
  | {
      type: ActionType["REMOVE_TOAST"]
      toastId?: ToasterToast["id"]
    }

interface State {
  toasts: ToasterToast[]
}

const toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()

const addToRemoveQueue = (toastId: string) => {
  if (toastTimeouts.has(toastId)) {
    return
  }

  const timeout = setTimeout(() => {
    toastTimeouts.delete(toastId)
    dispatch({
      type: "REMOVE_TOAST",
      toastId: toastId,
    })
  }, TOAST_REMOVE_DELAY)

  toastTimeouts.set(toastId, timeout)
}

export const reducer = (state: State, action: Action): State => {
  switch (action.type) {
    case "ADD_TOAST":
      return {
        ...state,
        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),
      }

    case "UPDATE_TOAST":
      return {
        ...state,
        toasts: state.toasts.map((t) =>
          t.id === action.toast.id ? { ...t, ...action.toast } : t
        ),
      }

    case "DISMISS_TOAST": {
      const { toastId } = action

      // ! Side effects ! - This could be extracted into a dismissToast() action,
      // but I'll keep it here for simplicity
      if (toastId) {
        addToRemoveQueue(toastId)
      } else {
        state.toasts.forEach((toast) => {
          addToRemoveQueue(toast.id)
        })
      }

      return {
        ...state,
        toasts: state.toasts.map((t) =>
          t.id === toastId || toastId === undefined
            ? {
                ...t,
                open: false,
              }
            : t
        ),
      }
    }
    case "REMOVE_TOAST":
      if (action.toastId === undefined) {
        return {
          ...state,
          toasts: [],
        }
      }
      return {
        ...state,
        toasts: state.toasts.filter((t) => t.id !== action.toastId),
      }
  }
}

const listeners: Array<(state: State) => void> = []

let memoryState: State = { toasts: [] }

function dispatch(action: Action) {
  memoryState = reducer(memoryState, action)
  listeners.forEach((listener) => {
    listener(memoryState)
  })
}

type Toast = Omit<ToasterToast, "id">

function toast({ ...props }: Toast) {
  const id = genId()

  const update = (props: ToasterToast) =>
    dispatch({
      type: "UPDATE_TOAST",
      toast: { ...props, id },
    })
  const dismiss = () => dispatch({ type: "DISMISS_TOAST", toastId: id })

  dispatch({
    type: "ADD_TOAST",
    toast: {
      ...props,
      id,
      open: true,
      onOpenChange: (open) => {
        if (!open) dismiss()
      },
    },
  })

  return {
    id: id,
    dismiss,
    update,
  }
}

function useToast() {
  const [state, setState] = React.useState<State>(memoryState)

  React.useEffect(() => {
    listeners.push(setState)
    return () => {
      const index = listeners.indexOf(setState)
      if (index > -1) {
        listeners.splice(index, 1)
      }
    }
  }, [state])

  return {
    ...state,
    toast,
    dismiss: (toastId?: string) => dispatch({ type: "DISMISS_TOAST", toastId }),
  }
}

export { useToast, toast }
</file>

<file path="src/hooks/use-view-tracker.ts">
'use client';

import { useEffect, useRef } from 'react';

interface UseViewTrackerProps {
  postId: string;
  enabled?: boolean;
}

export function useViewTracker({ postId, enabled = true }: UseViewTrackerProps) {
  const hasTracked = useRef(false);

  useEffect(() => {
    if (!enabled || !postId || hasTracked.current) {
      return;
    }

    const trackView = async () => {
      try {
        // Generate a simple session ID for tracking
        const sessionId = sessionStorage.getItem('blog-session-id') || 
          (() => {
            const id = Math.random().toString(36).substring(2, 15);
            sessionStorage.setItem('blog-session-id', id);
            return id;
          })();

        const response = await fetch(`/api/posts/${postId}/views`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ sessionId }),
        });

        if (response.ok) {
          hasTracked.current = true;
        }
      } catch (error) {
        console.error('Failed to track view:', error);
      }
    };

    // Track view after a short delay to ensure user is actually reading
    const timeoutId = setTimeout(trackView, 2000);

    return () => {
      clearTimeout(timeoutId);
    };
  }, [postId, enabled]);
}

export function useViewCount(postId: string) {
  const getViewCount = async (): Promise<number> => {
    try {
      const response = await fetch(`/api/posts/${postId}/views`);
      if (response.ok) {
        const data = await response.json();
        return data.viewCount || 0;
      }
    } catch (error) {
      console.error('Failed to fetch view count:', error);
    }
    return 0;
  };

  return { getViewCount };
}
</file>

<file path="src/i18n/config.ts">
import { getRequestConfig } from 'next-intl/server';
import { routing } from './routing';

export default getRequestConfig(async ({ requestLocale }) => {
  // This function receives the locale from the [locale] segment
  let locale = await requestLocale;
  
  // Validate that the incoming `locale` parameter is valid
  if (!locale || !routing.locales.includes(locale as any)) {
    locale = routing.defaultLocale;
  }

  return {
    locale,
    messages: (await import(`../../messages/${locale}.json`)).default
  };
});
</file>

<file path="src/i18n/routing.ts">
import { createNavigation } from 'next-intl/navigation';
import { defineRouting } from 'next-intl/routing';

export const routing = defineRouting({
  locales: ['en', 'ko'],
  defaultLocale: 'en',
  localePrefix: 'always',
  localeDetection: true
});

export const { Link, redirect, usePathname, useRouter } = createNavigation(routing);
</file>

<file path="src/lib/animations.ts">
import { Variants } from 'framer-motion';

// ê³µí†µ easing functions - ì•ˆì „í•œ ì„¤ì •ìœ¼ë¡œ ë³€ê²½
export const easings = {
  easeInOut: "easeInOut",
  easeOut: "easeOut", 
  easeIn: "easeIn",
  spring: { type: "spring" as const, damping: 25, stiffness: 300 },
  springBounce: { type: "spring" as const, damping: 20, stiffness: 400 },
  springSmooth: { type: "spring" as const, damping: 30, stiffness: 200 },
};

// í˜ì´ì§€ íŠ¸ëœì§€ì…˜ variants
export const pageVariants: Variants = {
  initial: {
    opacity: 0,
    y: 20,
  },
  animate: {
    opacity: 1,
    y: 0,
    transition: {
      duration: 0.5,
      ease: "easeOut",
    },
  },
  exit: {
    opacity: 0,
    y: -20,
    transition: {
      duration: 0.3,
      ease: "easeIn",
    },
  },
};

// ì»¨í…Œì´ë„ˆ stagger variants
export const containerVariants: Variants = {
  hidden: {
    opacity: 0,
  },
  visible: {
    opacity: 1,
    transition: {
      staggerChildren: 0.1,
      delayChildren: 0.2,
    },
  },
};

// ì¹´ë“œ ì• ë‹ˆë©”ì´ì…˜ variants
export const cardVariants: Variants = {
  hidden: {
    opacity: 0,
    y: 50,
    scale: 0.95,
  },
  visible: {
    opacity: 1,
    y: 0,
    scale: 1,
    transition: {
      duration: 0.5,
      ease: "easeOut",
    },
  },
  hover: {
    y: -8,
    scale: 1.02,
    transition: {
      duration: 0.3,
      type: "spring",
      damping: 30,
      stiffness: 200,
    },
  },
  tap: {
    scale: 0.98,
    transition: {
      duration: 0.1,
    },
  },
};

// ëª¨ë‹¬ ì• ë‹ˆë©”ì´ì…˜ variants
export const modalVariants: Variants = {
  hidden: {
    opacity: 0,
    scale: 0.8,
    y: 20,
  },
  visible: {
    opacity: 1,
    scale: 1,
    y: 0,
    transition: {
      duration: 0.3,
      type: "spring",
      damping: 20,
      stiffness: 400,
    },
  },
  exit: {
    opacity: 0,
    scale: 0.9,
    y: 10,
    transition: {
      duration: 0.2,
      ease: "easeIn",
    },
  },
};

// ë“œë¡­ë‹¤ìš´ ì• ë‹ˆë©”ì´ì…˜ variants
export const dropdownVariants: Variants = {
  hidden: {
    opacity: 0,
    scale: 0.95,
    y: -10,
  },
  visible: {
    opacity: 1,
    scale: 1,
    y: 0,
    transition: {
      duration: 0.2,
      ease: "easeOut",
    },
  },
  exit: {
    opacity: 0,
    scale: 0.95,
    y: -10,
    transition: {
      duration: 0.15,
      ease: "easeIn",
    },
  },
};

// í—¤ë” ì• ë‹ˆë©”ì´ì…˜ variants
export const headerVariants: Variants = {
  visible: {
    y: 0,
    opacity: 1,
    transition: {
      duration: 0.3,
      ease: "easeOut",
    },
  },
  hidden: {
    y: -100,
    opacity: 0,
    transition: {
      duration: 0.3,
      ease: "easeIn",
    },
  },
};

// ë²„íŠ¼ ì• ë‹ˆë©”ì´ì…˜ variants
export const buttonVariants: Variants = {
  initial: {
    scale: 1,
  },
  hover: {
    scale: 1.05,
    transition: {
      duration: 0.2,
      ease: "easeOut",
    },
  },
  tap: {
    scale: 0.95,
    transition: {
      duration: 0.1,
    },
  },
};

// í˜ì´ë“œ ì¸ ì• ë‹ˆë©”ì´ì…˜
export const fadeInVariants: Variants = {
  hidden: {
    opacity: 0,
  },
  visible: {
    opacity: 1,
    transition: {
      duration: 0.4,
      ease: "easeOut",
    },
  },
};

// ìŠ¬ë¼ì´ë“œ ì—… ì• ë‹ˆë©”ì´ì…˜
export const slideUpVariants: Variants = {
  hidden: {
    opacity: 0,
    y: 30,
  },
  visible: {
    opacity: 1,
    y: 0,
    transition: {
      duration: 0.5,
      ease: "easeOut",
    },
  },
};

// ìŠ¤ì¼€ì¼ ì• ë‹ˆë©”ì´ì…˜
export const scaleVariants: Variants = {
  hidden: {
    opacity: 0,
    scale: 0.8,
  },
  visible: {
    opacity: 1,
    scale: 1,
    transition: {
      duration: 0.4,
      type: "spring",
      damping: 30,
      stiffness: 200,
    },
  },
};

// ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ ì• ë‹ˆë©”ì´ì…˜
export const listItemVariants: Variants = {
  hidden: {
    opacity: 0,
    x: -20,
  },
  visible: {
    opacity: 1,
    x: 0,
    transition: {
      duration: 0.3,
      ease: "easeOut",
    },
  },
};

// ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ì„ ìœ„í•œ ìœ í‹¸ë¦¬í‹°
export const loadingVariants: Variants = {
  loading: {
    opacity: 0.5,
    transition: {
      duration: 1.5,
      repeat: Infinity,
      repeatType: "reverse",
      ease: "easeInOut",
    },
  },
};

// Reduced motionì„ ê³ ë ¤í•œ ì• ë‹ˆë©”ì´ì…˜ ì„¤ì •
export const getReducedMotionVariants = (variants: Variants): Variants => {
  if (typeof window !== 'undefined' && window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
    // Reduced motionì´ ì„¤ì •ëœ ê²½ìš° ì• ë‹ˆë©”ì´ì…˜ì„ ë‹¨ìˆœí™”
    return Object.keys(variants).reduce((acc, key) => {
      acc[key] = {
        ...variants[key],
        transition: { duration: 0.01 },
      };
      return acc;
    }, {} as Variants);
  }
  return variants;
};
</file>

<file path="src/lib/auth/admin-guard.ts">
import { createClient } from '@/lib/supabase/server';
import { redirect } from 'next/navigation';

/**
 * ì„œë²„ ì‚¬ì´ë“œ ê´€ë¦¬ì ê¶Œí•œ ê²€ì¦
 * ê´€ë¦¬ì í˜ì´ì§€ì—ì„œ ì‚¬ìš©í•˜ì—¬ ê¶Œí•œì„ í™•ì¸í•©ë‹ˆë‹¤.
 */
export async function requireAdmin() {
  const supabase = await createClient();
  
  // 1. ì‚¬ìš©ì ì¸ì¦ í™•ì¸
  const { data: { user }, error: userError } = await supabase.auth.getUser();
  
  if (userError || !user) {
    redirect('/auth/login?redirectTo=/admin');
  }

  // 2. ê´€ë¦¬ì ê¶Œí•œ í™•ì¸ (ì´ë©”ì¼ ê¸°ë°˜ ì„ì‹œ)
  const isAdmin = user.email === 'admin@devblog.com';

  if (!isAdmin) {
    redirect('/unauthorized');
  }

  return { user, isAdmin: true };
}

/**
 * ê´€ë¦¬ì ê¶Œí•œì´ ìˆëŠ”ì§€ í™•ì¸ë§Œ í•˜ê³  ë¦¬ë‹¤ì´ë ‰íŠ¸í•˜ì§€ ì•ŠìŒ
 */
export async function checkAdminPermission() {
  const supabase = await createClient();
  
  try {
    const { data: { user } } = await supabase.auth.getUser();
    
    if (!user) {
      return { user: null, isAdmin: false };
    }

    const isAdmin = user.email === 'admin@devblog.com';
    
    return { user, isAdmin };
  } catch (error) {
    console.error('Admin permission check error:', error);
    return { user: null, isAdmin: false };
  }
}

/**
 * ê´€ë¦¬ì ì‘ì—… ë¡œê¹…
 */
export async function logAdminAction(
  action: string,
  tableName: string,
  recordId: string,
  details?: Record<string, any>
) {
  const supabase = await createClient();
  
  try {
    const { user } = await requireAdmin();
    
    await supabase.rpc('log_admin_action', {
      p_action: action,
      p_table_name: tableName,
      p_record_id: recordId,
      p_details: details || {}
    });
  } catch (error) {
    console.error('Admin action logging error:', error);
    // ë¡œê¹… ì‹¤íŒ¨ëŠ” ì£¼ìš” ê¸°ëŠ¥ì„ ì°¨ë‹¨í•˜ì§€ ì•ŠìŒ
  }
}
</file>

<file path="src/lib/security/input-validation.ts">
/**
 * ì…ë ¥ ê²€ì¦ ë° ìƒˆë‹ˆíƒ€ì´ì œì´ì…˜ ìœ í‹¸ë¦¬í‹°
 * XSS, SQL ì¸ì ì…˜, ê¸°íƒ€ ë³´ì•ˆ ìœ„í˜‘ìœ¼ë¡œë¶€í„° ë³´í˜¸
 */

// HTML ì—”í‹°í‹° ì¸ì½”ë”©ì„ ìœ„í•œ ë§¤í•‘
const HTML_ENTITIES: Record<string, string> = {
  '&': '&amp;',
  '<': '&lt;',
  '>': '&gt;',
  '"': '&quot;',
  "'": '&#x27;',
  '/': '&#x2F;',
  '`': '&#x60;',
  '=': '&#x3D;'
};

/**
 * HTML íŠ¹ìˆ˜ ë¬¸ìë¥¼ ì—”í‹°í‹°ë¡œ ì¸ì½”ë”©
 */
export function escapeHtml(unsafe: string): string {
  return unsafe.replace(/[&<>"'`=\/]/g, (s) => HTML_ENTITIES[s]);
}

/**
 * ê¸°ë³¸ XSS ë°©ì§€ë¥¼ ìœ„í•œ HTML íƒœê·¸ ì œê±°
 */
export function stripHtml(html: string): string {
  return html.replace(/<[^>]*>/g, '');
}

/**
 * í—ˆìš©ëœ HTML íƒœê·¸ë§Œ ìœ ì§€ (í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ë°©ì‹)
 */
export function sanitizeHtml(html: string, allowedTags: string[] = []): string {
  if (allowedTags.length === 0) {
    return stripHtml(html);
  }

  const allowedTagsRegex = new RegExp(`<(?!\/?(?:${allowedTags.join('|')})\\b)[^>]*>`, 'gi');
  return html.replace(allowedTagsRegex, '');
}

/**
 * SQL ì¸ì ì…˜ ë°©ì§€ë¥¼ ìœ„í•œ íŠ¹ìˆ˜ ë¬¸ì ì´ìŠ¤ì¼€ì´í”„
 */
export function escapeSql(input: string): string {
  return input.replace(/['";\\]/g, '\\$&');
}

/**
 * ì´ë©”ì¼ í˜•ì‹ ê²€ì¦
 */
export function validateEmail(email: string): boolean {
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  return emailRegex.test(email);
}

/**
 * URL í˜•ì‹ ê²€ì¦
 */
export function validateUrl(url: string): boolean {
  try {
    new URL(url);
    return true;
  } catch {
    return false;
  }
}

/**
 * íŒŒì¼ í™•ì¥ì ê²€ì¦
 */
export function validateFileExtension(filename: string, allowedExtensions: string[]): boolean {
  const extension = filename.split('.').pop()?.toLowerCase();
  return extension ? allowedExtensions.includes(extension) : false;
}

/**
 * íŒŒì¼ í¬ê¸° ê²€ì¦ (ë°”ì´íŠ¸ ë‹¨ìœ„)
 */
export function validateFileSize(size: number, maxSize: number): boolean {
  return size <= maxSize;
}

/**
 * ë¹„ë°€ë²ˆí˜¸ ê°•ë„ ê²€ì¦
 */
export function validatePasswordStrength(password: string): {
  isStrong: boolean;
  score: number;
  feedback: string[];
} {
  const feedback: string[] = [];
  let score = 0;

  if (password.length >= 8) {
    score += 1;
  } else {
    feedback.push('ìµœì†Œ 8ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
  }

  if (/[A-Z]/.test(password)) {
    score += 1;
  } else {
    feedback.push('ëŒ€ë¬¸ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.');
  }

  if (/[a-z]/.test(password)) {
    score += 1;
  } else {
    feedback.push('ì†Œë¬¸ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.');
  }

  if (/[0-9]/.test(password)) {
    score += 1;
  } else {
    feedback.push('ìˆ«ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.');
  }

  if (/[^A-Za-z0-9]/.test(password)) {
    score += 1;
  } else {
    feedback.push('íŠ¹ìˆ˜ë¬¸ìë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.');
  }

  // ì¼ë°˜ì ì¸ ì•½í•œ íŒ¨í„´ ê²€ì‚¬
  const weakPatterns = [
    /^(password|123456|qwerty|abc123)/i,
    /^(.)\1{7,}$/, // ê°™ì€ ë¬¸ì ë°˜ë³µ
    /^(012345|123456|234567|345678|456789)/,
  ];

  if (weakPatterns.some(pattern => pattern.test(password))) {
    score = Math.max(0, score - 2);
    feedback.push('ë” ë³µì¡í•œ íŒ¨í„´ì„ ì‚¬ìš©í•´ì£¼ì„¸ìš”.');
  }

  return {
    isStrong: score >= 4,
    score,
    feedback
  };
}

/**
 * ì‚¬ìš©ì ì´ë¦„ ê²€ì¦ (ì˜ë¬¸, ìˆ«ì, í•˜ì´í”ˆ, ì–¸ë”ìŠ¤ì½”ì–´ë§Œ í—ˆìš©)
 */
export function validateUsername(username: string): boolean {
  const usernameRegex = /^[a-zA-Z0-9_-]{3,20}$/;
  return usernameRegex.test(username);
}

/**
 * ìŠ¬ëŸ¬ê·¸ ê²€ì¦ (URL ì¹œí™”ì ì¸ ë¬¸ìì—´)
 */
export function validateSlug(slug: string): boolean {
  const slugRegex = /^[a-z0-9-]+$/;
  return slugRegex.test(slug);
}

/**
 * íœ´ëŒ€í° ë²ˆí˜¸ ê²€ì¦ (í•œêµ­ í˜•ì‹)
 */
export function validatePhoneNumber(phone: string): boolean {
  const phoneRegex = /^010-\d{4}-\d{4}$/;
  return phoneRegex.test(phone);
}

/**
 * ì •ìˆ˜ ê²€ì¦
 */
export function validateInteger(value: string, min?: number, max?: number): boolean {
  const num = parseInt(value, 10);
  if (isNaN(num)) return false;
  if (min !== undefined && num < min) return false;
  if (max !== undefined && num > max) return false;
  return true;
}

/**
 * ì‹¤ìˆ˜ ê²€ì¦
 */
export function validateFloat(value: string, min?: number, max?: number): boolean {
  const num = parseFloat(value);
  if (isNaN(num)) return false;
  if (min !== undefined && num < min) return false;
  if (max !== undefined && num > max) return false;
  return true;
}

/**
 * ë¬¸ìì—´ ê¸¸ì´ ê²€ì¦
 */
export function validateLength(value: string, min: number, max: number): boolean {
  return value.length >= min && value.length <= max;
}

/**
 * íŠ¹ì • ê°’ë“¤ë§Œ í—ˆìš©í•˜ëŠ” ê²€ì¦ (í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸)
 */
export function validateWhitelist(value: string, allowedValues: string[]): boolean {
  return allowedValues.includes(value);
}

/**
 * ì •ê·œí‘œí˜„ì‹ íŒ¨í„´ ê²€ì¦
 */
export function validatePattern(value: string, pattern: RegExp): boolean {
  return pattern.test(value);
}

/**
 * ì¢…í•©ì ì¸ ì…ë ¥ ê²€ì¦ í•¨ìˆ˜
 */
export function validateInput(
  value: string,
  rules: {
    required?: boolean;
    minLength?: number;
    maxLength?: number;
    pattern?: RegExp;
    whitelist?: string[];
    email?: boolean;
    url?: boolean;
    integer?: boolean;
    float?: boolean;
    username?: boolean;
    slug?: boolean;
    phone?: boolean;
    sanitize?: boolean;
    escapeHtml?: boolean;
  }
): {
  isValid: boolean;
  sanitizedValue: string;
  errors: string[];
} {
  const errors: string[] = [];
  let sanitizedValue = value;

  // í•„ìˆ˜ ê°’ ê²€ì¦
  if (rules.required && !value) {
    errors.push('í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.');
    return { isValid: false, sanitizedValue, errors };
  }

  // ê°’ì´ ì—†ìœ¼ë©´ ê²€ì¦ í†µê³¼
  if (!value) {
    return { isValid: true, sanitizedValue, errors };
  }

  // ê¸¸ì´ ê²€ì¦
  if (rules.minLength && value.length < rules.minLength) {
    errors.push(`ìµœì†Œ ${rules.minLength}ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.`);
  }

  if (rules.maxLength && value.length > rules.maxLength) {
    errors.push(`ìµœëŒ€ ${rules.maxLength}ìê¹Œì§€ ì…ë ¥ ê°€ëŠ¥í•©ë‹ˆë‹¤.`);
  }

  // íŒ¨í„´ ê²€ì¦
  if (rules.pattern && !rules.pattern.test(value)) {
    errors.push('ì˜¬ë°”ë¥¸ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.');
  }

  // í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê²€ì¦
  if (rules.whitelist && !rules.whitelist.includes(value)) {
    errors.push('í—ˆìš©ë˜ì§€ ì•ŠëŠ” ê°’ì…ë‹ˆë‹¤.');
  }

  // ì´ë©”ì¼ ê²€ì¦
  if (rules.email && !validateEmail(value)) {
    errors.push('ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.');
  }

  // URL ê²€ì¦
  if (rules.url && !validateUrl(value)) {
    errors.push('ì˜¬ë°”ë¥¸ URL í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.');
  }

  // ì •ìˆ˜ ê²€ì¦
  if (rules.integer && !validateInteger(value)) {
    errors.push('ì˜¬ë°”ë¥¸ ì •ìˆ˜ê°€ ì•„ë‹™ë‹ˆë‹¤.');
  }

  // ì‹¤ìˆ˜ ê²€ì¦
  if (rules.float && !validateFloat(value)) {
    errors.push('ì˜¬ë°”ë¥¸ ìˆ«ìê°€ ì•„ë‹™ë‹ˆë‹¤.');
  }

  // ì‚¬ìš©ìëª… ê²€ì¦
  if (rules.username && !validateUsername(value)) {
    errors.push('ì‚¬ìš©ìëª…ì€ ì˜ë¬¸, ìˆ«ì, í•˜ì´í”ˆ, ì–¸ë”ìŠ¤ì½”ì–´ë§Œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.');
  }

  // ìŠ¬ëŸ¬ê·¸ ê²€ì¦
  if (rules.slug && !validateSlug(value)) {
    errors.push('ìŠ¬ëŸ¬ê·¸ëŠ” ì†Œë¬¸ì, ìˆ«ì, í•˜ì´í”ˆë§Œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.');
  }

  // íœ´ëŒ€í° ë²ˆí˜¸ ê²€ì¦
  if (rules.phone && !validatePhoneNumber(value)) {
    errors.push('ì˜¬ë°”ë¥¸ íœ´ëŒ€í° ë²ˆí˜¸ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤. (010-0000-0000)');
  }

  // ìƒˆë‹ˆíƒ€ì´ì œì´ì…˜
  if (rules.sanitize) {
    sanitizedValue = stripHtml(sanitizedValue);
  }

  if (rules.escapeHtml) {
    sanitizedValue = escapeHtml(sanitizedValue);
  }

  return {
    isValid: errors.length === 0,
    sanitizedValue,
    errors
  };
}

/**
 * ê°ì²´ì˜ ëª¨ë“  ì†ì„±ì— ëŒ€í•´ ê²€ì¦ ìˆ˜í–‰
 */
export function validateObject<T extends Record<string, any>>(
  obj: T,
  schema: Record<keyof T, Parameters<typeof validateInput>[1]>
): {
  isValid: boolean;
  sanitizedData: T;
  errors: Record<keyof T, string[]>;
} {
  const errors: Record<keyof T, string[]> = {} as any;
  const sanitizedData: T = {} as any;
  let isValid = true;

  for (const [key, rules] of Object.entries(schema)) {
    const value = obj[key];
    const result = validateInput(String(value || ''), rules);
    
    if (!result.isValid) {
      errors[key as keyof T] = result.errors;
      isValid = false;
    }
    
    sanitizedData[key as keyof T] = result.sanitizedValue as any;
  }

  return { isValid, sanitizedData, errors };
}
</file>

<file path="src/lib/session.ts">
'use server';

import { cookies } from 'next/headers';
import { createClient } from '@/lib/supabase/server';

const SESSION_COOKIE_NAME = 'comment_session';
const DELETION_TIMEOUT = 30 * 60 * 1000; // 30 minutes in milliseconds

/**
 * Get or create a session ID for comment management
 */
export async function getCommentSessionId(): Promise<string> {
  const cookieStore = await cookies();
  let sessionId = cookieStore.get(SESSION_COOKIE_NAME)?.value;

  if (!sessionId) {
    sessionId = crypto.randomUUID();
    cookieStore.set(SESSION_COOKIE_NAME, sessionId, {
      httpOnly: true,
      secure: process.env.NODE_ENV === 'production',
      sameSite: 'lax',
      maxAge: 60 * 60 * 24, // 24 hours
    });
  }

  return sessionId;
}

/**
 * Grant deletion rights for a comment to the current session
 */
export async function grantCommentDeletionRights(commentId: string): Promise<void> {
  const sessionId = await getCommentSessionId();
  const supabase = await createClient();
  
  const expiresAt = new Date(Date.now() + DELETION_TIMEOUT);
  
  await supabase
    .from('session_comments')
    .insert({
      session_id: sessionId,
      comment_id: commentId,
      expires_at: expiresAt.toISOString(),
    });
}

/**
 * Check if the current session can delete a specific comment
 */
export async function canDeleteComment(commentId: string): Promise<boolean> {
  const sessionId = await getCommentSessionId();
  const supabase = await createClient();
  
  const { data, error } = await supabase
    .from('session_comments')
    .select('expires_at')
    .eq('session_id', sessionId)
    .eq('comment_id', commentId)
    .single();
  
  if (error || !data) {
    return false;
  }
  
  // Check if the deletion right has expired
  const now = new Date();
  const expiresAt = new Date(data.expires_at);
  
  return now < expiresAt;
}

/**
 * Get all comments that the current session can delete
 */
export async function getUserDeletableComments(postId: string): Promise<string[]> {
  const sessionId = await getCommentSessionId();
  const supabase = await createClient();
  
  const { data, error } = await supabase
    .from('session_comments')
    .select(`
      comment_id,
      expires_at,
      comments!inner(post_id)
    `)
    .eq('session_id', sessionId)
    .eq('comments.post_id', postId)
    .gt('expires_at', new Date().toISOString());
  
  if (error || !data) {
    return [];
  }
  
  return data.map(item => item.comment_id);
}

/**
 * Clean up expired session comment rights
 */
export async function cleanupExpiredSessions(): Promise<void> {
  const supabase = await createClient();
  
  await supabase
    .from('session_comments')
    .delete()
    .lt('expires_at', new Date().toISOString());
}

/**
 * Revoke deletion rights for a comment (used after deletion)
 */
export async function revokeCommentDeletionRights(commentId: string): Promise<void> {
  const sessionId = await getCommentSessionId();
  const supabase = await createClient();
  
  await supabase
    .from('session_comments')
    .delete()
    .eq('session_id', sessionId)
    .eq('comment_id', commentId);
}
</file>

<file path="src/lib/translations.ts">
import type { CategoryWithStats, TagWithStats } from '@/lib/blog';

/**
 * Get translated category name using the slug as a key
 * @param categorySlug - The category slug to translate
 * @param t - The translation function from useTranslations('categories')
 * @param fallbackName - Optional fallback name if translation key not found
 * @returns Translated category name or fallback
 */
export function getTranslatedCategoryName(
  categorySlug: string,
  t: (key: string) => string,
  fallbackName?: string
): string {
  try {
    // Try to get translation using slug as key
    const translatedName = t(categorySlug);
    
    // If translation key is not found, next-intl returns the key itself
    // Check if we got a translation or just the key back
    if (translatedName === categorySlug && fallbackName) {
      return fallbackName;
    }
    
    return translatedName;
  } catch (error: any) {
    // If translation fails (MISSING_MESSAGE error), return fallback or original name
    if (error?.code === 'MISSING_MESSAGE') {
      return fallbackName || categorySlug;
    }
    // For other errors, still return fallback
    return fallbackName || categorySlug;
  }
}

/**
 * Get translated category description using the slug as a key
 * @param categorySlug - The category slug to translate
 * @param t - The translation function from useTranslations('categoryDescriptions')
 * @param fallbackDescription - Optional fallback description if translation key not found
 * @returns Translated category description or fallback
 */
export function getTranslatedCategoryDescription(
  categorySlug: string,
  t: (key: string) => string,
  fallbackDescription?: string
): string {
  try {
    const translatedDescription = t(categorySlug);
    
    if (translatedDescription === categorySlug && fallbackDescription) {
      return fallbackDescription;
    }
    
    return translatedDescription;
  } catch (error: any) {
    // If translation fails (MISSING_MESSAGE error), return fallback
    if (error?.code === 'MISSING_MESSAGE') {
      return fallbackDescription || `Explore articles about ${categorySlug}`;
    }
    // For other errors, still return fallback
    return fallbackDescription || `Explore articles about ${categorySlug}`;
  }
}

/**
 * Get translated tag name using the slug as a key
 * @param tagSlug - The tag slug to translate
 * @param t - The translation function from useTranslations('tags')
 * @param fallbackName - Optional fallback name if translation key not found
 * @returns Translated tag name or fallback
 */
export function getTranslatedTagName(
  tagSlug: string,
  t: (key: string) => string,
  fallbackName?: string
): string {
  try {
    const translatedName = t(tagSlug);
    
    if (translatedName === tagSlug && fallbackName) {
      return fallbackName;
    }
    
    return translatedName;
  } catch (error: any) {
    // If translation fails (MISSING_MESSAGE error), return fallback or original name
    if (error?.code === 'MISSING_MESSAGE') {
      return fallbackName || tagSlug;
    }
    // For other errors, still return fallback
    return fallbackName || tagSlug;
  }
}

/**
 * Transform a category object to include translated name and description
 * @param category - The category object with stats
 * @param tCategory - Translation function for category names
 * @param tDescription - Translation function for category descriptions
 * @returns Category object with translated properties
 */
export function getTranslatedCategory(
  category: CategoryWithStats,
  tCategory: (key: string) => string,
  tDescription: (key: string) => string
) {
  return {
    ...category,
    translatedName: getTranslatedCategoryName(category.slug, tCategory, category.name),
    translatedDescription: getTranslatedCategoryDescription(category.slug, tDescription)
  };
}

/**
 * Transform a tag object to include translated name
 * @param tag - The tag object with stats
 * @param tTag - Translation function for tag names
 * @returns Tag object with translated properties
 */
export function getTranslatedTag(
  tag: TagWithStats,
  tTag: (key: string) => string
) {
  return {
    ...tag,
    translatedName: getTranslatedTagName(tag.slug, tTag, tag.name)
  };
}

/**
 * Transform an array of categories to include translated names and descriptions
 * @param categories - Array of category objects with stats
 * @param tCategory - Translation function for category names
 * @param tDescription - Translation function for category descriptions
 * @returns Array of category objects with translated properties
 */
export function getTranslatedCategories(
  categories: CategoryWithStats[],
  tCategory: (key: string) => string,
  tDescription: (key: string) => string
) {
  return categories.map(category => getTranslatedCategory(category, tCategory, tDescription));
}

/**
 * Transform an array of tags to include translated names
 * @param tags - Array of tag objects with stats
 * @param tTag - Translation function for tag names
 * @returns Array of tag objects with translated properties
 */
export function getTranslatedTags(
  tags: TagWithStats[],
  tTag: (key: string) => string
) {
  return tags.map(tag => getTranslatedTag(tag, tTag));
}
</file>

<file path="src/lib/utils.ts">
import { clsx, type ClassValue } from "clsx";
import { twMerge } from "tailwind-merge";

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}
</file>

<file path="src/lib/utils/__tests__/html-utils.test.ts">
/**
 * Tests for HTML utility functions
 * These tests ensure the image extraction functionality works correctly
 */

import { 
  extractFirstImageFromHtml, 
  extractAllImagesFromHtml, 
  getPostThumbnail, 
  hasImages,
  extractTextFromHtml 
} from '../html-utils';

describe('HTML Utils', () => {
  describe('extractFirstImageFromHtml', () => {
    it('should extract first image URL from HTML', () => {
      const html = '<p>Some text</p><img src="https://example.com/image1.jpg" alt="Image 1"><img src="https://example.com/image2.jpg" alt="Image 2">';
      const result = extractFirstImageFromHtml(html);
      expect(result).toBe('https://example.com/image1.jpg');
    });

    it('should return null when no images exist', () => {
      const html = '<p>Just some text with no images</p>';
      const result = extractFirstImageFromHtml(html);
      expect(result).toBeNull();
    });

    it('should return null for empty content', () => {
      const result = extractFirstImageFromHtml('');
      expect(result).toBeNull();
    });

    it('should handle malformed HTML gracefully', () => {
      const html = '<img src="test.jpg"'; // missing closing >
      const result = extractFirstImageFromHtml(html);
      expect(result).toBeNull();
    });
  });

  describe('extractAllImagesFromHtml', () => {
    it('should extract all image URLs from HTML', () => {
      const html = '<img src="image1.jpg"><p>Text</p><img src="image2.jpg"><img src="image3.jpg">';
      const result = extractAllImagesFromHtml(html);
      expect(result).toEqual(['image1.jpg', 'image2.jpg', 'image3.jpg']);
    });

    it('should return empty array when no images exist', () => {
      const html = '<p>No images here</p>';
      const result = extractAllImagesFromHtml(html);
      expect(result).toEqual([]);
    });
  });

  describe('getPostThumbnail', () => {
    it('should prioritize cover image over content images', () => {
      const coverImage = 'https://example.com/cover.jpg';
      const content = '<img src="https://example.com/content.jpg">';
      const result = getPostThumbnail(coverImage, content);
      expect(result).toBe(coverImage);
    });

    it('should use first content image when no cover image', () => {
      const content = '<p>Text</p><img src="https://example.com/content.jpg"><img src="https://example.com/content2.jpg">';
      const result = getPostThumbnail(null, content);
      expect(result).toBe('https://example.com/content.jpg');
    });

    it('should return null when no images available', () => {
      const result = getPostThumbnail(null, '<p>No images</p>');
      expect(result).toBeNull();
    });
  });

  describe('hasImages', () => {
    it('should return true when content has images', () => {
      const html = '<p>Text</p><img src="test.jpg">';
      expect(hasImages(html)).toBe(true);
    });

    it('should return false when content has no images', () => {
      const html = '<p>Just text</p>';
      expect(hasImages(html)).toBe(false);
    });

    it('should return false for empty content', () => {
      expect(hasImages('')).toBe(false);
    });
  });

  describe('extractTextFromHtml', () => {
    it('should extract plain text from HTML', () => {
      const html = '<h1>Title</h1><p>Paragraph with <strong>bold</strong> text</p>';
      const result = extractTextFromHtml(html);
      expect(result).toBe('Title Paragraph with bold text');
    });

    it('should return empty string for empty content', () => {
      const result = extractTextFromHtml('');
      expect(result).toBe('');
    });

    it('should handle content with only HTML tags', () => {
      const html = '<div><span></span></div>';
      const result = extractTextFromHtml(html);
      expect(result).toBe('');
    });
  });
});
</file>

<file path="src/lib/utils/date.ts">
import { format, formatDistanceToNow } from 'date-fns';
import { ko } from 'date-fns/locale';

export function formatDate(date: Date | string, locale: string = 'en'): string {
  const dateObj = typeof date === 'string' ? new Date(date) : date;
  
  if (locale === 'ko') {
    return format(dateObj, 'yyyyë…„ MMì›” ddì¼', { locale: ko });
  }
  
  return format(dateObj, 'MMMM dd, yyyy');
}

export function formatRelativeTime(date: Date | string, locale: string = 'en'): string {
  const dateObj = typeof date === 'string' ? new Date(date) : date;
  
  if (locale === 'ko') {
    return formatDistanceToNow(dateObj, { addSuffix: true, locale: ko });
  }
  
  return formatDistanceToNow(dateObj, { addSuffix: true });
}

export function formatDateTime(date: Date | string, locale: string = 'en'): string {
  const dateObj = typeof date === 'string' ? new Date(date) : date;
  
  if (locale === 'ko') {
    return format(dateObj, 'yyyyë…„ MMì›” ddì¼ HH:mm', { locale: ko });
  }
  
  return format(dateObj, 'MMMM dd, yyyy at HH:mm');
}
</file>

<file path="src/lib/utils/html-utils.ts">
/**
 * Extract the first image URL from HTML content
 * @param htmlContent - The HTML content to parse
 * @returns The first image URL found, or null if no image exists
 */
export function extractFirstImageFromHtml(htmlContent: string): string | null {
  if (!htmlContent) return null;

  // Create a temporary DOM element to parse HTML
  if (typeof window === 'undefined') {
    // Server-side: Use regex to extract first image
    const imgRegex = /<img[^>]+src="([^"]*)"[^>]*>/i;
    const match = htmlContent.match(imgRegex);
    return match ? match[1] : null;
  }

  // Client-side: Use DOM parsing
  try {
    const parser = new DOMParser();
    const doc = parser.parseFromString(htmlContent, 'text/html');
    const firstImg = doc.querySelector('img');
    return firstImg ? firstImg.src : null;
  } catch (error) {
    console.error('Error parsing HTML for image extraction:', error);
    return null;
  }
}

/**
 * Extract all image URLs from HTML content
 * @param htmlContent - The HTML content to parse
 * @returns Array of image URLs found
 */
export function extractAllImagesFromHtml(htmlContent: string): string[] {
  if (!htmlContent) return [];

  if (typeof window === 'undefined') {
    // Server-side: Use regex to extract all images
    const imgRegex = /<img[^>]+src="([^"]*)"[^>]*>/gi;
    const matches = htmlContent.matchAll(imgRegex);
    return Array.from(matches).map(match => match[1]);
  }

  // Client-side: Use DOM parsing
  try {
    const parser = new DOMParser();
    const doc = parser.parseFromString(htmlContent, 'text/html');
    const images = doc.querySelectorAll('img');
    return Array.from(images).map(img => img.src);
  } catch (error) {
    console.error('Error parsing HTML for image extraction:', error);
    return [];
  }
}

/**
 * Get the best thumbnail for a post
 * Priority: cover_image_path > first image in content > null
 * @param coverImagePath - The post's cover image path
 * @param htmlContent - The post's HTML content
 * @returns The best thumbnail URL or null
 */
export function getPostThumbnail(coverImagePath: string | null, htmlContent: string): string | null {
  // Priority 1: Use cover image if available
  if (coverImagePath) {
    return coverImagePath;
  }

  // Priority 2: Use first image from content
  return extractFirstImageFromHtml(htmlContent);
}

/**
 * Check if content has any images
 * @param htmlContent - The HTML content to check
 * @returns true if content contains at least one image
 */
export function hasImages(htmlContent: string): boolean {
  if (!htmlContent) return false;

  const imgRegex = /<img[^>]+src="[^"]*"[^>]*>/i;
  return imgRegex.test(htmlContent);
}

/**
 * Extract text content from HTML (strip all HTML tags)
 * @param htmlContent - The HTML content to parse
 * @returns Plain text content
 */
export function extractTextFromHtml(htmlContent: string): string {
  if (!htmlContent) return '';

  if (typeof window === 'undefined') {
    // Server-side: Use regex to remove HTML tags
    return htmlContent.replace(/<[^>]*>/g, '').replace(/\s+/g, ' ').trim();
  }

  // Client-side: Use DOM parsing
  try {
    const parser = new DOMParser();
    const doc = parser.parseFromString(htmlContent, 'text/html');
    return doc.body.textContent || doc.body.innerText || '';
  } catch (error) {
    console.error('Error parsing HTML for text extraction:', error);
    return htmlContent.replace(/<[^>]*>/g, '').replace(/\s+/g, ' ').trim();
  }
}
</file>

<file path="src/lib/utils/slug.ts">
import slugify from 'slugify';

export function generateSlug(text: string): string {
  return slugify(text, {
    lower: true,
    strict: true,
    remove: /[*+~.()'"!:@]/g,
  });
}

export function formatDate(date: string | Date): string {
  return new Intl.DateTimeFormat('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric',
    hour: '2-digit',
    minute: '2-digit',
  }).format(new Date(date));
}

export function getStatusColor(status: string): string {
  switch (status) {
    case 'published':
      return 'bg-green-100 text-green-800';
    case 'draft':
      return 'bg-gray-100 text-gray-800';
    case 'scheduled':
      return 'bg-blue-100 text-blue-800';
    case 'archived':
      return 'bg-red-100 text-red-800';
    default:
      return 'bg-gray-100 text-gray-800';
  }
}

export function getStatusText(status: string): string {
  switch (status) {
    case 'published':
      return 'Published';
    case 'draft':
      return 'Draft';
    case 'scheduled':
      return 'Scheduled';
    case 'archived':
      return 'Archived';
    default:
      return 'Unknown';
  }
}
</file>

<file path="src/styles/tiptap.css">
/* TipTap Editor Styles */

.ProseMirror {
  outline: none;
  padding: 1rem;
  min-height: 400px;
}

.ProseMirror p.is-editor-empty:first-child::before {
  color: #adb5bd;
  content: attr(data-placeholder);
  float: left;
  height: 0;
  pointer-events: none;
}

/* Improved selection styles */
.ProseMirror .ProseMirror-selectednode {
  outline: 2px solid #3b82f6;
  outline-offset: 2px;
}

/* Image styles */
.ProseMirror img {
  max-width: 100%;
  height: auto;
  border-radius: 0.5rem;
  margin: 1rem 0;
  display: block;
}

.ProseMirror img.ProseMirror-selectednode {
  outline: 2px solid #3b82f6;
  outline-offset: 2px;
}

/* Table styles */
.ProseMirror table {
  border-collapse: collapse;
  margin: 1rem 0;
  overflow: hidden;
  table-layout: fixed;
  width: 100%;
}

.ProseMirror table td,
.ProseMirror table th {
  border: 2px solid #e5e7eb;
  box-sizing: border-box;
  min-width: 1em;
  padding: 6px 8px;
  position: relative;
  vertical-align: top;
}

.ProseMirror table th {
  background-color: #f3f4f6;
  font-weight: bold;
  text-align: left;
}

.ProseMirror table .selectedCell:after {
  background: rgba(59, 130, 246, 0.1);
  content: "";
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  pointer-events: none;
  position: absolute;
  z-index: 2;
}

.ProseMirror table .column-resize-handle {
  background-color: #3b82f6;
  bottom: -2px;
  position: absolute;
  right: -2px;
  pointer-events: none;
  top: 0;
  width: 4px;
}

/* Blockquote styles */
.ProseMirror blockquote {
  border-left: 4px solid #e5e7eb;
  margin: 1rem 0;
  padding-left: 1rem;
  font-style: italic;
}

/* Code styles */
.ProseMirror code {
  background-color: #f3f4f6;
  border-radius: 0.25rem;
  color: #1f2937;
  font-size: 0.875em;
  padding: 0.125rem 0.25rem;
}

.ProseMirror pre {
  background: #1f2937;
  border-radius: 0.5rem;
  color: #f9fafb;
  font-family: 'JetBrains Mono', 'Monaco', 'Consolas', monospace;
  margin: 1rem 0;
  padding: 1rem;
  overflow-x: auto;
}

.ProseMirror pre code {
  background: none;
  color: inherit;
  font-size: 0.875rem;
  padding: 0;
}

/* Link styles */
.ProseMirror a {
  color: #3b82f6;
  text-decoration: underline;
  cursor: pointer;
}

.ProseMirror a:hover {
  color: #1d4ed8;
}

/* Heading styles */
.ProseMirror h1 {
  font-size: 2.25rem;
  font-weight: 700;
  line-height: 2.5rem;
  margin: 2rem 0 1rem 0;
}

.ProseMirror h2 {
  font-size: 1.875rem;
  font-weight: 600;
  line-height: 2.25rem;
  margin: 1.5rem 0 0.75rem 0;
}

.ProseMirror h3 {
  font-size: 1.5rem;
  font-weight: 600;
  line-height: 2rem;
  margin: 1.25rem 0 0.5rem 0;
}

/* List styles */
.ProseMirror ul,
.ProseMirror ol {
  margin: 1rem 0;
  padding-left: 2rem;
}

.ProseMirror li {
  margin: 0.5rem 0;
}

/* Horizontal rule */
.ProseMirror hr {
  border: none;
  border-top: 2px solid #e5e7eb;
  margin: 2rem 0;
}

/* Drag cursor */
.ProseMirror-dropcursor {
  border-left: 2px solid #3b82f6;
  pointer-events: none;
  position: absolute;
}

/* Gap cursor */
.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 2px solid #3b82f6;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

/* Placeholder styles */
.ProseMirror p.is-editor-empty:first-child::before {
  color: #9ca3af;
  content: attr(data-placeholder);
  float: left;
  height: 0;
  pointer-events: none;
}

/* Dark mode support */
@media (prefers-color-scheme: dark) {
  .ProseMirror {
    color: #f9fafb;
  }
  
  .ProseMirror table td,
  .ProseMirror table th {
    border-color: #374151;
  }
  
  .ProseMirror table th {
    background-color: #1f2937;
  }
  
  .ProseMirror blockquote {
    border-left-color: #374151;
  }
  
  .ProseMirror code {
    background-color: #1f2937;
    color: #f9fafb;
  }
  
  .ProseMirror hr {
    border-top-color: #374151;
  }
  
  .ProseMirror p.is-editor-empty:first-child::before {
    color: #6b7280;
  }
}

/* HTML Content Rendering Styles */
.html-content {
  /* Ensure consistent styling when HTML is rendered */
}

.html-content img {
  max-width: 100%;
  height: auto;
  border-radius: 0.5rem;
  margin: 1rem 0;
  display: block;
}

.html-content table {
  border-collapse: collapse;
  margin: 1rem 0;
  overflow: hidden;
  table-layout: fixed;
  width: 100%;
}

.html-content table td,
.html-content table th {
  border: 2px solid #e5e7eb;
  box-sizing: border-box;
  min-width: 1em;
  padding: 6px 8px;
  position: relative;
  vertical-align: top;
}

.html-content table th {
  background-color: #f3f4f6;
  font-weight: bold;
  text-align: left;
}

.html-content blockquote {
  border-left: 4px solid #e5e7eb;
  margin: 1rem 0;
  padding-left: 1rem;
  font-style: italic;
}

.html-content code {
  background-color: #f3f4f6;
  border-radius: 0.25rem;
  color: #1f2937;
  font-size: 0.875em;
  padding: 0.125rem 0.25rem;
}

.html-content pre {
  background: #1f2937;
  border-radius: 0.5rem;
  color: #f9fafb;
  font-family: 'JetBrains Mono', 'Monaco', 'Consolas', monospace;
  margin: 1rem 0;
  padding: 1rem;
  overflow-x: auto;
}

.html-content pre code {
  background: none;
  color: inherit;
  font-size: 0.875rem;
  padding: 0;
}

.html-content a {
  color: #3b82f6;
  text-decoration: underline;
}

.html-content a:hover {
  color: #1d4ed8;
}

/* Dark mode for HTML content */
.dark .html-content table td,
.dark .html-content table th {
  border-color: #374151;
}

.dark .html-content table th {
  background-color: #1f2937;
}

.dark .html-content blockquote {
  border-left-color: #374151;
}

.dark .html-content code {
  background-color: #1f2937;
  color: #f9fafb;
}
</file>

<file path="src/types/global.d.ts">
import en from '../messages/en.json';

type Messages = typeof en;

declare global {
  interface IntlMessages extends Messages {}
}
</file>

<file path="tests/scripts/create-admin-demo.js">
#!/usr/bin/env node
/**
 * ë°ëª¨ ê´€ë¦¬ì ê³„ì • ìƒì„± ìŠ¤í¬ë¦½íŠ¸
 *
 * ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” í…ŒìŠ¤íŠ¸ìš© ê´€ë¦¬ì ê³„ì •ì„ ìƒì„±í•©ë‹ˆë‹¤.
 * ì‹¤ì œ ìš´ì˜ í™˜ê²½ì—ì„œëŠ” ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”.
 */

import { createClient } from "@supabase/supabase-js";

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;

if (!supabaseUrl || !supabaseServiceKey) {
  console.error("âŒ í™˜ê²½ ë³€ìˆ˜ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
  console.error(
    "NEXT_PUBLIC_SUPABASE_URLê³¼ SUPABASE_SERVICE_ROLE_KEYë¥¼ í™•ì¸í•˜ì„¸ìš”."
  );
  process.exit(1);
}

const supabase = createClient(supabaseUrl, supabaseServiceKey);

async function createAdminAccount() {
  console.log("ğŸ”‘ ë°ëª¨ ê´€ë¦¬ì ê³„ì • ìƒì„± ì¤‘...");

  const testEmail = "admin@devblog.com";
  const testPassword = process.env.ADMIN_INITIAL_PASSWORD || (() => {
    console.error("âŒ ADMIN_INITIAL_PASSWORD í™˜ê²½ ë³€ìˆ˜ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
    console.error("ë³´ì•ˆì„ ìœ„í•´ .env.local íŒŒì¼ì— ADMIN_INITIAL_PASSWORD=<your-secure-password>ë¥¼ ì„¤ì •í•˜ì„¸ìš”.");
    process.exit(1);
  })();

  try {
    // 1. ì‚¬ìš©ì ìƒì„±
    const { data: authData, error: authError } =
      await supabase.auth.admin.createUser({
        email: testEmail,
        password: testPassword,
        email_confirm: true,
      });

    if (authError) {
      if (authError.message.includes("already registered")) {
        console.log(
          "â„¹ï¸  ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì‚¬ìš©ìì…ë‹ˆë‹¤. ê´€ë¦¬ì ê¶Œí•œ ë¶€ì—¬ë¥¼ ì‹œë„í•©ë‹ˆë‹¤."
        );

        // ê¸°ì¡´ ì‚¬ìš©ì ì°¾ê¸°
        const { data: existingUser, error: findError } = await supabase
          .from("auth.users")
          .select("id")
          .eq("email", testEmail)
          .single();

        if (findError) {
          console.error(
            "âŒ ê¸°ì¡´ ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:",
            findError.message
          );
          return;
        }

        // ê´€ë¦¬ì ê¶Œí•œ ë¶€ì—¬
        const { error: adminError } = await supabase
          .from("admins")
          .insert([{ user_id: existingUser.id }]);

        if (adminError && !adminError.message.includes("duplicate")) {
          console.error("âŒ ê´€ë¦¬ì ê¶Œí•œ ë¶€ì—¬ ì‹¤íŒ¨:", adminError.message);
          return;
        }

        console.log("âœ… ê¸°ì¡´ ì‚¬ìš©ìì—ê²Œ ê´€ë¦¬ì ê¶Œí•œì´ ë¶€ì—¬ë˜ì—ˆìŠµë‹ˆë‹¤.");
      } else {
        console.error("âŒ ì‚¬ìš©ì ìƒì„± ì‹¤íŒ¨:", authError.message);
        return;
      }
    } else {
      console.log("âœ… ì‚¬ìš©ì ìƒì„± ì„±ê³µ");

      // 2. ê´€ë¦¬ì ê¶Œí•œ ë¶€ì—¬
      const { error: adminError } = await supabase
        .from("admins")
        .insert([{ user_id: authData.user.id }]);

      if (adminError) {
        console.error("âŒ ê´€ë¦¬ì ê¶Œí•œ ë¶€ì—¬ ì‹¤íŒ¨:", adminError.message);
        return;
      }

      console.log("âœ… ê´€ë¦¬ì ê¶Œí•œ ë¶€ì—¬ ì„±ê³µ");
    }

    // 3. ìƒ˜í”Œ ë°ì´í„° ìƒì„±
    console.log("ğŸ“ ìƒ˜í”Œ ë°ì´í„° ìƒì„± ì¤‘...");

    // ì¹´í…Œê³ ë¦¬ ìƒì„±
    const categories = [
      {
        name: "Programming",
        slug: "programming",
        description: "Programming tutorials and tips",
      },
      {
        name: "Web Development",
        slug: "web-development",
        description: "Frontend and backend development",
      },
      {
        name: "DevOps",
        slug: "devops",
        description: "DevOps and infrastructure",
      },
      {
        name: "Tutorial",
        slug: "tutorial",
        description: "Step-by-step tutorials",
      },
    ];

    const { error: categoryError } = await supabase
      .from("categories")
      .upsert(categories, { onConflict: "slug" });

    if (categoryError) {
      console.error("âš ï¸  ì¹´í…Œê³ ë¦¬ ìƒì„± ì‹¤íŒ¨:", categoryError.message);
    } else {
      console.log("âœ… ì¹´í…Œê³ ë¦¬ ìƒì„± ì„±ê³µ");
    }

    // íƒœê·¸ ìƒì„±
    const tags = [
      { name: "JavaScript", slug: "javascript" },
      { name: "TypeScript", slug: "typescript" },
      { name: "React", slug: "react" },
      { name: "Next.js", slug: "nextjs" },
      { name: "Node.js", slug: "nodejs" },
      { name: "Python", slug: "python" },
    ];

    const { error: tagError } = await supabase
      .from("tags")
      .upsert(tags, { onConflict: "slug" });

    if (tagError) {
      console.error("âš ï¸  íƒœê·¸ ìƒì„± ì‹¤íŒ¨:", tagError.message);
    } else {
      console.log("âœ… íƒœê·¸ ìƒì„± ì„±ê³µ");
    }

    console.log("\nğŸ‰ ë°ëª¨ ê³„ì • ì„¤ì • ì™„ë£Œ!");
    console.log("=".repeat(50));
    console.log("ğŸ“§ ì´ë©”ì¼:", testEmail);
    console.log("ğŸ” ë¹„ë°€ë²ˆí˜¸: [í™˜ê²½ ë³€ìˆ˜ì—ì„œ ì„¤ì •ë¨]");
    console.log("ğŸ”— ë¡œê·¸ì¸ URL: http://localhost:3001/auth/login");
    console.log("ğŸ  ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ: http://localhost:3001/admin");
    console.log("=".repeat(50));
    console.log("\nğŸ’¡ ë‹¤ìŒ ë‹¨ê³„:");
    console.log("1. npm run devë¡œ ê°œë°œ ì„œë²„ ì‹¤í–‰");
    console.log("2. ìœ„ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸");
    console.log("3. ìƒˆ í¬ìŠ¤íŠ¸ ì‘ì„± ë° ë°œí–‰");
  } catch (error) {
    console.error("âŒ ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜:", error.message);
  }
}

createAdminAccount();
</file>

<file path="tests/scripts/test-admin-function.js">
#!/usr/bin/env node
/**
 * is_admin í•¨ìˆ˜ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
 */

import { createClient } from "@supabase/supabase-js";
import { config } from "dotenv";

// í™˜ê²½ ë³€ìˆ˜ ë¡œë“œ
config({ path: '.env.local' });

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;

if (!supabaseUrl || !supabaseAnonKey) {
  console.error("âŒ í™˜ê²½ ë³€ìˆ˜ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
  process.exit(1);
}

const supabase = createClient(supabaseUrl, supabaseAnonKey);

async function testAdminFunction() {
  console.log("ğŸ§ª is_admin í•¨ìˆ˜ í…ŒìŠ¤íŠ¸...");
  
  try {
    // 1. ë¡œê·¸ì¸
    const { data: authData, error: authError } = await supabase.auth.signInWithPassword({
      email: 'admin@devblog.com',
      password: 'DevBlog123!'
    });
    
    if (authError) {
      console.error("âŒ ë¡œê·¸ì¸ ì‹¤íŒ¨:", authError.message);
      return;
    }
    
    console.log("âœ… ë¡œê·¸ì¸ ì„±ê³µ");
    console.log("ì‚¬ìš©ì ID:", authData.user.id);
    
    // 2. is_admin í•¨ìˆ˜ í˜¸ì¶œ
    const { data: isAdminData, error: isAdminError } = await supabase.rpc('is_admin');
    
    if (isAdminError) {
      console.error("âŒ is_admin í•¨ìˆ˜ í˜¸ì¶œ ì‹¤íŒ¨:", isAdminError.message);
      return;
    }
    
    console.log("âœ… is_admin í•¨ìˆ˜ í˜¸ì¶œ ì„±ê³µ");
    console.log("ê´€ë¦¬ì ì—¬ë¶€:", isAdminData);
    
    // 3. ì§ì ‘ admins í…Œì´ë¸” ì¡°íšŒ ì‹œë„
    console.log("\nğŸ“‹ admins í…Œì´ë¸” ì§ì ‘ ì¡°íšŒ ì‹œë„...");
    const { data: adminsData, error: adminsError } = await supabase
      .from('admins')
      .select('user_id')
      .eq('user_id', authData.user.id);
    
    if (adminsError) {
      console.error("âŒ admins í…Œì´ë¸” ì¡°íšŒ ì‹¤íŒ¨:", adminsError.message);
      console.log("ì´ëŠ” ì˜ˆìƒëœ ê²°ê³¼ì…ë‹ˆë‹¤. RLS ì •ì±… ë•Œë¬¸ì…ë‹ˆë‹¤.");
    } else {
      console.log("âœ… admins í…Œì´ë¸” ì¡°íšŒ ì„±ê³µ:", adminsData);
    }
    
    // 4. ë¡œê·¸ì•„ì›ƒ
    await supabase.auth.signOut();
    console.log("âœ… ë¡œê·¸ì•„ì›ƒ ì™„ë£Œ");
    
  } catch (error) {
    console.error("âŒ í…ŒìŠ¤íŠ¸ ì¤‘ ì˜¤ë¥˜:", error.message);
  }
}

testAdminFunction();
</file>

<file path="tests/scripts/test-login.js">
#!/usr/bin/env node
/**
 * ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
 */

import { createClient } from "@supabase/supabase-js";
import { config } from "dotenv";

// í™˜ê²½ ë³€ìˆ˜ ë¡œë“œ
config({ path: '.env.local' });

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;
const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;

if (!supabaseUrl || !supabaseAnonKey) {
  console.error("âŒ í™˜ê²½ ë³€ìˆ˜ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
  process.exit(1);
}

const supabase = createClient(supabaseUrl, supabaseAnonKey);

async function testLogin() {
  console.log("ğŸ§ª ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸ ì‹œì‘...");
  
  try {
    // 1. ë¡œê·¸ì¸ ì‹œë„
    console.log("\n1. ë¡œê·¸ì¸ ì‹œë„...");
    const { data: authData, error: authError } = await supabase.auth.signInWithPassword({
      email: 'admin@devblog.com',
      password: 'DevBlog123!'
    });
    
    if (authError) {
      console.error("âŒ ë¡œê·¸ì¸ ì‹¤íŒ¨:", authError.message);
      console.error("ìƒì„¸ ì˜¤ë¥˜:", authError);
      return;
    }
    
    console.log("âœ… ë¡œê·¸ì¸ ì„±ê³µ!");
    console.log("ì‚¬ìš©ì ID:", authData.user.id);
    console.log("ì´ë©”ì¼:", authData.user.email);
    
    // 2. ê´€ë¦¬ì ê¶Œí•œ í™•ì¸
    console.log("\n2. ê´€ë¦¬ì ê¶Œí•œ í™•ì¸...");
    
    // ë¨¼ì € RPC í•¨ìˆ˜ ì‹œë„
    try {
      const { data: isAdminRPC, error: rpcError } = await supabase.rpc('is_admin');
      if (rpcError) {
        console.log("âš ï¸ RPC í•¨ìˆ˜ ì˜¤ë¥˜:", rpcError.message);
        console.log("ì§ì ‘ í…Œì´ë¸” ì¡°íšŒë¡œ ì „í™˜...");
        
        // ì§ì ‘ í…Œì´ë¸” ì¡°íšŒ
        const { data: directAdmin, error: directError } = await supabase
          .from('admins')
          .select('user_id')
          .eq('user_id', authData.user.id)
          .single();
        
        if (directError) {
          console.error("âŒ ê´€ë¦¬ì í…Œì´ë¸” ì¡°íšŒ ì‹¤íŒ¨:", directError.message);
        } else {
          console.log("âœ… ê´€ë¦¬ì ê¶Œí•œ í™•ì¸ (ì§ì ‘ ì¡°íšŒ):", !!directAdmin);
        }
      } else {
        console.log("âœ… ê´€ë¦¬ì ê¶Œí•œ í™•ì¸ (RPC):", !!isAdminRPC);
      }
    } catch (error) {
      console.error("âŒ ê´€ë¦¬ì ê¶Œí•œ í™•ì¸ ì‹¤íŒ¨:", error.message);
    }
    
    // 3. ë¡œê·¸ì•„ì›ƒ
    console.log("\n3. ë¡œê·¸ì•„ì›ƒ...");
    const { error: signOutError } = await supabase.auth.signOut();
    if (signOutError) {
      console.error("âŒ ë¡œê·¸ì•„ì›ƒ ì‹¤íŒ¨:", signOutError.message);
    } else {
      console.log("âœ… ë¡œê·¸ì•„ì›ƒ ì„±ê³µ");
    }
    
  } catch (error) {
    console.error("âŒ í…ŒìŠ¤íŠ¸ ì¤‘ ì˜¤ë¥˜:", error.message);
    console.error("ì „ì²´ ì˜¤ë¥˜:", error);
  }
}

testLogin();
</file>

<file path="tests/scripts/test-workflow.js">
#!/usr/bin/env node
/**
 * ë¸”ë¡œê·¸ ì‹œìŠ¤í…œ ì™„ì „ ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
 *
 * ì´ ìŠ¤í¬ë¦½íŠ¸ëŠ” ë‹¤ìŒ ê¸°ëŠ¥ë“¤ì„ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤:
 * 1. í•„ìˆ˜ íŒŒì¼ ì¡´ì¬ í™•ì¸
 * 2. í™˜ê²½ ë³€ìˆ˜ í™•ì¸
 * 3. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í…ŒìŠ¤íŠ¸
 * 4. ê´€ë¦¬ì ë¡œê·¸ì¸ ì‹œë®¬ë ˆì´ì…˜
 * 5. í¬ìŠ¤íŠ¸ ì‘ì„± ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
 */

import { existsSync, readFileSync } from "fs";
import path from "path";
import { execSync } from "child_process";

console.log("ğŸ§ª DevBlog ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ ì‹œì‘...\n");

// 1. í•„ìˆ˜ íŒŒì¼ í™•ì¸
console.log("ğŸ“ í•„ìˆ˜ íŒŒì¼ í™•ì¸ ì¤‘...");
const requiredFiles = [
  "src/app/auth/login/page.tsx",
  "src/app/admin/page.tsx",
  "src/app/admin/posts/new/page.tsx",
  "src/lib/validations/post.ts",
  "src/lib/utils/slug.ts",
  "src/components/ui/form.tsx",
  "src/components/ui/checkbox.tsx",
  "src/components/admin/markdown-editor.tsx",
  "src/hooks/use-auth.ts",
  "docs/database-schema.sql",
  "scripts/setup-admin.sql",
  "docs/admin-setup-guide.md",
];

let missingFiles = [];
requiredFiles.forEach((file) => {
  if (existsSync(file)) {
    console.log(`âœ… ${file}`);
  } else {
    console.log(`âŒ ${file} - ëˆ„ë½`);
    missingFiles.push(file);
  }
});

// 2. í™˜ê²½ ë³€ìˆ˜ í™•ì¸
console.log("\nğŸ” í™˜ê²½ ë³€ìˆ˜ í™•ì¸ ì¤‘...");
const envFile = ".env.local";
if (existsSync(envFile)) {
  console.log("âœ… .env.local íŒŒì¼ ì¡´ì¬");
  const envContent = readFileSync(envFile, "utf8");
  const requiredEnvVars = [
    "NEXT_PUBLIC_SUPABASE_URL",
    "NEXT_PUBLIC_SUPABASE_ANON_KEY",
    "NEXT_PUBLIC_SITE_URL",
  ];

  requiredEnvVars.forEach((envVar) => {
    if (envContent.includes(envVar)) {
      console.log(`âœ… ${envVar} ì„¤ì •ë¨`);
    } else {
      console.log(`âš ï¸  ${envVar} ì„¤ì • í•„ìš”`);
    }
  });
} else {
  console.log("âŒ .env.local íŒŒì¼ ì—†ìŒ - ì„¤ì • í•„ìš”");
}

// 3. íŒ¨í‚¤ì§€ ì˜ì¡´ì„± í™•ì¸
console.log("\nğŸ“¦ ì˜ì¡´ì„± í™•ì¸ ì¤‘...");
const packageJson = JSON.parse(readFileSync("package.json", "utf8"));
const requiredDeps = [
  "next",
  "react",
  "@supabase/supabase-js",
  "@supabase/ssr",
  "react-hook-form",
  "zod",
  "react-markdown",
  "next-themes",
  "lucide-react",
];

requiredDeps.forEach((dep) => {
  if (packageJson.dependencies[dep] || packageJson.devDependencies[dep]) {
    console.log(`âœ… ${dep}`);
  } else {
    console.log(`âŒ ${dep} - ì„¤ì¹˜ í•„ìš”`);
  }
});

// 4. TypeScript ì»´íŒŒì¼ í™•ì¸
console.log("\nğŸ”§ TypeScript ì»´íŒŒì¼ í™•ì¸ ì¤‘...");
try {
  execSync("npx tsc --noEmit", { stdio: "pipe" });
  console.log("âœ… TypeScript ì»´íŒŒì¼ ì„±ê³µ");
} catch (error) {
  console.log("âŒ TypeScript ì»´íŒŒì¼ ì˜¤ë¥˜ ë°œê²¬");
  console.log("   ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ í™•ì¸: npx tsc --noEmit");
}

// 5. ë¹Œë“œ í…ŒìŠ¤íŠ¸
console.log("\nğŸ—ï¸  ë¹Œë“œ í…ŒìŠ¤íŠ¸ ì¤‘...");
try {
  execSync("npm run build", { stdio: "pipe", timeout: 60000 });
  console.log("âœ… ë¹Œë“œ ì„±ê³µ");
} catch (error) {
  console.log("âš ï¸  ë¹Œë“œ í…ŒìŠ¤íŠ¸ ì‹œê°„ ì´ˆê³¼ ë˜ëŠ” ì˜¤ë¥˜");
  console.log("   ë„¤íŠ¸ì›Œí¬ ì—°ê²° í™•ì¸ í›„ ìˆ˜ë™ìœ¼ë¡œ í…ŒìŠ¤íŠ¸: npm run build");
}

// 6. ê²°ê³¼ ìš”ì•½
console.log("\nğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½:");
console.log("=".repeat(50));

if (missingFiles.length === 0) {
  console.log("âœ… ëª¨ë“  í•„ìˆ˜ íŒŒì¼ ì¡´ì¬");
} else {
  console.log(`âŒ ëˆ„ë½ëœ íŒŒì¼: ${missingFiles.length}ê°œ`);
}

console.log("\nğŸ¯ ë‹¤ìŒ ë‹¨ê³„:");
console.log("1. Supabase í”„ë¡œì íŠ¸ ìƒì„± ë° í™˜ê²½ ë³€ìˆ˜ ì„¤ì •");
console.log("2. docs/database-schema.sql ì‹¤í–‰");
console.log("3. scripts/setup-admin.sqlë¡œ ê´€ë¦¬ì ê³„ì • ìƒì„±");
console.log("4. npm run devë¡œ ê°œë°œ ì„œë²„ ì‹¤í–‰");
console.log("5. http://localhost:3001/auth/loginì—ì„œ ë¡œê·¸ì¸");
console.log("6. ìƒˆ í¬ìŠ¤íŠ¸ ì‘ì„± ë° ë°œí–‰ í…ŒìŠ¤íŠ¸");

console.log("\nğŸ“š ìì„¸í•œ ê°€ì´ë“œ: docs/admin-setup-guide.md");
console.log("ğŸš€ ëª¨ë“  ì¤€ë¹„ ì™„ë£Œ! ë¸”ë¡œê·¸ ì‹œì‘í•˜ì„¸ìš”!");
</file>

<file path="tsconfig.json">
{
  "compilerOptions": {
    "target": "ES2017",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "strictNullChecks": false,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noImplicitAny": false,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}
</file>

<file path="docs/progress-log.md">
# í”„ë¡œì íŠ¸ ì§„í–‰ ìƒí™© ë¡œê·¸

## ë¡œê·¸ ì‘ì„± ê·œì¹™
- ê° ì‘ì—… ë‹¨ê³„ë³„ë¡œ ìˆœì„œëŒ€ë¡œ ê¸°ë¡
- ëª¨ë“  ê¸°ë¡ì—ëŠ” íƒ€ì„ìŠ¤íƒ¬í”„ í¬í•¨
- ì¤‘ìš”í•œ ì»¨í…ìŠ¤íŠ¸ ì •ë³´ëŠ” ë°˜ë“œì‹œ ê¸°ë¡
- ì‘ì—… ê³„íš, ì§„í–‰ ìƒí™©, ì£¼ìš” ê²°ì •ì‚¬í•­ í¬í•¨

---

## 2025-01-10 (í”„ë¡œì íŠ¸ ì‹œì‘)

### [2025-01-10 17:00] í”„ë¡œì íŠ¸ ë¶„ì„ ë° ì„¤ì •
**ì‘ì—…**: í”„ë¡œì íŠ¸ ì´ˆê¸° ë¶„ì„ ë° CLAUDE.md ìƒì„±
- EasyNext í…œí”Œë¦¿ ê¸°ë°˜ Next.js 15 í”„ë¡œì íŠ¸ í™•ì¸
- docs/ ë‚´ ëª¨ë“  ë¬¸ì„œ ë¶„ì„ (PRD, TRD, ê°œë°œ ê°€ì´ë“œë¼ì¸)
- CLAUDE.md ìƒì„± (ê¸°ìˆ  ìŠ¤íƒ, ì•„í‚¤í…ì²˜, ê°œë°œ ê°€ì´ë“œë¼ì¸)
- Gemini ë³´ì¡° ë„êµ¬ ì„¤ì • ì¶”ê°€

**ì¤‘ìš” ì»¨í…ìŠ¤íŠ¸**:
- ë‹¨ì¼ ê´€ë¦¬ì ë¸”ë¡œê·¸ í”Œë«í¼ êµ¬ì¶•
- ê¸°ìˆ  ìŠ¤íƒ: Next.js 15, React 19, TypeScript, Tailwind CSS, shadcn-ui, Supabase
- í˜„ì¬ ìƒíƒœ: EasyNext ëœë”© í˜ì´ì§€

### [2025-01-10 17:30] ì‘ì—… ê³„íš ìˆ˜ë¦½
**ì‘ì—…**: Gemini í”¼ë“œë°± ê¸°ë°˜ ì‘ì—… ê³„íš ìˆ˜ë¦½
- PRD ë¶„ì„ ë° MVP ìš°ì„ ìˆœìœ„ ê²°ì •
- 3ë‹¨ê³„ Phase êµ¬ì„± (ì¸í”„ë¼ â†’ ì½˜í…ì¸  ê´€ë¦¬ â†’ ë¶€ê°€ ê¸°ëŠ¥)
- 11ê°œ ì£¼ìš” ì‘ì—… í•­ëª© ì •ì˜

**ì‘ì—… ìš°ì„ ìˆœìœ„**:
1. P1 (í•µì‹¬ MVP): Supabase ì„¤ì •, ì¸ì¦, í¬ìŠ¤íŠ¸ CRUD, ì´ë¯¸ì§€ ì—…ë¡œë“œ
2. P2 (ì‚¬ìš©ì„±): íƒœê·¸/ì¹´í…Œê³ ë¦¬, ê²€ìƒ‰, ë‹¤í¬ëª¨ë“œ  
3. P3 (ê³ ë„í™”): ê³ ê¸‰ SEO, ì„±ëŠ¥ ìµœì í™”

**ë‹¤ìŒ ë‹¨ê³„**: Supabase ì„¤ì • ë° DB ìŠ¤í‚¤ë§ˆ êµ¬ì„±

### [2025-01-10 17:45] Supabase ì„¤ì • ì‹œì‘
**ì‘ì—…**: Supabase í´ë¼ì´ì–¸íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ ë° ê¸°ë³¸ ì„¤ì •
- @supabase/supabase-js ì„¤ì¹˜
- í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ì¤€ë¹„
- Supabase í´ë¼ì´ì–¸íŠ¸ ì´ˆê¸°í™” ì½”ë“œ ì‘ì„±

**ì¤‘ìš” ì»¨í…ìŠ¤íŠ¸**:
- Supabase í”„ë¡œì íŠ¸ ìƒì„± í•„ìš” (ì‚¬ìš©ìê°€ ì§ì ‘ ìƒì„±)
- í™˜ê²½ ë³€ìˆ˜: NEXT_PUBLIC_SUPABASE_URL, NEXT_PUBLIC_SUPABASE_ANON_KEY
- í´ë¼ì´ì–¸íŠ¸ëŠ” src/lib/supabase.tsì— ì„¤ì •

**ê²°ê³¼/ê²°ì •ì‚¬í•­**:
- Supabase í´ë¼ì´ì–¸íŠ¸ ì„¤ì¹˜ ì™„ë£Œ
- í™˜ê²½ ë³€ìˆ˜ í…œí”Œë¦¿ ìƒì„± (.env.local.example)
- TypeScript íƒ€ì… ì •ì˜ ì™„ë£Œ (src/lib/supabase.ts)

**ë‹¤ìŒ ë‹¨ê³„**: ê¸°ë³¸ ë¸”ë¡œê·¸ êµ¬ì¡°ë¡œ í˜ì´ì§€ êµì²´

### [2025-01-10 18:00] ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì—…ê·¸ë ˆì´ë“œ í™•ì¸
**ì‘ì—…**: í–¥ìƒëœ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì ìš© ë° TypeScript íƒ€ì… ë™ê¸°í™”
- ìŠ¤í‚¤ë§ˆ ì—…ê·¸ë ˆì´ë“œ: post_status ENUM, ì†Œí”„íŠ¸ ì‚­ì œ, ê´€ë¦¬ì í…Œì´ë¸” ì¶”ê°€
- TypeScript íƒ€ì… ì •ì˜ ì—…ë°ì´íŠ¸ (Database interface)
- ì „ì²´ í…ìŠ¤íŠ¸ ê²€ìƒ‰, RLS ì •ì±… ì ìš© í™•ì¸

**ì¤‘ìš” ì»¨í…ìŠ¤íŠ¸**:
- **í–¥ìƒëœ ê¸°ëŠ¥**: post_status ENUM (draft, scheduled, published, archived)
- **ê´€ë¦¬ì ì‹œìŠ¤í…œ**: admins í…Œì´ë¸”ë¡œ ê´€ë¦¬ì ê¶Œí•œ ê´€ë¦¬
- **ì†Œí”„íŠ¸ ì‚­ì œ**: deleted_at í•„ë“œë¡œ ë°ì´í„° ë³µêµ¬ ê°€ëŠ¥
- **ì „ì²´ í…ìŠ¤íŠ¸ ê²€ìƒ‰**: search_vector ìë™ ìƒì„±
- **RLS ë³´ì•ˆ**: is_admin() í•¨ìˆ˜ë¡œ ê¶Œí•œ ë¶„ë¦¬

**ê²°ê³¼/ê²°ì •ì‚¬í•­**:
- TypeScript íƒ€ì… ì •ì˜ê°€ ìƒˆ ìŠ¤í‚¤ë§ˆì™€ ë™ê¸°í™”ë¨
- PostStatus íƒ€ì… ì¶”ê°€ ('draft' | 'scheduled' | 'published' | 'archived')
- ëª¨ë“  í…Œì´ë¸” íƒ€ì… ì •ì˜ ì—…ë°ì´íŠ¸ (admins, post_revisions í¬í•¨)

**ë‹¤ìŒ ë‹¨ê³„**: EasyNext ëœë”© í˜ì´ì§€ë¥¼ ê¸°ë³¸ ë¸”ë¡œê·¸ êµ¬ì¡°ë¡œ êµì²´

### [2025-01-10 18:05] ê¸°ë³¸ ë¸”ë¡œê·¸ êµ¬ì¡° êµ¬í˜„ ì‹œì‘
**ì‘ì—…**: EasyNext ëœë”© í˜ì´ì§€ë¥¼ ë¸”ë¡œê·¸ í™ˆí˜ì´ì§€ë¡œ êµì²´
- ë©”ì¸ í˜ì´ì§€ (src/app/page.tsx) ë¸”ë¡œê·¸ í™ˆìœ¼ë¡œ ë³€ê²½
- ê¸°ë³¸ ë ˆì´ì•„ì›ƒ ë° ë„¤ë¹„ê²Œì´ì…˜ êµ¬ì¡° ìƒì„±
- ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ ëª©ë¡ í‘œì‹œ ì»´í¬ë„ŒíŠ¸ êµ¬í˜„

**ì¤‘ìš” ì»¨í…ìŠ¤íŠ¸**:
- ê³µê°œ í¬ìŠ¤íŠ¸ë§Œ í‘œì‹œ (status = 'published', deleted_at IS NULL)
- ë°˜ì‘í˜• ë””ìì¸ ì ìš© (ëª¨ë°”ì¼ ìš°ì„ )
- SEO ìµœì í™”ë¥¼ ìœ„í•œ ë©”íƒ€ë°ì´í„° ì„¤ì •
- shadcn-ui ì»´í¬ë„ŒíŠ¸ í™œìš©

**ê²°ê³¼/ê²°ì •ì‚¬í•­**:
- Header/Footer ì»´í¬ë„ŒíŠ¸ ìƒì„± (ë°˜ì‘í˜• ë„¤ë¹„ê²Œì´ì…˜, ëª¨ë°”ì¼ ë©”ë‰´)
- ë¸”ë¡œê·¸ ë°ì´í„° ë ˆì´ì–´ êµ¬í˜„ (src/lib/blog.ts)
- PostCard ì»´í¬ë„ŒíŠ¸ ìƒì„± (ì¹´ë“œ í˜•íƒœ í¬ìŠ¤íŠ¸ í‘œì‹œ)
- ë©”ì¸ í˜ì´ì§€ ì™„ì „ êµì²´ (Hero + Latest Posts + CTA)
- SEO ìµœì í™” ë©”íƒ€ë°ì´í„° ì„¤ì •

**ë‹¤ìŒ ë‹¨ê³„**: ì¸ì¦ ì‹œìŠ¤í…œ êµ¬í˜„ (Supabase Auth)

### [2025-01-10 18:15] ì¸ì¦ ì‹œìŠ¤í…œ êµ¬í˜„ ì‹œì‘
**ì‘ì—…**: Supabase Authë¥¼ í™œìš©í•œ ê´€ë¦¬ì ì¸ì¦ ì‹œìŠ¤í…œ êµ¬í˜„
- Supabase Auth í—¬í¼ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
- ì¸ì¦ ì»¨í…ìŠ¤íŠ¸ ë° í›… êµ¬í˜„
- ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ í˜ì´ì§€ ìƒì„±
- ê´€ë¦¬ì ê¶Œí•œ í™•ì¸ ë¡œì§ êµ¬í˜„

**ì¤‘ìš” ì»¨í…ìŠ¤íŠ¸**:
- ë‹¨ì¼ ê´€ë¦¬ì ì‹œìŠ¤í…œ (admins í…Œì´ë¸” í™œìš©)
- JWT í† í° ê¸°ë°˜ ì¸ì¦
- RLS ì •ì±…ê³¼ ì—°ë™ëœ ê¶Œí•œ ê´€ë¦¬
- ë¯¸ë“¤ì›¨ì–´ë¥¼ í†µí•œ ë³´í˜¸ëœ ë¼ìš°íŠ¸ êµ¬í˜„

**ê²°ê³¼/ê²°ì •ì‚¬í•­**:
- @supabase/ssr ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ (ìµœì‹  ê¶Œì¥ ë°©ì‹)
- Supabase í´ë¼ì´ì–¸íŠ¸/ì„œë²„ ë¶„ë¦¬ êµ¬ì¡° êµ¬í˜„
- ë¯¸ë“¤ì›¨ì–´ ê¸°ë°˜ ë¼ìš°íŠ¸ ë³´í˜¸ (/admin ê²½ë¡œ)
- useAuth í›…ìœ¼ë¡œ ì¸ì¦ ìƒíƒœ ê´€ë¦¬
- ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ í˜ì´ì§€ ë° ê¶Œí•œ ì—†ìŒ í˜ì´ì§€ ìƒì„±
- Headerì— ë™ì  ì¸ì¦ UI (ë¡œê·¸ì¸/ì‚¬ìš©ì ë“œë¡­ë‹¤ìš´)
- ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ê¸°ë³¸ êµ¬ì¡° (í†µê³„, ë¹ ë¥¸ ì•¡ì…˜)

**ë‹¤ìŒ ë‹¨ê³„**: ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ CRUD ê¸°ëŠ¥ êµ¬í˜„

### [2025-01-10 18:30] ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ CRUD ê¸°ëŠ¥ êµ¬í˜„ ì‹œì‘
**ì‘ì—…**: ê´€ë¦¬ììš© í¬ìŠ¤íŠ¸ CRUD ê¸°ëŠ¥ êµ¬í˜„
- í¬ìŠ¤íŠ¸ ëª©ë¡ í˜ì´ì§€ (/admin/posts)
- ìƒˆ í¬ìŠ¤íŠ¸ ì‘ì„± í˜ì´ì§€ (/admin/posts/new)
- í¬ìŠ¤íŠ¸ í¸ì§‘ í˜ì´ì§€ (/admin/posts/[id]/edit)
- Markdown ì—ë””í„° êµ¬í˜„
- ì´ë¯¸ì§€ ì—…ë¡œë“œ ê¸°ëŠ¥

**ì¤‘ìš” ì»¨í…ìŠ¤íŠ¸**:
- React Hook Form + Zod ìŠ¤í‚¤ë§ˆ ê²€ì¦
- ì‹¤ì‹œê°„ Markdown ë¯¸ë¦¬ë³´ê¸°
- ìŠ¬ëŸ¬ê·¸ ìë™ ìƒì„±
- í¬ìŠ¤íŠ¸ ìƒíƒœ ê´€ë¦¬ (draft, published, scheduled, archived)
- ì¹´í…Œê³ ë¦¬ ë° íƒœê·¸ ê´€ë¦¬

**ê²°ê³¼/ê²°ì •ì‚¬í•­**:
- React Hook Form + Zod ê²€ì¦ ìŠ¤í‚¤ë§ˆ êµ¬í˜„
- Markdown ì—ë””í„° with ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸° (react-markdown, remark-gfm)
- í¬ìŠ¤íŠ¸ ëª©ë¡ í˜ì´ì§€ (ìƒíƒœë³„ ë°°ì§€, í¸ì§‘/ì‚­ì œ ë²„íŠ¼)
- ìƒˆ í¬ìŠ¤íŠ¸ ì‘ì„± í˜ì´ì§€ (ì œëª©, ë‚´ìš©, ìŠ¬ëŸ¬ê·¸, ì¹´í…Œê³ ë¦¬, íƒœê·¸)
- ìŠ¬ëŸ¬ê·¸ ìë™ ìƒì„± ê¸°ëŠ¥ (slugify)
- í¬ìŠ¤íŠ¸ ìƒíƒœ ê´€ë¦¬ (draft, published, scheduled, archived)
- íƒœê·¸ ë‹¤ì¤‘ ì„ íƒ UI
- ì¹´í…Œê³ ë¦¬ ë“œë¡­ë‹¤ìš´ ì„ íƒ

**ë‹¤ìŒ ë‹¨ê³„**: ê³µê°œ ë¸”ë¡œê·¸ í˜ì´ì§€ êµ¬í˜„ (í¬ìŠ¤íŠ¸ ìƒì„¸, ì¹´í…Œê³ ë¦¬/íƒœê·¸ í˜ì´ì§€)

### [2025-01-10 18:45] ê³µê°œ ë¸”ë¡œê·¸ í˜ì´ì§€ êµ¬í˜„ ì‹œì‘
**ì‘ì—…**: ë°©ë¬¸ììš© ë¸”ë¡œê·¸ í˜ì´ì§€ êµ¬í˜„
- í¬ìŠ¤íŠ¸ ìƒì„¸ í˜ì´ì§€ (/posts/[slug])
- ì¹´í…Œê³ ë¦¬ë³„ í¬ìŠ¤íŠ¸ í˜ì´ì§€ (/categories/[slug])
- íƒœê·¸ë³„ í¬ìŠ¤íŠ¸ í˜ì´ì§€ (/tags/[slug])
- ì „ì²´ í¬ìŠ¤íŠ¸ ëª©ë¡ í˜ì´ì§€ (/posts)
- About í˜ì´ì§€ (/about)

**ì¤‘ìš” ì»¨í…ìŠ¤íŠ¸**:
- SSG/SSRì„ í™œìš©í•œ SEO ìµœì í™”
- ë™ì  ë©”íƒ€ë°ì´í„° ìƒì„±
- Markdown ë Œë”ë§ with ë¬¸ë²• ê°•ì¡°
- í˜ì´ì§€ë„¤ì´ì…˜ êµ¬í˜„
- ë°˜ì‘í˜• ë””ìì¸

**ê²°ê³¼/ê²°ì •ì‚¬í•­**:
- í¬ìŠ¤íŠ¸ ìƒì„¸ í˜ì´ì§€: ë™ì  ë©”íƒ€ë°ì´í„°, Markdown ë Œë”ë§, ì†Œì…œ ê³µìœ 
- ì „ì²´ í¬ìŠ¤íŠ¸ ëª©ë¡: í˜ì´ì§€ë„¤ì´ì…˜, ë¹ˆ ìƒíƒœ ì²˜ë¦¬
- ì¹´í…Œê³ ë¦¬ í˜ì´ì§€: ì¹´í…Œê³ ë¦¬ë³„ í¬ìŠ¤íŠ¸ ê·¸ë£¹í•‘, í¬ìŠ¤íŠ¸ ìˆ˜ í‘œì‹œ
- íƒœê·¸ í˜ì´ì§€: íƒœê·¸ë³„ í¬ìŠ¤íŠ¸ í•„í„°ë§, ë™ì  ë¼ìš°íŒ…
- About í˜ì´ì§€: ë¸”ë¡œê·¸ ì†Œê°œ, ê¸°ìˆ  ìŠ¤íƒ, ì—°ë½ì²˜
- 404 í˜ì´ì§€: ì‚¬ìš©ì ì¹œí™”ì  ì˜¤ë¥˜ ì²˜ë¦¬
- SEO ìµœì í™”: ëª¨ë“  í˜ì´ì§€ì— ì ì ˆí•œ ë©”íƒ€ë°ì´í„° ì„¤ì •

**ë‹¤ìŒ ë‹¨ê³„**: ê²€ìƒ‰ ê¸°ëŠ¥ êµ¬í˜„ ë° í•„í„°ë§ ê°œì„ 

### [2025-01-10 19:00] ê²€ìƒ‰ ë° í•„í„°ë§ ê¸°ëŠ¥ êµ¬í˜„ ì‹œì‘
**ì‘ì—…**: ë¸”ë¡œê·¸ ê²€ìƒ‰ ë° í•„í„°ë§ ì‹œìŠ¤í…œ êµ¬í˜„
- ì „ì²´ í…ìŠ¤íŠ¸ ê²€ìƒ‰ í˜ì´ì§€ (/search)
- Headerì— ê²€ìƒ‰ ì…ë ¥ í•„ë“œ ì¶”ê°€
- ì‹¤ì‹œê°„ ê²€ìƒ‰ ì œì•ˆ (debounced)
- ê³ ê¸‰ í•„í„°ë§ ì˜µì…˜ (ì¹´í…Œê³ ë¦¬, íƒœê·¸)
- ê²€ìƒ‰ ê²°ê³¼ í•˜ì´ë¼ì´íŒ…

**ì¤‘ìš” ì»¨í…ìŠ¤íŠ¸**:
- PostgreSQL Full-Text Search í™œìš©
- ê²€ìƒ‰ ì„±ëŠ¥ ìµœì í™” (debouncing, ìºì‹±)
- ì‚¬ìš©ì ì¹œí™”ì  ê²€ìƒ‰ UI/UX
- ê²€ìƒ‰ ê¸°ë¡ ë° ì¸ê¸° ê²€ìƒ‰ì–´ (ì„ íƒì )

**ê²°ê³¼/ê²°ì •ì‚¬í•­**:
- ê³ ê¸‰ ê²€ìƒ‰ ì…ë ¥ ì»´í¬ë„ŒíŠ¸: ì‹¤ì‹œê°„ ì œì•ˆ, ê²€ìƒ‰ ê¸°ë¡, ë“œë¡­ë‹¤ìš´ ê²°ê³¼
- Header í†µí•©: ë°ìŠ¤í¬íƒ‘/ëª¨ë°”ì¼ ê²€ìƒ‰ ì¸í„°í˜ì´ìŠ¤
- ì „ìš© ê²€ìƒ‰ í˜ì´ì§€ (/search): í•„í„°ë§, í˜ì´ì§€ë„¤ì´ì…˜, ê²°ê³¼ í‘œì‹œ
- ê²€ìƒ‰ í•„í„°: ì¹´í…Œê³ ë¦¬, íƒœê·¸ë³„ í•„í„°ë§ ì‚¬ì´ë“œë°”
- ê²€ìƒ‰ ê²°ê³¼ ì»´í¬ë„ŒíŠ¸: ë¹ˆ ìƒíƒœ, í˜ì´ì§€ë„¤ì´ì…˜, PostCard ì¬ì‚¬ìš©
- PostgreSQL Full-Text Search í™œìš©
- ì„±ëŠ¥ ìµœì í™”: useDebounceë¡œ API í˜¸ì¶œ ì œí•œ

**ë‹¤ìŒ ë‹¨ê³„**: ë‹¤í¬ëª¨ë“œ ë° ë°˜ì‘í˜• ë””ìì¸ êµ¬í˜„

### [2025-01-10 19:15] ë‹¤í¬ëª¨ë“œ ë° ë°˜ì‘í˜• ë””ìì¸ êµ¬í˜„ ì‹œì‘
**ì‘ì—…**: í…Œë§ˆ ì‹œìŠ¤í…œ ë° ë°˜ì‘í˜• ê°œì„ 
- next-themesë¥¼ í™œìš©í•œ ë‹¤í¬ëª¨ë“œ êµ¬í˜„
- Headerì— í…Œë§ˆ í† ê¸€ ë²„íŠ¼ ì¶”ê°€
- ëª¨ë“  ì»´í¬ë„ŒíŠ¸ ë‹¤í¬ëª¨ë“œ ìŠ¤íƒ€ì¼ ì ìš©
- ë°˜ì‘í˜• ë””ìì¸ ê°œì„  (ëª¨ë°”ì¼/íƒœë¸”ë¦¿/ë°ìŠ¤í¬íƒ‘)
- ì‹œìŠ¤í…œ í…Œë§ˆ ê°ì§€ ë° ìë™ ì ìš©

**ì¤‘ìš” ì»¨í…ìŠ¤íŠ¸**:
- Tailwind CSS dark: variant í™œìš©
- ì‹œìŠ¤í…œ prefers-color-scheme ì§€ì›
- localStorageì— í…Œë§ˆ ì„¤ì • ì €ì¥
- ê¹œë¹¡ì„ ì—†ëŠ” í…Œë§ˆ ì „í™˜

### [2025-01-10 21:15] ë‹¤í¬ëª¨ë“œ êµ¬í˜„ ì™„ë£Œ
**ì‘ì—…**: next-themes ê¸°ë°˜ ë‹¤í¬ëª¨ë“œ ì‹œìŠ¤í…œ ì™„ì„±
- ThemeProvider ë° ThemeToggle ì»´í¬ë„ŒíŠ¸ ìƒì„±
- Tailwind ì„¤ì • ì—…ë°ì´íŠ¸ (ë‹¤í¬ëª¨ë“œ ë° íƒ€ì´í¬ê·¸ë˜í”¼)
- CSS ë³€ìˆ˜ ê¸°ë°˜ ë‹¤í¬ëª¨ë“œ ìƒ‰ìƒ ì‹œìŠ¤í…œ êµ¬í˜„
- êµ¬ë¬¸ ê°•ì¡° ë‹¤í¬ëª¨ë“œ ì§€ì› ì¶”ê°€
- prose ìŠ¤íƒ€ì¼ ë‹¤í¬ëª¨ë“œ ìµœì í™”

**ê²°ê³¼/ê²°ì •ì‚¬í•­**:
- Light/Dark/System í…Œë§ˆ ëª¨ë“œ ì§€ì›
- ì‹œìŠ¤í…œ ì„¤ì • ìë™ ê°ì§€
- ë§ˆìš´íŠ¸ ìƒíƒœ ì²´í¬ë¡œ í•˜ì´ë“œë ˆì´ì…˜ ì—ëŸ¬ ë°©ì§€
- ì½”ë“œ ë¸”ë¡ êµ¬ë¬¸ ê°•ì¡° ë‹¤í¬ëª¨ë“œ ëŒ€ì‘
- Alert ì»´í¬ë„ŒíŠ¸ ì¶”ê°€ (ë¹Œë“œ ì—ëŸ¬ ìˆ˜ì •)

**ë‹¤ìŒ ë‹¨ê³„**: SEO ìµœì í™” ë° ì„±ëŠ¥ ê°œì„ 

### [2025-01-10 21:30] SEO ìµœì í™” ë° ì„±ëŠ¥ ê°œì„  ì™„ë£Œ
**ì‘ì—…**: ê²€ìƒ‰ ì—”ì§„ ìµœì í™” ë° ì„±ëŠ¥ í–¥ìƒ ê¸°ëŠ¥ êµ¬í˜„
- ë™ì  ë©”íƒ€ë°ì´í„° ë° Open Graph íƒœê·¸ ê°œì„ 
- robots.txt ë° sitemap.xml ìë™ ìƒì„±
- JSON-LD êµ¬ì¡°í™” ë°ì´í„° ì¶”ê°€ (WebSite, Blog, Article)
- RSS í”¼ë“œ ìƒì„± ê¸°ëŠ¥ êµ¬í˜„
- OpenGraph ì´ë¯¸ì§€ ìë™ ìƒì„±

**ì„±ëŠ¥ ìµœì í™” êµ¬í˜„**:
- ì§€ì—° ë¡œë”© ì´ë¯¸ì§€ ì»´í¬ë„ŒíŠ¸ (LazyImage)
- React.memo ë° useMemoë¥¼ í†µí•œ ì»´í¬ë„ŒíŠ¸ ìµœì í™”
- Web Vitals ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ì¶”ê°€
- PWA ì§€ì›ì„ ìœ„í•œ manifest.json ìƒì„±

**SEO ê°œì„  ì‚¬í•­**:
- ë©”íƒ€ë°ì´í„° í…œí”Œë¦¿ ë° canonical URL ì„¤ì •
- êµ¬ì¡°í™” ë°ì´í„°ë¡œ ê²€ìƒ‰ ì—”ì§„ ê°€ë…ì„± í–¥ìƒ
- ì†Œì…œ ë¯¸ë””ì–´ ìµœì í™” (Twitter, LinkedIn ê³µìœ )
- ì‚¬ì´íŠ¸ë§µ ìë™ ìƒì„±ìœ¼ë¡œ í¬ë¡¤ë§ ìµœì í™”

**ê²°ê³¼/ê²°ì •ì‚¬í•­**:
- ì™„ì „í•œ SEO ìµœì í™” êµ¬í˜„ ì™„ë£Œ
- ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ë° ìµœì í™” ì‹œìŠ¤í…œ êµ¬ì¶•
- ì†Œì…œ ë¯¸ë””ì–´ ê³µìœ  ê¸°ëŠ¥ ì¶”ê°€
- PWA ê¸°ë³¸ ì„¤ì • ì™„ë£Œ

### [2025-01-10 21:45] ê°œë°œ ì„œë²„ ì˜¤ë¥˜ ìˆ˜ì •
**ì‘ì—…**: Next.js ê°œë°œ ì„œë²„ ì‹¤í–‰ ì˜¤ë¥˜ í•´ê²°
- CSS @import ê·œì¹™ ìˆœì„œ ë¬¸ì œ ìˆ˜ì • (ìµœìƒë‹¨ìœ¼ë¡œ ì´ë™)
- web-vitals ë¼ì´ë¸ŒëŸ¬ë¦¬ API ë³€ê²½ ëŒ€ì‘ (get* â†’ on* í•¨ìˆ˜)
- êµ¬ë¬¸ ê°•ì¡° ìŠ¤íƒ€ì¼ ë¡œë”© ë°©ì‹ ê°œì„  (layout.tsxì—ì„œ import)
- robots.txtë¥¼ robots.tsë¡œ ë³€ê²½ (Next.js í‘œì¤€ ë°©ì‹)

**ìˆ˜ì •ëœ ì£¼ìš” ì˜¤ë¥˜**:
- `@import rules must precede all rules` CSS íŒŒì‹± ì˜¤ë¥˜
- `Export getCLS doesn't exist` web-vitals ì„í¬íŠ¸ ì˜¤ë¥˜
- êµ¬ë¬¸ ê°•ì¡° ìŠ¤íƒ€ì¼ ë¡œë”© ìµœì í™”

**ê²°ê³¼/ê²°ì •ì‚¬í•­**:
- ê°œë°œ ì„œë²„ ì •ìƒ ì‹¤í–‰ ê°€ëŠ¥
- ìµœì‹  web-vitals v4 API í˜¸í™˜
- ì˜¬ë°”ë¥¸ CSS êµ¬ì¡° ë° ë¡œë”© ìˆœì„œ ì ìš©

### [2025-01-10 22:00] ì• í”Œë¦¬ì¼€ì´ì…˜ í…ŒìŠ¤íŠ¸ ì™„ë£Œ
**ì‘ì—…**: ì „ì²´ ì• í”Œë¦¬ì¼€ì´ì…˜ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ë° ê²€ì¦
- TypeScript ì˜¤ë¥˜ ì „ì²´ ìˆ˜ì • ì™„ë£Œ
- í•„ìˆ˜ íŒŒì¼ ë° ì¢…ì†ì„± êµ¬ì¡° ê²€ì¦
- ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹Œë“œ ë° ì‹¤í–‰ í…ŒìŠ¤íŠ¸
- ì½”ë“œ í’ˆì§ˆ ë° íƒ€ì… ì•ˆì •ì„± í™•ì¸

**ìˆ˜ì •ëœ ì£¼ìš” ì´ìŠˆ**:
- ëˆ„ë½ëœ types/database.ts íŒŒì¼ ìƒì„±
- Supabase í´ë¼ì´ì–¸íŠ¸ í˜¸ì¶œ ë°©ì‹ ìˆ˜ì • (await ì¶”ê°€)
- ReactMarkdown ì»´í¬ë„ŒíŠ¸ íƒ€ì… ì˜¤ë¥˜ ìˆ˜ì •
- theme-provider íƒ€ì… ì •ì˜ ê°œì„ 
- JSON-LD ì»´í¬ë„ŒíŠ¸ ì†ì„± ë§¤í•‘ ìˆ˜ì •

**í…ŒìŠ¤íŠ¸ ê²°ê³¼**:
- âœ… ëª¨ë“  í•„ìˆ˜ íŒŒì¼ ì¡´ì¬ í™•ì¸
- âœ… TypeScript ì˜¤ë¥˜ 0ê°œ (ì™„ì „ í•´ê²°)
- âœ… ëª¨ë“  ì¢…ì†ì„± ì •ìƒ ì„¤ì¹˜
- âœ… ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸ ì •ìƒ ì‘ë™
- âœ… ì½”ë“œ êµ¬ì¡° ë° ì•„í‚¤í…ì²˜ ê²€ì¦ ì™„ë£Œ

**ë‹¤ìŒ ë‹¨ê³„**: ì´ë¯¸ì§€ ì—…ë¡œë“œ ê¸°ëŠ¥ êµ¬í˜„ ë˜ëŠ” ë°°í¬ ë¬¸ì„œ ì‘ì„±

### [2025-01-10 22:15] ë°°í¬ ë¬¸ì„œ ì‘ì„± ì™„ë£Œ
**ì‘ì—…**: ì™„ì „í•œ ë°°í¬ ê°€ì´ë“œ ë¬¸ì„œ ì‘ì„±
- 3ê°€ì§€ ë°°í¬ ì˜µì…˜ ì œê³µ (Vercel, Netlify, Docker)
- í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ê°€ì´ë“œ
- Supabase í”„ë¡œì íŠ¸ ì„¤ì • ë°©ë²•
- ì„±ëŠ¥ ìµœì í™” ë° ë³´ì•ˆ ê³ ë ¤ì‚¬í•­
- ë¬¸ì œ í•´ê²° ê°€ì´ë“œ í¬í•¨

**ì£¼ìš” ë‚´ìš©**:
- ë‹¨ê³„ë³„ ë°°í¬ ê°€ì´ë“œ (ì´ˆë³´ì ì¹œí™”ì )
- í™˜ê²½ë³„ ì„¤ì • ë°©ë²• ìƒì„¸ ì„¤ëª…
- ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ë° ìœ ì§€ë³´ìˆ˜ ê°€ì´ë“œ
- ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸ í¬í•¨
- ë¬¸ì œ í•´ê²° FAQ ë° ìµœì í™” íŒ

**ê²°ê³¼/ê²°ì •ì‚¬í•­**:
- ì™„ì „í•œ ë°°í¬ ê°€ì´ë“œ ë¬¸ì„œ ì™„ì„±
- í”„ë¡œë•ì…˜ í™˜ê²½ ë°°í¬ ì¤€ë¹„ ì™„ë£Œ
- ìœ ì§€ë³´ìˆ˜ ë° ëª¨ë‹ˆí„°ë§ ë°©ì•ˆ ì œì‹œ
- ë³´ì•ˆ ê³ ë ¤ì‚¬í•­ ë° ìµœì í™” íŒ í¬í•¨

**ë‹¤ìŒ ë‹¨ê³„**: ì´ë¯¸ì§€ ì—…ë¡œë“œ ê¸°ëŠ¥ êµ¬í˜„ ë˜ëŠ” ìƒ˜í”Œ ë°ì´í„° ìƒì„±

### [2025-01-10 22:30] Turbopack ì„œë²„ ì˜¤ë¥˜ ìˆ˜ì •
**ì‘ì—…**: ê°œë°œ ì„œë²„ ì‹¤í–‰ ì‹œ Turbopack ëŸ°íƒ€ì„ ì˜¤ë¥˜ í•´ê²°
- Turbopack ëª¨ë“œì—ì„œ í‘œì¤€ webpack ëª¨ë“œë¡œ ë³€ê²½
- `.next` ë¹Œë“œ ìºì‹œ ì •ë¦¬
- `next.config.js` íŒŒì¼ ìƒì„±ìœ¼ë¡œ ì„¤ì • ìµœì í™”
- ì´ë¯¸ì§€ ë„ë©”ì¸ ë° transpilation ì„¤ì • ì¶”ê°€

**ìˆ˜ì •ëœ ì˜¤ë¥˜**:
- `Error: Cannot find module '../chunks/ssr/[turbopack]_runtime.js'`
- Turbopack ëŸ°íƒ€ì„ ëª¨ë“ˆ ëˆ„ë½ ë¬¸ì œ í•´ê²°
- ê°œë°œ ì„œë²„ ì •ìƒ ì‹¤í–‰ (localhost:3001)

**ì£¼ìš” ë³€ê²½ì‚¬í•­**:
- package.json: `next dev --turbopack` â†’ `next dev`
- next.config.js ì¶”ê°€: ì´ë¯¸ì§€ ìµœì í™” ë° transpilation ì„¤ì •
- highlight.js ë¼ì´ë¸ŒëŸ¬ë¦¬ transpilation ì„¤ì •

**ê²°ê³¼/ê²°ì •ì‚¬í•­**:
- ê°œë°œ ì„œë²„ ì •ìƒ ì‹¤í–‰ (í¬íŠ¸ 3001)
- Turbopack ì‚¬ìš© ì‹œ ë°œìƒí•˜ëŠ” í˜¸í™˜ì„± ë¬¸ì œ í•´ê²°
- í‘œì¤€ webpack ëª¨ë“œë¡œ ì•ˆì •ì ì¸ ê°œë°œ í™˜ê²½ êµ¬ì¶•

### [2025-01-10 22:45] ê´€ë¦¬ì ë¡œê·¸ì¸ ë° í¬ìŠ¤íŠ¸ ì‘ì„± ì‹œë‚˜ë¦¬ì˜¤ ì™„ì„±
**ì‘ì—…**: ì™„ì „í•œ ê´€ë¦¬ì ì›Œí¬í”Œë¡œìš° êµ¬í˜„ ë° í…ŒìŠ¤íŠ¸ í™˜ê²½ êµ¬ì¶•
- ëˆ„ë½ëœ validation ë° utility íŒŒì¼ í™•ì¸ (ì´ë¯¸ ì¡´ì¬)
- í•„ìˆ˜ UI ì»´í¬ë„ŒíŠ¸ í™•ì¸ ë° ì„¤ì¹˜ (form, checkbox)
- ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì¼ê´€ì„± í™•ì¸ ë° ìˆ˜ì •
- ë°ëª¨ ê´€ë¦¬ì ê³„ì • ìƒì„± ìŠ¤í¬ë¦½íŠ¸ ì‘ì„± ë° ì‹¤í–‰
- ìƒ˜í”Œ ì¹´í…Œê³ ë¦¬ ë° íƒœê·¸ ë°ì´í„° ìƒì„±

**êµ¬í˜„ëœ ì™„ì „í•œ ì‹œë‚˜ë¦¬ì˜¤**:
1. **ê´€ë¦¬ì ê³„ì • ìƒì„±**: `admin@devblog.com` / `DevBlog123!`
2. **ë¡œê·¸ì¸ í”„ë¡œì„¸ìŠ¤**: `/auth/login` â†’ ì¸ì¦ â†’ `/admin` ë¦¬ë‹¤ì´ë ‰íŠ¸
3. **ëŒ€ì‹œë³´ë“œ ì ‘ê·¼**: í†µê³„ í™•ì¸ ë° ìƒˆ í¬ìŠ¤íŠ¸ ìƒì„± ë²„íŠ¼
4. **í¬ìŠ¤íŠ¸ ì‘ì„±**: ë§ˆí¬ë‹¤ìš´ ì—ë””í„°, ì¹´í…Œê³ ë¦¬/íƒœê·¸ ì„ íƒ, ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°
5. **ë°œí–‰ ë° í™•ì¸**: ì´ˆì•ˆ ì €ì¥ ë˜ëŠ” ì¦‰ì‹œ ë°œí–‰, ê³µê°œ í˜ì´ì§€ í™•ì¸

**ìƒì„±ëœ íŒŒì¼ë“¤**:
- `scripts/setup-admin.sql` - ê´€ë¦¬ì ì„¤ì • SQL ìŠ¤í¬ë¦½íŠ¸
- `scripts/create-admin-demo.js` - ë°ëª¨ ê³„ì • ìƒì„± ìŠ¤í¬ë¦½íŠ¸
- `scripts/test-workflow.js` - ì „ì²´ ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
- `docs/admin-setup-guide.md` - ì™„ì „í•œ ì‚¬ìš©ì ê°€ì´ë“œ

**í…ŒìŠ¤íŠ¸ ê²°ê³¼**:
- âœ… ëª¨ë“  í•„ìˆ˜ íŒŒì¼ ì¡´ì¬ í™•ì¸
- âœ… TypeScript ì»´íŒŒì¼ ì„±ê³µ
- âœ… í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ì™„ë£Œ
- âœ… ë°ëª¨ ê´€ë¦¬ì ê³„ì • ìƒì„± ì„±ê³µ
- âœ… ìƒ˜í”Œ ì¹´í…Œê³ ë¦¬ ë° íƒœê·¸ ìƒì„± ì™„ë£Œ

**ì‚¬ìš© ë°©ë²•**:
1. `npm run dev` - ê°œë°œ ì„œë²„ ì‹¤í–‰
2. `http://localhost:3001/auth/login` - ê´€ë¦¬ì ë¡œê·¸ì¸
3. ê³„ì •: `admin@devblog.com` / `DevBlog123!`
4. í¬ìŠ¤íŠ¸ ì‘ì„± ë° ë°œí–‰ í…ŒìŠ¤íŠ¸

**ê²°ê³¼/ê²°ì •ì‚¬í•­**:
- ì™„ì „íˆ ì‘ë™í•˜ëŠ” ê´€ë¦¬ì ì‹œìŠ¤í…œ êµ¬ì¶• ì™„ë£Œ
- ì‹¤ì œ ì‚¬ìš© ê°€ëŠ¥í•œ ë°ëª¨ í™˜ê²½ ì œê³µ
- ë‹¨ê³„ë³„ ì‚¬ìš©ì ê°€ì´ë“œ ë° ë¬¸ì„œí™” ì™„ë£Œ
- ìë™í™”ëœ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì œê³µ

### [2025-01-16 16:45] ëŒ“ê¸€ ì‹œìŠ¤í…œ êµ¬í˜„ ì™„ë£Œ
**ì‘ì—…**: ìµëª… ëŒ“ê¸€ ì‹œìŠ¤í…œ êµ¬í˜„ ì™„ë£Œ - ìˆ˜í•™ CAPTCHA ê²€ì¦ í¬í•¨
- ëŒ“ê¸€ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì„¤ê³„ ë° êµ¬í˜„
- ìˆ˜í•™ CAPTCHA API êµ¬í˜„ (ê°„ë‹¨í•œ ì‚°ìˆ˜ ë¬¸ì œ)
- ëŒ“ê¸€ CRUD API êµ¬í˜„ (ì‘ì„±, ì¡°íšŒ, ì‚­ì œ)
- ëŒ“ê¸€ ì‘ì„± í¼ ì»´í¬ë„ŒíŠ¸ êµ¬í˜„
- ëŒ“ê¸€ ì„¹ì…˜ UI ì»´í¬ë„ŒíŠ¸ êµ¬í˜„
- ê²Œì‹œê¸€ ìƒì„¸ í˜ì´ì§€ì— ëŒ“ê¸€ ì‹œìŠ¤í…œ í†µí•©
- ë¯¸ë“¤ì›¨ì–´ ìˆ˜ì •ìœ¼ë¡œ API ë¼ìš°íŠ¸ 404 ì˜¤ë¥˜ í•´ê²°

**ì¤‘ìš” ì»¨í…ìŠ¤íŠ¸**:
- **ìµëª… ëŒ“ê¸€ ì‹œìŠ¤í…œ**: ë¡œê·¸ì¸ ì—†ì´ ëŒ“ê¸€ ì‘ì„± ê°€ëŠ¥
- **ìˆ˜í•™ CAPTCHA**: ê°„ë‹¨í•œ ì‚°ìˆ˜ ë¬¸ì œ (3+5, 7-2, 4Ã—2 ë“±)
- **ìŠ¤íŒ¸ ë°©ì§€**: IP ê¸°ë°˜ rate limiting (5ê°œ/ì‹œê°„)
- **ê´€ë¦¬ì ìŠ¹ì¸ ë¶ˆí•„ìš”**: ê²€ì¦ í›„ ì¦‰ì‹œ ëŒ“ê¸€ í‘œì‹œ
- **ë¯¸ë“¤ì›¨ì–´ ìˆ˜ì •**: `/api/` ê²½ë¡œì— ëŒ€í•œ êµ­ì œí™” ì²˜ë¦¬ ê±´ë„ˆë›°ê¸°

**êµ¬í˜„ëœ ê¸°ëŠ¥**:
- ëŒ“ê¸€ ì‘ì„± í¼ with ìˆ˜í•™ CAPTCHA ê²€ì¦
- ëŒ“ê¸€ ëª©ë¡ í‘œì‹œ with í˜ì´ì§€ë„¤ì´ì…˜
- ê´€ë¦¬ì ëŒ“ê¸€ ì‚­ì œ ê¸°ëŠ¥
- ì‹¤ì‹œê°„ ëŒ“ê¸€ ì¶”ê°€ (ìƒˆë¡œê³ ì¹¨ ë¶ˆí•„ìš”)
- ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ ë° ë°˜ì‘í˜• ë””ìì¸
- ì—ëŸ¬ ì²˜ë¦¬ ë° ì‚¬ìš©ì í”¼ë“œë°±

**ê¸°ìˆ ì  êµ¬í˜„**:
- ë°ì´í„°ë² ì´ìŠ¤: comments, rate_limiting í…Œì´ë¸”
- API: /api/captcha/math (GET/POST), /api/comments (GET/POST/DELETE)
- ì»´í¬ë„ŒíŠ¸: MathCaptcha, CommentForm, CommentSection
- ê²€ì¦: zod ìŠ¤í‚¤ë§ˆ, ì…ë ¥ ê²€ì¦ (ì´ë¦„ 2-30ì, ëŒ“ê¸€ 5-500ì)
- ë³´ì•ˆ: ì„¸ì…˜ ê¸°ë°˜ CAPTCHA, IP ê¸°ë°˜ rate limiting

**í•´ê²°ëœ ë¬¸ì œ**:
- CAPTCHA API 404 ì˜¤ë¥˜: ë¯¸ë“¤ì›¨ì–´ì—ì„œ /api/ ê²½ë¡œ êµ­ì œí™” ì²˜ë¦¬ ê±´ë„ˆë›°ê¸°
- í•œêµ­ì–´ í…ìŠ¤íŠ¸ ì§€ì›: UTF-8 ì¸ì½”ë”© í™•ì¸
- ë´‡ ì°¨ë‹¨: ê°„ë‹¨í•œ ìˆ˜í•™ ë¬¸ì œë¡œ ì‚¬ìš©ì ê²½í—˜ ìµœì í™”

**ê²°ê³¼/ê²°ì •ì‚¬í•­**:
- ì™„ì „íˆ ì‘ë™í•˜ëŠ” ëŒ“ê¸€ ì‹œìŠ¤í…œ êµ¬ì¶• ì™„ë£Œ
- ì‚¬ìš©ì ì¹œí™”ì  ë´‡ ì°¨ë‹¨ ì‹œìŠ¤í…œ êµ¬í˜„
- ê´€ë¦¬ì ìŠ¹ì¸ ì—†ì´ ì¦‰ì‹œ ëŒ“ê¸€ í‘œì‹œ ê°€ëŠ¥
- ìŠ¤íŒ¸ ë°©ì§€ ë° ë³´ì•ˆ ê³ ë ¤ì‚¬í•­ ì ìš© ì™„ë£Œ

**ë‹¤ìŒ ë‹¨ê³„**: ëŒ“ê¸€ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ ë° ì¶”ê°€ ê¸°ëŠ¥ ê°œë°œ (ëŒ€ëŒ“ê¸€, ì¢‹ì•„ìš” ë“±)

---

## ì§„í–‰ ìƒí™© ì²´í¬ë¦¬ìŠ¤íŠ¸

### Phase 1: í•µì‹¬ ì¸í”„ë¼ êµ¬ì¶•
- [x] Supabase ì„¤ì • ë° DB ìŠ¤í‚¤ë§ˆ ì„¤ê³„ (ì™„ë£Œ)
- [x] ê¸°ë³¸ ë¸”ë¡œê·¸ êµ¬ì¡°ë¡œ í˜ì´ì§€ êµì²´ (ì™„ë£Œ)
- [x] ì¸ì¦ ì‹œìŠ¤í…œ êµ¬í˜„ (ì™„ë£Œ)

### Phase 2: ì½˜í…ì¸  ê´€ë¦¬ ì‹œìŠ¤í…œ  
- [x] ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ êµ¬ì¡° (ì™„ë£Œ)
- [x] ë¸”ë¡œê·¸ í¬ìŠ¤íŠ¸ CRUD ê¸°ëŠ¥ (ì™„ë£Œ)
- [x] ê³µê°œ ë¸”ë¡œê·¸ í˜ì´ì§€ë“¤ (ì™„ë£Œ)

### Phase 3: ë¶€ê°€ ê¸°ëŠ¥
- [x] ê²€ìƒ‰ ë° í•„í„°ë§ (ì™„ë£Œ)
- [x] ë‹¤í¬ëª¨ë“œ ë° ë°˜ì‘í˜• ë””ìì¸ (ì™„ë£Œ)
- [x] SEO ìµœì í™” (ì™„ë£Œ)
- [x] ëŒ“ê¸€ ì‹œìŠ¤í…œ (ì™„ë£Œ)

---

## ì¤‘ìš”í•œ ê²°ì •ì‚¬í•­ ë° ì»¨í…ìŠ¤íŠ¸

### ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ê³„íš
```sql
-- Gemini í”¼ë“œë°± ê¸°ë°˜ ìŠ¤í‚¤ë§ˆ ì„¤ê³„
posts (id, created_at, title, content, slug, published, cover_image_url, category_id)
categories (id, name)
tags (id, name)
post_tags (post_id, tag_id)
```

### ê¸°ìˆ ì  êµ¬í˜„ ë°©í–¥
- Markdown ì—ë””í„°: Toast UI Editor ë˜ëŠ” TipTap
- ì´ë¯¸ì§€ ì—…ë¡œë“œ: Supabase Storage
- ì¸ì¦: Supabase Auth with RLS
- ê²€ìƒ‰: PostgreSQL Full-Text Search
- ë‹¤í¬ëª¨ë“œ: next-themes ë¼ì´ë¸ŒëŸ¬ë¦¬

### ì„±ëŠ¥ ëª©í‘œ
- TTFB < 200ms
- LCP â‰¤ 1.5s P75
- CLS < 0.1
- ê´€ë¦¬ì í¬ìŠ¤íŠ¸ ì‘ì„± ì‹œê°„ < 5ë¶„
</file>

<file path="next.config.ts">
import type { NextConfig } from 'next';
import createNextIntlPlugin from 'next-intl/plugin';

const withNextIntl = createNextIntlPlugin('./src/i18n/config.ts');

const nextConfig: NextConfig = {
  /* config options here */
  eslint: {
    ignoreDuringBuilds: true,
  },
  images: {
    remotePatterns: [
      {
        hostname: '**',
      },
    ],
  },
};

export default withNextIntl(nextConfig);
</file>

<file path="README.md">
# Dev-eloper Blog

> Modern blog platform providing elegant writing experience for developers.

![Dev-eloper](https://img.shields.io/badge/Dev--eloper-Modern%20Blog-blue)
![Next.js](https://img.shields.io/badge/Next.js-15-black)
![React](https://img.shields.io/badge/React-19-blue)
![TypeScript](https://img.shields.io/badge/TypeScript-5-blue)
![Tailwind CSS](https://img.shields.io/badge/Tailwind%20CSS-3.4-38bdf8)

## ğŸš€ Project Overview

**Dev-eloper** is a modern blog platform built with Next.js 15 and Supabase. It allows a single administrator to create, manage, and publish Markdown-based articles while providing visitors with an elegant reading and discovery experience.

### âœ¨ Key Features

- ğŸ“ **Markdown Editor**: Intuitive WYSIWYG editor based on TipTap
- ğŸ¨ **Responsive Design**: Perfect support for mobile, tablet, and desktop
- ğŸŒ— **Dark Mode**: Automatic light/dark theme switching
- ğŸŒ **Internationalization**: Full Korean/English support (next-intl)
- ğŸ” **Advanced Search**: Real-time search by title, content, and tags
- ğŸ·ï¸ **Tag System**: Category and tag-based classification
- ğŸ” **Secure Authentication**: Supabase Auth-based admin authentication
- âš¡ **Performance Optimization**: Image optimization, lazy loading, SSR/SSG
- ğŸ“± **PWA Support**: Offline reading and installable
- ğŸ­ **Animations**: Smooth transitions with Framer Motion

## ğŸ› ï¸ Tech Stack

### Frontend
- **Next.js 15** - App Router, React Server Components
- **React 19** - Latest React features
- **TypeScript** - Type safety
- **Tailwind CSS** - Utility-based styling
- **shadcn/ui** - Reusable UI components
- **Framer Motion** - High-performance animations

### Backend & Database
- **Supabase** - Authentication, database, storage
- **PostgreSQL** - Powerful relational database
- **Row Level Security** - Data security

### Development Tools
- **ESLint** - Code quality management
- **Prettier** - Code formatting

### Deployment & Hosting
- **Vercel** - Optimized deployment environment
- **Supabase** - Backend services

## ğŸš€ Getting Started

### Prerequisites

- Node.js 18.0.0 or higher
- npm or yarn
- Supabase account

### Installation

1. **Clone the repository**
   ```bash
   git clone https://github.com/your-username/dev-eloper.git
   cd dev-eloper
   ```

2. **Install dependencies**
   ```bash
   npm install
   ```

3. **Environment setup**
   ```bash
   cp .env.example .env.local
   ```

   Edit the `.env.local` file and set the required values:
   ```env
   # Supabase Configuration
   NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
   NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
   SUPABASE_SERVICE_ROLE_KEY=your_service_role_key

   # Site Configuration
   NEXT_PUBLIC_SITE_URL=https://www.dev-eloper.site

   # Optional: Analytics
   GOOGLE_ANALYTICS_ID=your_ga_id
   ```

4. **Database setup**
   
   Run the following SQL in your Supabase project:
   ```bash
   # Create database schema
   psql -h your-supabase-host -U postgres -d postgres -f docs/database-complete.sql
   ```

5. **Start development server**
   ```bash
   npm run dev
   ```

   Open [http://localhost:3000](http://localhost:3000) in your browser to see the result.

## ğŸ“ Project Structure

```
Dev-Eloper4/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ [locale]/          # Internationalization routing
â”‚   â”‚   â”œâ”€â”€ api/               # API routes
â”‚   â”‚   â””â”€â”€ globals.css        # Global styles
â”‚   â”œâ”€â”€ components/            # Reusable components
â”‚   â”‚   â”œâ”€â”€ ui/               # shadcn/ui components
â”‚   â”‚   â”œâ”€â”€ blog/             # Blog-related components
â”‚   â”‚   â”œâ”€â”€ admin/            # Admin components
â”‚   â”‚   â””â”€â”€ shared/           # Shared components
â”‚   â”œâ”€â”€ hooks/                # Custom hooks
â”‚   â”œâ”€â”€ lib/                  # Utility functions
â”‚   â”œâ”€â”€ types/                # TypeScript type definitions
â”‚   â””â”€â”€ styles/               # Additional styles
â”œâ”€â”€ public/                   # Static files
â”œâ”€â”€ docs/                     # Project documentation
â”œâ”€â”€ messages/                 # Internationalization messages
â””â”€â”€ supabase/                # Supabase-related files
```

## ğŸ’» Development Commands

```bash
# Start development server (with Turbopack)
npm run dev

# Production build
npm run build

# Start production server
npm start

# Lint code
npm run lint
```

## ğŸ¯ Main Features

### Admin Features
- **Secure Login**: JWT-based authentication system
- **Post Management**: Create, edit, delete, publish/unpublish
- **Image Upload**: Supabase Storage integration
- **Tags & Categories**: Classification system with autocomplete
- **Draft Saving**: Auto-save and preview functionality

### Visitor Features
- **Responsive Design**: Optimized experience on all devices
- **Real-time Search**: Search by title, content, and tags
- **Category Filtering**: Explore posts by topic
- **Social Sharing**: Social media sharing features
- **RSS Feed**: RSS support for subscribers

### Performance Optimization
- **Image Optimization**: Next.js Image component usage
- **Lazy Loading**: Scroll-based content loading
- **Caching**: ISR (Incremental Static Regeneration) applied
- **Core Web Vitals**: Targeting LCP < 1.5s, CLS < 0.1

## ğŸŒ Deployment

### Vercel Deployment

1. **Connect Vercel account**
   ```bash
   npx vercel
   ```

2. **Set environment variables**
   Set the following environment variables in the Vercel dashboard:
   - `NEXT_PUBLIC_SUPABASE_URL`
   - `NEXT_PUBLIC_SUPABASE_ANON_KEY`
   - `SUPABASE_SERVICE_ROLE_KEY`
   - `NEXT_PUBLIC_SITE_URL`

3. **Connect domain**
   - Set up custom domain in Vercel
   - SSL automatically applied after DNS setup

### Environment Settings

- **Development**: `http://localhost:3000`
- **Staging**: `https://dev-eloper-staging.vercel.app`
- **Production**: `https://www.dev-eloper.site`

## ğŸ§ª Testing

```bash
# Run unit tests
npm run test

# Run E2E tests
npm run test:e2e

# Check test coverage
npm run test:coverage
```

## ğŸ“Š Monitoring & Analytics

- **Web Vitals**: Real-time performance metrics monitoring
- **Vercel Analytics**: User behavior analysis
- **Sentry**: Error tracking and monitoring (optional)

## ğŸ¤ Contributing

1. Fork the Project
2. Create your Feature Branch (`git checkout -b feature/AmazingFeature`)
3. Commit your Changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the Branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

### Development Guidelines

- **Code Style**: Follow ESLint + Prettier configuration
- **Commit Messages**: Follow [Conventional Commits](https://conventionalcommits.org/) rules
- **Branch Strategy**: Apply Git Flow
- **Testing**: Write test code for new features

## ğŸ“ License

This project is distributed under the MIT License. See [LICENSE](LICENSE) file for more details.

## ğŸ“ Contact

- **Website**: [https://www.dev-eloper.site](https://www.dev-eloper.site)
- **Email**: contact@dev-eloper.site
- **GitHub**: [https://github.com/your-username/dev-eloper](https://github.com/your-username/dev-eloper)

## ğŸ™ Acknowledgments

This project was built with the help of the following open source projects:

- [Next.js](https://nextjs.org/)
- [React](https://reactjs.org/)
- [Supabase](https://supabase.com/)
- [Tailwind CSS](https://tailwindcss.com/)
- [shadcn/ui](https://ui.shadcn.com/)
- [Framer Motion](https://www.framer.com/motion/)

---

Start your own development blog with **Dev-eloper**! ğŸš€
</file>

<file path="src/app/[locale]/admin/posts/[id]/edit/page.tsx">
'use client';

import { useState, useEffect } from 'react';
import { useRouter, useParams } from 'next/navigation';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { createClient } from '@/lib/supabase/client';
import { postSchema, type PostFormData } from '@/lib/validations/post';
import { generateSlug } from '@/lib/utils/slug';
import { useToast } from '@/hooks/use-toast';
import { useAuth } from '@/hooks/use-auth';

import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from '@/components/ui/form';
import { Checkbox } from '@/components/ui/checkbox';
import { Badge } from '@/components/ui/badge';
import { Separator } from '@/components/ui/separator';
import { RichTextEditorEnhanced } from '@/components/admin/rich-text-editor-enhanced';
import { ImageUpload } from '@/components/admin/image-upload';
import { Save, Send, Clock, Archive, ArrowLeft, Trash2, Eye } from 'lucide-react';
import Link from 'next/link';

interface Category {
  id: number;
  name: string;
  slug: string;
}

interface Tag {
  id: number;
  name: string;
  slug: string;
}

interface PostData {
  id: string;
  title: string;
  content: string;
  slug: string;
  status: 'draft' | 'scheduled' | 'published' | 'archived';
  published_at: string | null;
  cover_image_path: string | null;
  category_id: number | null;
  created_at: string;
  updated_at: string;
  category?: Category | null;
  post_tags?: Array<{
    tag: Tag;
  }>;
}

export default function EditPostPage() {
  const [categories, setCategories] = useState<Category[]>([]);
  const [tags, setTags] = useState<Tag[]>([]);
  const [loading, setLoading] = useState(false);
  const [selectedTags, setSelectedTags] = useState<number[]>([]);
  const [post, setPost] = useState<PostData | null>(null);
  const [pageLoading, setPageLoading] = useState(true);
  
  const router = useRouter();
  const params = useParams();
  const { toast } = useToast();
  const { isAdmin } = useAuth();
  const supabase = createClient();
  
  const postId = params.id as string;

  const form = useForm<PostFormData>({
    resolver: zodResolver(postSchema),
    defaultValues: {
      title: '',
      content: '',
      slug: '',
      status: 'draft',
      published_at: null,
      cover_image_path: null,
      category_id: null,
      tag_ids: [],
    },
  });

  const title = form.watch('title');

  // Load post data
  useEffect(() => {
    const loadPost = async () => {
      if (!postId) return;
      
      setPageLoading(true);
      
      try {
        const { data, error } = await supabase
          .from('posts')
          .select(`
            *,
            category:categories(*),
            post_tags(tag:tags(*))
          `)
          .eq('id', postId)
          .is('deleted_at', null)
          .single();

        if (error) {
          throw error;
        }

        if (!data) {
          throw new Error('Post not found');
        }

        setPost(data);
        
        // Populate form
        form.reset({
          title: data.title,
          content: data.content,
          slug: data.slug,
          status: data.status,
          published_at: data.published_at,
          cover_image_path: data.cover_image_path,
          category_id: data.category_id,
          tag_ids: data.post_tags?.map(pt => pt.tag.id) || [],
        });

        // Set selected tags
        setSelectedTags(data.post_tags?.map(pt => pt.tag.id) || []);
        
      } catch (error) {
        console.error('Error loading post:', error);
        toast({
          variant: 'destructive',
          description: 'Failed to load post. Please try again.',
        });
        router.push('/admin/posts');
      } finally {
        setPageLoading(false);
      }
    };

    loadPost();
  }, [postId, supabase, form, router, toast]);

  // Auto-generate slug from title (only if slug field is empty)
  useEffect(() => {
    if (title && !form.getValues('slug')) {
      const slug = generateSlug(title);
      form.setValue('slug', slug);
    }
  }, [title, form]);

  // Load categories and tags
  useEffect(() => {
    const loadData = async () => {
      const [categoriesRes, tagsRes] = await Promise.all([
        supabase.from('categories').select('*').is('deleted_at', null).order('name'),
        supabase.from('tags').select('*').is('deleted_at', null).order('name'),
      ]);

      if (categoriesRes.data) setCategories(categoriesRes.data);
      if (tagsRes.data) setTags(tagsRes.data);
    };

    loadData();
  }, [supabase]);

  const onSubmit = async (data: PostFormData, status: PostFormData['status']) => {
    if (!post) return;
    
    setLoading(true);

    try {
      // Check if slug already exists (excluding current post)
      const { data: existingPost } = await supabase
        .from('posts')
        .select('id')
        .eq('slug', data.slug)
        .neq('id', post.id)
        .is('deleted_at', null)
        .maybeSingle();

      if (existingPost) {
        form.setError('slug', { message: 'This slug already exists' });
        setLoading(false);
        return;
      }

      // Prepare post data
      const { tag_ids, ...postDataWithoutTags } = data;
      const postData = {
        ...postDataWithoutTags,
        status,
        published_at: status === 'published' && !data.published_at 
          ? new Date().toISOString() 
          : data.published_at,
        updated_at: new Date().toISOString(),
      };

      // Update post
      const { error: postError } = await supabase
        .from('posts')
        .update(postData)
        .eq('id', post.id);

      if (postError) throw postError;

      // Update tags - delete existing and insert new ones
      const { error: deleteTagError } = await supabase
        .from('post_tags')
        .delete()
        .eq('post_id', post.id);

      if (deleteTagError) throw deleteTagError;

      // Insert new tags if any selected
      if (selectedTags.length > 0) {
        const tagRelations = selectedTags.map(tagId => ({
          post_id: post.id,
          tag_id: tagId,
        }));

        const { error: tagError } = await supabase
          .from('post_tags')
          .insert(tagRelations);

        if (tagError) throw tagError;
      }

      toast({
        description: `Post ${status === 'published' ? 'published' : 'updated'} successfully!`,
      });

      router.push('/admin/posts');
      router.refresh();
    } catch (error) {
      console.error('Error updating post:', error);
      toast({
        variant: 'destructive',
        description: 'Failed to update post. Please try again.',
      });
    } finally {
      setLoading(false);
    }
  };

  const handleTagToggle = (tagId: number) => {
    setSelectedTags(prev => 
      prev.includes(tagId) 
        ? prev.filter(id => id !== tagId)
        : [...prev, tagId]
    );
  };

  const handleDelete = async () => {
    if (!post) return;
    
    if (!confirm('Are you sure you want to delete this post? This action cannot be undone.')) {
      return;
    }

    setLoading(true);

    try {
      const { error } = await supabase
        .from('posts')
        .update({ deleted_at: new Date().toISOString() })
        .eq('id', post.id);

      if (error) throw error;

      toast({
        description: 'Post deleted successfully!',
      });

      router.push('/admin/posts');
      router.refresh();
    } catch (error) {
      console.error('Error deleting post:', error);
      toast({
        variant: 'destructive',
        description: 'Failed to delete post. Please try again.',
      });
    } finally {
      setLoading(false);
    }
  };

  if (!isAdmin) {
    return (
      <div className="container py-8">
        <div className="text-center">
          <h1 className="text-2xl font-bold mb-4">Access Denied</h1>
          <p className="text-muted-foreground">You don&apos;t have permission to access this page.</p>
        </div>
      </div>
    );
  }

  if (pageLoading) {
    return (
      <div className="container py-8">
        <div className="flex items-center justify-center">
          <div className="text-center">
            <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"></div>
            <p className="text-muted-foreground">Loading post...</p>
          </div>
        </div>
      </div>
    );
  }

  if (!post) {
    return (
      <div className="container py-8">
        <div className="text-center">
          <h1 className="text-2xl font-bold mb-4">Post Not Found</h1>
          <p className="text-muted-foreground mb-4">The post you&apos;re looking for doesn&apos;t exist.</p>
          <Button asChild>
            <Link href="/admin/posts">
              <ArrowLeft className="mr-2 h-4 w-4" />
              Back to Posts
            </Link>
          </Button>
        </div>
      </div>
    );
  }

  return (
    <div className="container py-8 max-w-4xl">
      <div className="mb-8">
        <div className="flex items-center justify-between">
          <div className="flex items-center gap-4">
            <Button variant="ghost" asChild>
              <Link href="/admin/posts">
                <ArrowLeft className="mr-2 h-4 w-4" />
                Back to Posts
              </Link>
            </Button>
            <div>
              <h1 className="text-3xl font-bold">Edit Post</h1>
              <p className="text-muted-foreground">
                Update your blog post
              </p>
            </div>
          </div>
          <div className="flex items-center gap-2">
            <Badge variant="secondary" className="text-sm">
              {post.status.charAt(0).toUpperCase() + post.status.slice(1)}
            </Badge>
            {post.status === 'published' && (
              <Button variant="outline" size="sm" asChild>
                <Link href={`/posts/${post.slug}`} target="_blank">
                  <Eye className="h-4 w-4 mr-2" />
                  View Live
                </Link>
              </Button>
            )}
          </div>
        </div>
      </div>

      <Form {...form}>
        <div className="grid gap-6 lg:grid-cols-3">
          {/* Main Content */}
          <div className="lg:col-span-2 space-y-6">
            <Card>
              <CardHeader>
                <CardTitle>Post Content</CardTitle>
              </CardHeader>
              <CardContent className="space-y-4">
                <FormField
                  control={form.control}
                  name="title"
                  render={({ field }) => (
                    <FormItem>
                      <FormLabel>Title</FormLabel>
                      <FormControl>
                        <Input 
                          placeholder="Enter post title..." 
                          {...field} 
                        />
                      </FormControl>
                      <FormMessage />
                    </FormItem>
                  )}
                />

                <FormField
                  control={form.control}
                  name="slug"
                  render={({ field }) => (
                    <FormItem>
                      <FormLabel>Slug</FormLabel>
                      <FormControl>
                        <Input 
                          placeholder="post-url-slug" 
                          {...field} 
                        />
                      </FormControl>
                      <FormMessage />
                    </FormItem>
                  )}
                />

                <FormField
                  control={form.control}
                  name="content"
                  render={({ field }) => (
                    <FormItem>
                      <FormLabel>Content</FormLabel>
                      <FormControl>
                        <RichTextEditorEnhanced
                          value={field.value}
                          onChange={field.onChange}
                          placeholder="Edit your post content..."
                          showWordCount={true}
                          maxLength={50000}
                        />
                      </FormControl>
                      <FormMessage />
                    </FormItem>
                  )}
                />
              </CardContent>
            </Card>
          </div>

          {/* Sidebar */}
          <div className="space-y-6">
            <Card>
              <CardHeader>
                <CardTitle>Actions</CardTitle>
              </CardHeader>
              <CardContent className="space-y-4">
                <div className="flex flex-col gap-2">
                  <Button
                    type="button"
                    onClick={() => onSubmit(form.getValues(), 'draft')}
                    disabled={loading}
                    variant="outline"
                  >
                    <Save className="mr-2 h-4 w-4" />
                    Save Draft
                  </Button>
                  <Button
                    type="button"
                    onClick={() => onSubmit(form.getValues(), 'published')}
                    disabled={loading}
                  >
                    <Send className="mr-2 h-4 w-4" />
                    {post.status === 'published' ? 'Update' : 'Publish'}
                  </Button>
                  {post.status === 'published' && (
                    <Button
                      type="button"
                      onClick={() => onSubmit(form.getValues(), 'draft')}
                      disabled={loading}
                      variant="outline"
                    >
                      <Archive className="mr-2 h-4 w-4" />
                      Unpublish
                    </Button>
                  )}
                </div>
                
                <Separator />
                
                <Button
                  type="button"
                  onClick={handleDelete}
                  disabled={loading}
                  variant="destructive"
                  className="w-full"
                >
                  <Trash2 className="mr-2 h-4 w-4" />
                  Delete Post
                </Button>
              </CardContent>
            </Card>

            <Card>
              <CardHeader>
                <CardTitle>Settings</CardTitle>
              </CardHeader>
              <CardContent className="space-y-4">
                <FormField
                  control={form.control}
                  name="category_id"
                  render={({ field }) => (
                    <FormItem>
                      <FormLabel>Category</FormLabel>
                      <Select 
                        onValueChange={(value) => field.onChange(value === "none" ? null : Number(value))}
                        value={field.value?.toString() || "none"}
                      >
                        <FormControl>
                          <SelectTrigger>
                            <SelectValue placeholder="Select category" />
                          </SelectTrigger>
                        </FormControl>
                        <SelectContent>
                          <SelectItem value="none">No category</SelectItem>
                          {categories.map((category) => (
                            <SelectItem key={category.id} value={category.id.toString()}>
                              {category.name}
                            </SelectItem>
                          ))}
                        </SelectContent>
                      </Select>
                      <FormMessage />
                    </FormItem>
                  )}
                />

                <FormField
                  control={form.control}
                  name="cover_image_path"
                  render={({ field }) => (
                    <FormItem>
                      <FormControl>
                        <ImageUpload
                          value={field.value}
                          onChange={field.onChange}
                          label="Cover Image"
                        />
                      </FormControl>
                      <FormMessage />
                    </FormItem>
                  )}
                />
              </CardContent>
            </Card>

            {tags.length > 0 && (
              <Card>
                <CardHeader>
                  <CardTitle>Tags</CardTitle>
                </CardHeader>
                <CardContent>
                  <div className="space-y-2">
                    {tags.map((tag) => (
                      <div key={tag.id} className="flex items-center space-x-2">
                        <Checkbox
                          id={`tag-${tag.id}`}
                          checked={selectedTags.includes(tag.id)}
                          onCheckedChange={() => handleTagToggle(tag.id)}
                        />
                        <Label htmlFor={`tag-${tag.id}`} className="text-sm">
                          {tag.name}
                        </Label>
                      </div>
                    ))}
                  </div>
                </CardContent>
              </Card>
            )}

            <Card>
              <CardHeader>
                <CardTitle>Post Info</CardTitle>
              </CardHeader>
              <CardContent className="space-y-2 text-sm">
                <div className="flex justify-between">
                  <span className="text-muted-foreground">Created:</span>
                  <span>{new Date(post.created_at).toLocaleDateString()}</span>
                </div>
                <div className="flex justify-between">
                  <span className="text-muted-foreground">Updated:</span>
                  <span>{new Date(post.updated_at).toLocaleDateString()}</span>
                </div>
                {post.published_at && (
                  <div className="flex justify-between">
                    <span className="text-muted-foreground">Published:</span>
                    <span>{new Date(post.published_at).toLocaleDateString()}</span>
                  </div>
                )}
              </CardContent>
            </Card>
          </div>
        </div>
      </Form>
    </div>
  );
}
</file>

<file path="src/app/[locale]/admin/posts/new/page.tsx">
'use client';

import { useState, useEffect } from 'react';
import { useRouter } from 'next/navigation';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { createClient } from '@/lib/supabase/client';
import { postSchema, type PostFormData } from '@/lib/validations/post';
import { generateSlug } from '@/lib/utils/slug';
import { useToast } from '@/hooks/use-toast';
import { useAuth } from '@/hooks/use-auth';

import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from '@/components/ui/form';
import { Checkbox } from '@/components/ui/checkbox';
import { RichTextEditorEnhanced } from '@/components/admin/rich-text-editor-enhanced';
import { ImageUpload } from '@/components/admin/image-upload';
import { Save, Send, Clock, Archive, Loader2 } from 'lucide-react';

interface Category {
  id: number;
  name: string;
  slug: string;
}

interface Tag {
  id: number;
  name: string;
  slug: string;
}

export default function NewPostPage() {
  const [categories, setCategories] = useState<Category[]>([]);
  const [tags, setTags] = useState<Tag[]>([]);
  const [loading, setLoading] = useState(false);
  const [selectedTags, setSelectedTags] = useState<number[]>([]);
  
  const router = useRouter();
  const { toast } = useToast();
  const { user, isAdmin, loading: authLoading } = useAuth();
  const supabase = createClient();

  const form = useForm<PostFormData>({
    resolver: zodResolver(postSchema),
    defaultValues: {
      title: '',
      content: '',
      slug: '',
      status: 'draft',
      published_at: null,
      cover_image_path: null,
      category_id: null,
      tag_ids: [],
    },
  });

  const title = form.watch('title');

  // Auto-generate slug from title
  useEffect(() => {
    if (title && !form.formState.dirtyFields.slug) {
      const slug = generateSlug(title);
      form.setValue('slug', slug);
    }
  }, [title, form]);

  // Load categories and tags
  useEffect(() => {
    const loadData = async () => {
      const [categoriesRes, tagsRes] = await Promise.all([
        supabase.from('categories').select('*').is('deleted_at', null).order('name'),
        supabase.from('tags').select('*').is('deleted_at', null).order('name'),
      ]);

      if (categoriesRes.data) setCategories(categoriesRes.data);
      if (tagsRes.data) setTags(tagsRes.data);
    };

    loadData();
  }, [supabase]);

  const onSubmit = async (data: PostFormData, status: PostFormData['status']) => {
    setLoading(true);

    try {
      // Check if slug already exists
      const { data: existingPost } = await supabase
        .from('posts')
        .select('id')
        .eq('slug', data.slug)
        .is('deleted_at', null)
        .maybeSingle();

      if (existingPost) {
        form.setError('slug', { message: 'This slug already exists' });
        setLoading(false);
        return;
      }

      // Prepare post data
      const { tag_ids, ...postDataWithoutTags } = data;
      const postData = {
        ...postDataWithoutTags,
        status,
        published_at: status === 'published' ? new Date().toISOString() : data.published_at,
      };

      // Insert post
      const { data: newPost, error: postError } = await supabase
        .from('posts')
        .insert([postData])
        .select()
        .single();

      if (postError) throw postError;

      // Insert tags if any selected
      if (selectedTags.length > 0) {
        const tagRelations = selectedTags.map(tagId => ({
          post_id: newPost.id,
          tag_id: tagId,
        }));

        const { error: tagError } = await supabase
          .from('post_tags')
          .insert(tagRelations);

        if (tagError) throw tagError;
      }

      toast({
        description: `Post ${status === 'published' ? 'published' : 'saved'} successfully!`,
      });

      router.push('/admin/posts');
      router.refresh();
    } catch (error) {
      console.error('Error saving post:', error);
      toast({
        variant: 'destructive',
        description: 'Failed to save post. Please try again.',
      });
    } finally {
      setLoading(false);
    }
  };

  const handleTagToggle = (tagId: number) => {
    setSelectedTags(prev => 
      prev.includes(tagId) 
        ? prev.filter(id => id !== tagId)
        : [...prev, tagId]
    );
  };

  if (authLoading) {
    return (
      <div className="container py-8">
        <div className="flex items-center justify-center min-h-[200px]">
          <div className="text-center">
            <Loader2 className="h-8 w-8 animate-spin mx-auto mb-4" />
            <p className="text-muted-foreground">Loading...</p>
          </div>
        </div>
      </div>
    );
  }

  if (!isAdmin) {
    return (
      <div className="container py-8">
        <div className="text-center">
          <h1 className="text-2xl font-bold mb-4">Access Denied</h1>
          <p className="text-muted-foreground mb-4">You don&apos;t have permission to access this page.</p>
          <div className="mt-4 p-4 bg-muted rounded-lg">
            <p className="text-sm">Debug Info:</p>
            <p className="text-sm">User: {user?.email || 'Not logged in'}</p>
            <p className="text-sm">Is Admin: {isAdmin ? 'Yes' : 'No'}</p>
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="container py-8 max-w-4xl">
      <div className="mb-8">
        <h1 className="text-3xl font-bold">Create New Post</h1>
        <p className="text-muted-foreground">
          Write and publish your blog post
        </p>
      </div>

      <Form {...form}>
        <div className="grid gap-6 lg:grid-cols-3">
          {/* Main Content */}
          <div className="lg:col-span-2 space-y-6">
            <Card>
              <CardHeader>
                <CardTitle>Post Content</CardTitle>
              </CardHeader>
              <CardContent className="space-y-4">
                <FormField
                  control={form.control}
                  name="title"
                  render={({ field }) => (
                    <FormItem>
                      <FormLabel>Title</FormLabel>
                      <FormControl>
                        <Input 
                          placeholder="Enter post title..." 
                          {...field} 
                        />
                      </FormControl>
                      <FormMessage />
                    </FormItem>
                  )}
                />

                <FormField
                  control={form.control}
                  name="slug"
                  render={({ field }) => (
                    <FormItem>
                      <FormLabel>Slug</FormLabel>
                      <FormControl>
                        <Input 
                          placeholder="post-url-slug" 
                          {...field} 
                        />
                      </FormControl>
                      <FormMessage />
                    </FormItem>
                  )}
                />

                <FormField
                  control={form.control}
                  name="content"
                  render={({ field }) => (
                    <FormItem>
                      <FormLabel>Content</FormLabel>
                      <FormControl>
                        <RichTextEditorEnhanced
                          value={field.value}
                          onChange={field.onChange}
                          placeholder="Start writing your post content..."
                          showWordCount={true}
                          maxLength={50000}
                        />
                      </FormControl>
                      <FormMessage />
                    </FormItem>
                  )}
                />
              </CardContent>
            </Card>
          </div>

          {/* Sidebar */}
          <div className="space-y-6">
            <Card>
              <CardHeader>
                <CardTitle>Publish</CardTitle>
              </CardHeader>
              <CardContent className="space-y-4">
                <div className="flex flex-col gap-2">
                  <Button
                    type="button"
                    onClick={() => onSubmit(form.getValues(), 'draft')}
                    disabled={loading}
                    variant="outline"
                  >
                    <Save className="mr-2 h-4 w-4" />
                    Save Draft
                  </Button>
                  <Button
                    type="button"
                    onClick={() => onSubmit(form.getValues(), 'published')}
                    disabled={loading}
                  >
                    <Send className="mr-2 h-4 w-4" />
                    Publish Now
                  </Button>
                </div>
              </CardContent>
            </Card>

            <Card>
              <CardHeader>
                <CardTitle>Settings</CardTitle>
              </CardHeader>
              <CardContent className="space-y-4">
                <FormField
                  control={form.control}
                  name="category_id"
                  render={({ field }) => (
                    <FormItem>
                      <FormLabel>Category</FormLabel>
                      <Select 
                        onValueChange={(value) => field.onChange(value ? Number(value) : null)}
                        value={field.value?.toString()}
                      >
                        <FormControl>
                          <SelectTrigger>
                            <SelectValue placeholder="Select category" />
                          </SelectTrigger>
                        </FormControl>
                        <SelectContent>
                          <SelectItem value="none">No category</SelectItem>
                          {categories.map((category) => (
                            <SelectItem key={category.id} value={category.id.toString()}>
                              {category.name}
                            </SelectItem>
                          ))}
                        </SelectContent>
                      </Select>
                      <FormMessage />
                    </FormItem>
                  )}
                />

                <FormField
                  control={form.control}
                  name="cover_image_path"
                  render={({ field }) => (
                    <FormItem>
                      <FormControl>
                        <ImageUpload
                          value={field.value}
                          onChange={field.onChange}
                          label="Cover Image"
                        />
                      </FormControl>
                      <FormMessage />
                    </FormItem>
                  )}
                />
              </CardContent>
            </Card>

            {tags.length > 0 && (
              <Card>
                <CardHeader>
                  <CardTitle>Tags</CardTitle>
                </CardHeader>
                <CardContent>
                  <div className="space-y-2">
                    {tags.map((tag) => (
                      <div key={tag.id} className="flex items-center space-x-2">
                        <Checkbox
                          id={`tag-${tag.id}`}
                          checked={selectedTags.includes(tag.id)}
                          onCheckedChange={() => handleTagToggle(tag.id)}
                        />
                        <Label htmlFor={`tag-${tag.id}`} className="text-sm">
                          {tag.name}
                        </Label>
                      </div>
                    ))}
                  </div>
                </CardContent>
              </Card>
            )}
          </div>
        </div>
      </Form>
    </div>
  );
}
</file>

<file path="src/app/[locale]/admin/posts/page.tsx">
'use client';

import { useState, useEffect } from 'react';
import { createClient } from '@/lib/supabase/client';
import { useAuth } from '@/hooks/use-auth';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';
import { Plus, Edit, Trash2, Eye, Loader2 } from 'lucide-react';
import Link from 'next/link';
import { formatDate, getStatusColor, getStatusText } from '@/lib/utils/slug';
import { PostDeleteButton } from '@/components/admin/post-delete-button';
import type { Database } from '@/types/database';

type Post = Database['public']['Tables']['posts']['Row'];
type Category = Database['public']['Tables']['categories']['Row'];

interface PostWithRelations extends Post {
  category?: Category | null;
  post_tags?: Array<{
    tag: {
      id: number;
      name: string;
      slug: string;
    };
  }>;
}

export default function AdminPostsPage() {
  const [posts, setPosts] = useState<PostWithRelations[]>([]);
  const [loading, setLoading] = useState(true);
  const { user, isAdmin, loading: authLoading } = useAuth();
  const supabase = createClient();

  useEffect(() => {
    if (user && isAdmin) {
      loadPosts();
    }
  }, [user, isAdmin]);

  const loadPosts = async () => {
    try {
      // Get all posts with relations
      const { data: posts, error } = await supabase
        .from('posts')
        .select(`
          *,
          category:categories(*),
          post_tags(tag:tags(*))
        `)
        .is('deleted_at', null)
        .order('created_at', { ascending: false });

      if (error) {
        console.error('Error fetching posts:', error);
      } else {
        setPosts(posts || []);
      }
    } catch (error) {
      console.error('Error loading posts:', error);
    } finally {
      setLoading(false);
    }
  };

  if (authLoading) {
    return (
      <div className="container py-8">
        <div className="flex items-center justify-center min-h-[200px]">
          <div className="text-center">
            <Loader2 className="h-8 w-8 animate-spin mx-auto mb-4" />
            <p className="text-muted-foreground">Loading...</p>
          </div>
        </div>
      </div>
    );
  }

  if (!isAdmin) {
    return (
      <div className="container py-8">
        <div className="text-center">
          <h1 className="text-2xl font-bold mb-4">Access Denied</h1>
          <p className="text-muted-foreground mb-4">You don&apos;t have permission to access this page.</p>
          <div className="mt-4 p-4 bg-muted rounded-lg">
            <p className="text-sm">Debug Info:</p>
            <p className="text-sm">User: {user?.email || 'Not logged in'}</p>
            <p className="text-sm">Is Admin: {isAdmin ? 'Yes' : 'No'}</p>
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="container py-8">
      <div className="flex items-center justify-between mb-8">
        <div>
          <h1 className="text-3xl font-bold">Manage Posts</h1>
          <p className="text-muted-foreground">
            Create, edit, and manage your blog posts
          </p>
        </div>
        <Button asChild>
          <Link href="/admin/posts/new">
            <Plus className="mr-2 h-4 w-4" />
            New Post
          </Link>
        </Button>
      </div>

      {loading ? (
        <div className="flex items-center justify-center py-12">
          <div className="text-center">
            <Loader2 className="h-8 w-8 animate-spin mx-auto mb-4" />
            <p className="text-muted-foreground">Loading posts...</p>
          </div>
        </div>
      ) : posts.length === 0 ? (
        <Card>
          <CardContent className="flex flex-col items-center justify-center py-12">
            <div className="text-center space-y-4">
              <h3 className="text-lg font-semibold">No posts yet</h3>
              <p className="text-muted-foreground max-w-sm">
                Get started by creating your first blog post.
              </p>
              <Button asChild>
                <Link href="/admin/posts/new">
                  <Plus className="mr-2 h-4 w-4" />
                  Create Your First Post
                </Link>
              </Button>
            </div>
          </CardContent>
        </Card>
      ) : (
        <div className="space-y-4">
          {posts.map((post) => (
            <Card key={post.id}>
              <CardHeader>
                <div className="flex items-start justify-between">
                  <div className="space-y-2 flex-1">
                    <div className="flex items-center gap-2">
                      <CardTitle className="text-xl">{post.title}</CardTitle>
                      <Badge 
                        variant="secondary" 
                        className={getStatusColor(post.status)}
                      >
                        {getStatusText(post.status)}
                      </Badge>
                    </div>
                    
                    <div className="flex items-center gap-4 text-sm text-muted-foreground">
                      <span>Created: {formatDate(post.created_at)}</span>
                      {post.published_at && (
                        <span>Published: {formatDate(post.published_at)}</span>
                      )}
                      {post.category && (
                        <span>Category: {post.category.name}</span>
                      )}
                    </div>
                    
                    {post.post_tags && post.post_tags.length > 0 && (
                      <div className="flex gap-1 flex-wrap">
                        {post.post_tags.map(({ tag }) => (
                          <Badge key={tag.id} variant="outline" className="text-xs">
                            {tag.name}
                          </Badge>
                        ))}
                      </div>
                    )}
                  </div>
                  
                  <div className="flex items-center gap-2">
                    {post.status === 'published' && (
                      <Button variant="ghost" size="sm" asChild>
                        <Link href={`/posts/${post.slug}`} target="_blank">
                          <Eye className="h-4 w-4" />
                        </Link>
                      </Button>
                    )}
                    <Button variant="ghost" size="sm" asChild>
                      <Link href={`/admin/posts/${post.id}/edit`}>
                        <Edit className="h-4 w-4" />
                      </Link>
                    </Button>
                    <PostDeleteButton postId={post.id} postTitle={post.title} />
                  </div>
                </div>
              </CardHeader>
              
              {post.content && (
                <CardContent>
                  <p className="text-muted-foreground line-clamp-2">
                    {post.content.replace(/[#*`]/g, '').slice(0, 200)}...
                  </p>
                </CardContent>
              )}
            </Card>
          ))}
        </div>
      )}
    </div>
  );
}
</file>

<file path="src/app/[locale]/manifest.ts">
import { MetadataRoute } from 'next';

export default function manifest(): MetadataRoute.Manifest {
  return {
    name: 'Dev-eloper - Modern Blog Platform',
    short_name: 'Dev-eloper',
    description: 'Dev-eloper - A modern blog platform built with Next.js and Supabase',
    start_url: '/',
    display: 'standalone',
    background_color: '#ffffff',
    theme_color: '#000000',
    icons: [
      {
        src: '/easynext.png',
        sizes: '192x192',
        type: 'image/png',
        purpose: 'maskable',
      },
      {
        src: '/easynext.png',
        sizes: '512x512',
        type: 'image/png',
        purpose: 'maskable',
      },
    ],
    categories: ['blog', 'productivity', 'education'],
    lang: 'en-US',
    orientation: 'portrait-primary',
  };
}
</file>

<file path="src/app/[locale]/search/page.tsx">
"use client";

import { useTranslations } from 'next-intl';
import { useState, useEffect } from 'react';
import { Search } from 'lucide-react';
import { Input } from '@/components/ui/input';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';
import { Link } from '@/i18n/routing';
import { createClient } from '@/lib/supabase/client';
import type { CategoryWithStats, TagWithStats } from '@/lib/blog';
import { getTranslatedCategoryName, getTranslatedCategoryDescription, getTranslatedTagName } from '@/lib/translations';

export default function SearchPage() {
  const t = useTranslations();
  const tSearch = useTranslations('search');
  const tCategories = useTranslations('categories');
  const tCategoryDescriptions = useTranslations('categoryDescriptions');
  const tTags = useTranslations('tags');
  const [searchQuery, setSearchQuery] = useState('');
  const [isSearching, setIsSearching] = useState(false);
  const [popularCategories, setPopularCategories] = useState<CategoryWithStats[]>([]);
  const [trendingTags, setTrendingTags] = useState<TagWithStats[]>([]);

  useEffect(() => {
    const fetchData = async () => {
      const supabase = createClient();
      
      // Fetch categories with stats
      const { data: categoriesData } = await supabase
        .from('categories')
        .select(`
          *,
          posts!inner(id)
        `)
        .is('deleted_at', null)
        .eq('posts.status', 'published')
        .is('posts.deleted_at', null)
        .limit(6);

      if (categoriesData) {
        const categoryStats = new Map<string, number>();
        categoriesData.forEach(item => {
          const count = categoryStats.get(item.id.toString()) || 0;
          categoryStats.set(item.id.toString(), count + 1);
        });

        const uniqueCategories = new Map();
        categoriesData.forEach(item => {
          if (!uniqueCategories.has(item.id)) {
            uniqueCategories.set(item.id, {
              ...item,
              post_count: categoryStats.get(item.id.toString()) || 0
            });
          }
        });

        const sortedCategories = Array.from(uniqueCategories.values())
          .sort((a: any, b: any) => b.post_count - a.post_count)
          .slice(0, 6);
        
        setPopularCategories(sortedCategories);
      }

      // Fetch trending tags
      const { data: tagsData } = await supabase
        .from('tags')
        .select(`
          *,
          post_tags!inner(
            posts!inner(id)
          )
        `)
        .is('deleted_at', null)
        .eq('post_tags.posts.status', 'published')
        .is('post_tags.posts.deleted_at', null)
        .limit(8);

      if (tagsData) {
        const tagStats = new Map<string, number>();
        tagsData.forEach(item => {
          const count = tagStats.get(item.id.toString()) || 0;
          tagStats.set(item.id.toString(), count + 1);
        });

        const uniqueTags = new Map();
        tagsData.forEach(item => {
          if (!uniqueTags.has(item.id)) {
            uniqueTags.set(item.id, {
              ...item,
              post_count: tagStats.get(item.id.toString()) || 0
            });
          }
        });

        const sortedTags = Array.from(uniqueTags.values())
          .sort((a: any, b: any) => b.post_count - a.post_count)
          .slice(0, 8);
        
        setTrendingTags(sortedTags);
      }
    };

    fetchData();
  }, []);

  const handleSearch = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!searchQuery.trim()) return;
    
    setIsSearching(true);
    // TODO: Implement actual search functionality
    setTimeout(() => setIsSearching(false), 1000);
  };

  return (
    <div className="container mx-auto px-4 py-8">
      <div className="max-w-4xl mx-auto space-y-8">
        {/* Header */}
        <div className="text-center space-y-4">
          <h1 className="text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
            {t('navigation.search')}
          </h1>
          <p className="text-xl text-muted-foreground">
            Find articles, tutorials, and insights
          </p>
        </div>

        {/* Search Form */}
        <Card>
          <CardContent className="pt-6">
            <form onSubmit={handleSearch} className="flex gap-4">
              <div className="relative flex-1">
                <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4" />
                <Input
                  type="text"
                  placeholder={tSearch('searchPlaceholder')}
                  value={searchQuery}
                  onChange={(e) => setSearchQuery(e.target.value)}
                  className="pl-10"
                />
              </div>
              <Button type="submit" disabled={isSearching || !searchQuery.trim()}>
                {isSearching ? 'Searching...' : t('navigation.search')}
              </Button>
            </form>
          </CardContent>
        </Card>

        {/* Search Results */}
        {searchQuery && (
          <div className="space-y-6">
            <div className="flex items-center justify-between">
              <h2 className="text-2xl font-semibold">
                {tSearch('searchResults')}
              </h2>
              <span className="text-muted-foreground">
                {tSearch('foundResults', { count: 0 })}
              </span>
            </div>

            {/* No Results */}
            <Card>
              <CardContent className="text-center py-12">
                <div className="space-y-4">
                  <Search className="h-12 w-12 text-muted-foreground mx-auto" />
                  <div>
                    <h3 className="text-lg font-semibold mb-2">
                      {tSearch('noResults')} &quot;{searchQuery}&quot;
                    </h3>
                    <p className="text-muted-foreground">
                      Try different keywords or browse our categories
                    </p>
                  </div>
                </div>
              </CardContent>
            </Card>
          </div>
        )}

        {/* Popular Categories */}
        {!searchQuery && (
          <div className="space-y-6">
            <h2 className="text-2xl font-semibold">{tSearch('popularCategories')}</h2>
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
              {popularCategories.map((category) => (
                <Link key={category.id} href={`/categories/${category.slug}`}>
                  <Card className="hover:shadow-md transition-shadow cursor-pointer">
                    <CardHeader className="pb-3">
                      <div className="flex items-center justify-between">
                        <CardTitle className="text-lg">
                          {getTranslatedCategoryName(category.slug, tCategories, category.name)}
                        </CardTitle>
                        <Badge variant="secondary">{category.post_count}</Badge>
                      </div>
                      <CardDescription>
                        {getTranslatedCategoryDescription(category.slug, tCategoryDescriptions, `Explore articles about ${category.name.toLowerCase()}`)}
                      </CardDescription>
                    </CardHeader>
                  </Card>
                </Link>
              ))}
            </div>
          </div>
        )}

        {/* Recent Searches */}
        {!searchQuery && (
          <div className="space-y-6">
            <h2 className="text-2xl font-semibold">{tSearch('trendingTopics')}</h2>
            <div className="flex flex-wrap gap-2">
              {trendingTags.map((tag) => (
                <Link key={tag.id} href={`/tags/${tag.slug}`}>
                  <Badge 
                    variant="outline" 
                    className="cursor-pointer hover:bg-accent"
                  >
                    {getTranslatedTagName(tag.slug, tTags, tag.name)} ({tag.post_count})
                  </Badge>
                </Link>
              ))}
            </div>
          </div>
        )}
      </div>
    </div>
  );
}
</file>

<file path="src/app/api/comments/route.ts">
import { NextRequest, NextResponse } from 'next/server';
import { createClient } from '@/lib/supabase/server';
import { cookies } from 'next/headers';
import { 
  grantCommentDeletionRights, 
  getUserDeletableComments,
  cleanupExpiredSessions 
} from '@/lib/session';
import { hashIpAddress } from '@/lib/ip-hash';

// Rate limiting helper
async function checkRateLimit(hashedIp: string, supabase: any) {
  const now = new Date();
  
  // Get or create rate limit record
  const { data: rateLimitData, error: rateLimitError } = await supabase
    .from('comment_rate_limits')
    .select('*')
    .eq('ip_address', hashedIp)
    .single();
  
  if (rateLimitError && rateLimitError.code !== 'PGRST116') {
    throw new Error('Rate limit check failed');
  }
  
  if (!rateLimitData) {
    // First comment from this IP
    await supabase
      .from('comment_rate_limits')
      .insert({
        ip_address: hashedIp,
        comment_count: 1,
        last_comment_at: now.toISOString(),
        reset_time: new Date(now.getTime() + 60 * 60 * 1000).toISOString(), // 1 hour from now
      });
    return true;
  }
  
  // Check if reset time has passed
  if (now > new Date(rateLimitData.reset_time)) {
    // Reset the counter
    await supabase
      .from('comment_rate_limits')
      .update({
        comment_count: 1,
        last_comment_at: now.toISOString(),
        reset_time: new Date(now.getTime() + 60 * 60 * 1000).toISOString(),
      })
      .eq('ip_address', hashedIp);
    return true;
  }
  
  // Check if under limit (5 comments per hour)
  if (rateLimitData.comment_count >= 5) {
    return false;
  }
  
  // Update counter
  await supabase
    .from('comment_rate_limits')
    .update({
      comment_count: rateLimitData.comment_count + 1,
      last_comment_at: now.toISOString(),
    })
    .eq('ip_address', ip);
    
  return true;
}

// GET - Fetch comments for a post
export async function GET(request: NextRequest) {
  try {
    const { searchParams } = new URL(request.url);
    const postId = searchParams.get('postId');
    const page = parseInt(searchParams.get('page') || '1');
    const limit = parseInt(searchParams.get('limit') || '10');
    
    if (!postId) {
      return NextResponse.json(
        { error: 'Post ID is required' },
        { status: 400 }
      );
    }
    
    const supabase = await createClient();
    
    // Get parent comments with pagination
    const { data: parentComments, error, count } = await supabase
      .from('comments')
      .select('*', { count: 'exact' })
      .eq('post_id', postId)
      .is('deleted_at', null)
      .is('parent_id', null)
      .order('created_at', { ascending: false })
      .range((page - 1) * limit, page * limit - 1);

    if (error) {
      console.error('Error fetching comments:', error);
      return NextResponse.json(
        { error: 'Failed to fetch comments' },
        { status: 500 }
      );
    }

    // Get all replies for the parent comments
    const parentIds = parentComments?.map(comment => comment.id) || [];
    let replies = [];
    
    if (parentIds.length > 0) {
      const { data: repliesData, error: repliesError } = await supabase
        .from('comments')
        .select('*')
        .eq('post_id', postId)
        .is('deleted_at', null)
        .in('parent_id', parentIds)
        .order('created_at', { ascending: true }); // Replies in chronological order
      
      if (repliesError) {
        console.error('Error fetching replies:', repliesError);
        replies = [];
      } else {
        replies = repliesData || [];
      }
    }

    // Organize comments into hierarchy
    const comments = (parentComments || []).map(parentComment => ({
      ...parentComment,
      replies: replies.filter(reply => reply.parent_id === parentComment.id)
    }));

    // Get user's deletable comments
    const userDeletableComments = await getUserDeletableComments(postId);
    
    // Clean up expired sessions (optional, can be done periodically)
    await cleanupExpiredSessions();
    
    return NextResponse.json({
      comments: comments || [],
      userDeletableComments,
      pagination: {
        page,
        limit,
        total: count || 0,
        totalPages: Math.ceil((count || 0) / limit),
      },
    });
  } catch (error) {
    console.error('Error in GET /api/comments:', error);
    return NextResponse.json(
      { error: 'Internal server error' },
      { status: 500 }
    );
  }
}

// POST - Create a new comment
export async function POST(request: NextRequest) {
  try {
    const { postId, content, authorName, captchaSessionId, captchaAnswer, parentId } = await request.json();
    
    // Validation
    if (!postId || !content || !authorName || !captchaSessionId || captchaAnswer === undefined) {
      return NextResponse.json(
        { error: 'All fields are required' },
        { status: 400 }
      );
    }
    
    // Verify CAPTCHA
    const cookieStore = await cookies();
    const storedData = cookieStore.get(`captcha_${captchaSessionId}`);
    
    if (!storedData) {
      return NextResponse.json(
        { error: 'CAPTCHA session not found or expired' },
        { status: 400 }
      );
    }
    
    const { answer, expires, verified } = JSON.parse(storedData.value);
    
    if (Date.now() > expires) {
      cookieStore.delete(`captcha_${captchaSessionId}`);
      return NextResponse.json(
        { error: 'CAPTCHA session expired' },
        { status: 400 }
      );
    }
    
    // Check if CAPTCHA was verified
    if (!verified) {
      return NextResponse.json(
        { error: 'CAPTCHA not verified. Please solve the math problem first.' },
        { status: 400 }
      );
    }
    
    if (parseInt(captchaAnswer) !== answer) {
      return NextResponse.json(
        { error: 'Incorrect CAPTCHA answer' },
        { status: 400 }
      );
    }
    
    // Clean up CAPTCHA cookie
    cookieStore.delete(`captcha_${captchaSessionId}`);
    
    // Get client IP
    const ip = request.headers.get('x-forwarded-for') || 
               request.headers.get('x-real-ip') || 
               '127.0.0.1';
    const hashedIp = hashIpAddress(ip);
    
    const supabase = await createClient();
    
    // Check rate limit
    const canPost = await checkRateLimit(hashedIp, supabase);
    if (!canPost) {
      return NextResponse.json(
        { error: 'Rate limit exceeded. Please wait before posting again.' },
        { status: 429 }
      );
    }
    
    // Validate content length
    if (content.length < 5 || content.length > 500) {
      return NextResponse.json(
        { error: 'Comment must be between 5 and 500 characters' },
        { status: 400 }
      );
    }
    
    // Validate author name length
    if (authorName.length < 2 || authorName.length > 30) {
      return NextResponse.json(
        { error: 'Author name must be between 2 and 30 characters' },
        { status: 400 }
      );
    }
    
    // Check if post exists
    const { data: post, error: postError } = await supabase
      .from('posts')
      .select('id')
      .eq('id', postId)
      .eq('status', 'published')
      .is('deleted_at', null)
      .single();
    
    if (postError || !post) {
      return NextResponse.json(
        { error: 'Post not found' },
        { status: 404 }
      );
    }
    
    // If parentId is provided, verify the parent comment exists
    if (parentId) {
      const { data: parentComment, error: parentError } = await supabase
        .from('comments')
        .select('id')
        .eq('id', parentId)
        .eq('post_id', postId)
        .is('deleted_at', null)
        .single();
      
      if (parentError || !parentComment) {
        return NextResponse.json(
          { error: 'Parent comment not found' },
          { status: 400 }
        );
      }
    }

    // Create comment
    const { data: comment, error: commentError } = await supabase
      .from('comments')
      .insert({
        post_id: postId,
        content: content.trim(),
        author_name: authorName.trim(),
        ip_address: hashedIp,
        parent_id: parentId || null,
      })
      .select()
      .single();
    
    if (commentError) {
      console.error('Error creating comment:', commentError);
      return NextResponse.json(
        { error: 'Failed to create comment' },
        { status: 500 }
      );
    }

    // Grant deletion rights to the user who created the comment
    try {
      await grantCommentDeletionRights(comment.id);
    } catch (error) {
      console.error('Error granting deletion rights:', error);
      // This is not a fatal error, comment was created successfully
    }
    
    return NextResponse.json({
      success: true,
      comment,
    });
  } catch (error) {
    console.error('Error in POST /api/comments:', error);
    return NextResponse.json(
      { error: 'Internal server error' },
      { status: 500 }
    );
  }
}
</file>

<file path="src/app/providers.tsx">
// In Next.js, this file would be called: app/providers.tsx
'use client';

// Since QueryClientProvider relies on useContext under the hood, we have to put 'use client' on top
import {
  isServer,
  QueryClient,
  QueryClientProvider,
} from '@tanstack/react-query';
import { ThemeProvider } from '@/components/theme/theme-provider';

function makeQueryClient() {
  return new QueryClient({
    defaultOptions: {
      queries: {
        // With SSR, we usually want to set some default staleTime
        // above 0 to avoid refetching immediately on the client
        staleTime: 60 * 1000,
      },
    },
  });
}

let browserQueryClient: QueryClient | undefined = undefined;

function getQueryClient() {
  if (isServer) {
    // Server: always make a new query client
    return makeQueryClient();
  } else {
    // Browser: make a new query client if we don't already have one
    // This is very important, so we don't re-make a new client if React
    // suspends during the initial render. This may not be needed if we
    // have a suspense boundary BELOW the creation of the query client
    if (!browserQueryClient) browserQueryClient = makeQueryClient();
    return browserQueryClient;
  }
}

export default function Providers({ children }: { children: React.ReactNode }) {
  // NOTE: Avoid useState when initializing the query client if you don't
  //       have a suspense boundary between this and the code that may
  //       suspend because React will throw away the client on the initial
  //       render if it suspends and there is no boundary
  const queryClient = getQueryClient();

  return (
    <ThemeProvider
      attribute="class"
      defaultTheme="system"
      enableSystem
      disableTransitionOnChange
    >
      <QueryClientProvider client={queryClient}>{children}</QueryClientProvider>
    </ThemeProvider>
  );
}
</file>

<file path="src/app/rss/route.ts">
import { createClient } from '@/lib/supabase/server';
import { NextResponse } from 'next/server';

export async function GET() {
  const supabase = await createClient();
  const baseUrl = process.env.NEXT_PUBLIC_SITE_URL || 'http://localhost:3000';

  const { data: posts } = await supabase
    .from('posts')
    .select(`
      *,
      category:categories(name, slug),
      tags:post_tags(tag:tags(name, slug))
    `)
    .eq('status', 'published')
    .order('published_at', { ascending: false })
    .limit(20);

  const rss = `<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Dev-eloper</title>
    <description>Dev-eloper - A modern blog platform built with Next.js and Supabase</description>
    <link>${baseUrl}</link>
    <language>en-us</language>
    <lastBuildDate>${new Date().toUTCString()}</lastBuildDate>
    <atom:link href="${baseUrl}/rss" rel="self" type="application/rss+xml" />
    ${posts?.map(post => `
    <item>
      <title><![CDATA[${post.title}]]></title>
      <description><![CDATA[${post.content.replace(/[#*`]/g, '').slice(0, 300)}...]]></description>
      <link>${baseUrl}/posts/${post.slug}</link>
      <guid>${baseUrl}/posts/${post.slug}</guid>
      <pubDate>${new Date(post.published_at || post.created_at).toUTCString()}</pubDate>
      ${post.category ? `<category>${post.category.name}</category>` : ''}
      ${post.cover_image_path ? `<enclosure url="${post.cover_image_path}" type="image/jpeg" />` : ''}
    </item>
    `).join('')}
  </channel>
</rss>`;

  return new NextResponse(rss, {
    headers: {
      'Content-Type': 'application/rss+xml',
      'Cache-Control': 'public, max-age=3600, stale-while-revalidate=86400',
    },
  });
}
</file>

<file path="src/components/admin/post-delete-button.tsx">
'use client';

import { useState } from 'react';
import { useRouter } from 'next/navigation';
import { Button } from '@/components/ui/button';
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogTitle,
  DialogTrigger,
} from '@/components/ui/dialog';
import { useToast } from '@/hooks/use-toast';
import { createClient } from '@/lib/supabase/client';
import { Trash2, Loader2 } from 'lucide-react';

interface PostDeleteButtonProps {
  postId: string;
  postTitle: string;
}

export function PostDeleteButton({ postId, postTitle }: PostDeleteButtonProps) {
  const [isOpen, setIsOpen] = useState(false);
  const [isDeleting, setIsDeleting] = useState(false);
  const router = useRouter();
  const { toast } = useToast();
  const supabase = createClient();

  const handleDelete = async () => {
    setIsDeleting(true);

    try {
      const { error } = await supabase
        .from('posts')
        .update({ deleted_at: new Date().toISOString() })
        .eq('id', postId);

      if (error) throw error;

      toast({
        description: 'Post deleted successfully!',
      });

      setIsOpen(false);
      router.refresh();
    } catch (error) {
      console.error('Error deleting post:', error);
      toast({
        variant: 'destructive',
        description: 'Failed to delete post. Please try again.',
      });
    } finally {
      setIsDeleting(false);
    }
  };

  return (
    <Dialog open={isOpen} onOpenChange={setIsOpen}>
      <DialogTrigger asChild>
        <Button variant="ghost" size="sm">
          <Trash2 className="h-4 w-4" />
        </Button>
      </DialogTrigger>
      <DialogContent>
        <DialogHeader>
          <DialogTitle>Delete Post</DialogTitle>
          <DialogDescription>
            Are you sure you want to delete &quot;{postTitle}&quot;? This action cannot be undone.
          </DialogDescription>
        </DialogHeader>
        <DialogFooter>
          <Button
            variant="outline"
            onClick={() => setIsOpen(false)}
            disabled={isDeleting}
          >
            Cancel
          </Button>
          <Button
            variant="destructive"
            onClick={handleDelete}
            disabled={isDeleting}
          >
            {isDeleting ? (
              <>
                <Loader2 className="mr-2 h-4 w-4 animate-spin" />
                Deleting...
              </>
            ) : (
              <>
                <Trash2 className="mr-2 h-4 w-4" />
                Delete
              </>
            )}
          </Button>
        </DialogFooter>
      </DialogContent>
    </Dialog>
  );
}
</file>

<file path="src/components/auth/mfa-setup.tsx">
'use client';

import { useState } from 'react';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Alert, AlertDescription } from '@/components/ui/alert';
import { Badge } from '@/components/ui/badge';
import { QrCode, Shield, Smartphone, Copy, CheckCircle } from 'lucide-react';
import { createClient } from '@/lib/supabase/client';
import { useToast } from '@/hooks/use-toast';

interface MFASetupProps {
  onComplete?: () => void;
}

export function MFASetup({ onComplete }: MFASetupProps) {
  const [step, setStep] = useState<'setup' | 'verify' | 'complete'>('setup');
  const [qrCode, setQrCode] = useState<string>('');
  const [secret, setSecret] = useState<string>('');
  const [verificationCode, setVerificationCode] = useState<string>('');
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string>('');
  const { toast } = useToast();
  const supabase = createClient();

  const setupMFA = async () => {
    setLoading(true);
    setError('');
    
    try {
      const { data, error } = await supabase.auth.mfa.enroll({ 
        factorType: 'totp',
        friendlyName: 'Dev-eloper Admin App'
      });
      
      if (error) throw error;
      
      if (data) {
        setQrCode(data.totp.qr_code);
        setSecret(data.totp.secret);
        setStep('verify');
      }
    } catch (err) {
      setError(err instanceof Error ? err.message : 'MFA ì„¤ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    } finally {
      setLoading(false);
    }
  };

  const verifyMFA = async () => {
    if (!verificationCode || verificationCode.length !== 6) {
      setError('6ìë¦¬ ì¸ì¦ ì½”ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
      return;
    }

    setLoading(true);
    setError('');
    
    try {
      const { data, error } = await supabase.auth.mfa.verify({
        factorId: secret,
        challengeId: secret,
        code: verificationCode
      });
      
      if (error) throw error;
      
      setStep('complete');
      toast({
        title: 'ë‹¤ë‹¨ê³„ ì¸ì¦ ì„¤ì • ì™„ë£Œ',
        description: 'ì´ì œ ë¡œê·¸ì¸í•  ë•Œ ì¸ì¦ ì½”ë“œê°€ í•„ìš”í•©ë‹ˆë‹¤.',
      });
      
      onComplete?.();
    } catch (err) {
      setError(err instanceof Error ? err.message : 'ì¸ì¦ ì½”ë“œ í™•ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    } finally {
      setLoading(false);
    }
  };

  const copySecret = () => {
    navigator.clipboard.writeText(secret);
    toast({
      title: 'ë³µì‚¬ ì™„ë£Œ',
      description: 'ì‹œí¬ë¦¿ í‚¤ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.',
    });
  };

  if (step === 'setup') {
    return (
      <Card className="w-full max-w-md mx-auto">
        <CardHeader className="text-center">
          <div className="mx-auto w-16 h-16 rounded-full bg-blue-100 flex items-center justify-center mb-4">
            <Shield className="w-8 h-8 text-blue-600" />
          </div>
          <CardTitle>ë‹¤ë‹¨ê³„ ì¸ì¦ ì„¤ì •</CardTitle>
          <CardDescription>
            ê³„ì • ë³´ì•ˆì„ ê°•í™”í•˜ê¸° ìœ„í•´ MFAë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
          </CardDescription>
        </CardHeader>
        <CardContent className="space-y-4">
          <div className="space-y-2">
            <h4 className="font-medium">í•„ìš”í•œ ì•±:</h4>
            <div className="flex flex-wrap gap-2">
              <Badge variant="outline">Google Authenticator</Badge>
              <Badge variant="outline">Authy</Badge>
              <Badge variant="outline">Microsoft Authenticator</Badge>
            </div>
          </div>
          
          <div className="space-y-2">
            <h4 className="font-medium">ì„¤ì • ê³¼ì •:</h4>
            <ol className="text-sm text-muted-foreground space-y-1">
              <li>1. ì¸ì¦ ì•±ì—ì„œ QR ì½”ë“œ ìŠ¤ìº”</li>
              <li>2. ìƒì„±ëœ 6ìë¦¬ ì½”ë“œ ì…ë ¥</li>
              <li>3. MFA ì„¤ì • ì™„ë£Œ</li>
            </ol>
          </div>

          {error && (
            <Alert variant="destructive">
              <AlertDescription>{error}</AlertDescription>
            </Alert>
          )}

          <Button 
            onClick={setupMFA} 
            disabled={loading}
            className="w-full"
          >
            <Smartphone className="mr-2 h-4 w-4" />
            {loading ? 'MFA ì„¤ì • ì¤‘...' : 'MFA ì„¤ì • ì‹œì‘'}
          </Button>
        </CardContent>
      </Card>
    );
  }

  if (step === 'verify') {
    return (
      <Card className="w-full max-w-md mx-auto">
        <CardHeader className="text-center">
          <div className="mx-auto w-16 h-16 rounded-full bg-green-100 flex items-center justify-center mb-4">
            <QrCode className="w-8 h-8 text-green-600" />
          </div>
          <CardTitle>QR ì½”ë“œ ìŠ¤ìº”</CardTitle>
          <CardDescription>
            ì¸ì¦ ì•±ì—ì„œ QR ì½”ë“œë¥¼ ìŠ¤ìº”í•˜ê³  ìƒì„±ëœ ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”.
          </CardDescription>
        </CardHeader>
        <CardContent className="space-y-4">
          {qrCode && (
            <div className="flex justify-center">
              <div 
                className="p-4 bg-white rounded-lg border"
                dangerouslySetInnerHTML={{ __html: qrCode }}
              />
            </div>
          )}
          
          <div className="space-y-2">
            <Label className="text-sm font-medium">ìˆ˜ë™ ì…ë ¥ìš© ì‹œí¬ë¦¿ í‚¤</Label>
            <div className="flex gap-2">
              <Input 
                value={secret} 
                readOnly 
                className="font-mono text-xs"
              />
              <Button 
                variant="outline" 
                size="sm"
                onClick={copySecret}
              >
                <Copy className="h-4 w-4" />
              </Button>
            </div>
          </div>

          <div className="space-y-2">
            <Label htmlFor="verification-code">ì¸ì¦ ì½”ë“œ (6ìë¦¬)</Label>
            <Input
              id="verification-code"
              type="text"
              placeholder="000000"
              value={verificationCode}
              onChange={(e) => setVerificationCode(e.target.value.replace(/\D/g, '').slice(0, 6))}
              className="text-center text-lg font-mono"
              maxLength={6}
            />
          </div>

          {error && (
            <Alert variant="destructive">
              <AlertDescription>{error}</AlertDescription>
            </Alert>
          )}

          <div className="flex gap-2">
            <Button 
              variant="outline" 
              onClick={() => setStep('setup')}
              disabled={loading}
            >
              ì´ì „
            </Button>
            <Button 
              onClick={verifyMFA}
              disabled={loading || verificationCode.length !== 6}
              className="flex-1"
            >
              {loading ? 'í™•ì¸ ì¤‘...' : 'ì¸ì¦ ì™„ë£Œ'}
            </Button>
          </div>
        </CardContent>
      </Card>
    );
  }

  return (
    <Card className="w-full max-w-md mx-auto">
      <CardHeader className="text-center">
        <div className="mx-auto w-16 h-16 rounded-full bg-green-100 flex items-center justify-center mb-4">
          <CheckCircle className="w-8 h-8 text-green-600" />
        </div>
        <CardTitle>MFA ì„¤ì • ì™„ë£Œ</CardTitle>
        <CardDescription>
          ë‹¤ë‹¨ê³„ ì¸ì¦ì´ ì„±ê³µì ìœ¼ë¡œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.
        </CardDescription>
      </CardHeader>
      <CardContent className="space-y-4">
        <Alert>
          <Shield className="h-4 w-4" />
          <AlertDescription>
            ì´ì œ ë¡œê·¸ì¸í•  ë•Œ ì¸ì¦ ì•±ì—ì„œ ìƒì„±ëœ 6ìë¦¬ ì½”ë“œë¥¼ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.
          </AlertDescription>
        </Alert>
        
        <div className="space-y-2">
          <h4 className="font-medium text-sm">ì¤‘ìš” ì‚¬í•­:</h4>
          <ul className="text-sm text-muted-foreground space-y-1">
            <li>â€¢ ì¸ì¦ ì•±ì„ ì‚­ì œí•˜ì§€ ë§ˆì„¸ìš”</li>
            <li>â€¢ ì‹œí¬ë¦¿ í‚¤ë¥¼ ì•ˆì „í•œ ê³³ì— ë³´ê´€í•˜ì„¸ìš”</li>
            <li>â€¢ ìƒˆ ê¸°ê¸°ì—ì„œ ì•±ì„ ë‹¤ì‹œ ì„¤ì •í•  ë•Œ í•„ìš”í•©ë‹ˆë‹¤</li>
          </ul>
        </div>

        <Button 
          onClick={onComplete}
          className="w-full"
        >
          ì™„ë£Œ
        </Button>
      </CardContent>
    </Card>
  );
}
</file>

<file path="src/components/blog/post-footer.tsx">
'use client';

import { Button } from '@/components/ui/button';
import { Separator } from '@/components/ui/separator';
import { useTranslations } from 'next-intl';
import { ArrowLeft, Share2 } from 'lucide-react';
import { Link } from '@/i18n/routing';
import { useAuth } from '@/hooks/use-auth';
import { AdminActions } from '@/components/blog/admin-actions';
import type { PostWithRelations } from '@/lib/blog';

interface PostFooterProps {
  post: PostWithRelations;
}

export function PostFooter({ post }: PostFooterProps) {
  const { isAdmin } = useAuth();
  const t = useTranslations('blog');
  const tCommon = useTranslations('common');
  
  const handleShare = async () => {
    if (navigator.share) {
      try {
        await navigator.share({
          title: post.title,
          text: post.title,
          url: window.location.href,
        });
      } catch (error) {
        // User cancelled sharing or sharing failed
        console.log('Sharing failed or was cancelled');
      }
    } else {
      // Fallback: copy to clipboard
      await navigator.clipboard.writeText(window.location.href);
      // You could show a toast notification here
    }
  };

  return (
    <footer className="space-y-8">
      <Separator />
      
      {/* Actions */}
      <div className="flex items-center justify-between">
        <Button variant="outline" asChild>
          <Link href="/posts">
            <ArrowLeft className="mr-2 h-4 w-4" />
            {t('backToPosts')}
          </Link>
        </Button>
        
        <div className="flex items-center space-x-2">
          {isAdmin && <AdminActions post={post} />}
          <Button variant="outline" onClick={handleShare}>
            <Share2 className="mr-2 h-4 w-4" />
            {tCommon('share')}
          </Button>
        </div>
      </div>

      {/* Category and Tags Info */}
      <div className="text-center text-sm text-muted-foreground">
        <p>
          {t('filedUnder')}{' '}
          {post.category && (
            <Link 
              href={`/categories/${post.category.slug}`}
              className="hover:text-foreground transition-colors"
            >
              {post.category.name}
            </Link>
          )}
          {post.tags && post.tags.length > 0 && (
            <>
              {' '}{t('withTags')}{' '}
              {post.tags.map((tag, index) => (
                <span key={tag.id}>
                  <Link 
                    href={`/tags/${tag.slug}`}
                    className="hover:text-foreground transition-colors"
                  >
                    {tag.name}
                  </Link>
                  {index < post.tags!.length - 1 && ', '}
                </span>
              ))}
            </>
          )}
        </p>
      </div>
    </footer>
  );
}
</file>

<file path="src/components/blog/post-header.tsx">
'use client';

import { format } from 'date-fns';
import { Badge } from '@/components/ui/badge';
import { useTranslations } from 'next-intl';
import { CalendarDays, Clock, User } from 'lucide-react';
import { Link } from '@/i18n/routing';
import type { PostWithRelations } from '@/lib/blog';
import { LazyImage } from '@/components/ui/lazy-image';

interface PostHeaderProps {
  post: PostWithRelations;
}

export function PostHeader({ post }: PostHeaderProps) {
  const t = useTranslations('blog');
  
  const publishedDate = post.published_at 
    ? new Date(post.published_at) 
    : new Date(post.created_at);

  // Estimate reading time (average 200 words per minute)
  const textContent = post.content.replace(/<[^>]*>/g, ''); // Remove HTML tags
  const wordCount = textContent.split(/\s+/).length;
  const readingTime = Math.ceil(wordCount / 200);

  return (
    <header className="space-y-6">
      {/* Category */}
      {post.category && (
        <div>
          <Link href={`/categories/${post.category.slug}`}>
            <Badge variant="secondary" className="hover:bg-secondary/80">
              {post.category.name}
            </Badge>
          </Link>
        </div>
      )}

      {/* Title */}
      <h1 className="text-3xl font-bold tracking-tight sm:text-4xl md:text-5xl">
        {post.title}
      </h1>

      {/* Content Preview */}
      {post.content && (
        <p className="text-xl text-muted-foreground leading-relaxed">
          {post.content.replace(/<[^>]*>/g, '').substring(0, 200) + (post.content.replace(/<[^>]*>/g, '').length > 200 ? '...' : '')}
        </p>
      )}

      {/* Cover Image */}
      {post.cover_image_path && (
        <div className="aspect-[16/9] overflow-hidden rounded-lg">
          <LazyImage
            src={post.cover_image_path}
            alt={post.title}
            className="h-full w-full object-cover"
            width={800}
            height={450}
            priority
          />
        </div>
      )}

      {/* Meta Information */}
      <div className="flex flex-wrap items-center gap-4 text-sm text-muted-foreground">
        <div className="flex items-center space-x-1">
          <CalendarDays className="h-4 w-4" />
          <span>{format(publishedDate, 'MMMM dd, yyyy')}</span>
        </div>
        <div className="flex items-center space-x-1">
          <Clock className="h-4 w-4" />
          <span>{t('readingTime', { minutes: readingTime })}</span>
        </div>
      </div>

      {/* Tags */}
      {post.tags && post.tags.length > 0 && (
        <div className="flex flex-wrap gap-2">
          {post.tags.map((tag) => (
            <Link key={tag.id} href={`/tags/${tag.slug}`}>
              <Badge variant="outline" className="hover:bg-accent">
                {tag.name}
              </Badge>
            </Link>
          ))}
        </div>
      )}
    </header>
  );
}
</file>

<file path="src/components/no-ssr.tsx">
'use client';

import { useEffect, useState } from 'react';

interface NoSSRProps {
  children: React.ReactNode;
  fallback?: React.ReactNode;
}

export function NoSSR({ children, fallback }: NoSSRProps) {
  const [hasMounted, setHasMounted] = useState(false);

  useEffect(() => {
    setHasMounted(true);
  }, []);

  if (!hasMounted) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        {fallback || (
          <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
        )}
      </div>
    );
  }

  return <>{children}</>;
}
</file>

<file path="src/components/search/search-input.tsx">
'use client';

import { useState, useEffect, useRef } from 'react';
import { useRouter } from 'next/navigation';
import { Input } from '@/components/ui/input';
import { Button } from '@/components/ui/button';
import { Card, CardContent } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';
import { Search, X, Clock, TrendingUp } from 'lucide-react';
import { searchPosts } from '@/lib/blog';
import { useDebounce } from 'react-use';
import type { PostWithRelations } from '@/lib/blog';

interface SearchInputProps {
  placeholder?: string;
  className?: string;
  autoFocus?: boolean;
}

export function SearchInput({ 
  placeholder = "Search posts...", 
  className = "",
  autoFocus = false 
}: SearchInputProps) {
  const [query, setQuery] = useState('');
  const [isOpen, setIsOpen] = useState(false);
  const [results, setResults] = useState<PostWithRelations[]>([]);
  const [loading, setLoading] = useState(false);
  const [recentSearches, setRecentSearches] = useState<string[]>([]);
  
  const router = useRouter();
  const inputRef = useRef<HTMLInputElement>(null);
  const dropdownRef = useRef<HTMLDivElement>(null);

  // Debounce search query
  useDebounce(
    async () => {
      if (query.trim() && query.length >= 2) {
        setLoading(true);
        try {
          const { posts } = await searchPosts(query, 5); // Limit to 5 results for dropdown
          setResults(posts);
        } catch (error) {
          console.error('Search error:', error);
          setResults([]);
        } finally {
          setLoading(false);
        }
      } else {
        setResults([]);
      }
    },
    300,
    [query]
  );

  // Load recent searches from localStorage
  useEffect(() => {
    const stored = localStorage.getItem('recent-searches');
    if (stored) {
      try {
        setRecentSearches(JSON.parse(stored));
      } catch {
        setRecentSearches([]);
      }
    }
  }, []);

  // Handle click outside to close dropdown
  useEffect(() => {
    const handleClickOutside = (event: MouseEvent) => {
      if (
        dropdownRef.current &&
        !dropdownRef.current.contains(event.target as Node) &&
        !inputRef.current?.contains(event.target as Node)
      ) {
        setIsOpen(false);
      }
    };

    document.addEventListener('mousedown', handleClickOutside);
    return () => document.removeEventListener('mousedown', handleClickOutside);
  }, []);

  const handleSearch = (searchQuery: string) => {
    if (!searchQuery.trim()) return;

    // Add to recent searches
    const updated = [searchQuery, ...recentSearches.filter(s => s !== searchQuery)].slice(0, 5);
    setRecentSearches(updated);
    localStorage.setItem('recent-searches', JSON.stringify(updated));

    // Navigate to search page
    router.push(`/search?q=${encodeURIComponent(searchQuery)}`);
    setIsOpen(false);
    setQuery('');
  };

  const handleKeyDown = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter') {
      handleSearch(query);
    } else if (e.key === 'Escape') {
      setIsOpen(false);
    }
  };

  const clearRecentSearches = () => {
    setRecentSearches([]);
    localStorage.removeItem('recent-searches');
  };

  const showDropdown = isOpen && (query.length >= 2 || recentSearches.length > 0);

  return (
    <div className={`relative ${className}`}>
      <div className="relative">
        <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground" />
        <Input
          ref={inputRef}
          type="text"
          placeholder={placeholder}
          value={query}
          onChange={(e) => setQuery(e.target.value)}
          onFocus={() => setIsOpen(true)}
          onKeyDown={handleKeyDown}
          className="pl-10 pr-10"
          autoFocus={autoFocus}
        />
        {query && (
          <Button
            variant="ghost"
            size="sm"
            className="absolute right-1 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0"
            onClick={() => {
              setQuery('');
              setResults([]);
              inputRef.current?.focus();
            }}
          >
            <X className="h-3 w-3" />
          </Button>
        )}
      </div>

      {/* Search Dropdown */}
      {showDropdown && (
        <Card className="absolute top-full left-0 right-0 mt-1 z-50 max-h-96 overflow-hidden" ref={dropdownRef}>
          <CardContent className="p-0">
            {/* Loading */}
            {loading && (
              <div className="p-4 text-center text-sm text-muted-foreground">
                Searching...
              </div>
            )}

            {/* Search Results */}
            {!loading && query.length >= 2 && results.length > 0 && (
              <div>
                <div className="p-3 border-b bg-muted/50">
                  <h4 className="font-medium text-sm">Search Results</h4>
                </div>
                <div className="max-h-64 overflow-y-auto">
                  {results.map((post: any) => (
                    <button
                      key={post.id}
                      className="w-full p-3 text-left hover:bg-muted/50 border-b last:border-b-0 transition-colors"
                      onClick={() => {
                        router.push(`/posts/${post.slug}`);
                        setIsOpen(false);
                        setQuery('');
                      }}
                    >
                      <div className="font-medium text-sm line-clamp-1">{post.title}</div>
                      <div className="text-xs text-muted-foreground line-clamp-2 mt-1">
                        {post.content.replace(/[#*`]/g, '').slice(0, 100)}...
                      </div>
                      <div className="flex items-center gap-2 mt-2">
                        {post.category && (
                          <Badge variant="secondary" className="text-xs">
                            {post.category.name}
                          </Badge>
                        )}
                        {post.tags?.slice(0, 2).map((tag) => (
                          <Badge key={tag.id} variant="outline" className="text-xs">
                            {tag.name}
                          </Badge>
                        ))}
                      </div>
                    </button>
                  ))}
                </div>
                <div className="p-3 border-t bg-muted/25">
                  <Button
                    variant="ghost"
                    size="sm"
                    className="w-full justify-start text-xs"
                    onClick={() => handleSearch(query)}
                  >
                    <Search className="mr-2 h-3 w-3" />
                    View all results for &quot;{query}&quot;
                  </Button>
                </div>
              </div>
            )}

            {/* No Results */}
            {!loading && query.length >= 2 && results.length === 0 && (
              <div className="p-4 text-center text-sm text-muted-foreground">
                No results found for &quot;{query}&quot;
              </div>
            )}

            {/* Recent Searches */}
            {!loading && query.length < 2 && recentSearches.length > 0 && (
              <div>
                <div className="flex items-center justify-between p-3 border-b bg-muted/50">
                  <h4 className="font-medium text-sm flex items-center gap-2">
                    <Clock className="h-3 w-3" />
                    Recent Searches
                  </h4>
                  <Button
                    variant="ghost"
                    size="sm"
                    className="text-xs h-auto p-1"
                    onClick={clearRecentSearches}
                  >
                    Clear
                  </Button>
                </div>
                <div className="max-h-32 overflow-y-auto">
                  {recentSearches.map((search, index) => (
                    <button
                      key={index}
                      className="w-full p-3 text-left hover:bg-muted/50 border-b last:border-b-0 transition-colors"
                      onClick={() => handleSearch(search)}
                    >
                      <div className="text-sm flex items-center gap-2">
                        <Clock className="h-3 w-3 text-muted-foreground" />
                        {search}
                      </div>
                    </button>
                  ))}
                </div>
              </div>
            )}
          </CardContent>
        </Card>
      )}
    </div>
  );
}
</file>

<file path="src/components/search/search-results.tsx">
'use client';

import { PostCard } from '@/components/blog/post-card';
import { Button } from '@/components/ui/button';
import { ArrowLeft, ArrowRight, Search } from 'lucide-react';
import Link from 'next/link';
import type { PostWithRelations } from '@/lib/blog';

interface SearchResultsProps {
  posts: PostWithRelations[];
  total: number;
  currentPage: number;
  totalPages: number;
  query: string;
  searchParams: {
    q?: string;
    category?: string;
    tag?: string;
    page?: string;
  };
}

export function SearchResults({ 
  posts, 
  total, 
  currentPage, 
  totalPages, 
  query, 
  searchParams 
}: SearchResultsProps) {
  const hasNextPage = currentPage < totalPages;
  const hasPrevPage = currentPage > 1;

  // Build URL with current search params
  const buildUrl = (page: number) => {
    const params = new URLSearchParams();
    if (searchParams.q) params.set('q', searchParams.q);
    if (searchParams.category) params.set('category', searchParams.category);
    if (searchParams.tag) params.set('tag', searchParams.tag);
    if (page > 1) params.set('page', page.toString());
    
    return `/search${params.toString() ? `?${params.toString()}` : ''}`;
  };

  if (!query) {
    return (
      <div className="flex flex-col items-center justify-center py-12 text-center">
        <Search className="h-12 w-12 text-muted-foreground mb-4" />
        <h3 className="text-lg font-semibold mb-2">Start searching</h3>
        <p className="text-muted-foreground max-w-sm">
          Enter a search term to find posts about web development, programming, and technology.
        </p>
      </div>
    );
  }

  if (posts.length === 0) {
    return (
      <div className="flex flex-col items-center justify-center py-12 text-center">
        <Search className="h-12 w-12 text-muted-foreground mb-4" />
        <h3 className="text-lg font-semibold mb-2">No results found</h3>
        <p className="text-muted-foreground max-w-sm">
          We couldn&apos;t find any posts matching &quot;{query}&quot;. Try different keywords or browse our categories.
        </p>
        <div className="flex gap-2 mt-4">
          <Button variant="outline" asChild>
            <Link href="/posts">Browse All Posts</Link>
          </Button>
          <Button variant="outline" asChild>
            <Link href="/categories">Browse Categories</Link>
          </Button>
        </div>
      </div>
    );
  }

  return (
    <div className="space-y-6">
      {/* Results Info */}
      <div className="flex items-center justify-between">
        <p className="text-sm text-muted-foreground">
          Showing {posts.length} of {total} results
        </p>
        {totalPages > 1 && (
          <p className="text-sm text-muted-foreground">
            Page {currentPage} of {totalPages}
          </p>
        )}
      </div>

      {/* Posts Grid */}
      <div className="grid gap-6 md:grid-cols-2 xl:grid-cols-3">
        {posts.map((post: any) => (
          <PostCard key={post.id} post={post} />
        ))}
      </div>

      {/* Pagination */}
      {totalPages > 1 && (
        <div className="flex items-center justify-center space-x-2 pt-8">
          <Button
            variant="outline"
            asChild
            disabled={!hasPrevPage}
          >
            {hasPrevPage ? (
              <Link href={buildUrl(currentPage - 1)}>
                <ArrowLeft className="mr-2 h-4 w-4" />
                Previous
              </Link>
            ) : (
              <span className="flex items-center">
                <ArrowLeft className="mr-2 h-4 w-4" />
                Previous
              </span>
            )}
          </Button>

          <div className="flex items-center space-x-1">
            {Array.from({ length: Math.min(totalPages, 5) }, (_, i) => {
              let page: number;
              if (totalPages <= 5) {
                page = i + 1;
              } else if (currentPage <= 3) {
                page = i + 1;
              } else if (currentPage >= totalPages - 2) {
                page = totalPages - 4 + i;
              } else {
                page = currentPage - 2 + i;
              }

              return (
                <Button
                  key={page}
                  variant={page === currentPage ? 'default' : 'outline'}
                  size="sm"
                  asChild={page !== currentPage}
                >
                  {page === currentPage ? (
                    <span>{page}</span>
                  ) : (
                    <Link href={buildUrl(page)}>
                      {page}
                    </Link>
                  )}
                </Button>
              );
            })}
          </div>

          <Button
            variant="outline"
            asChild
            disabled={!hasNextPage}
          >
            {hasNextPage ? (
              <Link href={buildUrl(currentPage + 1)}>
                Next
                <ArrowRight className="ml-2 h-4 w-4" />
              </Link>
            ) : (
              <span className="flex items-center">
                Next
                <ArrowRight className="ml-2 h-4 w-4" />
              </span>
            )}
          </Button>
        </div>
      )}
    </div>
  );
}
</file>

<file path="src/components/shared/footer.tsx">
'use client';

import { Github, Twitter, Rss } from 'lucide-react';
import { Link } from '@/i18n/routing';
import { useTranslations } from 'next-intl';

export function Footer() {
  const t = useTranslations('footer');
  
  return (
    <footer className="border-t bg-background">
      <div className="container flex flex-col items-center justify-between gap-4 py-10 md:h-24 md:flex-row md:py-0">
        <div className="flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0">
          <p className="text-center text-sm leading-loose text-muted-foreground md:text-left">
            {t('builtWith')}{' '}
            <a
              href="https://nextjs.org"
              target="_blank"
              rel="noreferrer"
              className="font-medium underline underline-offset-4"
            >
              Next.js
            </a>{' '}
            {t('and')}{' '}
            <a
              href="https://supabase.com"
              target="_blank"
              rel="noreferrer"
              className="font-medium underline underline-offset-4"
            >
              Supabase
            </a>
            . {t('allRightsReserved')}
          </p>
        </div>
        <div className="flex items-center space-x-1">
          <Link
            href="/rss"
            className="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-9 w-9"
          >
            <Rss className="h-4 w-4" />
            <span className="sr-only">RSS Feed</span>
          </Link>
          <Link
            href="https://github.com"
            target="_blank"
            rel="noreferrer"
            className="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-9 w-9"
          >
            <Github className="h-4 w-4" />
            <span className="sr-only">GitHub</span>
          </Link>
          <Link
            href="https://twitter.com"
            target="_blank"
            rel="noreferrer"
            className="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-9 w-9"
          >
            <Twitter className="h-4 w-4" />
            <span className="sr-only">Twitter</span>
          </Link>
        </div>
      </div>
    </footer>
  );
}
</file>

<file path="src/components/theme/theme-provider.tsx">
'use client';

import { ThemeProvider as NextThemesProvider } from 'next-themes';
import { ComponentProps } from 'react';

type ThemeProviderProps = ComponentProps<typeof NextThemesProvider>;

export function ThemeProvider({ children, ...props }: ThemeProviderProps) {
  return (
    <NextThemesProvider {...props}>
      {children}
    </NextThemesProvider>
  );
}
</file>

<file path="src/components/ui/button.tsx">
import * as React from "react";
import { Slot } from "@radix-ui/react-slot";
import { cva, type VariantProps } from "class-variance-authority";

import { cn } from "@/lib/utils";

const buttonVariants = cva(
  "inline-flex items-center justify-center whitespace-nowrap rounded-lg text-sm font-medium ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 active:scale-[0.98]",
  {
    variants: {
      variant: {
        default: "bg-primary text-primary-foreground hover:bg-primary/90 shadow-lg shadow-primary/25 hover:shadow-xl hover:shadow-primary/30 hover:scale-[1.02]",
        destructive:
          "bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-lg shadow-destructive/25 hover:shadow-xl hover:shadow-destructive/30",
        outline:
          "border-2 border-input bg-background hover:bg-gray-50 dark:hover:bg-gray-800 hover:border-gray-300 dark:hover:border-gray-600 backdrop-blur-sm",
        secondary:
          "bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-md hover:shadow-lg",
        ghost: "hover:bg-gray-100 dark:hover:bg-gray-800 hover:scale-[1.02]",
        link: "text-primary underline-offset-4 hover:underline hover:scale-[1.02]",
      },
      size: {
        default: "h-11 px-6 py-3",
        sm: "h-9 rounded-lg px-4 text-xs",
        lg: "h-13 rounded-xl px-8 py-4 text-base",
        icon: "h-11 w-11 rounded-lg",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  },
);

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean;
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : "button";
    return (
      <Comp
        className={cn(buttonVariants({ variant, size, className }))}
        ref={ref}
        {...props}
      />
    );
  },
);
Button.displayName = "Button";

export { Button, buttonVariants };
</file>

<file path="src/components/ui/motion-badge.tsx">
'use client';

import React from 'react';
import { motion } from 'framer-motion';
import { cn } from '@/lib/utils';
import { Badge, BadgeProps } from '@/components/ui/badge';

interface MotionBadgeProps extends Omit<BadgeProps, 'onAnimationStart' | 'onAnimationEnd'> {
  children: React.ReactNode;
  pulse?: boolean;
  bounce?: boolean;
}

export function MotionBadge({ 
  className, 
  variant, 
  children, 
  pulse = false,
  bounce = false,
  ...props 
}: MotionBadgeProps) {
  return (
    <motion.div
      whileHover={{ 
        scale: 1.05,
      }}
      whileTap={{ scale: 0.98 }}
      transition={{ duration: 0.2, ease: "easeOut" }}
      className="inline-block"
    >
      <Badge
        variant={variant}
        className={cn(
          "cursor-pointer transition-colors",
          pulse && "animate-pulse",
          bounce && "animate-bounce",
          className
        )}
        {...props}
      >
        {children}
      </Badge>
    </motion.div>
  );
}
</file>

<file path="src/components/ui/motion-button.tsx">
'use client';

import React from 'react';
import { motion } from 'framer-motion';
import { cn } from '@/lib/utils';
import { buttonVariants } from '@/lib/animations';
import { Button, ButtonProps } from '@/components/ui/button';

interface MotionButtonProps extends Omit<ButtonProps, 'onAnimationStart' | 'onAnimationEnd'> {
  children: React.ReactNode;
  ripple?: boolean;
  glow?: boolean;
  float?: boolean;
}

export const MotionButton = React.forwardRef<
  HTMLButtonElement,
  MotionButtonProps
>(({ 
  className, 
  variant, 
  size, 
  children, 
  ripple = false,
  glow = false,
  float = false,
  asChild,
  ...props 
}, ref) => {
  return (
    <motion.div
      variants={buttonVariants}
      initial="initial"
      whileHover="hover"
      whileTap="tap"
      className="inline-block"
    >
      <Button
        className={cn(
          "relative",
          float && "animate-float",
          glow && "animate-glow",
          className
        )}
        variant={variant}
        size={size}
        asChild={asChild}
        ref={ref}
        {...props}
      >
        {children}
      </Button>
    </motion.div>
  );
});

MotionButton.displayName = "MotionButton";
</file>

<file path="src/hooks/use-auth.ts">
'use client';

import { createClient } from '@/lib/supabase/client';
import { useRouter } from 'next/navigation';
import { useState, useEffect } from 'react';
import type { User } from '@supabase/supabase-js';

interface AuthState {
  user: User | null;
  isAdmin: boolean;
  loading: boolean;
}

export function useAuth() {
  const [authState, setAuthState] = useState<AuthState>({
    user: null,
    isAdmin: false,
    loading: true,
  });
  const router = useRouter();
  const supabase = createClient();

  useEffect(() => {
    // Get initial session
    const getSession = async () => {
      console.log('ğŸ”„ Getting initial session...');
      const { data: { session } } = await supabase.auth.getSession();
      const user = session?.user ?? null;
      console.log('ğŸ”„ Initial session result:', { hasUser: !!user, email: user?.email });
      
      let isAdmin = false;
      if (user) {
        // Check if user is admin by querying admins table
        console.log('ğŸ” Checking admin status for user ID:', user.id);
        
        try {
          const { data: adminData, error } = await supabase
            .from('admins')
            .select('user_id')
            .eq('user_id', user.id)
            .single();
          
          if (!error && adminData) {
            isAdmin = true;
            console.log('ğŸ” User found in admins table');
          } else {
            console.log('ğŸ” User not found in admins table:', error?.message);
            // Fallback to email check for admin@devblog.com
            isAdmin = user.email === 'admin@devblog.com';
            console.log('ğŸ” Fallback email check result:', isAdmin);
          }
        } catch (error) {
          console.error('ğŸ” Error checking admin table:', error);
          // Fallback to email check
          isAdmin = user.email === 'admin@devblog.com';
          console.log('ğŸ” Fallback email check result:', isAdmin);
        }
      }

      console.log('ğŸ”„ Setting auth state:', { hasUser: !!user, isAdmin });
      setAuthState({ user, isAdmin, loading: false });
    };

    getSession();

    // Listen for auth changes
    const { data: { subscription } } = supabase.auth.onAuthStateChange(
      async (event, session) => {
        const user = session?.user ?? null;
        
        let isAdmin = false;
        if (user) {
          // Check if user is admin by querying admins table
          console.log('ğŸ” Auth change - checking admin status for user ID:', user.id);
          
          try {
            const { data: adminData, error } = await supabase
              .from('admins')
              .select('user_id')
              .eq('user_id', user.id)
              .single();
            
            if (!error && adminData) {
              isAdmin = true;
              console.log('ğŸ” Auth change - user found in admins table');
            } else {
              console.log('ğŸ” Auth change - user not found in admins table:', error?.message);
              // Fallback to email check for admin@devblog.com
              isAdmin = user.email === 'admin@devblog.com';
              console.log('ğŸ” Auth change - fallback email check result:', isAdmin);
            }
          } catch (error) {
            console.error('ğŸ” Auth change - error checking admin table:', error);
            // Fallback to email check
            isAdmin = user.email === 'admin@devblog.com';
            console.log('ğŸ” Auth change - fallback email check result:', isAdmin);
          }
        }

        setAuthState({ user, isAdmin, loading: false });

        if (event === 'SIGNED_IN') {
          router.refresh();
        }
      }
    );

    return () => subscription.unsubscribe();
  }, [router, supabase]);

  const signIn = async (email: string, password: string) => {
    console.log('ğŸ” Starting signIn process for:', email);
    
    try {
      const { data, error } = await supabase.auth.signInWithPassword({
        email,
        password,
      });
      
      console.log('ğŸ” Supabase signIn response:', { 
        hasUser: !!data?.user, 
        hasSession: !!data?.session, 
        error: error?.message 
      });
      
      return { data, error };
    } catch (error) {
      console.error('ğŸ” SignIn error caught:', error);
      return { data: null, error };
    }
  };

  const signOut = async () => {
    const { error } = await supabase.auth.signOut();
    if (!error) {
      setAuthState({ user: null, isAdmin: false, loading: false });
      router.push('/');
      router.refresh();
    }
    return { error };
  };

  const signUp = async (email: string, password: string) => {
    const { data, error } = await supabase.auth.signUp({
      email,
      password,
    });
    return { data, error };
  };

  return {
    ...authState,
    signIn,
    signOut,
    signUp,
  };
}
</file>

<file path="src/hooks/use-autosave.ts">
'use client';

import { useCallback, useEffect, useRef } from 'react';
import { useToast } from '@/hooks/use-toast';

interface AutoSaveOptions {
  onSave: (data: any) => Promise<void>;
  delay?: number;
  enabled?: boolean;
}

export function useAutoSave<T>(
  data: T,
  options: AutoSaveOptions
) {
  const { onSave, delay = 5000, enabled = true } = options;
  const { toast } = useToast();
  const timeoutRef = useRef<NodeJS.Timeout | null>(null);
  const lastSavedRef = useRef<string>('');
  const isSavingRef = useRef<boolean>(false);

  const save = useCallback(async () => {
    if (isSavingRef.current) return;
    
    try {
      isSavingRef.current = true;
      await onSave(data);
      lastSavedRef.current = JSON.stringify(data);
      
      toast({
        description: 'Draft saved automatically',
        duration: 2000,
      });
    } catch (error) {
      console.error('Auto-save error:', error);
      toast({
        variant: 'destructive',
        description: 'Failed to auto-save draft',
        duration: 3000,
      });
    } finally {
      isSavingRef.current = false;
    }
  }, [data, onSave, toast]);

  useEffect(() => {
    if (!enabled || !data) return;

    const currentData = JSON.stringify(data);
    
    // Don't save if data hasn't changed
    if (currentData === lastSavedRef.current) return;
    
    // Clear existing timeout
    if (timeoutRef.current) {
      clearTimeout(timeoutRef.current);
    }

    // Set new timeout
    timeoutRef.current = setTimeout(() => {
      save();
    }, delay);

    // Cleanup
    return () => {
      if (timeoutRef.current) {
        clearTimeout(timeoutRef.current);
      }
    };
  }, [data, enabled, delay, save]);

  // Cleanup on unmount
  useEffect(() => {
    return () => {
      if (timeoutRef.current) {
        clearTimeout(timeoutRef.current);
      }
    };
  }, []);

  return {
    save,
    isSaving: isSavingRef.current,
  };
}
</file>

<file path="src/lib/supabase/client.ts">
import { createBrowserClient } from '@supabase/ssr'
import type { Database } from '@/types/database'

export function createClient() {
  return createBrowserClient<Database>(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
  )
}
</file>

<file path="src/lib/supabase/middleware.ts">
import { createServerClient } from '@supabase/ssr'
import { NextResponse, type NextRequest } from 'next/server'

export async function updateSession(request: NextRequest, response?: NextResponse) {
  let supabaseResponse = response || NextResponse.next({
    request,
  })

  const supabase = createServerClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
    {
      cookies: {
        getAll() {
          return request.cookies.getAll()
        },
        setAll(cookiesToSet) {
          cookiesToSet.forEach(({ name, value }) => request.cookies.set(name, value))
          supabaseResponse = NextResponse.next({
            request,
          })
          cookiesToSet.forEach(({ name, value, options }) =>
            supabaseResponse.cookies.set(name, value, options)
          )
        },
      },
    }
  )

  // IMPORTANT: Avoid writing any logic between createServerClient and
  // supabase.auth.getUser(). A simple mistake could make it very hard to debug
  // issues with users being randomly logged out.

  const {
    data: { user },
  } = await supabase.auth.getUser()

  // Extract locale from pathname
  const pathSegments = request.nextUrl.pathname.split('/')
  const localeFromPath = pathSegments[1]
  const isLocaleRoute = ['en', 'ko'].includes(localeFromPath)
  const actualPath = isLocaleRoute ? '/' + pathSegments.slice(2).join('/') : request.nextUrl.pathname
  
  // Protect admin routes
  if (actualPath.startsWith('/admin')) {
    if (!user) {
      // No user, redirect to login
      const url = request.nextUrl.clone()
      const locale = isLocaleRoute ? localeFromPath : 'en'
      url.pathname = `/${locale}/auth/login`
      url.searchParams.set('redirectTo', request.nextUrl.pathname)
      return NextResponse.redirect(url)
    }

    // Check if user is admin by querying admins table
    console.log('ğŸš¦ Middleware - checking admin for user ID:', user.id);
    let isAdmin = false;
    
    try {
      const { data: adminData, error } = await supabase
        .from('admins')
        .select('user_id')
        .eq('user_id', user.id)
        .single();
      
      if (!error && adminData) {
        isAdmin = true;
        console.log('ğŸš¦ Middleware - user found in admins table');
      } else {
        console.log('ğŸš¦ Middleware - user not found in admins table:', error?.message);
        // Fallback to email check for admin@devblog.com
        isAdmin = user.email === 'admin@devblog.com';
        console.log('ğŸš¦ Middleware - fallback email check result:', isAdmin);
      }
    } catch (error) {
      console.error('ğŸš¦ Middleware - error checking admin table:', error);
      // Fallback to email check
      isAdmin = user.email === 'admin@devblog.com';
      console.log('ğŸš¦ Middleware - fallback email check result:', isAdmin);
    }

    if (!isAdmin) {
      // User exists but is not admin
      const url = request.nextUrl.clone()
      const locale = isLocaleRoute ? localeFromPath : 'en'
      url.pathname = `/${locale}/unauthorized`
      return NextResponse.redirect(url)
    }
  }

  // IMPORTANT: You *must* return the supabaseResponse object as it is. If you're
  // creating a new response object with NextResponse.next() make sure to:
  // 1. Pass the request in it, like so:
  //    const myNewResponse = NextResponse.next({ request })
  // 2. Copy over the cookies, like so:
  //    myNewResponse.cookies.setAll(supabaseResponse.cookies.getAll())
  // 3. Change the myNewResponse object instead of the supabaseResponse object

  return supabaseResponse
}
</file>

<file path="src/lib/validations/post.ts">
import { z } from 'zod';
import type { PostStatus } from '@/types/database';

export const postSchema = z.object({
  title: z
    .string()
    .min(1, 'Title is required')
    .max(200, 'Title must be less than 200 characters'),
  
  content: z
    .string()
    .min(1, 'Content is required'),
  
  slug: z
    .string()
    .min(1, 'Slug is required')
    .regex(/^[a-z0-9-]+$/, 'Slug must contain only lowercase letters, numbers, and hyphens'),
  
  status: z.enum(['draft', 'scheduled', 'published', 'archived'] as const),
  
  published_at: z
    .string()
    .datetime()
    .optional()
    .nullable(),
  
  cover_image_path: z
    .string()
    .url('Must be a valid URL')
    .optional()
    .nullable(),
  
  category_id: z
    .number()
    .int()
    .positive()
    .optional()
    .nullable(),
  
  tag_ids: z
    .array(z.number().int().positive())
    .default([]),
});

export type PostFormData = z.infer<typeof postSchema>;

export const categorySchema = z.object({
  name: z
    .string()
    .min(1, 'Category name is required')
    .max(100, 'Category name must be less than 100 characters'),
  
  slug: z
    .string()
    .min(1, 'Slug is required')
    .regex(/^[a-z0-9-]+$/, 'Slug must contain only lowercase letters, numbers, and hyphens'),
});

export type CategoryFormData = z.infer<typeof categorySchema>;

export const tagSchema = z.object({
  name: z
    .string()
    .min(1, 'Tag name is required')
    .max(50, 'Tag name must be less than 50 characters'),
  
  slug: z
    .string()
    .min(1, 'Slug is required')
    .regex(/^[a-z0-9-]+$/, 'Slug must contain only lowercase letters, numbers, and hyphens'),
});

export type TagFormData = z.infer<typeof tagSchema>;
</file>

<file path="src/lib/web-vitals.ts">
import { onCLS, onINP, onFCP, onLCP, onTTFB } from 'web-vitals';

function sendToAnalytics(metric: any) {
  // In a real app, you would send this to your analytics service
  // Disabled console logging in development to reduce noise
  // if (process.env.NODE_ENV === 'development') {
  //   console.log('Web Vitals:', metric);
  // }
  
  // Example: Send to Google Analytics
  if (typeof window !== 'undefined' && (window as any).gtag) {
    (window as any).gtag('event', metric.name, {
      event_category: 'Web Vitals',
      event_label: metric.id,
      value: Math.round(metric.name === 'CLS' ? metric.value * 1000 : metric.value),
      non_interaction: true,
    });
  }
}

export function reportWebVitals() {
  onCLS(sendToAnalytics);
  onINP(sendToAnalytics); // INP replaces FID in the latest version
  onFCP(sendToAnalytics);
  onLCP(sendToAnalytics);
  onTTFB(sendToAnalytics);
}
</file>

<file path="src/types/database.ts">
export type PostStatus = 'draft' | 'scheduled' | 'published' | 'archived';

export type Database = {
  public: {
    Tables: {
      admins: {
        Row: {
          user_id: string;
          added_at: string;
        };
        Insert: {
          user_id: string;
          added_at?: string;
        };
        Update: {
          user_id?: string;
          added_at?: string;
        };
      };
      posts: {
        Row: {
          id: string;
          created_at: string;
          updated_at: string;
          deleted_at: string | null;
          status: PostStatus;
          published_at: string | null;
          title: string;
          content: string;
          slug: string;
          cover_image_path: string | null;
          category_id: number | null;
          search_vector: unknown;
        };
        Insert: {
          id?: string;
          created_at?: string;
          updated_at?: string;
          deleted_at?: string | null;
          status?: PostStatus;
          published_at?: string | null;
          title: string;
          content: string;
          slug: string;
          cover_image_path?: string | null;
          category_id?: number | null;
          search_vector?: unknown;
        };
        Update: {
          id?: string;
          created_at?: string;
          updated_at?: string;
          deleted_at?: string | null;
          status?: PostStatus;
          published_at?: string | null;
          title?: string;
          content?: string;
          slug?: string;
          cover_image_path?: string | null;
          category_id?: number | null;
          search_vector?: unknown;
        };
      };
      categories: {
        Row: {
          id: number;
          created_at: string;
          updated_at: string;
          deleted_at: string | null;
          name: string;
          slug: string;
        };
        Insert: {
          id?: number;
          created_at?: string;
          updated_at?: string;
          deleted_at?: string | null;
          name: string;
          slug: string;
        };
        Update: {
          id?: number;
          created_at?: string;
          updated_at?: string;
          deleted_at?: string | null;
          name?: string;
          slug?: string;
        };
      };
      tags: {
        Row: {
          id: number;
          created_at: string;
          updated_at: string;
          deleted_at: string | null;
          name: string;
          slug: string;
        };
        Insert: {
          id?: number;
          created_at?: string;
          updated_at?: string;
          deleted_at?: string | null;
          name: string;
          slug: string;
        };
        Update: {
          id?: number;
          created_at?: string;
          updated_at?: string;
          deleted_at?: string | null;
          name?: string;
          slug?: string;
        };
      };
      post_tags: {
        Row: {
          post_id: string;
          tag_id: number;
          created_at: string;
        };
        Insert: {
          post_id: string;
          tag_id: number;
          created_at?: string;
        };
        Update: {
          post_id?: string;
          tag_id?: number;
          created_at?: string;
        };
      };
      post_revisions: {
        Row: {
          id: number;
          post_id: string;
          title: string | null;
          content: string | null;
          created_at: string;
          created_by: string | null;
        };
        Insert: {
          id?: number;
          post_id: string;
          title?: string | null;
          content?: string | null;
          created_at?: string;
          created_by?: string | null;
        };
        Update: {
          id?: number;
          post_id?: string;
          title?: string | null;
          content?: string | null;
          created_at?: string;
          created_by?: string | null;
        };
      };
      security_logs: {
        Row: {
          id: number;
          created_at: string;
          user_id: string | null;
          action: string;
          details: any;
          ip_address: string | null;
          user_agent: string | null;
        };
        Insert: {
          id?: number;
          created_at?: string;
          user_id?: string | null;
          action: string;
          details?: any;
          ip_address?: string | null;
          user_agent?: string | null;
        };
        Update: {
          id?: number;
          created_at?: string;
          user_id?: string | null;
          action?: string;
          details?: any;
          ip_address?: string | null;
          user_agent?: string | null;
        };
      };
      login_attempts: {
        Row: {
          id: number;
          created_at: string;
          email: string;
          success: boolean;
          ip_address: string | null;
          user_agent: string | null;
        };
        Insert: {
          id?: number;
          created_at?: string;
          email: string;
          success?: boolean;
          ip_address?: string | null;
          user_agent?: string | null;
        };
        Update: {
          id?: number;
          created_at?: string;
          email?: string;
          success?: boolean;
          ip_address?: string | null;
          user_agent?: string | null;
        };
      };
    };
  };
};
</file>

<file path="CLAUDE.md">
# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a modern blog web application built with Next.js 15 and React 19, designed for a single administrator to manage Markdown-based articles. The app provides an elegant reading experience for visitors with features like search, tagging, and dark mode.

## Development Commands

```bash
# Development server with Turbopack
npm run dev

# Production build
npm run build

# Start production server
npm start

# Lint code
npm run lint
```

## Tech Stack & Architecture

### Core Framework

- **Next.js 15** with App Router and React 19
- **TypeScript** for type safety
- **Tailwind CSS** with shadcn-ui components
- **Supabase** as backend-as-a-service

### Key Libraries

- **State Management**: zustand (global state)
- **Forms**: react-hook-form + zod (validation)
- **Data Fetching**: @tanstack/react-query
- **Date Handling**: date-fns
- **Pattern Matching**: ts-pattern
- **Utilities**: es-toolkit, react-use
- **Icons**: lucide-react
- **Animation**: framer-motion

### Directory Structure

```
src/
â”œâ”€â”€ app/                     # Next.js App Router pages
â”œâ”€â”€ components/ui/           # shadcn-ui components
â”œâ”€â”€ hooks/                   # Custom hooks
â”œâ”€â”€ lib/                     # Utility functions
â”œâ”€â”€ features/[feature]/      # Feature-based organization
    â”œâ”€â”€ components/          # Feature-specific components
    â”œâ”€â”€ hooks/              # Feature-specific hooks
    â”œâ”€â”€ lib/                # Feature-specific utilities
    â””â”€â”€ api.ts              # API functions
```

## Development Guidelines

### Component Rules

- **Always use client components** (`"use client"` directive)
- Use async/await for page.tsx params props
- Prioritize functional programming patterns
- Use early returns over nested conditionals

### UI Standards

- Use shadcn-ui components for consistent design
- Implement responsive design with Tailwind CSS
- Support light/dark mode theming
- Use `picsum.photos` for placeholder images

### Code Quality

- Follow ESLint configuration
- Write descriptive variable/function names
- Minimize AI-generated comments
- Use TypeScript strict mode
- Handle errors gracefully with proper validation

### State Management

- Use zustand for global state
- Use react-hook-form for form state
- Validate all inputs with zod schemas
- Use @tanstack/react-query for server state

## Adding New Components

When adding shadcn-ui components, use:

```bash
npx shadcn@latest add [component-name]
```

## Database & Backend

- **Supabase** for authentication, database, and storage
- Store migrations in `/supabase/migrations/`
- Use Row Level Security for data protection
- Handle Korean text with UTF-8 encoding

## Performance & SEO

- Optimize for Core Web Vitals (LCP <1.5s, CLS <0.1)
- Use SSR/SSG for better SEO
- Implement lazy loading for images
- Generate Open Graph and Twitter meta tags

## Error Handling

- Use TODO: and FIXME: comments for known issues
- Prefer returning errors over throwing exceptions
- Implement proper error boundaries
- Provide meaningful error messages

## Testing Strategy

- Write unit tests for core functionality
- Consider integration tests for critical paths
- Test accessibility compliance (WCAG 2.1 AA)
- Validate cross-browser compatibility

## Korean Language Support

- Verify UTF-8 encoding for Korean text
- Check for character encoding issues after code generation
- Test display properly across different browsers

## External Tool Integration

### Gemini Assistant Integration

**Command**: `gemini -p "{{prompt}}"`

Use Gemini as a secondary AI assistant for:
- **Planning Review & Feedback**: Validate implementation plans and architectural decisions
- **Code Stability Analysis**: Review code for potential issues and suggest improvements
- **Long Context Analysis**: Analyze large codebases or complex requirements
- **Implementation Verification**: Cross-check implementations against requirements

**When to Use Gemini:**
- Before implementing complex features (planning validation)
- When reviewing large-scale architectural changes
- For second opinions on critical code decisions
- When analyzing lengthy documentation or requirements

## Project Progress Logging

**CRITICAL**: All work progress must be logged in `docs/progress-log.md`

### Required Logging Points
- Work plan creation and updates
- Important technical decisions
- Context changes and requirement updates
- Problem resolution and solutions
- Task completion and next steps

### Logging Format
```markdown
### [YYYY-MM-DD HH:MM] Task Title
**ì‘ì—…**: Task summary
**ì¤‘ìš” ì»¨í…ìŠ¤íŠ¸**: Critical context info
**ê²°ê³¼/ê²°ì •ì‚¬í•­**: Results and decisions
**ë‹¤ìŒ ë‹¨ê³„**: Next steps
```

**Always check `docs/progress-log.md` before starting work to understand current project state and context.**

## Database Schema Management

**CRITICAL**: All database schema changes must be properly managed

### Database Change Protocol
1. **Update Schema File**: Always update `docs/database-complete.sql` with new schema changes
2. **Provide SQL Output**: After making changes, provide the SQL commands in a code block for direct execution
3. **Clear Documentation**: Document what tables/columns/indexes were added or modified

### SQL Output Format
When making database changes, always provide:
```sql
-- Copy and paste this into Supabase SQL Editor
-- [Description of changes]

[SQL commands here]
```

**Always update `@docs/database-complete.sql` first, then provide executable SQL output for the user.**
</file>

<file path="docs/database-complete.sql">
/* ============================================================================
   Dev-Eloper4 Blog Database Schema - Complete Setup
   ============================================================================
   
   This file contains the complete database schema for the blog application,
   including all tables, functions, RLS policies, and security enhancements.
   
   Run this file in Supabase SQL Editor to set up the complete database.
   
   ============================================================================ */

/* ============================================================================
   1. Extensions and Initial Setup
   ============================================================================ */
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";     -- UUID ìƒì„±
CREATE EXTENSION IF NOT EXISTS pgcrypto;        -- ì•”í˜¸í™”/í•´ì‹œ í•¨ìˆ˜

/* ============================================================================
   2. ENUMS
   ============================================================================ */
DO $$
BEGIN
  IF NOT EXISTS (SELECT 1 FROM pg_type WHERE typname = 'post_status') THEN
    CREATE TYPE post_status AS ENUM ('draft', 'scheduled', 'published', 'archived');
  END IF;
END $$;

/* ============================================================================
   3. Utility Functions
   ============================================================================ */

-- Updated_at ìë™ ê°±ì‹  í•¨ìˆ˜
CREATE OR REPLACE FUNCTION set_updated_at()
RETURNS TRIGGER AS $$
BEGIN
  NEW.updated_at = now();
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

-- Posts ê²€ìƒ‰ ë²¡í„° ìë™ ìƒì„± í•¨ìˆ˜
CREATE OR REPLACE FUNCTION set_posts_search_vector()
RETURNS TRIGGER AS $$
BEGIN
  NEW.search_vector :=
    setweight(to_tsvector('simple', coalesce(NEW.title,   '')), 'A') ||
    setweight(to_tsvector('simple', coalesce(NEW.content, '')), 'B');
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

/* ============================================================================
   4. Core Tables
   ============================================================================ */

-- Admins í…Œì´ë¸” (ê´€ë¦¬ì ê¶Œí•œ ê´€ë¦¬)
CREATE TABLE IF NOT EXISTS admins (
    user_id UUID PRIMARY KEY,
    added_at TIMESTAMPTZ DEFAULT now()
);

-- Categories í…Œì´ë¸”
CREATE TABLE IF NOT EXISTS categories (
    id          BIGSERIAL PRIMARY KEY,
    created_at  TIMESTAMPTZ DEFAULT now(),
    updated_at  TIMESTAMPTZ DEFAULT now(),
    deleted_at  TIMESTAMPTZ,
    name        TEXT NOT NULL,
    slug        TEXT NOT NULL,
    CONSTRAINT categories_slug_chk CHECK (slug ~ '^[a-z0-9-]+$'),
    CONSTRAINT categories_slug_uniq UNIQUE (slug)
);

-- Tags í…Œì´ë¸”
CREATE TABLE IF NOT EXISTS tags (
    id          BIGSERIAL PRIMARY KEY,
    created_at  TIMESTAMPTZ DEFAULT now(),
    updated_at  TIMESTAMPTZ DEFAULT now(),
    deleted_at  TIMESTAMPTZ,
    name        TEXT NOT NULL,
    slug        TEXT NOT NULL,
    CONSTRAINT tags_slug_chk CHECK (slug ~ '^[a-z0-9-]+$'),
    CONSTRAINT tags_slug_uniq UNIQUE (slug)
);

-- Posts í…Œì´ë¸”
CREATE TABLE IF NOT EXISTS posts (
    id              UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    created_at      TIMESTAMPTZ DEFAULT now(),
    updated_at      TIMESTAMPTZ DEFAULT now(),
    deleted_at      TIMESTAMPTZ,
    status          post_status DEFAULT 'draft',
    published_at    TIMESTAMPTZ,
    title           TEXT NOT NULL,
    content         TEXT NOT NULL,
    slug            TEXT NOT NULL,
    cover_image_path TEXT,
    category_id     BIGINT REFERENCES categories(id) ON DELETE SET NULL ON UPDATE CASCADE,
    search_vector   TSVECTOR
);

-- Post-Tag ê´€ê³„ í…Œì´ë¸” (ë‹¤ëŒ€ë‹¤)
CREATE TABLE IF NOT EXISTS post_tags (
    post_id UUID REFERENCES posts(id) ON DELETE CASCADE,
    tag_id  BIGINT REFERENCES tags(id) ON DELETE CASCADE,
    PRIMARY KEY (post_id, tag_id)
);

-- Security Logs í…Œì´ë¸”
CREATE TABLE IF NOT EXISTS security_logs (
    id          BIGSERIAL PRIMARY KEY,
    created_at  TIMESTAMPTZ DEFAULT now(),
    user_id     UUID,
    action      TEXT NOT NULL,
    details     JSONB,
    ip_address  INET,
    user_agent  TEXT
);

-- Login Attempts í…Œì´ë¸”
CREATE TABLE IF NOT EXISTS login_attempts (
    id          BIGSERIAL PRIMARY KEY,
    created_at  TIMESTAMPTZ DEFAULT now(),
    email       TEXT NOT NULL,
    success     BOOLEAN DEFAULT false,
    ip_address  INET,
    user_agent  TEXT
);

-- Comments í…Œì´ë¸” (ì¤‘ì²© ëŒ“ê¸€ ì§€ì›)
CREATE TABLE IF NOT EXISTS comments (
    id          UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    created_at  TIMESTAMPTZ DEFAULT now(),
    updated_at  TIMESTAMPTZ DEFAULT now(),
    deleted_at  TIMESTAMPTZ,
    post_id     UUID NOT NULL REFERENCES posts(id) ON DELETE CASCADE,
    parent_id   UUID REFERENCES comments(id) ON DELETE CASCADE,
    content     TEXT NOT NULL,
    author_name VARCHAR(30) NOT NULL,
    ip_address  INET NOT NULL,
    
    CONSTRAINT comments_content_length CHECK (length(content) BETWEEN 5 AND 500),
    CONSTRAINT comments_name_length CHECK (length(author_name) BETWEEN 2 AND 30)
);

-- Comment Rate Limits í…Œì´ë¸”
CREATE TABLE IF NOT EXISTS comment_rate_limits (
    ip_address      INET PRIMARY KEY,
    comment_count   INTEGER DEFAULT 0,
    last_comment_at TIMESTAMPTZ DEFAULT now(),
    reset_time      TIMESTAMPTZ DEFAULT (now() + INTERVAL '1 hour')
);

-- Session Comments í…Œì´ë¸” (ì‚¬ìš©ì ëŒ“ê¸€ ì‚­ì œ ê¶Œí•œ ê´€ë¦¬)
CREATE TABLE IF NOT EXISTS session_comments (
    id              UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    created_at      TIMESTAMPTZ DEFAULT now(),
    session_id      VARCHAR(128) NOT NULL,
    comment_id      UUID NOT NULL REFERENCES comments(id) ON DELETE CASCADE,
    expires_at      TIMESTAMPTZ NOT NULL,
    
    UNIQUE(session_id, comment_id)
);

-- Post Views í…Œì´ë¸” (ì¡°íšŒìˆ˜ ì¶”ì )
CREATE TABLE IF NOT EXISTS post_views (
    id              UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    created_at      TIMESTAMPTZ DEFAULT now(),
    post_id         UUID NOT NULL REFERENCES posts(id) ON DELETE CASCADE,
    ip_address      INET NOT NULL,
    user_agent      TEXT,
    session_id      VARCHAR(128),
    
    UNIQUE(post_id, ip_address, DATE(created_at))
);

-- Comment Reactions í…Œì´ë¸” (ëŒ“ê¸€ ë°˜ì‘)
CREATE TABLE IF NOT EXISTS comment_reactions (
    id              UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    created_at      TIMESTAMPTZ DEFAULT now(),
    comment_id      UUID NOT NULL REFERENCES comments(id) ON DELETE CASCADE,
    ip_address      INET NOT NULL,
    reaction_type   VARCHAR(20) NOT NULL CHECK (reaction_type IN ('like', 'dislike')),
    
    UNIQUE(comment_id, ip_address)
);

/* ============================================================================
   5. Indexes
   ============================================================================ */

-- Posts ì¸ë±ìŠ¤
CREATE UNIQUE INDEX IF NOT EXISTS uniq_posts_slug_live
  ON posts(slug) WHERE deleted_at IS NULL;

CREATE INDEX IF NOT EXISTS idx_posts_status_pubat
  ON posts(status, coalesce(published_at, created_at) DESC);

CREATE INDEX IF NOT EXISTS idx_posts_created_at
  ON posts(created_at DESC);

CREATE INDEX IF NOT EXISTS idx_posts_search_vector
  ON posts USING gin(search_vector);

-- Security logs ì¸ë±ìŠ¤
CREATE INDEX IF NOT EXISTS idx_security_logs_user_id
  ON security_logs(user_id);

CREATE INDEX IF NOT EXISTS idx_security_logs_created_at
  ON security_logs(created_at DESC);

-- Login attempts ì¸ë±ìŠ¤
CREATE INDEX IF NOT EXISTS idx_login_attempts_email
  ON login_attempts(email);

CREATE INDEX IF NOT EXISTS idx_login_attempts_created_at
  ON login_attempts(created_at DESC);

-- Comments ì¸ë±ìŠ¤
CREATE INDEX IF NOT EXISTS idx_comments_post_id
  ON comments(post_id);

CREATE INDEX IF NOT EXISTS idx_comments_parent_id
  ON comments(parent_id);

CREATE INDEX IF NOT EXISTS idx_comments_created_at
  ON comments(created_at DESC);

CREATE INDEX IF NOT EXISTS idx_comments_ip_address
  ON comments(ip_address);

-- Comment rate limits ì¸ë±ìŠ¤
CREATE INDEX IF NOT EXISTS idx_comment_rate_limits_reset_time
  ON comment_rate_limits(reset_time);

-- Session comments ì¸ë±ìŠ¤
CREATE INDEX IF NOT EXISTS idx_session_comments_session_id
  ON session_comments(session_id);

CREATE INDEX IF NOT EXISTS idx_session_comments_expires_at
  ON session_comments(expires_at);

-- Post views ì¸ë±ìŠ¤
CREATE INDEX IF NOT EXISTS idx_post_views_post_id
  ON post_views(post_id);

CREATE INDEX IF NOT EXISTS idx_post_views_created_at
  ON post_views(created_at DESC);

CREATE INDEX IF NOT EXISTS idx_post_views_ip_address
  ON post_views(ip_address);

-- Comment reactions ì¸ë±ìŠ¤
CREATE INDEX IF NOT EXISTS idx_comment_reactions_comment_id
  ON comment_reactions(comment_id);

CREATE INDEX IF NOT EXISTS idx_comment_reactions_ip_address
  ON comment_reactions(ip_address);

/* ============================================================================
   6. Triggers
   ============================================================================ */

-- Updated_at ìë™ ê°±ì‹  íŠ¸ë¦¬ê±°
CREATE TRIGGER trg_categories_updated_at
  BEFORE UPDATE ON categories
  FOR EACH ROW EXECUTE FUNCTION set_updated_at();

CREATE TRIGGER trg_tags_updated_at
  BEFORE UPDATE ON tags
  FOR EACH ROW EXECUTE FUNCTION set_updated_at();

CREATE TRIGGER trg_posts_updated_at
  BEFORE UPDATE ON posts
  FOR EACH ROW EXECUTE FUNCTION set_updated_at();

-- Posts ê²€ìƒ‰ ë²¡í„° ìë™ ìƒì„± íŠ¸ë¦¬ê±°
CREATE TRIGGER trg_posts_tsv
  BEFORE INSERT OR UPDATE ON posts
  FOR EACH ROW EXECUTE FUNCTION set_posts_search_vector();

-- Comments updated_at íŠ¸ë¦¬ê±°
CREATE TRIGGER trg_comments_updated_at
  BEFORE UPDATE ON comments
  FOR EACH ROW EXECUTE FUNCTION set_updated_at();

/* ============================================================================
   7. Security Functions
   ============================================================================ */

-- ê´€ë¦¬ì ê¶Œí•œ í™•ì¸ í•¨ìˆ˜ (ë¬´í•œ ì¬ê·€ ë°©ì§€)
CREATE OR REPLACE FUNCTION is_admin()
RETURNS boolean 
LANGUAGE sql 
SECURITY DEFINER -- í•¨ìˆ˜ ì†Œìœ ì ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰
STABLE
SET search_path = public
AS $$
  SELECT EXISTS (
    SELECT 1 FROM admins 
    WHERE user_id = auth.uid()
  );
$$;

-- ë³´ì•ˆ ë¡œê·¸ ê¸°ë¡ í•¨ìˆ˜
CREATE OR REPLACE FUNCTION log_security_event(
  p_action TEXT,
  p_details JSONB DEFAULT NULL,
  p_ip_address INET DEFAULT NULL,
  p_user_agent TEXT DEFAULT NULL
)
RETURNS void
LANGUAGE plpgsql
AS $$
BEGIN
  INSERT INTO security_logs (user_id, action, details, ip_address, user_agent)
  VALUES (auth.uid(), p_action, p_details, p_ip_address, p_user_agent);
END;
$$;

-- ë¡œê·¸ì¸ ì‹œë„ ê¸°ë¡ í•¨ìˆ˜
CREATE OR REPLACE FUNCTION log_login_attempt(
  p_email TEXT,
  p_success BOOLEAN,
  p_ip_address INET DEFAULT NULL,
  p_user_agent TEXT DEFAULT NULL
)
RETURNS void
LANGUAGE plpgsql
AS $$
BEGIN
  INSERT INTO login_attempts (email, success, ip_address, user_agent)
  VALUES (p_email, p_success, p_ip_address, p_user_agent);
END;
$$;

/* ============================================================================
   8. Row Level Security (RLS) Setup
   ============================================================================ */

-- Admins í…Œì´ë¸”: RLS í™œì„±í™” ë° ë³´ì•ˆ ì •ì±… ì„¤ì •
ALTER TABLE admins ENABLE ROW LEVEL SECURITY;

-- ë‹¤ë¥¸ ëª¨ë“  í…Œì´ë¸”ì— RLS í™œì„±í™”
ALTER TABLE categories ENABLE ROW LEVEL SECURITY;
ALTER TABLE tags ENABLE ROW LEVEL SECURITY;
ALTER TABLE posts ENABLE ROW LEVEL SECURITY;
ALTER TABLE post_tags ENABLE ROW LEVEL SECURITY;
ALTER TABLE security_logs ENABLE ROW LEVEL SECURITY;
ALTER TABLE login_attempts ENABLE ROW LEVEL SECURITY;
ALTER TABLE comments ENABLE ROW LEVEL SECURITY;
ALTER TABLE comment_rate_limits ENABLE ROW LEVEL SECURITY;
ALTER TABLE session_comments ENABLE ROW LEVEL SECURITY;
ALTER TABLE post_views ENABLE ROW LEVEL SECURITY;
ALTER TABLE comment_reactions ENABLE ROW LEVEL SECURITY;

/* ============================================================================
   9. RLS Policies
   ============================================================================ */

-- Admins ì •ì±… (is_admin() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ìˆœí™˜ ì°¸ì¡° ë°©ì§€)
CREATE POLICY admins_admin_read
  ON admins FOR SELECT
  USING (is_admin());

CREATE POLICY admins_admin_full
  ON admins FOR ALL
  USING (is_admin());

-- Categories ì •ì±…
CREATE POLICY categories_public_read
  ON categories FOR SELECT
  USING (deleted_at IS NULL);

CREATE POLICY categories_admin_full
  ON categories FOR ALL
  USING (is_admin());

-- Tags ì •ì±…
CREATE POLICY tags_public_read
  ON tags FOR SELECT
  USING (deleted_at IS NULL);

CREATE POLICY tags_admin_full
  ON tags FOR ALL
  USING (is_admin());

-- Posts ì •ì±…
CREATE POLICY posts_public_read
  ON posts FOR SELECT
  USING (deleted_at IS NULL AND status = 'published');

CREATE POLICY posts_admin_full
  ON posts FOR ALL
  USING (is_admin());

-- Post_tags ì •ì±…
CREATE POLICY post_tags_public_read
  ON post_tags FOR SELECT
  USING (EXISTS (
    SELECT 1 FROM posts 
    WHERE posts.id = post_tags.post_id 
    AND posts.deleted_at IS NULL 
    AND posts.status = 'published'
  ));

CREATE POLICY post_tags_admin_full
  ON post_tags FOR ALL
  USING (is_admin());

-- Security logs ì •ì±…
CREATE POLICY security_logs_admin_only
  ON security_logs FOR ALL
  USING (is_admin());

-- Login attempts ì •ì±…
CREATE POLICY login_attempts_admin_only
  ON login_attempts FOR ALL
  USING (is_admin());

-- Comments ì •ì±…
CREATE POLICY comments_public_read
  ON comments FOR SELECT
  USING (deleted_at IS NULL);

CREATE POLICY comments_public_insert
  ON comments FOR INSERT
  WITH CHECK (true);

CREATE POLICY comments_admin_full
  ON comments FOR ALL
  USING (is_admin());

-- Comment rate limits ì •ì±…
CREATE POLICY comment_rate_limits_public_read
  ON comment_rate_limits FOR SELECT
  USING (true);

CREATE POLICY comment_rate_limits_public_upsert
  ON comment_rate_limits FOR INSERT
  WITH CHECK (true);

CREATE POLICY comment_rate_limits_public_update
  ON comment_rate_limits FOR UPDATE
  USING (true);

-- Session comments ì •ì±…
CREATE POLICY session_comments_public_read
  ON session_comments FOR SELECT
  USING (true);

CREATE POLICY session_comments_public_insert
  ON session_comments FOR INSERT
  WITH CHECK (true);

CREATE POLICY session_comments_admin_full
  ON session_comments FOR ALL
  USING (is_admin());

-- Post views ì •ì±…
CREATE POLICY post_views_admin_read
  ON post_views FOR SELECT
  USING (is_admin());

CREATE POLICY post_views_public_insert
  ON post_views FOR INSERT
  WITH CHECK (true);

CREATE POLICY post_views_admin_full
  ON post_views FOR ALL
  USING (is_admin());

-- Comment reactions ì •ì±…
CREATE POLICY comment_reactions_public_read
  ON comment_reactions FOR SELECT
  USING (true);

CREATE POLICY comment_reactions_public_insert
  ON comment_reactions FOR INSERT
  WITH CHECK (true);

CREATE POLICY comment_reactions_public_update
  ON comment_reactions FOR UPDATE
  USING (true);

CREATE POLICY comment_reactions_admin_full
  ON comment_reactions FOR ALL
  USING (is_admin());

/* ============================================================================
   10. Function Permissions
   ============================================================================ */

-- í•¨ìˆ˜ ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬
GRANT EXECUTE ON FUNCTION is_admin() TO authenticated;
GRANT EXECUTE ON FUNCTION is_admin() TO anon;
GRANT EXECUTE ON FUNCTION log_security_event(TEXT, JSONB, INET, TEXT) TO authenticated;
GRANT EXECUTE ON FUNCTION log_login_attempt(TEXT, BOOLEAN, INET, TEXT) TO authenticated;

/* ============================================================================
   11. Initial Data Setup
   ============================================================================ */

-- ê¸°ë³¸ ì¹´í…Œê³ ë¦¬ ìƒì„±
INSERT INTO categories (name, slug) VALUES 
  ('Technology', 'technology'),
  ('Web Development', 'web-development'),
  ('Programming', 'programming'),
  ('Tutorial', 'tutorial')
ON CONFLICT (slug) DO NOTHING;

-- ê¸°ë³¸ íƒœê·¸ ìƒì„±
INSERT INTO tags (name, slug) VALUES 
  ('JavaScript', 'javascript'),
  ('React', 'react'),
  ('TypeScript', 'typescript'),
  ('Next.js', 'nextjs'),
  ('Node.js', 'nodejs'),
  ('CSS', 'css'),
  ('HTML', 'html'),
  ('Database', 'database'),
  ('API', 'api'),
  ('Frontend', 'frontend'),
  ('Backend', 'backend'),
  ('Full Stack', 'full-stack')
ON CONFLICT (slug) DO NOTHING;

/* ============================================================================
   12. Completion Notice
   ============================================================================ */

DO $$
BEGIN
  RAISE NOTICE 'âœ… Database setup completed successfully!';
  RAISE NOTICE 'ğŸ“‹ Created tables: admins, categories, tags, posts, post_tags, security_logs, login_attempts, comments, comment_rate_limits, session_comments, post_views, comment_reactions';
  RAISE NOTICE 'ğŸ”§ Functions: is_admin(), log_security_event(), log_login_attempt()';
  RAISE NOTICE 'ğŸ›¡ï¸ RLS policies applied to all tables';
  RAISE NOTICE 'ğŸ“Š Initial data inserted for categories and tags';
  RAISE NOTICE 'ğŸ’¬ Comments system ready with nested comments, reactions, and rate limiting';
  RAISE NOTICE 'ğŸ“ˆ Post views tracking system ready';
  RAISE NOTICE '';
  RAISE NOTICE 'ğŸ”‘ Next steps:';
  RAISE NOTICE '   1. Add your admin user: INSERT INTO admins (user_id) VALUES (''your-uuid-here'');';
  RAISE NOTICE '   2. Test admin function: SELECT is_admin();';
  RAISE NOTICE '   3. Configure storage policies if needed';
  RAISE NOTICE '   4. Test enhanced comments system with nested replies and reactions';
  RAISE NOTICE '   5. Test post views tracking system';
END $$;
</file>

<file path="src/app/[locale]/about/page.tsx">
"use client";

import { useTranslations } from "next-intl";
import { useState, useEffect } from "react";
import { motion } from "framer-motion";
import {
  Card,
  CardContent,
  CardDescription,
  CardHeader,
  CardTitle,
} from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import {
  Github,
  Twitter,
  Mail,
  MapPin,
  Calendar,
  Code2,
  Coffee,
  BookOpen,
  Users,
  Star,
  GitBranch,
  Zap,
  Heart,
  Terminal,
  Rocket,
} from "lucide-react";
import { createClient } from "@/lib/supabase/client";
import type { CategoryWithStats } from "@/lib/blog";
import { getTranslatedCategoryName } from "@/lib/translations";

// Animation variants
const containerVariants = {
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: {
      staggerChildren: 0.1,
    },
  },
};

const itemVariants = {
  hidden: { y: 20, opacity: 0 },
  visible: {
    y: 0,
    opacity: 1,
    transition: {
      duration: 0.5,
    },
  },
};

const skillsData = [
  { name: "Frontend", color: "bg-blue-500", icon: "ğŸ¨" },
  { name: "Backend", color: "bg-green-500", icon: "âš™ï¸" },
  { name: "DevOps", color: "bg-purple-500", icon: "ğŸš€" },
];

const techStack = [
  { name: "React", icon: "âš›ï¸", level: "Intermediate" },
  { name: "Next.js", icon: "â–²", level: "Intermediate" },
  { name: "TypeScript", icon: "ğŸ”·", level: "Intermediate" },
  { name: "Node.js", icon: "ğŸŸ¢", level: "Intermediate" },

  { name: "Supabase", icon: "ğŸš€", level: "Intermediate" },
  { name: "Docker", icon: "ğŸ³", level: "Intermediate" },
  { name: "AWS", icon: "â˜ï¸", level: "Intermediate" },
];

const journeyData = [
  // {
  //   year: "2024",
  //   title: "Dev-eloper ë¸”ë¡œê·¸ ëŸ°ì¹­",
  //   description: "ê°œë°œì ì»¤ë®¤ë‹ˆí‹°ë¥¼ ìœ„í•œ í˜„ëŒ€ì ì¸ ë¸”ë¡œê·¸ í”Œë«í¼ êµ¬ì¶•",
  //   tech: ["Next.js 15", "React 19", "Supabase"],
  // },
  // {
  //   year: "2023",
  //   title: "í’€ìŠ¤íƒ ê°œë°œì ì „í™˜",
  //   description: "í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë°±ì—”ë“œê¹Œì§€ ì „ì²´ ì›¹ ê°œë°œ ìŠ¤íƒ ë§ˆìŠ¤í„°",
  //   tech: ["Node.js", "PostgreSQL", "Docker"],
  // },
  // {
  //   year: "2022",
  //   title: "ëª¨ë˜ í”„ë¡ íŠ¸ì—”ë“œ ì „ë¬¸í™”",
  //   description: "React ìƒíƒœê³„ì™€ ëª¨ë˜ ì›¹ ê¸°ìˆ ì— ì§‘ì¤‘",
  //   tech: ["React", "TypeScript", "Tailwind CSS"],
  // },
  // {
  //   year: "2021",
  //   title: "ê°œë°œ ì—¬ì • ì‹œì‘",
  //   description: "HTML, CSS, JavaScriptë¶€í„° ì‹œì‘í•œ ì›¹ ê°œë°œ ì…ë¬¸",
  //   tech: ["HTML", "CSS", "JavaScript"],
  // },
];

export default function AboutPage() {
  const t = useTranslations();
  const tCategories = useTranslations("categories");
  const [categories, setCategories] = useState<CategoryWithStats[]>([]);
  const [blogStats, setBlogStats] = useState({
    totalPosts: 0,
    totalViews: 0,
    totalCategories: 0,
  });

  useEffect(() => {
    const fetchData = async () => {
      const supabase = createClient();

      // Fetch categories
      const { data: categoriesData } = await supabase
        .from("categories")
        .select(
          `
          *,
          posts!inner(id)
        `
        )
        .is("deleted_at", null)
        .eq("posts.status", "published")
        .is("posts.deleted_at", null)
        .limit(6);

      // Fetch blog stats
      const { data: postsData, count: postsCount } = await supabase
        .from("posts")
        .select("*", { count: "exact" })
        .eq("status", "published")
        .is("deleted_at", null);

      const { data: categoriesCountData, count: categoriesCount } =
        await supabase
          .from("categories")
          .select("*", { count: "exact" })
          .is("deleted_at", null);

      if (categoriesData) {
        const categoryStats = new Map<string, number>();
        categoriesData.forEach((item) => {
          const count = categoryStats.get(item.id.toString()) || 0;
          categoryStats.set(item.id.toString(), count + 1);
        });

        const uniqueCategories = new Map();
        categoriesData.forEach((item) => {
          if (!uniqueCategories.has(item.id)) {
            uniqueCategories.set(item.id, {
              ...item,
              post_count: categoryStats.get(item.id.toString()) || 0,
            });
          }
        });

        const sortedCategories = Array.from(uniqueCategories.values())
          .sort((a: any, b: any) => b.post_count - a.post_count)
          .slice(0, 6);

        setCategories(sortedCategories);
      }

      setBlogStats({
        totalPosts: postsCount || 0,
        totalViews: Math.floor(Math.random() * 10000) + 1000, // Mock data
        totalCategories: categoriesCount || 0,
      });
    };

    fetchData();
  }, []);

  return (
    <div className="min-h-screen bg-gradient-to-br from-background via-background to-muted/20">
      <motion.div
        className="container mx-auto px-4 py-8 max-w-6xl"
        variants={containerVariants}
        initial="hidden"
        animate="visible"
      >
        {/* Hero Section */}
        <motion.section className="text-center mb-16" variants={itemVariants}>
          <div className="relative inline-block mb-8">
            <motion.div
              className="w-32 h-32 rounded-full bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 p-1 mx-auto"
              whileHover={{ scale: 1.05 }}
              whileTap={{ scale: 0.95 }}
            >
              <div className="w-full h-full rounded-full bg-background flex items-center justify-center">
                <Code2 className="w-16 h-16 text-primary" />
              </div>
            </motion.div>
            <motion.div
              className="absolute -top-2 -right-2 w-8 h-8 bg-green-500 rounded-full flex items-center justify-center"
              animate={{
                scale: [1, 1.2, 1],
                rotate: [0, 180, 360],
              }}
              transition={{
                duration: 2,
                repeat: Infinity,
                repeatType: "reverse",
              }}
            >
              <Zap className="w-4 h-4 text-white" />
            </motion.div>
          </div>

          <motion.h1
            className="text-5xl md:text-6xl font-bold mb-6"
            variants={itemVariants}
          >
            <span className="bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent">
              Dev-eloper
            </span>
          </motion.h1>

          <motion.div
            className="text-xl md:text-2xl text-muted-foreground mb-8 max-w-3xl mx-auto"
            variants={itemVariants}
          >
            <span className="inline-block">
              ê°œë°œì„ í†µí•´ ì„¸ìƒì„ ë” ë‚˜ì€ ê³³ìœ¼ë¡œ ë§Œë“¤ì–´ê°€ëŠ”
            </span>
            <br />
            <span className="bg-gradient-to-r from-primary to-blue-600 bg-clip-text text-transparent font-semibold">
              í’€ìŠ¤íƒ ê°œë°œì
            </span>
          </motion.div>

          <motion.div
            className="flex flex-wrap justify-center gap-4 mb-8"
            variants={itemVariants}
          >
            <Badge variant="secondary" className="px-4 py-2 text-sm">
              <Coffee className="w-4 h-4 mr-2" />
              Coffee Driven
            </Badge>
            <Badge variant="secondary" className="px-4 py-2 text-sm">
              <Terminal className="w-4 h-4 mr-2" />
              Code Enthusiast
            </Badge>
            <Badge variant="secondary" className="px-4 py-2 text-sm">
              <Rocket className="w-4 h-4 mr-2" />
              Innovation Seeker
            </Badge>
          </motion.div>

          <motion.div
            className="flex flex-wrap justify-center gap-4"
            variants={itemVariants}
          >
            <Button size="lg" className="gap-2">
              <BookOpen className="w-4 h-4" />
              ë¸”ë¡œê·¸ ë‘˜ëŸ¬ë³´ê¸°
            </Button>
            <Button variant="outline" size="lg" className="gap-2">
              <Mail className="w-4 h-4" />
              ì—°ë½í•˜ê¸°
            </Button>
          </motion.div>
        </motion.section>

        {/* Stats Section */}
        <motion.section
          className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-16"
          variants={itemVariants}
        >
          <Card className="text-center bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-950 dark:to-blue-900 border-blue-200 dark:border-blue-800">
            <CardContent className="pt-6">
              <div className="text-3xl font-bold text-blue-600 mb-2">
                {blogStats.totalPosts}
              </div>
              <div className="text-sm text-muted-foreground">ê²Œì‹œëœ ì•„í‹°í´</div>
            </CardContent>
          </Card>
          <Card className="text-center bg-gradient-to-br from-green-50 to-green-100 dark:from-green-950 dark:to-green-900 border-green-200 dark:border-green-800">
            <CardContent className="pt-6">
              <div className="text-3xl font-bold text-green-600 mb-2">
                {blogStats.totalViews.toLocaleString()}
              </div>
              <div className="text-sm text-muted-foreground">ì´ ì¡°íšŒìˆ˜</div>
            </CardContent>
          </Card>
          <Card className="text-center bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-950 dark:to-purple-900 border-purple-200 dark:border-purple-800">
            <CardContent className="pt-6">
              <div className="text-3xl font-bold text-purple-600 mb-2">
                {blogStats.totalCategories}
              </div>
              <div className="text-sm text-muted-foreground">ë‹¤ë£¨ëŠ” ì£¼ì œ</div>
            </CardContent>
          </Card>
        </motion.section>

        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
          {/* Main Content */}
          <div className="lg:col-span-2 space-y-8">
            {/* About Story */}
            <motion.div variants={itemVariants}>
              <Card className="overflow-hidden">
                <CardHeader className="bg-gradient-to-r from-primary/10 to-blue-500/10">
                  <CardTitle className="flex items-center gap-2">
                    <Heart className="w-5 h-5 text-red-500" />
                    ê°œë°œìë¡œì„œì˜ ì—¬ì •
                  </CardTitle>
                </CardHeader>
                <CardContent className="pt-6">
                  <div className="prose dark:prose-invert max-w-none">
                    <p className="text-lg leading-relaxed mb-4">
                      ì•ˆë…•í•˜ì„¸ìš”! ì €ëŠ” <strong>Dev-eloper</strong> ê°œë°œì
                      ì…ë‹ˆë‹¤. ë‹¨ìˆœíˆ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ê²ƒì„ ë„˜ì–´ì„œ, AI ë¥¼ í™œìš©í•˜ì—¬
                      ê°œë°œì˜ ìƒì‚°ì„±ì„ ë†’íˆê³  ê²½í—˜ì„ ê³µìœ í•˜ì—¬ ê¸°ì—¬í•˜ê³ ì í•˜ëŠ”
                      ë°”ëŒìœ¼ë¡œ ë¸”ë¡œê·¸ ì„œë¹„ìŠ¤ë¥¼ ì œì‘ í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.
                    </p>
                    <p className="text-lg leading-relaxed mb-4">
                      í˜„ì¬ëŠ” <strong>Next.js, React, TypeScript</strong>ë¥¼
                      ì£¼ë ¥ìœ¼ë¡œ í•˜ëŠ” í’€ìŠ¤íƒ ê°œë°œìë¡œ í™œë™í•˜ê³  ìˆìœ¼ë©°, íŠ¹íˆ ì‚¬ìš©ì
                      ê²½í—˜ê³¼ ê°œë°œì ê²½í—˜ì„ ë™ì‹œì— ê³ ë ¤í•œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ì¶•ì—
                      ì§‘ì¤‘í•˜ê³  ìˆìŠµë‹ˆë‹¤.
                    </p>
                    <p className="text-lg leading-relaxed">
                      ì´ ë¸”ë¡œê·¸ëŠ” ì œê°€ ê°œë°œí•˜ë©´ì„œ ë°°ìš´ ì§€ì‹ê³¼ ê²½í—˜ì„ ê³µìœ í•˜ê³ ,
                      í•¨ê»˜ ì„±ì¥í•  ìˆ˜ ìˆëŠ” ê°œë°œì ì»¤ë®¤ë‹ˆí‹°ë¥¼ ë§Œë“¤ì–´ê°€ê¸° ìœ„í•œ
                      ê³µê°„ì…ë‹ˆë‹¤.
                      <span className="text-primary font-semibold">
                        í•¨ê»˜ ë°°ìš°ê³ , í•¨ê»˜ ì„±ì¥í•´ìš”!
                      </span>
                    </p>
                  </div>
                </CardContent>
              </Card>
            </motion.div>

            {/* Journey Timeline */}
            <motion.div variants={itemVariants}>
              <Card>
                <CardHeader>
                  <CardTitle className="flex items-center gap-2">
                    <GitBranch className="w-5 h-5 text-primary" />
                    ê°œë°œ ì—¬ì • íƒ€ì„ë¼ì¸
                  </CardTitle>
                  <CardDescription>
                    ì£¼ìš” ë§ˆì¼ìŠ¤í†¤ê³¼ ê¸°ìˆ  ìŠ¤íƒì˜ ì§„í™” ê³¼ì •
                  </CardDescription>
                </CardHeader>
                <CardContent>
                  <div className="space-y-6">
                    {journeyData.map((item, index) => (
                      <motion.div
                        key={item.year}
                        className="relative flex gap-4 pb-6 border-l-2 border-primary/20 last:border-l-0 ml-4"
                        initial={{ opacity: 0, x: -20 }}
                        animate={{ opacity: 1, x: 0 }}
                        transition={{ delay: index * 0.1 }}
                      >
                        <div className="absolute -left-[9px] top-0 w-4 h-4 bg-primary rounded-full border-2 border-background" />
                        <div className="flex-1 ml-4">
                          <div className="flex items-center gap-2 mb-2">
                            <Badge variant="outline" className="text-xs">
                              {item.year}
                            </Badge>
                          </div>
                          <h3 className="font-semibold text-lg mb-2">
                            {item.title}
                          </h3>
                          <p className="text-muted-foreground mb-3">
                            {item.description}
                          </p>
                          <div className="flex flex-wrap gap-2">
                            {item.tech.map((tech) => (
                              <Badge
                                key={tech}
                                variant="secondary"
                                className="text-xs"
                              >
                                {tech}
                              </Badge>
                            ))}
                          </div>
                        </div>
                      </motion.div>
                    ))}
                  </div>
                </CardContent>
              </Card>
            </motion.div>

            {/* Skills Areas */}
            <motion.div variants={itemVariants}>
              <Card>
                <CardHeader>
                  <CardTitle className="flex items-center gap-2">
                    <Star className="w-5 h-5 text-yellow-500" />
                    ê´€ì‹¬ ë¶„ì•¼ & ìŠ¤í‚¬
                  </CardTitle>
                </CardHeader>
                <CardContent>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    {skillsData.map((skill, index) => (
                      <motion.div
                        key={skill.name}
                        className="flex items-center gap-3 p-4 rounded-lg border bg-gradient-to-br from-background to-muted/30 hover:to-muted/50 transition-all cursor-pointer"
                        whileHover={{ scale: 1.02 }}
                        whileTap={{ scale: 0.98 }}
                        initial={{ opacity: 0, y: 20 }}
                        animate={{ opacity: 1, y: 0 }}
                        transition={{ delay: index * 0.1 }}
                      >
                        <div
                          className={`w-10 h-10 rounded-full ${skill.color} flex items-center justify-center text-white`}
                        >
                          <span className="text-lg">{skill.icon}</span>
                        </div>
                        <div>
                          <div className="font-medium">{skill.name}</div>
                          <div className="text-sm text-muted-foreground">
                            ì§€ì†ì  í•™ìŠµ ì¤‘
                          </div>
                        </div>
                      </motion.div>
                    ))}
                  </div>
                </CardContent>
              </Card>
            </motion.div>
          </div>

          {/* Sidebar */}
          <div className="space-y-6">
            {/* Tech Stack */}
            <motion.div variants={itemVariants}>
              <Card>
                <CardHeader>
                  <CardTitle className="flex items-center gap-2">
                    <Code2 className="w-5 h-5 text-primary" />
                    ê¸°ìˆ  ìŠ¤íƒ
                  </CardTitle>
                </CardHeader>
                <CardContent>
                  <div className="grid grid-cols-2 gap-3">
                    {techStack.map((tech, index) => (
                      <motion.div
                        key={tech.name}
                        className="p-3 rounded-lg border bg-gradient-to-br from-background to-muted/50 hover:to-muted transition-all cursor-pointer"
                        whileHover={{ scale: 1.05 }}
                        whileTap={{ scale: 0.95 }}
                        initial={{ opacity: 0, y: 20 }}
                        animate={{ opacity: 1, y: 0 }}
                        transition={{ delay: index * 0.05 }}
                      >
                        <div className="text-2xl mb-1">{tech.icon}</div>
                        <div className="font-medium text-sm">{tech.name}</div>
                        <div className="text-xs text-muted-foreground">
                          {tech.level}
                        </div>
                      </motion.div>
                    ))}
                  </div>
                </CardContent>
              </Card>
            </motion.div>

            {/* Blog Categories */}
            <motion.div variants={itemVariants}>
              <Card>
                <CardHeader>
                  <CardTitle className="flex items-center gap-2">
                    <BookOpen className="w-5 h-5 text-primary" />
                    ì£¼ìš” ë‹¤ë£¨ëŠ” ì£¼ì œ
                  </CardTitle>
                </CardHeader>
                <CardContent>
                  <div className="space-y-2">
                    {categories.length > 0
                      ? categories.map((category) => (
                          <div
                            key={category.id}
                            className="flex justify-between items-center p-2 rounded-lg hover:bg-muted/50 transition-colors"
                          >
                            <span className="text-sm">
                              {getTranslatedCategoryName(
                                category.slug,
                                tCategories,
                                category.name
                              )}
                            </span>
                            <Badge variant="secondary" className="text-xs">
                              {category.post_count}
                            </Badge>
                          </div>
                        ))
                      : [
                          "Frontend",
                          "Backend",
                          "DevOps",
                          "Database",
                          "Mobile",
                          "AI/ML",
                        ].map((topic) => (
                          <div
                            key={topic}
                            className="flex justify-between items-center p-2 rounded-lg hover:bg-muted/50 transition-colors"
                          >
                            <span className="text-sm">{topic}</span>
                            <Badge variant="secondary" className="text-xs">
                              -
                            </Badge>
                          </div>
                        ))}
                  </div>
                </CardContent>
              </Card>
            </motion.div>

            {/* Contact */}
            <motion.div variants={itemVariants}>
              <Card className="bg-gradient-to-br from-primary/5 to-blue-500/5 border-primary/20">
                <CardHeader>
                  <CardTitle className="flex items-center gap-2">
                    <Users className="w-5 h-5 text-primary" />
                    Contact
                  </CardTitle>
                </CardHeader>
                <CardContent className="space-y-3">
                  <Button
                    variant="ghost"
                    className="w-full justify-start gap-2 hover:bg-primary/10"
                    asChild
                  >
                    <a
                      href="https://github.com/jhl9617"
                      target="_blank"
                      rel="noopener noreferrer"
                    >
                      <Github className="h-4 w-4" />
                      GitHub
                    </a>
                  </Button>

                  {/* <Button
                    variant="ghost"
                    className="w-full justify-start gap-2 hover:bg-blue-500/10"
                    asChild
                  >
                    <a
                      href="https://twitter.com"
                      target="_blank"
                      rel="noopener noreferrer"
                    >
                      <Twitter className="h-4 w-4" />
                      Twitter íŒ”ë¡œìš°
                    </a>
                  </Button> */}

                  <Button
                    variant="ghost"
                    className="w-full justify-start gap-2 hover:bg-green-500/10"
                    asChild
                  >
                    <a href="mailto:jhl9617@gmail.com">
                      <Mail className="h-4 w-4" />
                      e-mail
                    </a>
                  </Button>
                </CardContent>
              </Card>
            </motion.div>

            {/* Quick Info */}
            <motion.div variants={itemVariants}>
              <Card>
                <CardHeader>
                  <CardTitle className="text-lg">Quick Info</CardTitle>
                </CardHeader>
                <CardContent className="space-y-3">
                  <div className="flex items-center gap-2 text-sm">
                    <MapPin className="h-4 w-4 text-muted-foreground" />
                    <span>ëŒ€í•œë¯¼êµ­, ì„œìš¸</span>
                  </div>
                  <div className="flex items-center gap-2 text-sm">
                    <Calendar className="h-4 w-4 text-muted-foreground" />
                    <span>2025ë…„ë¶€í„° ë¸”ë¡œê¹…</span>
                  </div>
                  <div className="flex items-center gap-2 text-sm">
                    <Coffee className="h-4 w-4 text-muted-foreground" />
                    <span>â˜• ì»¤í”¼ ì¤‘ë…ì</span>
                  </div>
                </CardContent>
              </Card>
            </motion.div>
          </div>
        </div>
      </motion.div>
    </div>
  );
}
</file>

<file path="src/app/[locale]/categories/[slug]/page.tsx">
import { Metadata } from 'next';
import { notFound } from 'next/navigation';
import { getPostsByCategory, getCategories } from '@/lib/blog-server';
import { PostCard } from '@/components/blog/post-card';
import { Button } from '@/components/ui/button';
import { ArrowLeft, ArrowRight, Folder } from 'lucide-react';
import { Link } from '@/i18n/routing';

interface CategoryPageProps {
  params: Promise<{
    locale: string;
    slug: string;
  }>;
  searchParams: Promise<{
    page?: string;
  }>;
}

export async function generateMetadata({ params }: CategoryPageProps): Promise<Metadata> {
  const { locale, slug } = await params;
  const categories = await getCategories();
  const category = categories.find(cat => cat.slug === slug);

  if (!category) {
    return {
      title: 'Category Not Found',
    };
  }

  return {
    title: `${category.name} - Dev-eloper`,
    description: `Browse all posts in the ${category.name} category.`,
    openGraph: {
      title: `${category.name} - Dev-eloper`,
      description: `Browse all posts in the ${category.name} category.`,
    },
  };
}

const POSTS_PER_PAGE = 12;

export default async function CategoryPage({ params, searchParams }: CategoryPageProps) {
  const { locale, slug } = await params;
  const searchParamsValue = await searchParams;
  const currentPage = Number(searchParamsValue.page) || 1;
  const offset = (currentPage - 1) * POSTS_PER_PAGE;

  // Get category info
  const categories = await getCategories();
  const category = categories.find(cat => cat.slug === slug);

  if (!category) {
    notFound();
  }

  // Get posts in this category
  const { posts, total } = await getPostsByCategory(slug, POSTS_PER_PAGE, offset);
  const totalPages = Math.ceil(total / POSTS_PER_PAGE);
  const hasNextPage = currentPage < totalPages;
  const hasPrevPage = currentPage > 1;

  return (
    <div className="container py-8">
      {/* Header */}
      <div className="flex items-center justify-between mb-8">
        <div className="space-y-2">
          <div className="flex items-center gap-2 text-sm text-muted-foreground">
            <Link href="/categories" className="hover:text-primary">
              Categories
            </Link>
            <span>/</span>
            <span>{category.name}</span>
          </div>
          <div className="flex items-center gap-3">
            <Folder className="h-8 w-8 text-muted-foreground" />
            <div>
              <h1 className="text-3xl font-bold tracking-tight sm:text-4xl">
                {category.name}
              </h1>
              <p className="text-muted-foreground">
                {total} {total === 1 ? 'post' : 'posts'} in this category
              </p>
            </div>
          </div>
        </div>
        <Button variant="outline" asChild>
          <Link href="/categories">
            <ArrowLeft className="mr-2 h-4 w-4" />
            All Categories
          </Link>
        </Button>
      </div>

      {/* Posts Grid */}
      {posts.length === 0 ? (
        <div className="flex flex-col items-center justify-center py-12 text-center">
          <Folder className="h-12 w-12 text-muted-foreground mb-4" />
          <h3 className="text-lg font-semibold mb-2">No posts in this category yet</h3>
          <p className="text-muted-foreground max-w-sm">
            Posts in the {category.name} category will appear here once they are published.
          </p>
          <Button variant="outline" asChild className="mt-4">
            <Link href="/posts">
              Browse All Posts
            </Link>
          </Button>
        </div>
      ) : (
        <>
          <div className="grid gap-6 md:grid-cols-2 lg:grid-cols-3 mb-8">
            {posts.map((post: any) => (
              <PostCard key={post.id} post={post} />
            ))}
          </div>

          {/* Pagination */}
          {totalPages > 1 && (
            <div className="flex items-center justify-center space-x-2">
              <Button
                variant="outline"
                asChild
                disabled={!hasPrevPage}
              >
                {hasPrevPage ? (
                  <Link href={currentPage === 2 ? `/categories/${slug}` : `/categories/${slug}?page=${currentPage - 1}`}>
                    <ArrowLeft className="mr-2 h-4 w-4" />
                    Previous
                  </Link>
                ) : (
                  <span className="flex items-center">
                    <ArrowLeft className="mr-2 h-4 w-4" />
                    Previous
                  </span>
                )}
              </Button>

              <div className="flex items-center space-x-1">
                {Array.from({ length: totalPages }, (_, i) => i + 1).map((page) => (
                  <Button
                    key={page}
                    variant={page === currentPage ? 'default' : 'outline'}
                    size="sm"
                    asChild={page !== currentPage}
                  >
                    {page === currentPage ? (
                      <span>{page}</span>
                    ) : (
                      <Link href={page === 1 ? `/categories/${slug}` : `/categories/${slug}?page=${page}`}>
                        {page}
                      </Link>
                    )}
                  </Button>
                ))}
              </div>

              <Button
                variant="outline"
                asChild
                disabled={!hasNextPage}
              >
                {hasNextPage ? (
                  <Link href={`/categories/${slug}?page=${currentPage + 1}`}>
                    Next
                    <ArrowRight className="ml-2 h-4 w-4" />
                  </Link>
                ) : (
                  <span className="flex items-center">
                    Next
                    <ArrowRight className="ml-2 h-4 w-4" />
                  </span>
                )}
              </Button>
            </div>
          )}
        </>
      )}
    </div>
  );
}
</file>

<file path="src/app/[locale]/categories/page.tsx">
import { getTranslations } from 'next-intl/server';
import { getCategoriesWithStats, getTrendingTags } from '@/lib/blog-server';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';
import { BookOpen, Users, TrendingUp } from 'lucide-react';
import { Link } from '@/i18n/routing';
import { getTranslatedCategoryName, getTranslatedCategoryDescription, getTranslatedTagName } from '@/lib/translations';

interface CategoriesPageProps {
  params: Promise<{ locale: string }>;
}

export default async function CategoriesPage({ params }: CategoriesPageProps) {
  const { locale } = await params;
  const t = await getTranslations({ locale, namespace: 'navigation' });
  const tBlog = await getTranslations({ locale, namespace: 'blog' });
  const tAdmin = await getTranslations({ locale, namespace: 'admin' });
  const tCategories = await getTranslations({ locale, namespace: 'categories' });
  const tCategoryDescriptions = await getTranslations({ locale, namespace: 'categoryDescriptions' });
  const tTags = await getTranslations({ locale, namespace: 'tags' });
  
  const categoriesWithStats = await getCategoriesWithStats();
  const trendingTags = await getTrendingTags(18);

  const totalPosts = categoriesWithStats.reduce((sum, cat) => sum + cat.post_count, 0);
  
  // Define color patterns for categories
  const colorPatterns = [
    'from-blue-500 to-cyan-500',
    'from-green-500 to-emerald-500',
    'from-purple-500 to-violet-500',
    'from-orange-500 to-red-500',
    'from-pink-500 to-rose-500',
    'from-indigo-500 to-blue-500',
    'from-gray-600 to-gray-800',
    'from-teal-500 to-cyan-500',
    'from-yellow-500 to-orange-500',
    'from-red-500 to-pink-500'
  ];

  return (
    <div className="container mx-auto px-4 py-8">
      <div className="max-w-6xl mx-auto space-y-8">
        {/* Header */}
        <div className="text-center space-y-4">
          <h1 className="text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
            {t('categories')}
          </h1>
          <p className="text-xl text-muted-foreground max-w-2xl mx-auto">
            Explore our content organized by technology and topic
          </p>
        </div>

        {/* Stats */}
        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
          <Card>
            <CardContent className="p-6 text-center">
              <BookOpen className="h-8 w-8 mx-auto mb-2 text-blue-600" />
              <div className="text-2xl font-bold">{totalPosts}</div>
              <div className="text-sm text-muted-foreground">{tAdmin('totalArticles')}</div>
            </CardContent>
          </Card>
          <Card>
            <CardContent className="p-6 text-center">
              <Users className="h-8 w-8 mx-auto mb-2 text-green-600" />
              <div className="text-2xl font-bold">{categoriesWithStats.length}</div>
              <div className="text-sm text-muted-foreground">{t('categories')}</div>
            </CardContent>
          </Card>
          <Card>
            <CardContent className="p-6 text-center">
              <TrendingUp className="h-8 w-8 mx-auto mb-2 text-purple-600" />
              <div className="text-2xl font-bold">{trendingTags.length}</div>
              <div className="text-sm text-muted-foreground">Trending Topics</div>
            </CardContent>
          </Card>
        </div>

        {/* Categories Grid */}
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {categoriesWithStats.map((category, index) => (
            <Link key={category.id} href={`/categories/${category.slug}`}>
              <Card className="group hover:shadow-lg transition-all duration-300 cursor-pointer h-full">
                <CardHeader className="pb-3">
                  <div className="flex items-start justify-between">
                    <div className="space-y-2 flex-1">
                      <div className="flex items-center gap-2">
                        <div className={`w-4 h-4 rounded-full bg-gradient-to-r ${colorPatterns[index % colorPatterns.length]}`} />
                        <CardTitle className="text-lg group-hover:text-blue-600 transition-colors">
                          {getTranslatedCategoryName(category.slug, tCategories, category.name)}
                        </CardTitle>
                      </div>
                      {category.post_count > 5 && (
                        <Badge variant="secondary" className="w-fit">
                          <TrendingUp className="h-3 w-3 mr-1" />
                          {tAdmin('popularBadge')}
                        </Badge>
                      )}
                    </div>
                  </div>
                  <CardDescription className="line-clamp-2">
                    {getTranslatedCategoryDescription(category.slug, tCategoryDescriptions, `Explore articles about ${category.name.toLowerCase()}`)}
                  </CardDescription>
                </CardHeader>
                <CardContent>
                  <div className="flex items-center justify-between text-sm">
                    <span className="text-muted-foreground">
                      {category.post_count} {category.post_count === 1 ? 'article' : 'articles'}
                    </span>
                    <span className="text-blue-600 group-hover:text-blue-700 font-medium">
                      View all â†’
                    </span>
                  </div>
                </CardContent>
              </Card>
            </Link>
          ))}
        </div>

        {/* Popular Tags */}
        <div className="space-y-6">
          <h2 className="text-2xl font-semibold">{tBlog('tags')}</h2>
          <div className="flex flex-wrap gap-2">
            {trendingTags.map((tag) => (
              <Link key={tag.id} href={`/tags/${tag.slug}`}>
                <Badge 
                  variant="outline" 
                  className="cursor-pointer hover:bg-accent transition-colors"
                >
                  {getTranslatedTagName(tag.slug, tTags, tag.name)} ({tag.post_count})
                </Badge>
              </Link>
            ))}
          </div>
        </div>
      </div>
    </div>
  );
}
</file>

<file path="src/app/[locale]/home-page-client.tsx">
'use client';

import { motion } from 'framer-motion';
import { PostCard } from '@/components/blog/post-card';
import { Button } from '@/components/ui/button';
import { MotionButton } from '@/components/ui/motion-button';
import { ArrowRight, BookOpen } from 'lucide-react';
import { Link } from '@/i18n/routing';
import { containerVariants, pageVariants } from '@/lib/animations';

interface HomePageClientProps {
  posts: any[];
  total: number;
  translations: {
    allPosts: string;
    recentPosts: string;
    noPostsFound: string;
    categories: string;
    about: string;
  };
}

export function HomePageClient({ posts, total, translations }: HomePageClientProps) {
  return (
    <motion.div 
      className="min-h-screen"
      variants={pageVariants}
      initial="initial"
      animate="animate"
      exit="exit"
    >
      {/* Hero Section */}
      <section className="relative overflow-hidden bg-gradient-to-b from-background to-gray-50 dark:to-gray-900 py-20 lg:py-32">
        <div className="container px-6 lg:px-8">
          <div className="mx-auto max-w-4xl text-center">
            <motion.h1 
              className="text-4xl font-bold tracking-tight sm:text-5xl md:text-6xl lg:text-7xl xl:text-8xl"
              initial={{ opacity: 0, y: 30 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ duration: 0.8, ease: [0.16, 1, 0.3, 1] }}
            >
              <span className="bg-gradient-to-r from-foreground via-foreground to-gray-600 bg-clip-text text-transparent">
                Welcome to
              </span>
              <br />
              <span className="bg-gradient-to-r from-primary to-blue-600 bg-clip-text text-transparent">
                Dev-eloper
              </span>
            </motion.h1>
            <motion.p 
              className="mx-auto mt-8 max-w-2xl text-lg sm:text-xl md:text-2xl text-gray-600 dark:text-gray-400 leading-relaxed"
              initial={{ opacity: 0, y: 30 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ duration: 0.8, delay: 0.2, ease: [0.16, 1, 0.3, 1] }}
            >
              Discover articles about web development, programming, and technology. 
              Stay updated with the latest trends and best practices.
            </motion.p>
          </div>
          <motion.div 
            className="mt-12 flex flex-col sm:flex-row items-center justify-center gap-4 sm:gap-6"
            initial={{ opacity: 0, y: 30 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.8, delay: 0.4, ease: [0.16, 1, 0.3, 1] }}
          >
            <MotionButton asChild size="lg" className="rounded-full px-8 py-4 text-base font-medium shadow-lg shadow-primary/25 hover:shadow-xl hover:shadow-primary/30 transition-all duration-300">
              <Link href="/posts">
                <BookOpen className="mr-2 h-5 w-5" />
                {translations.allPosts}
              </Link>
            </MotionButton>
            <MotionButton variant="outline" size="lg" asChild className="rounded-full px-8 py-4 text-base font-medium border-2 hover:bg-gray-50 dark:hover:bg-gray-800 transition-all duration-300">
              <Link href="/categories">
                {translations.categories}
                <ArrowRight className="ml-2 h-5 w-5" />
              </Link>
            </MotionButton>
          </motion.div>
        </div>
      </section>

      {/* Latest Posts Section */}
      <section className="py-20 lg:py-24 bg-background">
        <div className="container px-6 lg:px-8">
          <div className="mx-auto max-w-7xl">
            <div className="flex flex-col lg:flex-row lg:items-end lg:justify-between mb-16">
              <div className="space-y-4">
                <h2 className="text-3xl sm:text-4xl lg:text-5xl font-bold tracking-tight">
                  {translations.recentPosts}
                </h2>
                <p className="text-lg text-gray-600 dark:text-gray-400 max-w-2xl">
                  Explore our latest articles and insights on web development, programming best practices, and cutting-edge technology trends.
                </p>
              </div>
              {total > 6 && (
                <Button variant="outline" asChild className="mt-6 lg:mt-0 rounded-full px-6 py-3 font-medium border-2 hover:bg-gray-50 dark:hover:bg-gray-800 transition-all duration-300">
                  <Link href="/posts">
                    {translations.allPosts}
                    <ArrowRight className="ml-2 h-4 w-4" />
                  </Link>
                </Button>
              )}
            </div>
          </div>
        </div>

        <div className="container px-6 lg:px-8">
          <div className="mx-auto max-w-7xl">
            {posts.length === 0 ? (
              <div className="flex flex-col items-center justify-center py-20 text-center">
                <div className="w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mb-6">
                  <BookOpen className="h-8 w-8 text-gray-400" />
                </div>
                <h3 className="text-xl font-semibold mb-3">{translations.noPostsFound}</h3>
                <p className="text-gray-600 dark:text-gray-400 max-w-md text-lg">
                  There are no published articles yet. Check back soon for new content!
                </p>
              </div>
            ) : (
              <motion.div 
                className="grid gap-8 md:grid-cols-2 lg:grid-cols-3"
                variants={containerVariants}
                initial="hidden"
                animate="visible"
              >
                {posts.map((post: any, index: number) => (
                  <PostCard 
                    key={post.id} 
                    post={post} 
                    priority={index === 0}
                    index={index}
                  />
                ))}
              </motion.div>
            )}
          </div>
        </div>
      </section>

      {/* Newsletter/CTA Section */}
      <section className="py-20 lg:py-24 bg-gradient-to-b from-gray-50 to-background dark:from-gray-900 dark:to-background">
        <div className="container px-6 lg:px-8">
          <div className="mx-auto max-w-4xl text-center">
            <h2 className="text-3xl sm:text-4xl lg:text-5xl font-bold tracking-tight mb-6">
              Stay Updated
            </h2>
            <p className="text-lg sm:text-xl text-gray-600 dark:text-gray-400 mb-12 max-w-2xl mx-auto">
              Follow us for the latest articles and insights in web development, programming best practices, and technology trends.
            </p>
            <div className="flex flex-col sm:flex-row justify-center gap-4">
              <Button variant="outline" asChild className="rounded-full px-8 py-4 text-base font-medium border-2 hover:bg-gray-50 dark:hover:bg-gray-800 transition-all duration-300">
                <Link href="/rss">
                  RSS Feed
                </Link>
              </Button>
              <Button variant="outline" asChild className="rounded-full px-8 py-4 text-base font-medium border-2 hover:bg-gray-50 dark:hover:bg-gray-800 transition-all duration-300">
                <Link href="/about">
                  {translations.about}
                </Link>
              </Button>
            </div>
          </div>
        </div>
      </section>
    </motion.div>
  );
}
</file>

<file path="src/app/[locale]/layout.tsx">
import type { Metadata } from 'next';
import { NextIntlClientProvider } from 'next-intl';
import { getMessages, getTranslations } from 'next-intl/server';
import { notFound } from 'next/navigation';
import { routing } from '@/i18n/routing';
import { Header } from '@/components/shared/header';
import { Footer } from '@/components/shared/footer';
import { Toaster } from '@/components/ui/toaster';
import { WebVitals } from '@/components/web-vitals';
import Providers from './providers';

type Props = {
  children: React.ReactNode;
  params: Promise<{ locale: string }>;
};

export async function generateMetadata({ params }: { params: Promise<{ locale: string }> }): Promise<Metadata> {
  const { locale } = await params;
  const t = await getTranslations({ locale, namespace: 'metadata' });
  
  return {
    title: {
      default: t('title'),
      template: `%s | ${t('title')}`,
    },
    description: t('description'),
    keywords: t('keywords').split(', '),
    authors: [{ name: 'Dev-eloper' }],
    creator: 'Dev-eloper',
    metadataBase: new URL(process.env.NEXT_PUBLIC_SITE_URL || 'http://localhost:3001'),
    alternates: {
      canonical: '/',
      languages: {
        'en': '/en',
        'ko': '/ko',
      },
    },
    openGraph: {
      type: 'website',
      locale: locale === 'ko' ? 'ko_KR' : 'en_US',
      url: '/',
      title: t('title'),
      description: t('description'),
      siteName: 'Dev-eloper',
      images: [
        {
          url: '/og-image.jpg',
          width: 1200,
          height: 630,
          alt: t('title'),
        },
      ],
    },
    twitter: {
      card: 'summary_large_image',
      title: t('title'),
      description: t('description'),
      images: ['/og-image.jpg'],
    },
    robots: {
      index: true,
      follow: true,
      googleBot: {
        index: true,
        follow: true,
        'max-video-preview': -1,
        'max-image-preview': 'large',
        'max-snippet': -1,
      },
    },
  };
}

export default async function LocaleLayout({ children, params }: Props) {
  const { locale } = await params;
  
  // Ensure that the incoming `locale` is valid
  if (!routing.locales.includes(locale as any)) {
    notFound();
  }

  // Providing all messages to the client
  // side is the easiest way to get started
  const messages = await getMessages();

  return (
    <NextIntlClientProvider messages={messages}>
      <Providers>
        <Header />
        <main className="flex-1">
          {children}
        </main>
        <Footer />
        <Toaster />
        <WebVitals />
      </Providers>
    </NextIntlClientProvider>
  );
}
</file>

<file path="src/app/[locale]/posts/page.tsx">
import { Metadata } from 'next';
import { getPublishedPosts } from '@/lib/blog-server';
import { PostCard } from '@/components/blog/post-card';
import { Button } from '@/components/ui/button';
import { ArrowLeft, ArrowRight, BookOpen } from 'lucide-react';
import { Link } from '@/i18n/routing';
import { getTranslations } from 'next-intl/server';

interface PostsPageProps {
  params: Promise<{ locale: string }>;
  searchParams: Promise<{
    page?: string;
  }>;
}

export async function generateMetadata({ params }: { params: Promise<{ locale: string }> }): Promise<Metadata> {
  const { locale } = await params;
  const t = await getTranslations({ locale, namespace: 'blog' });
  
  return {
    title: `${t('allPosts')} - Dev-eloper`,
    description: 'Browse all blog posts about web development, programming, and technology.',
    openGraph: {
      title: `${t('allPosts')} - Dev-eloper`,
      description: 'Browse all blog posts about web development, programming, and technology.',
    },
  };
}

const POSTS_PER_PAGE = 12;

export default async function PostsPage({ params, searchParams }: PostsPageProps) {
  const { locale } = await params;
  const searchParamsResolved = await searchParams;
  const currentPage = Number(searchParamsResolved.page) || 1;
  const offset = (currentPage - 1) * POSTS_PER_PAGE;

  const { posts, total } = await getPublishedPosts(POSTS_PER_PAGE, offset);
  const totalPages = Math.ceil(total / POSTS_PER_PAGE);
  const hasNextPage = currentPage < totalPages;
  const hasPrevPage = currentPage > 1;

  const t = await getTranslations({ locale, namespace: 'blog' });
  const tCommon = await getTranslations({ locale, namespace: 'common' });

  return (
    <div className="container py-8">
      {/* Header */}
      <div className="flex items-center justify-between mb-8">
        <div>
          <h1 className="text-3xl font-bold tracking-tight sm:text-4xl">
            {t('allPosts')}
          </h1>
          <p className="text-muted-foreground mt-2">
            {total} {total === 1 ? 'post' : 'posts'} published
          </p>
        </div>
        <Button variant="outline" asChild>
          <Link href="/">
            <ArrowLeft className="mr-2 h-4 w-4" />
            {tCommon('backToHome')}
          </Link>
        </Button>
      </div>

      {/* Posts Grid */}
      {posts.length === 0 ? (
        <div className="flex flex-col items-center justify-center py-12 text-center">
          <BookOpen className="h-12 w-12 text-muted-foreground mb-4" />
          <h3 className="text-lg font-semibold mb-2">{t('noPostsFound')}</h3>
          <p className="text-muted-foreground max-w-sm">
            There are no published posts yet. Check back soon for new content!
          </p>
        </div>
      ) : (
        <>
          <div className="grid gap-6 md:grid-cols-2 lg:grid-cols-3 mb-8">
            {posts.map((post: any) => (
              <PostCard key={post.id} post={post} />
            ))}
          </div>

          {/* Pagination */}
          {totalPages > 1 && (
            <div className="flex items-center justify-center space-x-2">
              <Button
                variant="outline"
                asChild
                disabled={!hasPrevPage}
              >
                {hasPrevPage ? (
                  <Link href={currentPage === 2 ? '/posts' : `/posts?page=${currentPage - 1}`}>
                    <ArrowLeft className="mr-2 h-4 w-4" />
                    {tCommon('previous')}
                  </Link>
                ) : (
                  <span className="flex items-center">
                    <ArrowLeft className="mr-2 h-4 w-4" />
                    {tCommon('previous')}
                  </span>
                )}
              </Button>

              <div className="flex items-center space-x-1">
                {Array.from({ length: totalPages }, (_, i) => i + 1).map((page) => (
                  <Button
                    key={page}
                    variant={page === currentPage ? 'default' : 'outline'}
                    size="sm"
                    asChild={page !== currentPage}
                  >
                    {page === currentPage ? (
                      <span>{page}</span>
                    ) : (
                      <Link href={page === 1 ? '/posts' : `/posts?page=${page}`}>
                        {page}
                      </Link>
                    )}
                  </Button>
                ))}
              </div>

              <Button
                variant="outline"
                asChild
                disabled={!hasNextPage}
              >
                {hasNextPage ? (
                  <Link href={`/posts?page=${currentPage + 1}`}>
                    {tCommon('next')}
                    <ArrowRight className="ml-2 h-4 w-4" />
                  </Link>
                ) : (
                  <span className="flex items-center">
                    {tCommon('next')}
                    <ArrowRight className="ml-2 h-4 w-4" />
                  </span>
                )}
              </Button>
            </div>
          )}
        </>
      )}
    </div>
  );
}
</file>

<file path="src/app/[locale]/tags/[slug]/page.tsx">
import { Metadata } from 'next';
import { notFound } from 'next/navigation';
import { getPostsByTag, getTags } from '@/lib/blog-server';
import { PostCard } from '@/components/blog/post-card';
import { Button } from '@/components/ui/button';
import { Badge } from '@/components/ui/badge';
import { ArrowLeft, ArrowRight, Tag } from 'lucide-react';
import { Link } from '@/i18n/routing';

interface TagPageProps {
  params: Promise<{
    locale: string;
    slug: string;
  }>;
  searchParams: Promise<{
    page?: string;
  }>;
}

export async function generateMetadata({ params }: TagPageProps): Promise<Metadata> {
  const { locale, slug } = await params;
  const tags = await getTags();
  const tag = tags.find(t => t.slug === slug);

  if (!tag) {
    return {
      title: 'Tag Not Found',
    };
  }

  return {
    title: `#${tag.name} - Dev-eloper`,
    description: `Browse all posts tagged with ${tag.name}.`,
    openGraph: {
      title: `#${tag.name} - Dev-eloper`,
      description: `Browse all posts tagged with ${tag.name}.`,
    },
  };
}

const POSTS_PER_PAGE = 12;

export default async function TagPage({ params, searchParams }: TagPageProps) {
  const { locale, slug } = await params;
  const searchParamsValue = await searchParams;
  const currentPage = Number(searchParamsValue.page) || 1;
  const offset = (currentPage - 1) * POSTS_PER_PAGE;

  // Get tag info
  const tags = await getTags();
  const tag = tags.find(t => t.slug === slug);

  if (!tag) {
    notFound();
  }

  // Get posts with this tag
  const { posts, total } = await getPostsByTag(slug, POSTS_PER_PAGE, offset);
  const totalPages = Math.ceil(total / POSTS_PER_PAGE);
  const hasNextPage = currentPage < totalPages;
  const hasPrevPage = currentPage > 1;

  return (
    <div className="container py-8">
      {/* Header */}
      <div className="flex items-center justify-between mb-8">
        <div className="space-y-2">
          <div className="flex items-center gap-2 text-sm text-muted-foreground">
            <Link href="/" className="hover:text-primary">
              Home
            </Link>
            <span>/</span>
            <span>Tag: {tag.name}</span>
          </div>
          <div className="flex items-center gap-3">
            <Tag className="h-8 w-8 text-muted-foreground" />
            <div>
              <h1 className="text-3xl font-bold tracking-tight sm:text-4xl">
                <span className="text-muted-foreground">#</span>{tag.name}
              </h1>
              <p className="text-muted-foreground">
                {total} {total === 1 ? 'post' : 'posts'} tagged with {tag.name}
              </p>
            </div>
          </div>
        </div>
        <Button variant="outline" asChild>
          <Link href="/">
            <ArrowLeft className="mr-2 h-4 w-4" />
            Back to Home
          </Link>
        </Button>
      </div>

      {/* Posts Grid */}
      {posts.length === 0 ? (
        <div className="flex flex-col items-center justify-center py-12 text-center">
          <Tag className="h-12 w-12 text-muted-foreground mb-4" />
          <h3 className="text-lg font-semibold mb-2">No posts with this tag yet</h3>
          <p className="text-muted-foreground max-w-sm">
            Posts tagged with <Badge variant="outline">#{tag.name}</Badge> will appear here once they are published.
          </p>
          <Button variant="outline" asChild className="mt-4">
            <Link href="/posts">
              Browse All Posts
            </Link>
          </Button>
        </div>
      ) : (
        <>
          <div className="grid gap-6 md:grid-cols-2 lg:grid-cols-3 mb-8">
            {posts.map((post: any) => (
              <PostCard key={post.id} post={post} />
            ))}
          </div>

          {/* Pagination */}
          {totalPages > 1 && (
            <div className="flex items-center justify-center space-x-2">
              <Button
                variant="outline"
                asChild
                disabled={!hasPrevPage}
              >
                {hasPrevPage ? (
                  <Link href={currentPage === 2 ? `/tags/${slug}` : `/tags/${slug}?page=${currentPage - 1}`}>
                    <ArrowLeft className="mr-2 h-4 w-4" />
                    Previous
                  </Link>
                ) : (
                  <span className="flex items-center">
                    <ArrowLeft className="mr-2 h-4 w-4" />
                    Previous
                  </span>
                )}
              </Button>

              <div className="flex items-center space-x-1">
                {Array.from({ length: totalPages }, (_, i) => i + 1).map((page) => (
                  <Button
                    key={page}
                    variant={page === currentPage ? 'default' : 'outline'}
                    size="sm"
                    asChild={page !== currentPage}
                  >
                    {page === currentPage ? (
                      <span>{page}</span>
                    ) : (
                      <Link href={page === 1 ? `/tags/${slug}` : `/tags/${slug}?page=${page}`}>
                        {page}
                      </Link>
                    )}
                  </Button>
                ))}
              </div>

              <Button
                variant="outline"
                asChild
                disabled={!hasNextPage}
              >
                {hasNextPage ? (
                  <Link href={`/tags/${slug}?page=${currentPage + 1}`}>
                    Next
                    <ArrowRight className="ml-2 h-4 w-4" />
                  </Link>
                ) : (
                  <span className="flex items-center">
                    Next
                    <ArrowRight className="ml-2 h-4 w-4" />
                  </span>
                )}
              </Button>
            </div>
          )}
        </>
      )}
    </div>
  );
}
</file>

<file path="src/app/opengraph-image.tsx">
import { ImageResponse } from 'next/og';

export const alt = 'Dev-eloper - Modern Blog Platform';
export const size = {
  width: 1200,
  height: 630,
};
export const contentType = 'image/png';

export default async function Image() {
  return new ImageResponse(
    (
      <div
        style={{
          height: '100%',
          width: '100%',
          display: 'flex',
          flexDirection: 'column',
          alignItems: 'center',
          justifyContent: 'center',
          backgroundColor: 'white',
          backgroundImage: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
        }}
      >
        <div
          style={{
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
            flexDirection: 'column',
          }}
        >
          <h1
            style={{
              fontSize: 72,
              fontWeight: 'bold',
              color: 'white',
              textAlign: 'center',
              marginBottom: 20,
            }}
          >
            Dev-eloper
          </h1>
          <p
            style={{
              fontSize: 32,
              color: 'white',
              textAlign: 'center',
              opacity: 0.9,
            }}
          >
            Modern Blog Platform
          </p>
          <p
            style={{
              fontSize: 24,
              color: 'white',
              textAlign: 'center',
              opacity: 0.7,
              marginTop: 20,
            }}
          >
            Built with Next.js & Supabase
          </p>
        </div>
      </div>
    ),
    {
      ...size,
    }
  );
}
</file>

<file path="src/app/page.tsx">
import { redirect } from 'next/navigation';

export default function RootPage() {
  redirect('/en');
}
</file>

<file path="src/components/blog/comment-form.tsx">
'use client';

import { useState } from 'react';
import { motion } from 'framer-motion';
import { useTranslations } from 'next-intl';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { z } from 'zod';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Textarea } from '@/components/ui/textarea';
import { Label } from '@/components/ui/label';
import { Alert, AlertDescription } from '@/components/ui/alert';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { MathCaptcha } from '@/components/blog/math-captcha';
import { MessageCircle, Send, AlertCircle, CheckCircle, Reply, X } from 'lucide-react';
import { useToast } from '@/hooks/use-toast';

const createCommentSchema = (t: any) => z.object({
  authorName: z.string()
    .min(2, t('nameMinLength'))
    .max(30, t('nameMaxLength'))
    .regex(/^[a-zA-Z0-9ê°€-í£\s]+$/, t('nameInvalidChars')),
  content: z.string()
    .min(5, t('contentMinLength'))
    .max(500, t('contentMaxLength'))
    .trim(),
});

type CommentFormData = z.infer<ReturnType<typeof createCommentSchema>>;

interface CommentFormProps {
  postId: string;
  parentId?: string;
  parentAuthor?: string;
  onCommentAdded?: (comment: any) => void;
  onCancel?: () => void;
}

export function CommentForm({ postId, parentId, parentAuthor, onCommentAdded, onCancel }: CommentFormProps) {
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [showCaptcha, setShowCaptcha] = useState(false);
  const [captchaSessionId, setCaptchaSessionId] = useState<string | null>(null);
  const [captchaAnswer, setCaptchaAnswer] = useState<string | null>(null);
  const [submitError, setSubmitError] = useState<string | null>(null);
  const [submitSuccess, setSubmitSuccess] = useState(false);
  const { toast } = useToast();
  const t = useTranslations('comments');
  const tCommon = useTranslations('common');

  const commentSchema = createCommentSchema(t);
  
  const {
    register,
    handleSubmit,
    formState: { errors },
    reset,
    watch,
  } = useForm<CommentFormData>({
    resolver: zodResolver(commentSchema),
  });

  const content = watch('content', '');

  const handleCaptchaVerify = async (sessionId: string, answer: string): Promise<boolean> => {
    try {
      const response = await fetch('/api/captcha/math', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          sessionId,
          userAnswer: answer,
        }),
      });

      const data = await response.json();
      
      if (response.ok) {
        setCaptchaSessionId(sessionId);
        setCaptchaAnswer(answer);
        return true;
      } else {
        throw new Error(data.error || 'CAPTCHA verification failed');
      }
    } catch (error) {
      console.error('CAPTCHA verification error:', error);
      throw error;
    }
  };

  const handleCaptchaSuccess = () => {
    setShowCaptcha(false);
    toast({
      title: t('verificationSuccess'),
      description: t('canSubmitComment'),
    });
  };

  const handleCaptchaError = (error: string) => {
    setSubmitError(error);
  };

  const onSubmit = async (data: CommentFormData) => {
    setSubmitError(null);
    setSubmitSuccess(false);

    // Show CAPTCHA if not verified
    if (!captchaSessionId || !captchaAnswer) {
      setShowCaptcha(true);
      return;
    }

    setIsSubmitting(true);

    try {
      const response = await fetch('/api/comments', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          postId,
          content: data.content,
          authorName: data.authorName,
          captchaSessionId,
          captchaAnswer,
          parentId,
        }),
      });

      const result = await response.json();

      if (response.ok) {
        setSubmitSuccess(true);
        reset();
        setCaptchaSessionId(null);
        setCaptchaAnswer(null);
        onCommentAdded?.(result.comment);
        
        toast({
          title: t('commentPosted'),
          description: t('commentPostedSuccess'),
        });
      } else {
        setSubmitError(result.error || t('postCommentFailed'));
        
        // Reset CAPTCHA if it's a CAPTCHA-related error
        if (result.error?.includes('CAPTCHA')) {
          setCaptchaSessionId(null);
          setCaptchaAnswer(null);
          setShowCaptcha(true);
        }
      }
    } catch (error) {
      console.error('Error posting comment:', error);
      setSubmitError(t('postCommentError'));
    } finally {
      setIsSubmitting(false);
    }
  };

  return (
    <Card className="w-full">
      <CardHeader>
        <CardTitle className="flex items-center justify-between">
          <div className="flex items-center gap-2">
            {parentId ? <Reply className="w-5 h-5" /> : <MessageCircle className="w-5 h-5" />}
            {parentId ? t('replyTo', { author: parentAuthor }) : t('leaveComment')}
          </div>
          {parentId && onCancel && (
            <Button variant="ghost" size="sm" onClick={onCancel}>
              <X className="w-4 h-4" />
            </Button>
          )}
        </CardTitle>
      </CardHeader>
      <CardContent>
        <form onSubmit={handleSubmit(onSubmit)} className="space-y-4">
          {/* Author Name */}
          <div className="space-y-2">
            <Label htmlFor="authorName">{t('name')} *</Label>
            <Input
              id="authorName"
              {...register('authorName')}
              placeholder={t('namePlaceholder')}
              className={errors.authorName ? 'border-red-500' : ''}
            />
            {errors.authorName && (
              <p className="text-sm text-red-500">{errors.authorName.message}</p>
            )}
          </div>

          {/* Comment Content */}
          <div className="space-y-2">
            <Label htmlFor="content">{t('comment')} *</Label>
            <Textarea
              id="content"
              {...register('content')}
              placeholder={t('commentPlaceholder')}
              rows={4}
              className={errors.content ? 'border-red-500' : ''}
            />
            <div className="flex justify-between items-center text-sm text-muted-foreground">
              <span>{errors.content?.message || ''}</span>
              <span>{content.length}/500</span>
            </div>
          </div>

          {/* CAPTCHA */}
          {showCaptcha && (
            <motion.div
              initial={{ opacity: 0, height: 0 }}
              animate={{ opacity: 1, height: 'auto' }}
              exit={{ opacity: 0, height: 0 }}
              transition={{ duration: 0.3 }}
            >
              <MathCaptcha
                onVerify={handleCaptchaVerify}
                onSuccess={handleCaptchaSuccess}
                onError={handleCaptchaError}
              />
            </motion.div>
          )}

          {/* Success Message */}
          {submitSuccess && (
            <Alert className="border-green-500 bg-green-50 dark:bg-green-950">
              <CheckCircle className="h-4 w-4 text-green-600" />
              <AlertDescription className="text-green-800 dark:text-green-200">
                {t('commentPostedSuccess')}
              </AlertDescription>
            </Alert>
          )}

          {/* Error Message */}
          {submitError && (
            <Alert variant="destructive">
              <AlertCircle className="h-4 w-4" />
              <AlertDescription>{submitError}</AlertDescription>
            </Alert>
          )}

          {/* Submit Button */}
          <Button
            type="submit"
            className="w-full"
            disabled={isSubmitting}
          >
            {isSubmitting ? (
              <>
                <div className="animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"></div>
                {t('posting')}
              </>
            ) : (
              <>
                <Send className="w-4 h-4 mr-2" />
                {t('postComment')}
              </>
            )}
          </Button>
        </form>
      </CardContent>
    </Card>
  );
}
</file>

<file path="src/lib/blog-server.ts">
import { createPublicClient } from './supabase/server';
import type { Database } from '@/types/database';

type Post = Database['public']['Tables']['posts']['Row'];
type Category = Database['public']['Tables']['categories']['Row'];
type Tag = Database['public']['Tables']['tags']['Row'];

export interface PostWithRelations extends Post {
  category?: Category | null;
  tags?: Tag[];
}

export interface CategoryWithStats extends Category {
  post_count: number;
  trending?: boolean;
}

export interface TagWithStats extends Tag {
  post_count: number;
  trending?: boolean;
}

// Get published posts for public display
export async function getPublishedPosts(limit = 10, offset = 0) {
  const supabase = createPublicClient();
  const { data, error, count } = await supabase
    .from('posts')
    .select(`
      *,
      category:categories(*),
      post_tags(tag:tags(*))
    `, { count: 'exact' })
    .eq('status', 'published')
    .is('deleted_at', null)
    .order('published_at', { ascending: false })
    .range(offset, offset + limit - 1);

  if (error) {
    console.error('Error fetching posts:', error);
    return { posts: [], total: 0 };
  }

  // Transform the data to include tags array
  const posts: PostWithRelations[] = data?.map(post => ({
    ...post,
    tags: post.post_tags?.map(pt => pt.tag).filter(Boolean) || []
  })) || [];

  return { posts, total: count || 0 };
}

// Get single post by slug
export async function getPostBySlug(slug: string): Promise<PostWithRelations | null> {
  try {
    const supabase = createPublicClient();
    const { data, error } = await supabase
      .from('posts')
      .select(`
        *,
        category:categories(*),
        post_tags(tag:tags(*))
      `)
      .eq('slug', slug)
      .eq('status', 'published')
      .is('deleted_at', null)
      .single();

    if (error) {
      console.error('Error fetching post:', error);
      return null;
    }

    if (!data) {
      return null;
    }

    // Transform the data to include tags array
    const post: PostWithRelations = {
      ...data,
      tags: data.post_tags?.map(pt => pt.tag).filter(Boolean) || []
    };

    return post;
  } catch (error) {
    console.error('Unexpected error fetching post:', error);
    return null;
  }
}

// Get posts by category
export async function getPostsByCategory(categorySlug: string, limit = 10, offset = 0) {
  const supabase = createPublicClient();
  const { data, error, count } = await supabase
    .from('posts')
    .select(`
      *,
      category:categories!inner(*),
      post_tags(tag:tags(*))
    `, { count: 'exact' })
    .eq('category.slug', categorySlug)
    .eq('status', 'published')
    .is('deleted_at', null)
    .order('published_at', { ascending: false })
    .range(offset, offset + limit - 1);

  if (error) {
    console.error('Error fetching posts by category:', error);
    return { posts: [], total: 0 };
  }

  const posts: PostWithRelations[] = data?.map(post => ({
    ...post,
    tags: post.post_tags?.map(pt => pt.tag).filter(Boolean) || []
  })) || [];

  return { posts, total: count || 0 };
}

// Get posts by tag
export async function getPostsByTag(tagSlug: string, limit = 10, offset = 0) {
  const supabase = createPublicClient();
  const { data, error, count } = await supabase
    .from('posts')
    .select(`
      *,
      category:categories(*),
      post_tags!inner(tag:tags!inner(*))
    `, { count: 'exact' })
    .eq('post_tags.tag.slug', tagSlug)
    .eq('status', 'published')
    .is('deleted_at', null)
    .order('published_at', { ascending: false })
    .range(offset, offset + limit - 1);

  if (error) {
    console.error('Error fetching posts by tag:', error);
    return { posts: [], total: 0 };
  }

  const posts: PostWithRelations[] = data?.map(post => ({
    ...post,
    tags: post.post_tags?.map(pt => pt.tag).filter(Boolean) || []
  })) || [];

  return { posts, total: count || 0 };
}

// Get all categories
export async function getCategories() {
  const supabase = createPublicClient();
  const { data, error } = await supabase
    .from('categories')
    .select('*')
    .is('deleted_at', null)
    .order('name');

  if (error) {
    console.error('Error fetching categories:', error);
    return [];
  }

  return data || [];
}

// Get all tags
export async function getTags() {
  const supabase = createPublicClient();
  const { data, error } = await supabase
    .from('tags')
    .select('*')
    .is('deleted_at', null)
    .order('name');

  if (error) {
    console.error('Error fetching tags:', error);
    return [];
  }

  return data || [];
}

// Get categories with post counts
export async function getCategoriesWithStats(): Promise<CategoryWithStats[]> {
  const supabase = createPublicClient();
  const { data, error } = await supabase
    .from('categories')
    .select(`
      *,
      posts!inner(id)
    `)
    .is('deleted_at', null)
    .eq('posts.status', 'published')
    .is('posts.deleted_at', null);

  if (error) {
    console.error('Error fetching categories with stats:', error);
    return [];
  }

  // Count posts for each category
  const categoryStats = new Map<string, number>();
  data?.forEach(item => {
    const count = categoryStats.get(item.id.toString()) || 0;
    categoryStats.set(item.id.toString(), count + 1);
  });

  // Get unique categories and add post counts
  const uniqueCategories = new Map();
  data?.forEach(item => {
    if (!uniqueCategories.has(item.id)) {
      uniqueCategories.set(item.id, {
        ...item,
        post_count: categoryStats.get(item.id.toString()) || 0
      });
    }
  });

  return Array.from(uniqueCategories.values()).sort((a, b) => b.post_count - a.post_count);
}

// Get popular categories (top categories by post count)
export async function getPopularCategories(limit = 6): Promise<CategoryWithStats[]> {
  const categoriesWithStats = await getCategoriesWithStats();
  return categoriesWithStats.slice(0, limit);
}

// Get tags with post counts
export async function getTagsWithStats(): Promise<TagWithStats[]> {
  const supabase = createPublicClient();
  const { data, error } = await supabase
    .from('tags')
    .select(`
      *,
      post_tags!inner(
        posts!inner(id)
      )
    `)
    .is('deleted_at', null)
    .eq('post_tags.posts.status', 'published')
    .is('post_tags.posts.deleted_at', null);

  if (error) {
    console.error('Error fetching tags with stats:', error);
    return [];
  }

  // Count posts for each tag
  const tagStats = new Map<string, number>();
  data?.forEach(item => {
    const count = tagStats.get(item.id.toString()) || 0;
    tagStats.set(item.id.toString(), count + 1);
  });

  // Get unique tags and add post counts
  const uniqueTags = new Map();
  data?.forEach(item => {
    if (!uniqueTags.has(item.id)) {
      uniqueTags.set(item.id, {
        ...item,
        post_count: tagStats.get(item.id.toString()) || 0
      });
    }
  });

  return Array.from(uniqueTags.values()).sort((a, b) => b.post_count - a.post_count);
}

// Get trending tags (top tags by post count)
export async function getTrendingTags(limit = 10): Promise<TagWithStats[]> {
  const tagsWithStats = await getTagsWithStats();
  return tagsWithStats.slice(0, limit);
}
</file>

<file path="src/lib/blog.ts">
import { createClient } from './supabase/client';
import type { Database } from '@/types/database';

type Post = Database['public']['Tables']['posts']['Row'];
type Category = Database['public']['Tables']['categories']['Row'];
type Tag = Database['public']['Tables']['tags']['Row'];

export interface PostWithRelations extends Post {
  category?: Category | null;
  tags?: Tag[];
}

export interface CategoryWithStats extends Category {
  post_count: number;
  trending?: boolean;
}

export interface TagWithStats extends Tag {
  post_count: number;
  trending?: boolean;
}

// Get published posts for public display
export async function getPublishedPosts(limit = 10, offset = 0) {
  const supabase = createClient();
  const { data, error, count } = await supabase
    .from('posts')
    .select(`
      *,
      category:categories(*),
      post_tags(tag:tags(*))
    `, { count: 'exact' })
    .eq('status', 'published')
    .is('deleted_at', null)
    .order('published_at', { ascending: false })
    .range(offset, offset + limit - 1);

  if (error) {
    console.error('Error fetching posts:', error);
    return { posts: [], total: 0 };
  }

  // Transform the data to include tags array
  const posts: PostWithRelations[] = data?.map(post => ({
    ...post,
    tags: post.post_tags?.map(pt => pt.tag).filter(Boolean) || []
  })) || [];

  return { posts, total: count || 0 };
}

// Get single post by slug
export async function getPostBySlug(slug: string): Promise<PostWithRelations | null> {
  const supabase = createClient();
  const { data, error } = await supabase
    .from('posts')
    .select(`
      *,
      category:categories(*),
      post_tags(tag:tags(*))
    `)
    .eq('slug', slug)
    .eq('status', 'published')
    .is('deleted_at', null)
    .single();

  if (error) {
    console.error('Error fetching post:', error);
    return null;
  }

  // Transform the data to include tags array
  const post: PostWithRelations = {
    ...data,
    tags: data.post_tags?.map(pt => pt.tag).filter(Boolean) || []
  };

  return post;
}

// Get posts by category
export async function getPostsByCategory(categorySlug: string, limit = 10, offset = 0) {
  const supabase = createClient();
  const { data, error, count } = await supabase
    .from('posts')
    .select(`
      *,
      category:categories!inner(*),
      post_tags(tag:tags(*))
    `, { count: 'exact' })
    .eq('category.slug', categorySlug)
    .eq('status', 'published')
    .is('deleted_at', null)
    .order('published_at', { ascending: false })
    .range(offset, offset + limit - 1);

  if (error) {
    console.error('Error fetching posts by category:', error);
    return { posts: [], total: 0 };
  }

  const posts: PostWithRelations[] = data?.map(post => ({
    ...post,
    tags: post.post_tags?.map(pt => pt.tag).filter(Boolean) || []
  })) || [];

  return { posts, total: count || 0 };
}

// Get posts by tag
export async function getPostsByTag(tagSlug: string, limit = 10, offset = 0) {
  const supabase = createClient();
  const { data, error, count } = await supabase
    .from('posts')
    .select(`
      *,
      category:categories(*),
      post_tags!inner(tag:tags!inner(*))
    `, { count: 'exact' })
    .eq('post_tags.tag.slug', tagSlug)
    .eq('status', 'published')
    .is('deleted_at', null)
    .order('published_at', { ascending: false })
    .range(offset, offset + limit - 1);

  if (error) {
    console.error('Error fetching posts by tag:', error);
    return { posts: [], total: 0 };
  }

  const posts: PostWithRelations[] = data?.map(post => ({
    ...post,
    tags: post.post_tags?.map(pt => pt.tag).filter(Boolean) || []
  })) || [];

  return { posts, total: count || 0 };
}

// Get all categories
export async function getCategories() {
  const supabase = createClient();
  const { data, error } = await supabase
    .from('categories')
    .select('*')
    .is('deleted_at', null)
    .order('name');

  if (error) {
    console.error('Error fetching categories:', error);
    return [];
  }

  return data || [];
}

// Get all tags
export async function getTags() {
  const supabase = createClient();
  const { data, error } = await supabase
    .from('tags')
    .select('*')
    .is('deleted_at', null)
    .order('name');

  if (error) {
    console.error('Error fetching tags:', error);
    return [];
  }

  return data || [];
}

// Search posts
export async function searchPosts(query: string, limit = 10, offset = 0) {
  const supabase = createClient();
  const { data, error, count } = await supabase
    .from('posts')
    .select(`
      *,
      category:categories(*),
      post_tags(tag:tags(*))
    `, { count: 'exact' })
    .textSearch('search_vector', query)
    .eq('status', 'published')
    .is('deleted_at', null)
    .order('published_at', { ascending: false })
    .range(offset, offset + limit - 1);

  if (error) {
    console.error('Error searching posts:', error);
    return { posts: [], total: 0 };
  }

  const posts: PostWithRelations[] = data?.map(post => ({
    ...post,
    tags: post.post_tags?.map(pt => pt.tag).filter(Boolean) || []
  })) || [];

  return { posts, total: count || 0 };
}

// Get categories with post counts
export async function getCategoriesWithStats(): Promise<CategoryWithStats[]> {
  const supabase = createClient();
  const { data, error } = await supabase
    .from('categories')
    .select(`
      *,
      posts!inner(id)
    `)
    .is('deleted_at', null)
    .eq('posts.status', 'published')
    .is('posts.deleted_at', null);

  if (error) {
    console.error('Error fetching categories with stats:', error);
    return [];
  }

  // Count posts for each category
  const categoryStats = new Map<string, number>();
  data?.forEach(item => {
    const count = categoryStats.get(item.id.toString()) || 0;
    categoryStats.set(item.id.toString(), count + 1);
  });

  // Get unique categories and add post counts
  const uniqueCategories = new Map();
  data?.forEach(item => {
    if (!uniqueCategories.has(item.id)) {
      uniqueCategories.set(item.id, {
        ...item,
        post_count: categoryStats.get(item.id.toString()) || 0
      });
    }
  });

  return Array.from(uniqueCategories.values()).sort((a, b) => b.post_count - a.post_count);
}

// Get popular categories (top categories by post count)
export async function getPopularCategories(limit = 6): Promise<CategoryWithStats[]> {
  const categoriesWithStats = await getCategoriesWithStats();
  return categoriesWithStats.slice(0, limit);
}

// Get tags with post counts
export async function getTagsWithStats(): Promise<TagWithStats[]> {
  const supabase = createClient();
  const { data, error } = await supabase
    .from('tags')
    .select(`
      *,
      post_tags!inner(
        posts!inner(id)
      )
    `)
    .is('deleted_at', null)
    .eq('post_tags.posts.status', 'published')
    .is('post_tags.posts.deleted_at', null);

  if (error) {
    console.error('Error fetching tags with stats:', error);
    return [];
  }

  // Count posts for each tag
  const tagStats = new Map<string, number>();
  data?.forEach(item => {
    const count = tagStats.get(item.id.toString()) || 0;
    tagStats.set(item.id.toString(), count + 1);
  });

  // Get unique tags and add post counts
  const uniqueTags = new Map();
  data?.forEach(item => {
    if (!uniqueTags.has(item.id)) {
      uniqueTags.set(item.id, {
        ...item,
        post_count: tagStats.get(item.id.toString()) || 0
      });
    }
  });

  return Array.from(uniqueTags.values()).sort((a, b) => b.post_count - a.post_count);
}

// Get trending tags (top tags by post count)
export async function getTrendingTags(limit = 10): Promise<TagWithStats[]> {
  const tagsWithStats = await getTagsWithStats();
  return tagsWithStats.slice(0, limit);
}

// Delete post (soft delete)
export async function deletePost(postId: string) {
  const supabase = createClient();
  const { error } = await supabase
    .from('posts')
    .update({ 
      deleted_at: new Date().toISOString(),
      status: 'archived'
    })
    .eq('id', postId);

  if (error) {
    console.error('Error deleting post:', error);
    return { success: false, error };
  }

  return { success: true };
}
</file>

<file path="src/middleware.ts">
import { type NextRequest } from 'next/server'
import { updateSession } from '@/lib/supabase/middleware'
import createIntlMiddleware from 'next-intl/middleware'
import { routing } from './i18n/routing'

const intlMiddleware = createIntlMiddleware(routing)

export async function middleware(request: NextRequest) {
  // Skip intl middleware for API routes
  if (request.nextUrl.pathname.startsWith('/api/')) {
    return await updateSession(request)
  }
  
  // Handle internationalization first
  const response = intlMiddleware(request)
  
  // Then handle Supabase session
  return await updateSession(request, response)
}

export const config = {
  matcher: [
    /*
     * Match all request paths except for the ones starting with:
     * - _next/static (static files)
     * - _next/image (image optimization files)
     * - favicon.ico (favicon file)
     * Feel free to modify this pattern to include more paths.
     */
    '/((?!_next/static|_next/image|favicon.ico|.*\\.(?:svg|png|jpg|jpeg|gif|webp)$).*)',
  ],
}
</file>

<file path="src/app/[locale]/admin/categories/page.tsx">
'use client';

import { useState, useEffect, useCallback } from 'react';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { createClient } from '@/lib/supabase/client';
import { categorySchema, tagSchema, type CategoryFormData, type TagFormData } from '@/lib/validations/post';
import { generateSlug } from '@/lib/utils/slug';
import { useToast } from '@/hooks/use-toast';
import { useAuth } from '@/hooks/use-auth';

import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { Label } from '@/components/ui/label';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from '@/components/ui/form';
import { Badge } from '@/components/ui/badge';
import { Separator } from '@/components/ui/separator';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogFooter,
  DialogHeader,
  DialogTitle,
  DialogTrigger,
} from '@/components/ui/dialog';
import { Plus, Edit, Trash2, Tag, Folder, Loader2 } from 'lucide-react';

interface Category {
  id: number;
  name: string;
  slug: string;
  created_at: string;
  _count?: {
    posts: number;
  };
}

interface TagData {
  id: number;
  name: string;
  slug: string;
  created_at: string;
  _count?: {
    posts: number;
  };
}

export default function CategoriesPage() {
  const [categories, setCategories] = useState<Category[]>([]);
  const [tags, setTags] = useState<TagData[]>([]);
  const [loading, setLoading] = useState(true);
  const [submitting, setSubmitting] = useState(false);
  const [editingCategory, setEditingCategory] = useState<Category | null>(null);
  const [editingTag, setEditingTag] = useState<TagData | null>(null);
  const [showCategoryDialog, setShowCategoryDialog] = useState(false);
  const [showTagDialog, setShowTagDialog] = useState(false);
  
  const { toast } = useToast();
  const { user, isAdmin } = useAuth();
  const supabase = createClient();

  const categoryForm = useForm<CategoryFormData>({
    resolver: zodResolver(categorySchema),
    defaultValues: {
      name: '',
      slug: '',
    },
  });

  const tagForm = useForm<TagFormData>({
    resolver: zodResolver(tagSchema),
    defaultValues: {
      name: '',
      slug: '',
    },
  });

  const categoryName = categoryForm.watch('name');
  const tagName = tagForm.watch('name');

  // Auto-generate slug from name
  useEffect(() => {
    if (categoryName && !categoryForm.formState.dirtyFields.slug) {
      const slug = generateSlug(categoryName);
      categoryForm.setValue('slug', slug);
    }
  }, [categoryName, categoryForm]);

  useEffect(() => {
    if (tagName && !tagForm.formState.dirtyFields.slug) {
      const slug = generateSlug(tagName);
      tagForm.setValue('slug', slug);
    }
  }, [tagName, tagForm]);

  const loadData = useCallback(async () => {
    setLoading(true);
    
    try {
      // Load categories with post count
      const { data: categoriesData, error: categoriesError } = await supabase
        .from('categories')
        .select(`
          *,
          posts(count)
        `)
        .is('deleted_at', null)
        .order('name');

      if (categoriesError) throw categoriesError;

      // Load tags with post count
      const { data: tagsData, error: tagsError } = await supabase
        .from('tags')
        .select(`
          *,
          post_tags(count)
        `)
        .is('deleted_at', null)
        .order('name');

      if (tagsError) throw tagsError;

      // Transform data to include counts
      const transformedCategories = categoriesData?.map(cat => ({
        ...cat,
        _count: {
          posts: cat.posts?.length || 0
        }
      })) || [];

      const transformedTags = tagsData?.map(tag => ({
        ...tag,
        _count: {
          posts: tag.post_tags?.length || 0
        }
      })) || [];

      setCategories(transformedCategories);
      setTags(transformedTags);
    } catch (error) {
      console.error('Error loading data:', error);
      toast({
        variant: 'destructive',
        description: 'Failed to load categories and tags.',
      });
    } finally {
      setLoading(false);
    }
  }, [toast, supabase]);

  // Load data
  useEffect(() => {
    loadData();
  }, [loadData]);

  const handleCategorySubmit = async (data: CategoryFormData) => {
    setSubmitting(true);

    try {
      // Check if slug already exists
      const { data: existingCategory } = await supabase
        .from('categories')
        .select('id')
        .eq('slug', data.slug)
        .neq('id', editingCategory?.id || 0)
        .is('deleted_at', null)
        .single();

      if (existingCategory) {
        categoryForm.setError('slug', { message: 'This slug already exists' });
        return;
      }

      if (editingCategory) {
        // Update existing category
        const { error } = await supabase
          .from('categories')
          .update(data)
          .eq('id', editingCategory.id);

        if (error) throw error;

        toast({
          description: 'Category updated successfully!',
        });
      } else {
        // Create new category
        const { error } = await supabase
          .from('categories')
          .insert([data]);

        if (error) throw error;

        toast({
          description: 'Category created successfully!',
        });
      }

      setShowCategoryDialog(false);
      setEditingCategory(null);
      categoryForm.reset();
      loadData();
    } catch (error) {
      console.error('Error saving category:', error);
      toast({
        variant: 'destructive',
        description: 'Failed to save category. Please try again.',
      });
    } finally {
      setSubmitting(false);
    }
  };

  const handleTagSubmit = async (data: TagFormData) => {
    setSubmitting(true);

    try {
      // Check if slug already exists
      const { data: existingTag } = await supabase
        .from('tags')
        .select('id')
        .eq('slug', data.slug)
        .neq('id', editingTag?.id || 0)
        .is('deleted_at', null)
        .single();

      if (existingTag) {
        tagForm.setError('slug', { message: 'This slug already exists' });
        return;
      }

      if (editingTag) {
        // Update existing tag
        const { error } = await supabase
          .from('tags')
          .update(data)
          .eq('id', editingTag.id);

        if (error) throw error;

        toast({
          description: 'Tag updated successfully!',
        });
      } else {
        // Create new tag
        const { error } = await supabase
          .from('tags')
          .insert([data]);

        if (error) throw error;

        toast({
          description: 'Tag created successfully!',
        });
      }

      setShowTagDialog(false);
      setEditingTag(null);
      tagForm.reset();
      loadData();
    } catch (error) {
      console.error('Error saving tag:', error);
      toast({
        variant: 'destructive',
        description: 'Failed to save tag. Please try again.',
      });
    } finally {
      setSubmitting(false);
    }
  };

  const handleDeleteCategory = async (category: Category) => {
    if (category._count?.posts && category._count.posts > 0) {
      toast({
        variant: 'destructive',
        description: `Cannot delete category "${category.name}" because it has ${category._count.posts} posts.`,
      });
      return;
    }

    if (!confirm(`Are you sure you want to delete the category "${category.name}"?`)) {
      return;
    }

    try {
      const { error } = await supabase
        .from('categories')
        .update({ deleted_at: new Date().toISOString() })
        .eq('id', category.id);

      if (error) throw error;

      toast({
        description: 'Category deleted successfully!',
      });

      loadData();
    } catch (error) {
      console.error('Error deleting category:', error);
      toast({
        variant: 'destructive',
        description: 'Failed to delete category. Please try again.',
      });
    }
  };

  const handleDeleteTag = async (tag: TagData) => {
    if (tag._count?.posts && tag._count.posts > 0) {
      toast({
        variant: 'destructive',
        description: `Cannot delete tag "${tag.name}" because it has ${tag._count.posts} posts.`,
      });
      return;
    }

    if (!confirm(`Are you sure you want to delete the tag "${tag.name}"?`)) {
      return;
    }

    try {
      const { error } = await supabase
        .from('tags')
        .update({ deleted_at: new Date().toISOString() })
        .eq('id', tag.id);

      if (error) throw error;

      toast({
        description: 'Tag deleted successfully!',
      });

      loadData();
    } catch (error) {
      console.error('Error deleting tag:', error);
      toast({
        variant: 'destructive',
        description: 'Failed to delete tag. Please try again.',
      });
    }
  };

  const openCategoryDialog = (category?: Category) => {
    setEditingCategory(category || null);
    if (category) {
      categoryForm.reset({
        name: category.name,
        slug: category.slug,
      });
    } else {
      categoryForm.reset();
    }
    setShowCategoryDialog(true);
  };

  const openTagDialog = (tag?: TagData) => {
    setEditingTag(tag || null);
    if (tag) {
      tagForm.reset({
        name: tag.name,
        slug: tag.slug,
      });
    } else {
      tagForm.reset();
    }
    setShowTagDialog(true);
  };

  if (!isAdmin) {
    return (
      <div className="container py-8">
        <div className="text-center">
          <h1 className="text-2xl font-bold mb-4">Access Denied</h1>
          <p className="text-muted-foreground">You don&apos;t have permission to access this page.</p>
        </div>
        <div className="mt-4 p-4 bg-muted rounded-lg">
          <p className="text-sm">ë””ë²„ê·¸ ì •ë³´:</p>
          <p className="text-sm">ì‚¬ìš©ì: {user?.email || 'Not logged in'}</p>
          <p className="text-sm">ê´€ë¦¬ì ì—¬ë¶€: {isAdmin ? 'Yes' : 'No'}</p>
        </div>
      </div>
    );
  }

  if (loading) {
    return (
      <div className="container py-8">
        <div className="flex items-center justify-center">
          <div className="text-center">
            <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"></div>
            <p className="text-muted-foreground">Loading categories and tags...</p>
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="container py-8">
      <div className="mb-8">
        <h1 className="text-3xl font-bold">Categories & Tags</h1>
        <p className="text-muted-foreground">
          Organize your content with categories and tags
        </p>
      </div>

      <Tabs defaultValue="categories" className="w-full">
        <TabsList className="grid w-full grid-cols-2">
          <TabsTrigger value="categories">Categories</TabsTrigger>
          <TabsTrigger value="tags">Tags</TabsTrigger>
        </TabsList>

        <TabsContent value="categories" className="space-y-4">
          <div className="flex justify-between items-center">
            <h2 className="text-2xl font-semibold">Categories</h2>
            <Button onClick={() => openCategoryDialog()}>
              <Plus className="mr-2 h-4 w-4" />
              Add Category
            </Button>
          </div>

          <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
            {categories.map((category) => (
              <Card key={category.id}>
                <CardHeader className="pb-3">
                  <div className="flex items-center justify-between">
                    <div className="flex items-center gap-2">
                      <Folder className="h-5 w-5 text-blue-500" />
                      <CardTitle className="text-lg">{category.name}</CardTitle>
                    </div>
                    <Badge variant="secondary">
                      {category._count?.posts || 0} posts
                    </Badge>
                  </div>
                </CardHeader>
                <CardContent>
                  <div className="space-y-2">
                    <p className="text-sm text-muted-foreground">
                      Slug: {category.slug}
                    </p>
                    <p className="text-sm text-muted-foreground">
                      Created: {new Date(category.created_at).toLocaleDateString()}
                    </p>
                    <div className="flex gap-2">
                      <Button
                        variant="outline"
                        size="sm"
                        onClick={() => openCategoryDialog(category)}
                      >
                        <Edit className="h-4 w-4" />
                      </Button>
                      <Button
                        variant="outline"
                        size="sm"
                        onClick={() => handleDeleteCategory(category)}
                        disabled={category._count?.posts && category._count.posts > 0}
                      >
                        <Trash2 className="h-4 w-4" />
                      </Button>
                    </div>
                  </div>
                </CardContent>
              </Card>
            ))}
          </div>

          {categories.length === 0 && (
            <Card>
              <CardContent className="flex flex-col items-center justify-center py-12">
                <div className="text-center space-y-4">
                  <Folder className="h-12 w-12 text-muted-foreground mx-auto" />
                  <h3 className="text-lg font-semibold">No categories yet</h3>
                  <p className="text-muted-foreground max-w-sm">
                    Create your first category to organize your posts.
                  </p>
                  <Button onClick={() => openCategoryDialog()}>
                    <Plus className="mr-2 h-4 w-4" />
                    Add Category
                  </Button>
                </div>
              </CardContent>
            </Card>
          )}
        </TabsContent>

        <TabsContent value="tags" className="space-y-4">
          <div className="flex justify-between items-center">
            <h2 className="text-2xl font-semibold">Tags</h2>
            <Button onClick={() => openTagDialog()}>
              <Plus className="mr-2 h-4 w-4" />
              Add Tag
            </Button>
          </div>

          <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
            {tags.map((tag) => (
              <Card key={tag.id}>
                <CardHeader className="pb-3">
                  <div className="flex items-center justify-between">
                    <div className="flex items-center gap-2">
                      <Tag className="h-5 w-5 text-green-500" />
                      <CardTitle className="text-lg">{tag.name}</CardTitle>
                    </div>
                    <Badge variant="secondary">
                      {tag._count?.posts || 0} posts
                    </Badge>
                  </div>
                </CardHeader>
                <CardContent>
                  <div className="space-y-2">
                    <p className="text-sm text-muted-foreground">
                      Slug: {tag.slug}
                    </p>
                    <p className="text-sm text-muted-foreground">
                      Created: {new Date(tag.created_at).toLocaleDateString()}
                    </p>
                    <div className="flex gap-2">
                      <Button
                        variant="outline"
                        size="sm"
                        onClick={() => openTagDialog(tag)}
                      >
                        <Edit className="h-4 w-4" />
                      </Button>
                      <Button
                        variant="outline"
                        size="sm"
                        onClick={() => handleDeleteTag(tag)}
                        disabled={tag._count?.posts && tag._count.posts > 0}
                      >
                        <Trash2 className="h-4 w-4" />
                      </Button>
                    </div>
                  </div>
                </CardContent>
              </Card>
            ))}
          </div>

          {tags.length === 0 && (
            <Card>
              <CardContent className="flex flex-col items-center justify-center py-12">
                <div className="text-center space-y-4">
                  <Tag className="h-12 w-12 text-muted-foreground mx-auto" />
                  <h3 className="text-lg font-semibold">No tags yet</h3>
                  <p className="text-muted-foreground max-w-sm">
                    Create your first tag to label your posts.
                  </p>
                  <Button onClick={() => openTagDialog()}>
                    <Plus className="mr-2 h-4 w-4" />
                    Add Tag
                  </Button>
                </div>
              </CardContent>
            </Card>
          )}
        </TabsContent>
      </Tabs>

      {/* Category Dialog */}
      <Dialog open={showCategoryDialog} onOpenChange={setShowCategoryDialog}>
        <DialogContent>
          <DialogHeader>
            <DialogTitle>
              {editingCategory ? 'Edit Category' : 'Add Category'}
            </DialogTitle>
            <DialogDescription>
              {editingCategory 
                ? 'Update the category information.' 
                : 'Create a new category to organize your posts.'
              }
            </DialogDescription>
          </DialogHeader>
          <Form {...categoryForm}>
            <form onSubmit={categoryForm.handleSubmit(handleCategorySubmit)} className="space-y-4">
              <FormField
                control={categoryForm.control}
                name="name"
                render={({ field }) => (
                  <FormItem>
                    <FormLabel>Name</FormLabel>
                    <FormControl>
                      <Input placeholder="Enter category name..." {...field} />
                    </FormControl>
                    <FormMessage />
                  </FormItem>
                )}
              />
              <FormField
                control={categoryForm.control}
                name="slug"
                render={({ field }) => (
                  <FormItem>
                    <FormLabel>Slug</FormLabel>
                    <FormControl>
                      <Input placeholder="category-slug" {...field} />
                    </FormControl>
                    <FormMessage />
                  </FormItem>
                )}
              />
              <DialogFooter>
                <Button
                  type="button"
                  variant="outline"
                  onClick={() => setShowCategoryDialog(false)}
                  disabled={submitting}
                >
                  Cancel
                </Button>
                <Button type="submit" disabled={submitting}>
                  {submitting ? (
                    <>
                      <Loader2 className="mr-2 h-4 w-4 animate-spin" />
                      {editingCategory ? 'Updating...' : 'Creating...'}
                    </>
                  ) : (
                    editingCategory ? 'Update' : 'Create'
                  )}
                </Button>
              </DialogFooter>
            </form>
          </Form>
        </DialogContent>
      </Dialog>

      {/* Tag Dialog */}
      <Dialog open={showTagDialog} onOpenChange={setShowTagDialog}>
        <DialogContent>
          <DialogHeader>
            <DialogTitle>
              {editingTag ? 'Edit Tag' : 'Add Tag'}
            </DialogTitle>
            <DialogDescription>
              {editingTag 
                ? 'Update the tag information.' 
                : 'Create a new tag to label your posts.'
              }
            </DialogDescription>
          </DialogHeader>
          <Form {...tagForm}>
            <form onSubmit={tagForm.handleSubmit(handleTagSubmit)} className="space-y-4">
              <FormField
                control={tagForm.control}
                name="name"
                render={({ field }) => (
                  <FormItem>
                    <FormLabel>Name</FormLabel>
                    <FormControl>
                      <Input placeholder="Enter tag name..." {...field} />
                    </FormControl>
                    <FormMessage />
                  </FormItem>
                )}
              />
              <FormField
                control={tagForm.control}
                name="slug"
                render={({ field }) => (
                  <FormItem>
                    <FormLabel>Slug</FormLabel>
                    <FormControl>
                      <Input placeholder="tag-slug" {...field} />
                    </FormControl>
                    <FormMessage />
                  </FormItem>
                )}
              />
              <DialogFooter>
                <Button
                  type="button"
                  variant="outline"
                  onClick={() => setShowTagDialog(false)}
                  disabled={submitting}
                >
                  Cancel
                </Button>
                <Button type="submit" disabled={submitting}>
                  {submitting ? (
                    <>
                      <Loader2 className="mr-2 h-4 w-4 animate-spin" />
                      {editingTag ? 'Updating...' : 'Creating...'}
                    </>
                  ) : (
                    editingTag ? 'Update' : 'Create'
                  )}
                </Button>
              </DialogFooter>
            </form>
          </Form>
        </DialogContent>
      </Dialog>
    </div>
  );
}
</file>

<file path="src/app/[locale]/admin/page.tsx">
'use client';

import { useState, useEffect, useCallback } from 'react';
import { createClient } from '@/lib/supabase/client';
import { useAuth } from '@/hooks/use-auth';
import { Button } from '@/components/ui/button';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Plus, FileText, Users, Settings, Loader2, BarChart3, MessageCircle } from 'lucide-react';
import { AnalyticsDashboard } from '@/components/admin/analytics-dashboard';
import { RecentComments } from '@/components/admin/recent-comments';
import Link from 'next/link';

export default function AdminDashboard() {
  const [stats, setStats] = useState({
    totalPosts: 0,
    publishedPosts: 0,
    draftPosts: 0,
    loading: true
  });
  
  const { user, isAdmin, loading } = useAuth();
  const supabase = createClient();

  const loadStats = useCallback(async () => {
    try {
      // Get some basic stats
      const { count: totalPosts } = await supabase
        .from('posts')
        .select('*', { count: 'exact', head: true })
        .is('deleted_at', null);

      const { count: publishedPosts } = await supabase
        .from('posts')
        .select('*', { count: 'exact', head: true })
        .eq('status', 'published')
        .is('deleted_at', null);

      const { count: draftPosts } = await supabase
        .from('posts')
        .select('*', { count: 'exact', head: true })
        .eq('status', 'draft')
        .is('deleted_at', null);

      setStats({
        totalPosts: totalPosts || 0,
        publishedPosts: publishedPosts || 0,
        draftPosts: draftPosts || 0,
        loading: false
      });
    } catch (error) {
      console.error('Error loading stats:', error);
      setStats(prev => ({ ...prev, loading: false }));
    }
  }, []);

  useEffect(() => {
    if (user && isAdmin) {
      loadStats();
    }
  }, [user, isAdmin, loadStats]);

  if (loading) {
    return (
      <div className="container py-8">
        <div className="flex items-center justify-center min-h-[200px]">
          <div className="text-center">
            <Loader2 className="h-8 w-8 animate-spin mx-auto mb-4" />
            <p className="text-muted-foreground">Loading...</p>
          </div>
        </div>
      </div>
    );
  }

  if (!isAdmin) {
    return (
      <div className="container py-8">
        <div className="text-center">
          <h1 className="text-2xl font-bold mb-4">Access Denied</h1>
          <p className="text-muted-foreground mb-4">You don&apos;t have permission to access this page.</p>
          <div className="mt-4 p-4 bg-muted rounded-lg">
            <p className="text-sm">Debug Info:</p>
            <p className="text-sm">User: {user?.email || 'Not logged in'}</p>
            <p className="text-sm">Is Admin: {isAdmin ? 'Yes' : 'No'}</p>
            <p className="text-sm">Loading: {loading ? 'Yes' : 'No'}</p>
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="container py-8">
      <div className="flex items-center justify-between mb-8">
        <div>
          <h1 className="text-3xl font-bold">Admin Dashboard</h1>
          <p className="text-muted-foreground">
            Welcome back! Manage your blog content and settings.
          </p>
        </div>
        <Button asChild>
          <Link href="/admin/posts/new">
            <Plus className="mr-2 h-4 w-4" />
            New Post
          </Link>
        </Button>
      </div>

      {/* Analytics Dashboard */}
      <div className="mb-8">
        <div className="flex items-center gap-2 mb-4">
          <BarChart3 className="h-5 w-5" />
          <h2 className="text-xl font-semibold">Analytics Dashboard</h2>
        </div>
        <AnalyticsDashboard />
      </div>

      {/* Recent Comments Section */}
      <div className="mb-8">
        <div className="flex items-center gap-2 mb-4">
          <MessageCircle className="h-5 w-5" />
          <h2 className="text-xl font-semibold">Recent Activity</h2>
        </div>
        <RecentComments limit={5} showViewAll={true} />
      </div>

      {/* Quick Actions */}
      <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-4">
        <Card className="hover:shadow-lg transition-shadow cursor-pointer">
          <Link href="/admin/posts">
            <CardHeader>
              <CardTitle className="flex items-center gap-2">
                <FileText className="h-5 w-5" />
                Manage Posts
              </CardTitle>
              <CardDescription>
                View, edit, and manage all your blog posts
              </CardDescription>
            </CardHeader>
          </Link>
        </Card>

        <Card className="hover:shadow-lg transition-shadow cursor-pointer">
          <Link href="/admin/posts/new">
            <CardHeader>
              <CardTitle className="flex items-center gap-2">
                <Plus className="h-5 w-5" />
                Create New Post
              </CardTitle>
              <CardDescription>
                Write and publish a new blog post
              </CardDescription>
            </CardHeader>
          </Link>
        </Card>

        <Card className="hover:shadow-lg transition-shadow cursor-pointer">
          <Link href="/admin/comments">
            <CardHeader>
              <CardTitle className="flex items-center gap-2">
                <MessageCircle className="h-5 w-5" />
                Manage Comments
              </CardTitle>
              <CardDescription>
                Monitor and moderate all user comments
              </CardDescription>
            </CardHeader>
          </Link>
        </Card>

        <Card className="hover:shadow-lg transition-shadow cursor-pointer">
          <Link href="/admin/categories">
            <CardHeader>
              <CardTitle className="flex items-center gap-2">
                <Settings className="h-5 w-5" />
                Categories & Tags
              </CardTitle>
              <CardDescription>
                Organize your content with categories and tags
              </CardDescription>
            </CardHeader>
          </Link>
        </Card>
      </div>
    </div>
  );
}
</file>

<file path="src/app/[locale]/page.tsx">
import { Suspense } from 'react';
import { getPublishedPosts } from '@/lib/blog-server';
import { PostCard } from '@/components/blog/post-card';
import { Button } from '@/components/ui/button';
import { MotionButton } from '@/components/ui/motion-button';
import { ArrowRight, BookOpen } from 'lucide-react';
import { Link } from '@/i18n/routing';
import { JsonLd } from '@/components/seo/json-ld';
import { getTranslations } from 'next-intl/server';
import { HomePageClient } from './home-page-client';

interface HomePageProps {
  params: Promise<{ locale: string }>;
}

export default async function HomePage({ params }: HomePageProps) {
  const { locale } = await params;
  const { posts, total } = await getPublishedPosts(6);
  
  const t = await getTranslations({ locale, namespace: 'blog' });
  const tNav = await getTranslations({ locale, namespace: 'navigation' });

  // Resolve translations to strings
  const translations = {
    allPosts: t('allPosts'),
    recentPosts: t('recentPosts'),
    noPostsFound: t('noPostsFound'),
    categories: tNav('categories'),
    about: tNav('about'),
  };

  return (
    <>
      <JsonLd type="website" />
      <JsonLd type="blog" />
      <HomePageClient 
        posts={posts}
        total={total}
        translations={translations}
      />
    </>
  );
}
</file>

<file path="src/app/[locale]/providers.tsx">
"use client";

import { ThemeProvider } from '@/components/theme/theme-provider';
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import { MotionProvider } from '@/components/motion/motion-provider';
import { useState } from 'react';

export default function Providers({ children }: { children: React.ReactNode }) {
  const [queryClient] = useState(() => new QueryClient({
    defaultOptions: {
      queries: {
        staleTime: 60 * 1000,
        refetchOnWindowFocus: false,
      },
    },
  }));

  return (
    <QueryClientProvider client={queryClient}>
      <MotionProvider>
        <ThemeProvider
          attribute="class"
          defaultTheme="system"
          enableSystem
          disableTransitionOnChange
          storageKey="devblog-theme"
        >
          {children}
        </ThemeProvider>
      </MotionProvider>
    </QueryClientProvider>
  );
}
</file>

<file path="src/components/blog/admin-actions.tsx">
'use client';

import { useState } from 'react';
import { useRouter } from 'next/navigation';
import { useTranslations } from 'next-intl';
import { motion, AnimatePresence } from 'framer-motion';
import { Button } from '@/components/ui/button';
import { 
  DropdownMenu, 
  DropdownMenuContent, 
  DropdownMenuItem, 
  DropdownMenuTrigger,
  DropdownMenuSeparator 
} from '@/components/ui/dropdown-menu';
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from '@/components/ui/alert-dialog';
import { MoreHorizontal, Edit, Trash2, Settings } from 'lucide-react';
import { useToast } from '@/hooks/use-toast';
import { deletePost } from '@/lib/blog';
import { buttonVariants, modalVariants, dropdownVariants } from '@/lib/animations';
import type { PostWithRelations } from '@/lib/blog';

interface AdminActionsProps {
  post: PostWithRelations;
}

export function AdminActions({ post }: AdminActionsProps) {
  const [showDeleteDialog, setShowDeleteDialog] = useState(false);
  const [isDeleting, setIsDeleting] = useState(false);
  const router = useRouter();
  const { toast } = useToast();
  const t = useTranslations('admin');
  const tCommon = useTranslations('common');

  const handleEdit = () => {
    router.push(`/admin/posts/${post.id}/edit`);
  };

  const handleDelete = async () => {
    setIsDeleting(true);
    
    try {
      const result = await deletePost(post.id);
      
      if (result.success) {
        toast({
          title: t('postDeleted'),
          description: t('postDeletedSuccess'),
        });
        router.push('/posts');
        router.refresh();
      } else {
        throw new Error('Delete failed');
      }
    } catch (error) {
      toast({
        title: t('deleteFailed'),
        description: t('deleteError'),
        variant: "destructive",
      });
    } finally {
      setIsDeleting(false);
      setShowDeleteDialog(false);
    }
  };

  return (
    <>
      <DropdownMenu>
        <DropdownMenuTrigger asChild>
          <motion.div
            variants={buttonVariants}
            initial="initial"
            whileHover="hover"
            whileTap="tap"
          >
            <Button variant="outline" size="sm" className="group">
              <motion.div
                animate={{ rotate: [0, 180, 0] }}
                transition={{ duration: 2, repeat: Infinity, ease: "easeInOut" }}
              >
                <Settings className="h-4 w-4 mr-2" />
              </motion.div>
              {t('manage')}
              <motion.div
                animate={{ rotate: [-90, 90, -90] }}
                transition={{ duration: 1.5, repeat: Infinity, ease: "easeInOut" }}
              >
                <MoreHorizontal className="h-4 w-4 ml-2" />
              </motion.div>
            </Button>
          </motion.div>
        </DropdownMenuTrigger>
        <DropdownMenuContent align="end">
          <DropdownMenuItem onClick={handleEdit}>
            <Edit className="mr-2 h-4 w-4" />
            {tCommon('edit')}
          </DropdownMenuItem>
          <DropdownMenuSeparator />
          <DropdownMenuItem 
            onClick={() => setShowDeleteDialog(true)}
            className="text-destructive"
          >
            <Trash2 className="mr-2 h-4 w-4" />
            {tCommon('delete')}
          </DropdownMenuItem>
        </DropdownMenuContent>
      </DropdownMenu>

      <AnimatePresence>
        {showDeleteDialog && (
          <AlertDialog open={showDeleteDialog} onOpenChange={setShowDeleteDialog}>
            <AlertDialogContent asChild>
              <motion.div
                variants={modalVariants}
                initial="hidden"
                animate="visible"
                exit="exit"
              >
                <AlertDialogHeader>
                  <AlertDialogTitle className="flex items-center gap-2">
                    <motion.div
                      animate={{ scale: [1, 1.2, 1] }}
                      transition={{ duration: 0.5, repeat: Infinity }}
                    >
                      <Trash2 className="h-5 w-5 text-destructive" />
                    </motion.div>
                    {t('confirmDeletePost')}
                  </AlertDialogTitle>
                  <AlertDialogDescription>
                    {t('deleteWarning', { title: post.title })}
                  </AlertDialogDescription>
                </AlertDialogHeader>
                <AlertDialogFooter>
                  <motion.div whileHover={{ scale: 1.05 }} whileTap={{ scale: 0.95 }}>
                    <AlertDialogCancel disabled={isDeleting}>{tCommon('cancel')}</AlertDialogCancel>
                  </motion.div>
                  <motion.div 
                    whileHover={{ scale: 1.05 }} 
                    whileTap={{ scale: 0.95 }}
                    animate={isDeleting ? { scale: [1, 1.05, 1] } : {}}
                    transition={isDeleting ? { duration: 0.5, repeat: Infinity } : {}}
                  >
                    <AlertDialogAction 
                      onClick={handleDelete}
                      disabled={isDeleting}
                      className="bg-destructive text-destructive-foreground hover:bg-destructive/90"
                    >
                      {isDeleting ? (
                        <motion.span
                          animate={{ opacity: [1, 0.5, 1] }}
                          transition={{ duration: 1, repeat: Infinity }}
                        >
                          {t('deleting')}
                        </motion.span>
                      ) : (
                        tCommon('delete')
                      )}
                    </AlertDialogAction>
                  </motion.div>
                </AlertDialogFooter>
              </motion.div>
            </AlertDialogContent>
          </AlertDialog>
        )}
      </AnimatePresence>
    </>
  );
}
</file>

<file path="src/components/blog/comment-section.tsx">
'use client';

import { useState, useEffect, useCallback } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { useTranslations } from 'next-intl';
import { Button } from '@/components/ui/button';
import { Card, CardContent } from '@/components/ui/card';
import { Separator } from '@/components/ui/separator';
import { Alert, AlertDescription } from '@/components/ui/alert';
import { CommentForm } from '@/components/blog/comment-form';
import { 
  MessageCircle, 
  Calendar, 
  User, 
  Trash2, 
  AlertCircle,
  RefreshCw,
  ChevronLeft,
  ChevronRight,
  Clock
} from 'lucide-react';
import { useAuth } from '@/hooks/use-auth';
import { useToast } from '@/hooks/use-toast';
import { formatDistanceToNow } from 'date-fns';

interface Comment {
  id: string;
  content: string;
  author_name: string;
  created_at: string;
  updated_at: string;
}

interface CommentsPagination {
  page: number;
  limit: number;
  total: number;
  totalPages: number;
}

interface CommentSectionProps {
  postId: string;
}

interface CommentsResponse {
  comments: Comment[];
  userDeletableComments: string[];
  pagination: CommentsPagination;
}

export function CommentSection({ postId }: CommentSectionProps) {
  const [comments, setComments] = useState<Comment[]>([]);
  const [userDeletableComments, setUserDeletableComments] = useState<string[]>([]);
  const [pagination, setPagination] = useState<CommentsPagination>({
    page: 1,
    limit: 10,
    total: 0,
    totalPages: 0,
  });
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [deleting, setDeleting] = useState<string | null>(null);
  const [sessionInitialized, setSessionInitialized] = useState(false);
  
  const { isAdmin } = useAuth();
  const { toast } = useToast();
  const t = useTranslations('comments');
  const tCommon = useTranslations('common');

  // Initialize comment session on component mount
  const initializeCommentSession = useCallback(async () => {
    try {
      const response = await fetch('/api/comments/session', {
        method: 'POST',
      });
      
      if (response.ok) {
        setSessionInitialized(true);
      }
    } catch (error) {
      console.error('Failed to initialize comment session:', error);
      // This is not a fatal error, user can still view comments
    }
  }, []);

  const fetchComments = useCallback(async (page: number = 1) => {
    setLoading(true);
    setError(null);
    
    try {
      const response = await fetch(`/api/comments?postId=${postId}&page=${page}&limit=${pagination.limit}`);
      const data: CommentsResponse = await response.json();
      
      if (response.ok) {
        setComments(data.comments);
        setUserDeletableComments(data.userDeletableComments);
        setPagination(data.pagination);
      } else {
        setError(t('loadCommentsFailed'));
      }
    } catch (err) {
      setError(t('loadCommentsFailed'));
    } finally {
      setLoading(false);
    }
  }, [postId, pagination.limit]);

  const handleDeleteComment = async (commentId: string) => {
    if (!confirm(t('confirmDeleteComment'))) {
      return;
    }

    setDeleting(commentId);
    
    try {
      const response = await fetch(`/api/comments/${commentId}`, {
        method: 'DELETE',
      });
      
      if (response.ok) {
        setComments(comments.filter(comment => comment.id !== commentId));
        setPagination(prev => ({
          ...prev,
          total: prev.total - 1,
        }));
        
        toast({
          title: t('commentDeleted'),
          description: t('commentDeletedSuccess'),
        });
      } else {
        const data = await response.json();
        toast({
          title: t('deleteFailed'),
          description: data.error || t('deleteCommentFailed'),
          variant: 'destructive',
        });
      }
    } catch (err) {
      toast({
        title: t('deleteFailed'),
        description: t('deleteCommentFailed'),
        variant: 'destructive',
      });
    } finally {
      setDeleting(null);
    }
  };

  const handleCommentAdded = (newComment: Comment) => {
    setComments(prev => [newComment, ...prev]);
    setUserDeletableComments(prev => [...prev, newComment.id]);
    setPagination(prev => ({
      ...prev,
      total: prev.total + 1,
    }));
  };

  const handlePageChange = (newPage: number) => {
    if (newPage >= 1 && newPage <= pagination.totalPages) {
      fetchComments(newPage);
    }
  };

  useEffect(() => {
    // Initialize session and fetch comments in parallel
    initializeCommentSession();
    fetchComments();
  }, [postId, initializeCommentSession, fetchComments]);

  const containerVariants = {
    hidden: { opacity: 0 },
    visible: {
      opacity: 1,
      transition: {
        staggerChildren: 0.1,
      },
    },
  };

  const itemVariants = {
    hidden: { y: 20, opacity: 0 },
    visible: {
      y: 0,
      opacity: 1,
      transition: {
        duration: 0.5,
      },
    },
  };

  return (
    <div className="space-y-8">
      {/* Comments Header */}
      <div className="flex items-center justify-between">
        <h2 className="text-2xl font-bold flex items-center gap-2">
          <MessageCircle className="w-6 h-6" />
          {t('comments')} ({pagination.total})
          {sessionInitialized && (
            <span className="text-xs text-green-600 dark:text-green-400 ml-2">
              {t('sessionReady')}
            </span>
          )}
        </h2>
        
        <Button
          variant="outline"
          size="sm"
          onClick={() => fetchComments(pagination.page)}
          disabled={loading}
        >
          <RefreshCw className={`w-4 h-4 mr-2 ${loading ? 'animate-spin' : ''}`} />
          {tCommon('refresh')}
        </Button>
      </div>

      {/* Comment Form */}
      <CommentForm postId={postId} onCommentAdded={handleCommentAdded} />

      <Separator />

      {/* Comments List */}
      <div className="space-y-6">
        {loading && comments.length === 0 ? (
          <div className="flex items-center justify-center py-8">
            <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
          </div>
        ) : error ? (
          <Alert variant="destructive">
            <AlertCircle className="h-4 w-4" />
            <AlertDescription>{error}</AlertDescription>
          </Alert>
        ) : comments.length === 0 ? (
          <div className="text-center py-8">
            <MessageCircle className="w-12 h-12 text-muted-foreground mx-auto mb-4" />
            <p className="text-muted-foreground">{t('noComments')}</p>
          </div>
        ) : (
          <motion.div
            variants={containerVariants}
            initial="hidden"
            animate="visible"
            className="space-y-4"
          >
            <AnimatePresence>
              {comments.map((comment) => (
                <motion.div
                  key={comment.id}
                  variants={itemVariants}
                  initial="hidden"
                  animate="visible"
                  exit="hidden"
                  layout
                >
                  <Card className="transition-all duration-200 hover:shadow-md">
                    <CardContent className="p-4">
                      <div className="flex items-start justify-between">
                        <div className="flex-1">
                          <div className="flex items-center gap-2 mb-2">
                            <User className="w-4 h-4 text-muted-foreground" />
                            <span className="font-medium">{comment.author_name}</span>
                            <span className="text-muted-foreground">â€¢</span>
                            <span className="text-sm text-muted-foreground flex items-center gap-1">
                              <Calendar className="w-3 h-3" />
                              {formatDistanceToNow(new Date(comment.created_at), { addSuffix: true })}
                            </span>
                          </div>
                          <p className="text-sm leading-relaxed whitespace-pre-wrap">
                            {comment.content}
                          </p>
                        </div>
                        
                        {(isAdmin || userDeletableComments.includes(comment.id)) && (
                          <div className="flex items-center gap-2">
                            {!isAdmin && userDeletableComments.includes(comment.id) && (
                              <div className="flex items-center gap-1 text-xs text-muted-foreground">
                                <Clock className="w-3 h-3" />
                                <span>{t('canDeleteComment')}</span>
                              </div>
                            )}
                            <Button
                              variant="ghost"
                              size="sm"
                              onClick={() => handleDeleteComment(comment.id)}
                              disabled={deleting === comment.id}
                              className="text-red-500 hover:text-red-700 hover:bg-red-50"
                              title={isAdmin ? t('deleteCommentAdmin') : t('deleteYourComment')}
                            >
                              {deleting === comment.id ? (
                                <div className="animate-spin rounded-full h-4 w-4 border-b-2 border-red-500"></div>
                              ) : (
                                <Trash2 className="w-4 h-4" />
                              )}
                            </Button>
                          </div>
                        )}
                      </div>
                    </CardContent>
                  </Card>
                </motion.div>
              ))}
            </AnimatePresence>
          </motion.div>
        )}
      </div>

      {/* Pagination */}
      {pagination.totalPages > 1 && (
        <div className="flex items-center justify-center gap-2">
          <Button
            variant="outline"
            size="sm"
            onClick={() => handlePageChange(pagination.page - 1)}
            disabled={pagination.page === 1}
          >
            <ChevronLeft className="w-4 h-4 mr-1" />
            {tCommon('previous')}
          </Button>
          
          <div className="flex items-center gap-2">
            {Array.from({ length: pagination.totalPages }, (_, i) => i + 1).map((page) => (
              <Button
                key={page}
                variant={page === pagination.page ? "default" : "outline"}
                size="sm"
                onClick={() => handlePageChange(page)}
                className="w-8 h-8 p-0"
              >
                {page}
              </Button>
            ))}
          </div>
          
          <Button
            variant="outline"
            size="sm"
            onClick={() => handlePageChange(pagination.page + 1)}
            disabled={pagination.page === pagination.totalPages}
          >
            {tCommon('next')}
            <ChevronRight className="w-4 h-4 ml-1" />
          </Button>
        </div>
      )}
    </div>
  );
}
</file>

<file path="src/components/seo/json-ld.tsx">
import { PostWithRelations } from '@/lib/blog';

interface JsonLdProps {
  type: 'website' | 'article' | 'blog';
  post?: any;
}

function sanitizeContent(content: string): string {
  if (!content) return '';
  
  // Remove HTML tags and decode HTML entities
  const withoutTags = content.replace(/<[^>]*>/g, '');
  const withoutEntities = withoutTags
    .replace(/&amp;/g, '&')
    .replace(/&lt;/g, '<')
    .replace(/&gt;/g, '>')
    .replace(/&quot;/g, '"')
    .replace(/&#39;/g, "'");
  
  // Remove extra whitespace and newlines
  const cleaned = withoutEntities.replace(/\s+/g, ' ').trim();
  
  // Limit length and ensure safe characters
  return cleaned.length > 160 ? cleaned.substring(0, 160) + '...' : cleaned;
}

function safeStringify(obj: any): string {
  try {
    return JSON.stringify(obj);
  } catch (error) {
    console.error('JSON.stringify error:', error);
    return '{}';
  }
}

export function JsonLd({ type, post }: JsonLdProps) {
  const baseUrl = process.env.NEXT_PUBLIC_SITE_URL || 'http://localhost:3000';

  if (type === 'website') {
    const websiteData = {
      '@context': 'https://schema.org',
      '@type': 'WebSite',
      name: 'Dev-eloper',
      description: 'Dev-eloper - A modern blog platform built with Next.js and Supabase',
      url: baseUrl,
      potentialAction: {
        '@type': 'SearchAction',
        target: `${baseUrl}/search?q={search_term_string}`,
        'query-input': 'required name=search_term_string',
      },
    };

    return (
      <script
        type="application/ld+json"
        dangerouslySetInnerHTML={{ __html: safeStringify(websiteData) }}
      />
    );
  }

  if (type === 'blog') {
    const blogData = {
      '@context': 'https://schema.org',
      '@type': 'Blog',
      name: 'Dev-eloper',
      description: 'Dev-eloper - A modern blog platform built with Next.js and Supabase',
      url: baseUrl,
      author: {
        '@type': 'Person',
        name: 'Dev-eloper',
      },
      publisher: {
        '@type': 'Organization',
        name: 'Dev-eloper',
        logo: {
          '@type': 'ImageObject',
          url: `${baseUrl}/logo.png`,
        },
      },
    };

    return (
      <script
        type="application/ld+json"
        dangerouslySetInnerHTML={{ __html: safeStringify(blogData) }}
      />
    );
  }

  if (type === 'article' && post) {
    const description = sanitizeContent(post.content || '');
    const articleData = {
      '@context': 'https://schema.org',
      '@type': 'Article',
      headline: post.title || 'Untitled',
      description: description || post.title || 'No description available',
      author: {
        '@type': 'Person',
        name: 'Dev-eloper',
      },
      publisher: {
        '@type': 'Organization',
        name: 'Dev-eloper',
        logo: {
          '@type': 'ImageObject',
          url: `${baseUrl}/logo.png`,
        },
      },
      datePublished: post.created_at || new Date().toISOString(),
      dateModified: post.updated_at || post.created_at || new Date().toISOString(),
      url: `${baseUrl}/posts/${post.slug}`,
      image: post.cover_image_path ? [post.cover_image_path] : [`${baseUrl}/og-image.jpg`],
      articleSection: post.category?.name || 'General',
      keywords: post.tags?.map((tag: any) => tag.name).join(', ') || '',
    };

    return (
      <script
        type="application/ld+json"
        dangerouslySetInnerHTML={{ __html: safeStringify(articleData) }}
      />
    );
  }

  return null;
}
</file>

<file path="src/lib/supabase/server.ts">
import { createServerClient } from '@supabase/ssr'
import { cookies } from 'next/headers'
import type { Database } from '@/types/database'

// Environment variable validation
function validateEnvVars() {
  const url = process.env.NEXT_PUBLIC_SUPABASE_URL;
  const key = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;
  
  if (!url || !key) {
    throw new Error('Missing required Supabase environment variables');
  }
  
  return { url, key };
}

export async function createClient() {
  const { url, key } = validateEnvVars();
  const cookieStore = await cookies()

  return createServerClient<Database>(
    url,
    key,
    {
      cookies: {
        getAll() {
          return cookieStore.getAll()
        },
        setAll(cookiesToSet) {
          try {
            cookiesToSet.forEach(({ name, value, options }) => {
              cookieStore.set(name, value, options)
            })
          } catch (error) {
            // The `setAll` method was called from a Server Component.
            // This can be ignored if you have middleware refreshing
            // user sessions.
            console.warn('Cookie setting failed in server component:', error)
          }
        },
      },
    }
  )
}

// Create a simplified client for public read-only operations
export function createPublicClient() {
  const { url, key } = validateEnvVars();
  
  return createServerClient<Database>(
    url,
    key,
    {
      cookies: {
        getAll() {
          return []
        },
        setAll() {
          // No-op for public client
        },
      },
    }
  )
}
</file>

<file path="tailwind.config.ts">
import type { Config } from 'tailwindcss';

const config = {
  darkMode: ['class'],
  content: ['./src/**/*.{ts,tsx}'],
  prefix: '',
  theme: {
    container: {
      center: true,
      padding: '2rem',
      screens: {
        '2xl': '1400px',
      },
    },
    extend: {
      fontFamily: {
        sans: ['var(--font-inter)', 'system-ui', 'sans-serif'],
        mono: ['var(--font-jetbrains-mono)', 'monospace'],
      },
      fontSize: {
        'xs': ['0.75rem', { lineHeight: '1rem' }],
        'sm': ['0.875rem', { lineHeight: '1.25rem' }],
        'base': ['1rem', { lineHeight: '1.5rem' }],
        'lg': ['1.125rem', { lineHeight: '1.75rem' }],
        'xl': ['1.25rem', { lineHeight: '1.75rem' }],
        '2xl': ['1.5rem', { lineHeight: '2rem' }],
        '3xl': ['1.875rem', { lineHeight: '2.25rem' }],
        '4xl': ['2.25rem', { lineHeight: '2.5rem' }],
        '5xl': ['3rem', { lineHeight: '1.16' }],
        '6xl': ['3.75rem', { lineHeight: '1.16' }],
        '7xl': ['4.5rem', { lineHeight: '1.16' }],
        '8xl': ['6rem', { lineHeight: '1.16' }],
        '9xl': ['8rem', { lineHeight: '1.16' }],
      },
      colors: {
        border: 'hsl(var(--border))',
        input: 'hsl(var(--input))',
        ring: 'hsl(var(--ring))',
        background: 'hsl(var(--background))',
        foreground: 'hsl(var(--foreground))',
        primary: {
          DEFAULT: 'hsl(var(--primary))',
          foreground: 'hsl(var(--primary-foreground))',
        },
        secondary: {
          DEFAULT: 'hsl(var(--secondary))',
          foreground: 'hsl(var(--secondary-foreground))',
        },
        destructive: {
          DEFAULT: 'hsl(var(--destructive))',
          foreground: 'hsl(var(--destructive-foreground))',
        },
        muted: {
          DEFAULT: 'hsl(var(--muted))',
          foreground: 'hsl(var(--muted-foreground))',
        },
        accent: {
          DEFAULT: 'hsl(var(--accent))',
          foreground: 'hsl(var(--accent-foreground))',
        },
        popover: {
          DEFAULT: 'hsl(var(--popover))',
          foreground: 'hsl(var(--popover-foreground))',
        },
        card: {
          DEFAULT: 'hsl(var(--card))',
          foreground: 'hsl(var(--card-foreground))',
        },
        gray: {
          50: 'hsl(var(--gray-50))',
          100: 'hsl(var(--gray-100))',
          200: 'hsl(var(--gray-200))',
          300: 'hsl(var(--gray-300))',
          400: 'hsl(var(--gray-400))',
          500: 'hsl(var(--gray-500))',
          600: 'hsl(var(--gray-600))',
          700: 'hsl(var(--gray-700))',
          800: 'hsl(var(--gray-800))',
          900: 'hsl(var(--gray-900))',
        },
      },
      borderRadius: {
        'xs': '0.25rem',
        'sm': '0.375rem',
        'md': '0.5rem',
        'lg': 'var(--radius)',
        'xl': '1rem',
        '2xl': '1.25rem',
        '3xl': '1.5rem',
      },
      spacing: {
        '18': '4.5rem',
        '88': '22rem',
        '128': '32rem',
      },
      keyframes: {
        'accordion-down': {
          from: { height: '0' },
          to: { height: 'var(--radix-accordion-content-height)' },
        },
        'accordion-up': {
          from: { height: 'var(--radix-accordion-content-height)' },
          to: { height: '0' },
        },
        // Advanced animations
        'fade-in': {
          '0%': { opacity: '0' },
          '100%': { opacity: '1' },
        },
        'fade-in-up': {
          '0%': { opacity: '0', transform: 'translateY(20px)' },
          '100%': { opacity: '1', transform: 'translateY(0)' },
        },
        'fade-in-down': {
          '0%': { opacity: '0', transform: 'translateY(-20px)' },
          '100%': { opacity: '1', transform: 'translateY(0)' },
        },
        'slide-in-left': {
          '0%': { opacity: '0', transform: 'translateX(-20px)' },
          '100%': { opacity: '1', transform: 'translateX(0)' },
        },
        'slide-in-right': {
          '0%': { opacity: '0', transform: 'translateX(20px)' },
          '100%': { opacity: '1', transform: 'translateX(0)' },
        },
        'scale-in': {
          '0%': { opacity: '0', transform: 'scale(0.95)' },
          '100%': { opacity: '1', transform: 'scale(1)' },
        },
        'bounce-in': {
          '0%': { opacity: '0', transform: 'scale(0.3)' },
          '50%': { opacity: '1', transform: 'scale(1.05)' },
          '70%': { transform: 'scale(0.9)' },
          '100%': { transform: 'scale(1)' },
        },
        'shake': {
          '0%, 100%': { transform: 'translateX(0)' },
          '10%, 30%, 50%, 70%, 90%': { transform: 'translateX(-2px)' },
          '20%, 40%, 60%, 80%': { transform: 'translateX(2px)' },
        },
        'pulse-soft': {
          '0%, 100%': { opacity: '1' },
          '50%': { opacity: '0.7' },
        },
        'float': {
          '0%, 100%': { transform: 'translateY(0px)' },
          '50%': { transform: 'translateY(-6px)' },
        },
        'glow': {
          '0%, 100%': { boxShadow: '0 0 5px rgba(59, 130, 246, 0.5)' },
          '50%': { boxShadow: '0 0 20px rgba(59, 130, 246, 0.8)' },
        },
        'shimmer': {
          '0%': { backgroundPosition: '-200px 0' },
          '100%': { backgroundPosition: 'calc(200px + 100%) 0' },
        },
        'gradient-shift': {
          '0%, 100%': { backgroundPosition: '0% 50%' },
          '50%': { backgroundPosition: '100% 50%' },
        },
      },
      animation: {
        'accordion-down': 'accordion-down 0.2s ease-out',
        'accordion-up': 'accordion-up 0.2s ease-out',
        // Advanced animations
        'fade-in': 'fade-in 0.5s ease-out',
        'fade-in-up': 'fade-in-up 0.6s ease-out',
        'fade-in-down': 'fade-in-down 0.6s ease-out',
        'slide-in-left': 'slide-in-left 0.5s ease-out',
        'slide-in-right': 'slide-in-right 0.5s ease-out',
        'scale-in': 'scale-in 0.3s ease-out',
        'bounce-in': 'bounce-in 0.6s ease-out',
        'shake': 'shake 0.5s ease-in-out',
        'pulse-soft': 'pulse-soft 2s ease-in-out infinite',
        'float': 'float 3s ease-in-out infinite',
        'glow': 'glow 2s ease-in-out infinite',
        'shimmer': 'shimmer 2s linear infinite',
        'gradient-shift': 'gradient-shift 3s ease infinite',
      },
      typography: {
        DEFAULT: {
          css: {
            maxWidth: 'none',
            color: 'hsl(var(--foreground))',
            a: {
              color: 'hsl(var(--primary))',
              '&:hover': {
                color: 'hsl(var(--primary))',
              },
            },
            'code::before': {
              content: 'none',
            },
            'code::after': {
              content: 'none',
            },
          },
        },
      },
    },
  },
  plugins: [
    require('tailwindcss-animate'), 
    require('@tailwindcss/typography'),
    require('@tailwindcss/container-queries')
  ],
} satisfies Config;

export default config;
</file>

<file path="messages/en.json">
{
  "metadata": {
    "title": "Dev-eloper - Modern Blog Platform",
    "description": "A modern blog platform built with Next.js and Supabase. Discover programming insights, tutorials, and technical articles.",
    "keywords": "blog, nextjs, supabase, typescript, programming, web development, react, tutorials"
  },
  "navigation": {
    "home": "Home",
    "posts": "Posts",
    "categories": "Categories",
    "about": "About",
    "search": "Search",
    "admin": "Admin",
    "login": "Login",
    "logout": "Logout"
  },
  "common": {
    "readMore": "Read More",
    "backToHome": "Back to Home",
    "loading": "Loading...",
    "error": "Error",
    "notFound": "Not Found",
    "retry": "Retry",
    "save": "Save",
    "cancel": "Cancel",
    "delete": "Delete",
    "edit": "Edit",
    "create": "Create",
    "update": "Update",
    "confirm": "Confirm",
    "back": "Back",
    "next": "Next",
    "previous": "Previous",
    "close": "Close",
    "open": "Open",
    "refresh": "Refresh",
    "share": "Share"
  },
  "blog": {
    "recentPosts": "Recent Posts",
    "popularPosts": "Popular Posts",
    "allPosts": "All Posts",
    "noPostsFound": "No posts found",
    "publishedOn": "Published on",
    "lastUpdated": "Last updated",
    "readingTime": "{minutes} min read",
    "tags": "Tags",
    "category": "Category",
    "author": "Author",
    "relatedPosts": "Related Posts",
    "comments": "Comments",
    "share": "Share",
    "backToPosts": "Back to Posts",
    "filedUnder": "Filed under",
    "withTags": "with tags"
  },
  "search": {
    "searchPlaceholder": "Search posts...",
    "searchResults": "Search Results",
    "noResults": "No results found for",
    "foundResults": "Found {count} results",
    "filterByCategory": "Filter by Category",
    "filterByTag": "Filter by Tag",
    "allCategories": "All Categories",
    "allTags": "All Tags",
    "clearFilters": "Clear Filters",
    "popularCategories": "Popular Categories",
    "trendingTopics": "Trending Topics"
  },
  "admin": {
    "dashboard": "Dashboard",
    "manageCategories": "Manage Categories",
    "managePosts": "Manage Posts",
    "settings": "Settings",
    "createPost": "Create Post",
    "editPost": "Edit Post",
    "deletePost": "Delete Post",
    "publishPost": "Publish Post",
    "draftPost": "Save as Draft",
    "postTitle": "Post Title",
    "postContent": "Post Content",
    "postExcerpt": "Post Excerpt",
    "postSlug": "Post Slug",
    "featuredImage": "Featured Image",
    "postStatus": "Post Status",
    "published": "Published",
    "draft": "Draft",
    "categoryName": "Category Name",
    "categorySlug": "Category Slug",
    "categoryDescription": "Category Description",
    "tagName": "Tag Name",
    "postDeleted": "Post deleted",
    "postDeletedSuccess": "Post has been successfully deleted",
    "postSaved": "Post saved successfully",
    "postPublished": "Post published successfully",
    "confirmDelete": "Are you sure you want to delete this post?",
    "confirmDeletePost": "Delete this post?",
    "deleteWarning": "This action cannot be undone. Post \"{title}\" will be permanently deleted.",
    "deleteFailed": "Delete failed",
    "deleteError": "An error occurred while deleting the post.",
    "deleting": "Deleting...",
    "manage": "Manage",
    "uploadImage": "Upload Image",
    "imageUploaded": "Image uploaded successfully",
    "totalArticles": "Total Articles",
    "popularBadge": "Popular",
    "manageComments": "Manage Comments",
    "commentsManagement": "Comments Management",
    "recentComments": "Recent Comments",
    "recentActivity": "Recent Activity",
    "viewAllComments": "View All Comments",
    "noRecentComments": "No recent comments",
    "commentManagement": "Comment Management",
    "monitorComments": "Monitor and moderate all user comments",
    "totalComments": "Total Comments",
    "thisPage": "This Page",
    "totalPages": "Total Pages",
    "commentsList": "Comments List",
    "clickToViewPost": "Click on a comment to go to the post",
    "sortBy": "Sort By",
    "newest": "Newest",
    "oldest": "Oldest",
    "byPost": "By Post",
    "deleteComment": "Delete Comment",
    "manageAllComments": "Manage and monitor all blog comments",
    "replyToComment": "Reply",
    "reactions": "reactions",
    "parentComment": "Parent Comment",
    "replyToUser": "Reply to {author}:"
  },
  "auth": {
    "email": "Email",
    "password": "Password",
    "signIn": "Sign In",
    "signOut": "Sign Out",
    "signUp": "Sign Up",
    "forgotPassword": "Forgot Password?",
    "resetPassword": "Reset Password",
    "emailRequired": "Email is required",
    "passwordRequired": "Password is required",
    "invalidEmail": "Invalid email format",
    "weakPassword": "Password must be at least 8 characters",
    "loginFailed": "Login failed",
    "loginSuccess": "Login successful",
    "logoutSuccess": "Logout successful",
    "unauthorized": "Unauthorized access"
  },
  "footer": {
    "builtWith": "Built with",
    "and": "and",
    "allRightsReserved": "All rights reserved."
  },
  "errors": {
    "pageNotFound": "Page Not Found",
    "pageNotFoundDescription": "The page you are looking for does not exist.",
    "serverError": "Server Error",
    "serverErrorDescription": "Something went wrong on our end.",
    "networkError": "Network Error",
    "networkErrorDescription": "Please check your internet connection."
  },
  "dates": {
    "justNow": "Just now",
    "minutesAgo": "{count} minutes ago",
    "hoursAgo": "{count} hours ago",
    "daysAgo": "{count} days ago",
    "weeksAgo": "{count} weeks ago",
    "monthsAgo": "{count} months ago",
    "yearsAgo": "{count} years ago"
  },
  "categories": {
    "programming": "Programming",
    "web-development": "Web Development",
    "devops": "DevOps",
    "tutorial": "Tutorial",
    "frontend": "Frontend",
    "backend": "Backend",
    "database": "Database",
    "mobile": "Mobile",
    "ai-ml": "AI/ML",
    "security": "Security",
    "testing": "Testing",
    "design": "Design"
  },
  "categoryDescriptions": {
    "programming": "Programming tutorials and tips",
    "web-development": "Frontend and backend development",
    "devops": "DevOps and infrastructure",
    "tutorial": "Step-by-step tutorials",
    "frontend": "User interface and client-side development",
    "backend": "Server-side development and APIs",
    "database": "Database design and management",
    "mobile": "Mobile app development",
    "ai-ml": "Artificial Intelligence and Machine Learning",
    "security": "Cybersecurity and application security",
    "testing": "Software testing and quality assurance",
    "design": "UI/UX design and principles"
  },
  "tags": {
    "javascript": "JavaScript",
    "typescript": "TypeScript",
    "react": "React",
    "nextjs": "Next.js",
    "nodejs": "Node.js",
    "python": "Python",
    "vue": "Vue.js",
    "angular": "Angular",
    "docker": "Docker",
    "kubernetes": "Kubernetes",
    "aws": "AWS",
    "tailwindcss": "Tailwind CSS",
    "supabase": "Supabase",
    "mongodb": "MongoDB",
    "postgresql": "PostgreSQL",
    "redis": "Redis",
    "graphql": "GraphQL",
    "rest-api": "REST API",
    "jwt": "JWT",
    "oauth": "OAuth",
    "css": "CSS",
    "backend": "Backend",
    "frontend": "Frontend",
    "html": "HTML",
    "sass": "Sass",
    "scss": "SCSS",
    "webpack": "Webpack",
    "vite": "Vite",
    "eslint": "ESLint",
    "prettier": "Prettier",
    "git": "Git",
    "github": "GitHub",
    "gitlab": "GitLab",
    "vercel": "Vercel",
    "netlify": "Netlify",
    "firebase": "Firebase"
  },
  "comments": {
    "leaveComment": "Leave a Comment",
    "name": "Name",
    "namePlaceholder": "Your name",
    "comment": "Comment",
    "commentPlaceholder": "Share your thoughts...",
    "postComment": "Post Comment",
    "posting": "Posting...",
    "verificationSuccess": "Verification successful!",
    "canSubmitComment": "You can now submit your comment.",
    "commentPosted": "Comment posted!",
    "commentPostedSuccess": "Your comment has been successfully posted.",
    "postCommentFailed": "Failed to post comment",
    "postCommentError": "Failed to post comment. Please try again.",
    "comments": "Comments",
    "sessionReady": "Session ready",
    "noComments": "No comments yet. Be the first to comment!",
    "loadCommentsFailed": "Failed to load comments",
    "confirmDeleteComment": "Are you sure you want to delete this comment?",
    "commentDeleted": "Comment deleted",
    "commentDeletedSuccess": "The comment has been successfully deleted.",
    "deleteFailed": "Delete failed",
    "deleteCommentFailed": "Failed to delete comment",
    "canDeleteComment": "You can delete this comment (30 min limit)",
    "deleteCommentAdmin": "Delete comment (admin)",
    "deleteYourComment": "Delete your comment",
    "nameMinLength": "Name must be at least 2 characters",
    "nameMaxLength": "Name must be no more than 30 characters",
    "nameInvalidChars": "Name can only contain letters, numbers, and spaces",
    "contentMinLength": "Comment must be at least 5 characters",
    "contentMaxLength": "Comment must be no more than 500 characters",
    "reply": "Reply",
    "replyTo": "Reply to {author}",
    "reactionFailed": "Reaction failed",
    "reactionError": "An error occurred while processing your reaction. Please try again."
  }
}
</file>

<file path="messages/ko.json">
{
  "metadata": {
    "title": "Dev-eloper - ëª¨ë˜ ë¸”ë¡œê·¸ í”Œë«í¼",
    "description": "Next.jsì™€ Supabaseë¡œ êµ¬ì¶•ëœ ëª¨ë˜ ë¸”ë¡œê·¸ í”Œë«í¼ì…ë‹ˆë‹¤. í”„ë¡œê·¸ë˜ë° ì¸ì‚¬ì´íŠ¸, íŠœí† ë¦¬ì–¼, ê¸°ìˆ  ì•„í‹°í´ì„ ë°œê²¬í•´ë³´ì„¸ìš”.",
    "keywords": "ë¸”ë¡œê·¸, nextjs, supabase, íƒ€ì…ìŠ¤í¬ë¦½íŠ¸, í”„ë¡œê·¸ë˜ë°, ì›¹ ê°œë°œ, ë¦¬ì•¡íŠ¸, íŠœí† ë¦¬ì–¼"
  },
  "navigation": {
    "home": "í™ˆ",
    "posts": "í¬ìŠ¤íŠ¸",
    "categories": "ì¹´í…Œê³ ë¦¬",
    "about": "ì†Œê°œ",
    "search": "ê²€ìƒ‰",
    "admin": "ê´€ë¦¬ì",
    "login": "ë¡œê·¸ì¸",
    "logout": "ë¡œê·¸ì•„ì›ƒ"
  },
  "common": {
    "readMore": "ë” ì½ê¸°",
    "backToHome": "í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°",
    "loading": "ë¡œë”© ì¤‘...",
    "error": "ì˜¤ë¥˜",
    "notFound": "ì°¾ì„ ìˆ˜ ì—†ìŒ",
    "retry": "ë‹¤ì‹œ ì‹œë„",
    "save": "ì €ì¥",
    "cancel": "ì·¨ì†Œ",
    "delete": "ì‚­ì œ",
    "edit": "í¸ì§‘",
    "create": "ìƒì„±",
    "update": "ì—…ë°ì´íŠ¸",
    "confirm": "í™•ì¸",
    "back": "ë’¤ë¡œ",
    "next": "ë‹¤ìŒ",
    "previous": "ì´ì „",
    "close": "ë‹«ê¸°",
    "open": "ì—´ê¸°",
    "refresh": "ìƒˆë¡œê³ ì¹¨",
    "share": "ê³µìœ "
  },
  "blog": {
    "recentPosts": "ìµœê·¼ í¬ìŠ¤íŠ¸",
    "popularPosts": "ì¸ê¸° í¬ìŠ¤íŠ¸",
    "allPosts": "ëª¨ë“  í¬ìŠ¤íŠ¸",
    "noPostsFound": "í¬ìŠ¤íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤",
    "publishedOn": "ê²Œì‹œì¼",
    "lastUpdated": "ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸",
    "readingTime": "{minutes}ë¶„ ì½ê¸°",
    "tags": "íƒœê·¸",
    "category": "ì¹´í…Œê³ ë¦¬",
    "author": "ì‘ì„±ì",
    "relatedPosts": "ê´€ë ¨ í¬ìŠ¤íŠ¸",
    "comments": "ëŒ“ê¸€",
    "share": "ê³µìœ ",
    "backToPosts": "í¬ìŠ¤íŠ¸ ëª©ë¡ìœ¼ë¡œ",
    "filedUnder": "ë¶„ë¥˜:",
    "withTags": "íƒœê·¸:"
  },
  "search": {
    "searchPlaceholder": "í¬ìŠ¤íŠ¸ ê²€ìƒ‰...",
    "searchResults": "ê²€ìƒ‰ ê²°ê³¼",
    "noResults": "ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤:",
    "foundResults": "{count}ê°œì˜ ê²°ê³¼ë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤",
    "filterByCategory": "ì¹´í…Œê³ ë¦¬ë³„ í•„í„°",
    "filterByTag": "íƒœê·¸ë³„ í•„í„°",
    "allCategories": "ëª¨ë“  ì¹´í…Œê³ ë¦¬",
    "allTags": "ëª¨ë“  íƒœê·¸",
    "clearFilters": "í•„í„° ì´ˆê¸°í™”",
    "popularCategories": "ì¸ê¸° ì¹´í…Œê³ ë¦¬",
    "trendingTopics": "ì¸ê¸° ì£¼ì œ"
  },
  "admin": {
    "dashboard": "ëŒ€ì‹œë³´ë“œ",
    "manageCategories": "ì¹´í…Œê³ ë¦¬ ê´€ë¦¬",
    "managePosts": "í¬ìŠ¤íŠ¸ ê´€ë¦¬",
    "settings": "ì„¤ì •",
    "createPost": "í¬ìŠ¤íŠ¸ ì‘ì„±",
    "editPost": "í¬ìŠ¤íŠ¸ í¸ì§‘",
    "deletePost": "í¬ìŠ¤íŠ¸ ì‚­ì œ",
    "publishPost": "í¬ìŠ¤íŠ¸ ê²Œì‹œ",
    "draftPost": "ì„ì‹œì €ì¥",
    "postTitle": "í¬ìŠ¤íŠ¸ ì œëª©",
    "postContent": "í¬ìŠ¤íŠ¸ ë‚´ìš©",
    "postExcerpt": "í¬ìŠ¤íŠ¸ ìš”ì•½",
    "postSlug": "í¬ìŠ¤íŠ¸ ìŠ¬ëŸ¬ê·¸",
    "featuredImage": "ëŒ€í‘œ ì´ë¯¸ì§€",
    "postStatus": "í¬ìŠ¤íŠ¸ ìƒíƒœ",
    "published": "ê²Œì‹œë¨",
    "draft": "ì„ì‹œì €ì¥",
    "categoryName": "ì¹´í…Œê³ ë¦¬ ì´ë¦„",
    "categorySlug": "ì¹´í…Œê³ ë¦¬ ìŠ¬ëŸ¬ê·¸",
    "categoryDescription": "ì¹´í…Œê³ ë¦¬ ì„¤ëª…",
    "tagName": "íƒœê·¸ ì´ë¦„",
    "postDeleted": "í¬ìŠ¤íŠ¸ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤",
    "postDeletedSuccess": "í¬ìŠ¤íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤",
    "postSaved": "í¬ìŠ¤íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤",
    "postPublished": "í¬ìŠ¤íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ê²Œì‹œë˜ì—ˆìŠµë‹ˆë‹¤",
    "confirmDelete": "ì •ë§ë¡œ ì´ í¬ìŠ¤íŠ¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
    "confirmDeletePost": "í¬ìŠ¤íŠ¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
    "deleteWarning": "ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í¬ìŠ¤íŠ¸ \"{title}\"ì´(ê°€) ì˜êµ¬ì ìœ¼ë¡œ ì‚­ì œë©ë‹ˆë‹¤.",
    "deleteFailed": "ì‚­ì œ ì‹¤íŒ¨",
    "deleteError": "í¬ìŠ¤íŠ¸ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",
    "deleting": "ì‚­ì œ ì¤‘...",
    "manage": "ê´€ë¦¬",
    "uploadImage": "ì´ë¯¸ì§€ ì—…ë¡œë“œ",
    "imageUploaded": "ì´ë¯¸ì§€ê°€ ì„±ê³µì ìœ¼ë¡œ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤",
    "totalArticles": "ì´ ì•„í‹°í´ ìˆ˜",
    "popularBadge": "ì¸ê¸°",
    "manageComments": "ëŒ“ê¸€ ê´€ë¦¬",
    "commentsManagement": "ëŒ“ê¸€ ê´€ë¦¬",
    "recentComments": "ìµœê·¼ ëŒ“ê¸€",
    "recentActivity": "ìµœê·¼ í™œë™",
    "viewAllComments": "ì „ì²´ ëŒ“ê¸€ ë³´ê¸°",
    "noRecentComments": "ìµœê·¼ ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤",
    "commentManagement": "ëŒ“ê¸€ ê´€ë¦¬",
    "monitorComments": "ëª¨ë“  ì‚¬ìš©ì ëŒ“ê¸€ì„ ëª¨ë‹ˆí„°ë§í•˜ê³  ê´€ë¦¬",
    "totalComments": "ì´ ëŒ“ê¸€ ìˆ˜",
    "thisPage": "ì´ í˜ì´ì§€",
    "totalPages": "ì „ì²´ í˜ì´ì§€",
    "commentsList": "ëŒ“ê¸€ ëª©ë¡",
    "clickToViewPost": "ëŒ“ê¸€ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ê²Œì‹œë¬¼ë¡œ ì´ë™í•©ë‹ˆë‹¤",
    "sortBy": "ì •ë ¬ ë°©ì‹",
    "newest": "ìµœì‹ ìˆœ",
    "oldest": "ì˜¤ë˜ëœìˆœ",
    "byPost": "ê²Œì‹œë¬¼ë³„",
    "deleteComment": "ëŒ“ê¸€ ì‚­ì œ",
    "manageAllComments": "ë¸”ë¡œê·¸ì˜ ëª¨ë“  ëŒ“ê¸€ì„ ê´€ë¦¬í•˜ê³  ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤",
    "replyToComment": "ë‹µê¸€",
    "reactions": "ë°˜ì‘",
    "parentComment": "ë¶€ëª¨ ëŒ“ê¸€",
    "replyToUser": "{author}ë‹˜ì˜ ëŒ“ê¸€ì— ë‹µê¸€:"
  },
  "auth": {
    "email": "ì´ë©”ì¼",
    "password": "ë¹„ë°€ë²ˆí˜¸",
    "signIn": "ë¡œê·¸ì¸",
    "signOut": "ë¡œê·¸ì•„ì›ƒ",
    "signUp": "íšŒì›ê°€ì…",
    "forgotPassword": "ë¹„ë°€ë²ˆí˜¸ë¥¼ ìŠìœ¼ì…¨ë‚˜ìš”?",
    "resetPassword": "ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •",
    "emailRequired": "ì´ë©”ì¼ì€ í•„ìˆ˜ì…ë‹ˆë‹¤",
    "passwordRequired": "ë¹„ë°€ë²ˆí˜¸ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤",
    "invalidEmail": "ì˜¬ë°”ë¥´ì§€ ì•Šì€ ì´ë©”ì¼ í˜•ì‹ì…ë‹ˆë‹¤",
    "weakPassword": "ë¹„ë°€ë²ˆí˜¸ëŠ” ìµœì†Œ 8ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤",
    "loginFailed": "ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤",
    "loginSuccess": "ë¡œê·¸ì¸ì— ì„±ê³µí–ˆìŠµë‹ˆë‹¤",
    "logoutSuccess": "ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤",
    "unauthorized": "ì¸ì¦ë˜ì§€ ì•Šì€ ì ‘ê·¼ì…ë‹ˆë‹¤"
  },
  "footer": {
    "builtWith": "ë‹¤ìŒìœ¼ë¡œ ì œì‘:",
    "and": "ê·¸ë¦¬ê³ ",
    "allRightsReserved": "ëª¨ë“  ê¶Œë¦¬ ë³´ìœ ."
  },
  "errors": {
    "pageNotFound": "í˜ì´ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ",
    "pageNotFoundDescription": "ì°¾ê³  ê³„ì‹  í˜ì´ì§€ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",
    "serverError": "ì„œë²„ ì˜¤ë¥˜",
    "serverErrorDescription": "ì„œë²„ì—ì„œ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.",
    "networkError": "ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜",
    "networkErrorDescription": "ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”."
  },
  "dates": {
    "justNow": "ë°©ê¸ˆ ì „",
    "minutesAgo": "{count}ë¶„ ì „",
    "hoursAgo": "{count}ì‹œê°„ ì „",
    "daysAgo": "{count}ì¼ ì „",
    "weeksAgo": "{count}ì£¼ ì „",
    "monthsAgo": "{count}ê°œì›” ì „",
    "yearsAgo": "{count}ë…„ ì „"
  },
  "categories": {
    "programming": "í”„ë¡œê·¸ë˜ë°",
    "web-development": "ì›¹ ê°œë°œ",
    "devops": "ë°ë¸Œì˜µìŠ¤",
    "tutorial": "íŠœí† ë¦¬ì–¼",
    "frontend": "í”„ë¡ íŠ¸ì—”ë“œ",
    "backend": "ë°±ì—”ë“œ",
    "database": "ë°ì´í„°ë² ì´ìŠ¤",
    "mobile": "ëª¨ë°”ì¼",
    "ai-ml": "ì¸ê³µì§€ëŠ¥/ë¨¸ì‹ ëŸ¬ë‹",
    "security": "ë³´ì•ˆ",
    "testing": "í…ŒìŠ¤íŒ…",
    "design": "ë””ìì¸"
  },
  "categoryDescriptions": {
    "programming": "í”„ë¡œê·¸ë˜ë° íŠœí† ë¦¬ì–¼ê³¼ íŒ",
    "web-development": "í”„ë¡ íŠ¸ì—”ë“œ ë° ë°±ì—”ë“œ ê°œë°œ",
    "devops": "ë°ë¸Œì˜µìŠ¤ì™€ ì¸í”„ë¼",
    "tutorial": "ë‹¨ê³„ë³„ íŠœí† ë¦¬ì–¼",
    "frontend": "ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ ë° í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ ê°œë°œ",
    "backend": "ì„œë²„ ì‚¬ì´ë“œ ê°œë°œê³¼ API",
    "database": "ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ì™€ ê´€ë¦¬",
    "mobile": "ëª¨ë°”ì¼ ì•± ê°œë°œ",
    "ai-ml": "ì¸ê³µì§€ëŠ¥ê³¼ ë¨¸ì‹ ëŸ¬ë‹",
    "security": "ì‚¬ì´ë²„ ë³´ì•ˆê³¼ ì• í”Œë¦¬ì¼€ì´ì…˜ ë³´ì•ˆ",
    "testing": "ì†Œí”„íŠ¸ì›¨ì–´ í…ŒìŠ¤íŒ…ê³¼ í’ˆì§ˆ ë³´ì¦",
    "design": "UI/UX ë””ìì¸ê³¼ ì›ì¹™"
  },
  "tags": {
    "javascript": "ìë°”ìŠ¤í¬ë¦½íŠ¸",
    "typescript": "íƒ€ì…ìŠ¤í¬ë¦½íŠ¸",
    "react": "ë¦¬ì•¡íŠ¸",
    "nextjs": "Next.js",
    "nodejs": "Node.js",
    "python": "íŒŒì´ì¬",
    "vue": "Vue.js",
    "angular": "ì•µê·¤ëŸ¬",
    "docker": "ë„ì»¤",
    "kubernetes": "ì¿ ë²„ë„¤í‹°ìŠ¤",
    "aws": "AWS",
    "tailwindcss": "Tailwind CSS",
    "supabase": "Supabase",
    "mongodb": "MongoDB",
    "postgresql": "PostgreSQL",
    "redis": "Redis",
    "graphql": "GraphQL",
    "rest-api": "REST API",
    "jwt": "JWT",
    "oauth": "OAuth",
    "css": "CSS",
    "backend": "ë°±ì—”ë“œ",
    "frontend": "í”„ë¡ íŠ¸ì—”ë“œ",
    "html": "HTML",
    "sass": "Sass",
    "scss": "SCSS",
    "webpack": "ì›¹íŒ©",
    "vite": "Vite",
    "eslint": "ESLint",
    "prettier": "Prettier",
    "git": "Git",
    "github": "GitHub",
    "gitlab": "GitLab",
    "vercel": "Vercel",
    "netlify": "Netlify",
    "firebase": "Firebase"
  },
  "comments": {
    "leaveComment": "ëŒ“ê¸€ ë‚¨ê¸°ê¸°",
    "name": "ì´ë¦„",
    "namePlaceholder": "ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”",
    "comment": "ëŒ“ê¸€",
    "commentPlaceholder": "ì˜ê²¬ì„ ê³µìœ í•´ì£¼ì„¸ìš”...",
    "postComment": "ëŒ“ê¸€ ê²Œì‹œ",
    "posting": "ê²Œì‹œ ì¤‘...",
    "verificationSuccess": "ì¸ì¦ ì„±ê³µ!",
    "canSubmitComment": "ì´ì œ ëŒ“ê¸€ì„ ê²Œì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
    "commentPosted": "ëŒ“ê¸€ì´ ê²Œì‹œë˜ì—ˆìŠµë‹ˆë‹¤!",
    "commentPostedSuccess": "ëŒ“ê¸€ì´ ì„±ê³µì ìœ¼ë¡œ ê²Œì‹œë˜ì—ˆìŠµë‹ˆë‹¤.",
    "postCommentFailed": "ëŒ“ê¸€ ê²Œì‹œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤",
    "postCommentError": "ëŒ“ê¸€ ê²Œì‹œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",
    "comments": "ëŒ“ê¸€",
    "sessionReady": "ì„¸ì…˜ ì¤€ë¹„ë¨",
    "noComments": "ì•„ì§ ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤. ì²« ë²ˆì§¸ ëŒ“ê¸€ì„ ë‚¨ê²¨ë³´ì„¸ìš”!",
    "loadCommentsFailed": "ëŒ“ê¸€ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤",
    "confirmDeleteComment": "ì´ ëŒ“ê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
    "commentDeleted": "ëŒ“ê¸€ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤",
    "commentDeletedSuccess": "ëŒ“ê¸€ì´ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.",
    "deleteFailed": "ì‚­ì œ ì‹¤íŒ¨",
    "deleteCommentFailed": "ëŒ“ê¸€ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤",
    "canDeleteComment": "ì´ ëŒ“ê¸€ì„ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (30ë¶„ ì œí•œ)",
    "deleteCommentAdmin": "ëŒ“ê¸€ ì‚­ì œ (ê´€ë¦¬ì)",
    "deleteYourComment": "ëŒ“ê¸€ ì‚­ì œ",
    "nameMinLength": "ì´ë¦„ì€ ìµœì†Œ 2ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤",
    "nameMaxLength": "ì´ë¦„ì€ 30ìë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤",
    "nameInvalidChars": "ì´ë¦„ì€ ë¬¸ì, ìˆ«ì, ê³µë°±ë§Œ í¬í•¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤",
    "contentMinLength": "ëŒ“ê¸€ì€ ìµœì†Œ 5ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤",
    "contentMaxLength": "ëŒ“ê¸€ì€ 500ìë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤",
    "reply": "ë‹µê¸€",
    "replyTo": "{author}ë‹˜ì—ê²Œ ë‹µê¸€",
    "reactionFailed": "ë°˜ì‘ ì‹¤íŒ¨",
    "reactionError": "ë°˜ì‘ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”."
  }
}
</file>

<file path="package.json">
{
  "name": "dev-eloper4",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  },
  "dependencies": {
    "@hookform/resolvers": "^4.1.3",
    "@radix-ui/react-accordion": "^1.2.3",
    "@radix-ui/react-alert-dialog": "^1.1.14",
    "@radix-ui/react-avatar": "^1.1.2",
    "@radix-ui/react-checkbox": "^1.1.1",
    "@radix-ui/react-dialog": "^1.1.14",
    "@radix-ui/react-dropdown-menu": "^2.1.1",
    "@radix-ui/react-label": "^2.1.7",
    "@radix-ui/react-popover": "^1.1.14",
    "@radix-ui/react-select": "^2.1.4",
    "@radix-ui/react-separator": "^1.1.1",
    "@radix-ui/react-slot": "^1.2.3",
    "@radix-ui/react-tabs": "^1.1.12",
    "@radix-ui/react-toast": "^1.2.6",
    "@radix-ui/react-toggle": "^1.1.9",
    "@supabase/ssr": "^0.6.1",
    "@supabase/supabase-js": "^2.50.4",
    "@tailwindcss/container-queries": "^0.1.1",
    "@tanstack/react-query": "^5",
    "@tiptap/extension-character-count": "^2.26.0",
    "@tiptap/extension-color": "^2.26.0",
    "@tiptap/extension-dropcursor": "^2.26.0",
    "@tiptap/extension-gapcursor": "^2.26.0",
    "@tiptap/extension-highlight": "^2.26.0",
    "@tiptap/extension-image": "^2.26.0",
    "@tiptap/extension-link": "^2.26.0",
    "@tiptap/extension-placeholder": "^2.26.0",
    "@tiptap/extension-table": "^2.26.0",
    "@tiptap/extension-table-cell": "^2.26.0",
    "@tiptap/extension-table-header": "^2.26.0",
    "@tiptap/extension-table-row": "^2.26.0",
    "@tiptap/extension-text-align": "^2.26.0",
    "@tiptap/extension-text-style": "^2.26.0",
    "@tiptap/react": "^2.26.0",
    "@tiptap/starter-kit": "^2.26.0",
    "@types/dompurify": "^3.0.5",
    "@types/mdast": "^4.0.4",
    "autoprefixer": "10.4.20",
    "axios": "^1.7.9",
    "class-variance-authority": "^0.7.0",
    "clsx": "^2.1.1",
    "date-fns": "^4",
    "dompurify": "^3.2.6",
    "dotenv": "^17.2.0",
    "es-toolkit": "^1",
    "framer-motion": "^11",
    "lucide-react": "^0.469.0",
    "next": "15.1.0",
    "next-intl": "^4.3.4",
    "next-themes": "^0.4.3",
    "react": "^19.0.0",
    "react-dom": "^19.0.0",
    "react-hook-form": "^7.60.0",
    "react-markdown": "^10.1.0",
    "react-use": "^17",
    "rehype-highlight": "^7.0.2",
    "remark-gfm": "^4.0.1",
    "server-only": "0.0.1",
    "slugify": "^1.6.6",
    "ts-pattern": "^5",
    "web-vitals": "^5.0.3",
    "zod": "^3.25.76",
    "zustand": "^4"
  },
  "devDependencies": {
    "@eslint/eslintrc": "^3",
    "@tailwindcss/typography": "^0.5.10",
    "@types/node": "^20",
    "@types/react": "^19",
    "@types/react-dom": "^19",
    "eslint": "^9",
    "eslint-config-next": "15.1.0",
    "postcss": "^8",
    "tailwind-merge": "^2.5.2",
    "tailwindcss": "^3.4.1",
    "tailwindcss-animate": "^1.0.7",
    "typescript": "^5"
  }
}
</file>

<file path="src/app/globals.css">
@tailwind base;
@tailwind components;
@tailwind utilities;

/* TipTap Editor Styles */
@import '../styles/tiptap.css';

/* Syntax highlighting for code blocks - imported through components */

@layer base {
  :root {
    /* Apple Light Mode Colors */
    --background: 0 0% 100%;
    --foreground: 0 0% 8%;
    --card: 0 0% 100%;
    --card-foreground: 0 0% 8%;
    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 8%;
    --primary: 211 100% 50%; /* Apple Blue #007AFF */
    --primary-foreground: 0 0% 100%;
    --secondary: 210 40% 96%;
    --secondary-foreground: 0 0% 8%;
    --muted: 210 40% 96%;
    --muted-foreground: 0 0% 45%;
    --accent: 210 40% 96%;
    --accent-foreground: 0 0% 8%;
    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 100%;
    --border: 210 40% 90%;
    --input: 210 40% 95%;
    --ring: 211 100% 50%;
    --radius: 0.75rem;
    /* Apple-style grays */
    --gray-50: 210 40% 98%;
    --gray-100: 210 40% 96%;
    --gray-200: 210 40% 93%;
    --gray-300: 210 40% 87%;
    --gray-400: 210 40% 70%;
    --gray-500: 210 40% 50%;
    --gray-600: 210 40% 35%;
    --gray-700: 210 40% 25%;
    --gray-800: 210 40% 15%;
    --gray-900: 210 40% 8%;
    /* Chart colors */
    --chart-1: 211 100% 50%;
    --chart-2: 195 100% 50%;
    --chart-3: 48 100% 67%;
    --chart-4: 27 96% 61%;
    --chart-5: 339 100% 66%;
  }

  .dark {
    /* Apple Dark Mode Colors */
    --background: 0 0% 7%; /* Rich Black */
    --foreground: 0 0% 98%;
    --card: 210 10% 9%;
    --card-foreground: 0 0% 98%;
    --popover: 210 10% 9%;
    --popover-foreground: 0 0% 98%;
    --primary: 211 100% 60%; /* Brighter Apple Blue for dark mode */
    --primary-foreground: 0 0% 7%;
    --secondary: 210 10% 14%;
    --secondary-foreground: 0 0% 98%;
    --muted: 210 10% 14%;
    --muted-foreground: 0 0% 65%;
    --accent: 210 10% 14%;
    --accent-foreground: 0 0% 98%;
    --destructive: 0 62% 50%;
    --destructive-foreground: 0 0% 98%;
    --border: 210 10% 20%;
    --input: 210 10% 14%;
    --ring: 211 100% 60%;
    /* Apple-style grays for dark mode */
    --gray-50: 210 10% 95%;
    --gray-100: 210 10% 90%;
    --gray-200: 210 10% 80%;
    --gray-300: 210 10% 65%;
    --gray-400: 210 10% 50%;
    --gray-500: 210 10% 35%;
    --gray-600: 210 10% 25%;
    --gray-700: 210 10% 18%;
    --gray-800: 210 10% 12%;
    --gray-900: 210 10% 7%;
    /* Chart colors for dark mode */
    --chart-1: 211 100% 60%;
    --chart-2: 195 100% 65%;
    --chart-3: 48 100% 70%;
    --chart-4: 27 96% 65%;
    --chart-5: 339 100% 70%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
    font-feature-settings: "rlig" 1, "calt" 1;
    font-optical-sizing: auto;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
  }
}

/* Dark mode syntax highlighting - handled via CSS variables */

/* Custom styles for improved responsiveness */
@layer utilities {
  .prose {
    @apply max-w-none;
  }
  
  .prose pre {
    @apply overflow-x-auto rounded-lg border bg-muted px-4 py-3;
  }
  
  .prose code {
    @apply relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono text-sm;
  }
  
  .prose pre code {
    @apply bg-transparent p-0;
  }
  
  /* Line clamp utilities */
  .line-clamp-1 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 1;
  }
  
  .line-clamp-2 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
  }
  
  .line-clamp-3 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 3;
  }
}

/* Loading states */
@keyframes shimmer {
  0% {
    background-position: -200px 0;
  }
  100% {
    background-position: calc(200px + 100%) 0;
  }
}

.shimmer {
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
  background-size: 200px 100%;
  animation: shimmer 1.5s infinite;
}

.dark .shimmer {
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
}

/* Enhanced prose styling for dark mode */
.prose {
  color: hsl(var(--foreground)) !important;
}

/* Animation utilities for enhanced UX */
.animate-in {
  animation: animate-in 0.6s ease-out;
}

.animate-out {
  animation: animate-out 0.3s ease-in;
}

@keyframes animate-in {
  from {
    opacity: 0;
    transform: translateY(20px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes animate-out {
  from {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
  to {
    opacity: 0;
    transform: translateY(-20px) scale(0.95);
  }
}

/* Smooth scrolling for the entire document */
html {
  scroll-behavior: smooth;
}

/* Page transition support */
body {
  overflow-x: hidden;
}

/* Loading overlay for navigation transitions */
.page-loading {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: hsl(var(--background));
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

/* Enhanced focus states for accessibility */
*:focus-visible {
  outline: 2px solid hsl(var(--primary));
  outline-offset: 2px;
  border-radius: 4px;
}

/* Apple-style smooth scrolling */
html {
  scroll-padding-top: 4rem;
}

/* Apple-style backdrop blur support */
@supports (backdrop-filter: blur(0)) {
  .backdrop-blur-apple {
    backdrop-filter: blur(20px);
    background-color: rgba(255, 255, 255, 0.8);
  }
  
  .dark .backdrop-blur-apple {
    background-color: rgba(0, 0, 0, 0.8);
  }
}

/* Apple-style focus ring */
.focus-ring-apple:focus-visible {
  outline: 2px solid hsl(var(--primary));
  outline-offset: 2px;
  border-radius: 8px;
}

/* Apple-style card hover effect */
.card-hover-apple {
  transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
}

.card-hover-apple:hover {
  transform: translateY(-4px) scale(1.02);
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
}

.dark .card-hover-apple:hover {
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
}

/* Apple-style button press animation */
.button-press-apple {
  transition: all 0.2s cubic-bezier(0.16, 1, 0.3, 1);
}

.button-press-apple:active {
  transform: scale(0.98);
}

/* Reduce motion for users who prefer it */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
  
  .card-hover-apple:hover {
    transform: none !important;
  }
}

.prose h1,
.prose h2,
.prose h3,
.prose h4,
.prose h5,
.prose h6 {
  color: hsl(var(--foreground)) !important;
}

.prose strong {
  color: hsl(var(--foreground)) !important;
}

.prose a {
  color: hsl(var(--primary)) !important;
}

.prose blockquote {
  border-left-color: hsl(var(--border)) !important;
  color: hsl(var(--muted-foreground)) !important;
}
</file>

<file path="src/app/layout.tsx">
import './globals.css';
import 'highlight.js/styles/github.css';
import { Inter, JetBrains_Mono } from 'next/font/google';

const inter = Inter({
  variable: '--font-inter',
  subsets: ['latin'],
  display: 'swap',
  weight: ['300', '400', '500', '600', '700'],
});

const jetbrainsMono = JetBrains_Mono({
  variable: '--font-jetbrains-mono',
  subsets: ['latin'],
  display: 'swap',
});

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html suppressHydrationWarning>
      <body className={`${inter.variable} ${jetbrainsMono.variable} antialiased min-h-screen flex flex-col font-sans`}>
        {children}
      </body>
    </html>
  );
}
</file>

<file path="src/components/shared/header.tsx">
'use client';

import { useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { Button } from '@/components/ui/button';
import { Sheet, SheetContent, SheetTrigger } from '@/components/ui/sheet';
import { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuSeparator, DropdownMenuTrigger } from '@/components/ui/dropdown-menu';
import { Menu, Search, User, LogOut, Settings } from 'lucide-react';
import { useAuth } from '@/hooks/use-auth';
import { useScroll } from '@/hooks/use-scroll';
import { SearchInput } from '@/components/search/search-input';
import { ThemeToggle } from '@/components/theme/theme-toggle';
import { LanguageToggle } from '@/components/shared/language-toggle';
import { Link } from '@/i18n/routing';
import { useTranslations } from 'next-intl';
import { headerVariants } from '@/lib/animations';

function AuthButton() {
  const { user, isAdmin, signOut, loading } = useAuth();
  const t = useTranslations('navigation');
  const tAuth = useTranslations('auth');

  if (loading) {
    return (
      <Button variant="ghost" size="sm" disabled className="h-9 w-9 rounded-full">
        <User className="h-4 w-4" />
      </Button>
    );
  }

  if (!user) {
    return (
      <Button variant="ghost" size="sm" asChild className="h-9 w-9 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-all duration-200">
        <Link href="/auth/login">
          <User className="h-4 w-4" />
          <span className="sr-only">{t('login')}</span>
        </Link>
      </Button>
    );
  }

  return (
    <DropdownMenu>
      <DropdownMenuTrigger asChild>
        <Button variant="ghost" size="sm" className="h-9 w-9 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-all duration-200">
          <User className="h-4 w-4" />
          <span className="sr-only">User menu</span>
        </Button>
      </DropdownMenuTrigger>
      <DropdownMenuContent align="end">
        <div className="px-2 py-1.5 text-sm font-medium">
          {user.email}
        </div>
        <DropdownMenuSeparator />
        {isAdmin && (
          <>
            <DropdownMenuItem asChild>
              <Link href="/admin">
                <Settings className="mr-2 h-4 w-4" />
                {t('admin')}
              </Link>
            </DropdownMenuItem>
            <DropdownMenuSeparator />
          </>
        )}
        <DropdownMenuItem onClick={() => signOut()}>
          <LogOut className="mr-2 h-4 w-4" />
          {tAuth('signOut')}
        </DropdownMenuItem>
      </DropdownMenuContent>
    </DropdownMenu>
  );
}

export function Header() {
  const [isOpen, setIsOpen] = useState(false);
  const t = useTranslations('navigation');
  const tSearch = useTranslations('search');
  const { scrollDirection, isAtTop, scrollY } = useScroll();

  const navItems = [
    { href: '/', label: t('home') },
    { href: '/categories', label: t('categories') },
    { href: '/about', label: t('about') },
  ];

  const shouldHideHeader = scrollDirection === 'down' && scrollY > 100;

  return (
    <motion.header 
      className="sticky top-0 z-50 w-full border-b bg-background/80 backdrop-blur-xl supports-[backdrop-filter]:bg-background/70"
      variants={headerVariants}
      animate={shouldHideHeader ? 'hidden' : 'visible'}
      transition={{ duration: 0.4, ease: [0.16, 1, 0.3, 1] }}
      style={{
        backdropFilter: isAtTop ? 'none' : 'blur(20px)',
        borderBottomColor: isAtTop ? 'transparent' : 'hsl(var(--border))',
        boxShadow: isAtTop ? 'none' : '0 1px 0 0 hsl(var(--border))',
      }}
    >
      <div className="container flex h-16 items-center px-6 lg:px-8">
        {/* Logo */}
        <div className="mr-8 flex">
          <Link href="/" className="flex items-center space-x-2 group">
            <span className="font-semibold text-xl tracking-tight text-foreground transition-colors group-hover:text-primary">
              Dev-eloper
            </span>
          </Link>
        </div>

        {/* Desktop Navigation */}
        <nav className="hidden md:flex items-center space-x-8">
          {navItems.map((item) => (
            <Link
              key={item.href}
              href={item.href}
              className="text-sm font-medium text-foreground/70 transition-all duration-200 hover:text-foreground hover:scale-105 relative after:absolute after:bottom-[-4px] after:left-0 after:w-0 after:h-0.5 after:bg-primary after:transition-all after:duration-300 hover:after:w-full"
            >
              {item.label}
            </Link>
          ))}
        </nav>

        {/* Desktop Actions */}
        <div className="ml-auto flex items-center space-x-3">
          <div className="hidden lg:block w-72">
            <SearchInput placeholder={tSearch('searchPlaceholder')} />
          </div>
          <div className="flex items-center space-x-2">
            <ThemeToggle />
            <LanguageToggle />
            <AuthButton />
          </div>
        </div>

        {/* Mobile Navigation */}
        <Sheet open={isOpen} onOpenChange={setIsOpen}>
          <SheetTrigger asChild>
            <Button
              variant="ghost"
              className="ml-auto px-0 text-base hover:bg-transparent focus-visible:bg-transparent focus-visible:ring-0 focus-visible:ring-offset-0 md:hidden"
            >
              <Menu className="h-5 w-5" />
              <span className="sr-only">Toggle Menu</span>
            </Button>
          </SheetTrigger>
          <SheetContent side="right" className="pr-0">
            <nav className="flex flex-col space-y-3">
              <div className="mb-4">
                <SearchInput placeholder={tSearch('searchPlaceholder')} />
              </div>
              {navItems.map((item) => (
                <Link
                  key={item.href}
                  href={item.href}
                  onClick={() => setIsOpen(false)}
                  className="block px-2 py-1 text-lg transition-colors hover:text-foreground/80"
                >
                  {item.label}
                </Link>
              ))}
              <hr className="my-4" />
              <div className="flex items-center justify-between px-2 py-1">
                <span className="text-lg">Theme</span>
                <ThemeToggle />
              </div>
              <div className="flex items-center justify-between px-2 py-1">
                <span className="text-lg">Language</span>
                <LanguageToggle />
              </div>
              <Link
                href="/admin"
                onClick={() => setIsOpen(false)}
                className="block px-2 py-1 text-lg transition-colors hover:text-foreground/80"
              >
                {t('admin')}
              </Link>
            </nav>
          </SheetContent>
        </Sheet>
      </div>
    </motion.header>
  );
}
</file>

<file path="src/app/[locale]/posts/[slug]/page.tsx">
import { notFound } from 'next/navigation';
import { getTranslations } from 'next-intl/server';
import { getPostBySlug } from '@/lib/blog-server';
import { PostHeader } from '@/components/blog/post-header';
import { PostContent } from '@/components/blog/post-content';
import { PostFooter } from '@/components/blog/post-footer';
import { EnhancedCommentSection } from '@/components/blog/enhanced-comment-section';
import { ViewTracker } from '@/components/blog/view-tracker';
import { JsonLd } from '@/components/seo/json-ld';
import type { Metadata } from 'next';

// ë™ì  í˜ì´ì§€ ìƒì„± ì„¤ì • (ISR ì ìš©)
export const dynamic = 'force-dynamic';
export const revalidate = 3600; // 1ì‹œê°„ë§ˆë‹¤ ì¬ê²€ì¦

interface PostPageProps {
  params: Promise<{
    locale: string;
    slug: string;
  }>;
}

// Generate metadata for the post
export async function generateMetadata({ params }: PostPageProps): Promise<Metadata> {
  try {
    const { locale, slug } = await params;
    const post = await getPostBySlug(slug);

    if (!post) {
      return {
        title: 'Post Not Found',
        description: 'The requested post could not be found.',
      };
    }

    const publishedTime = post.published_at || post.created_at;
    const modifiedTime = post.updated_at;
    
    // Safe content extraction
    const safeContent = post.content || '';
    const textContent = safeContent.replace(/<[^>]*>/g, '').replace(/\s+/g, ' ').trim();
    const description = textContent.length > 160 
      ? textContent.substring(0, 160) + '...' 
      : textContent || post.title || 'No description available';

    return {
      title: post.title || 'Untitled Post',
      description,
      authors: [{ name: 'Dev-eloper' }],
      keywords: post.tags?.map(tag => tag.name).join(', ') || '',
      openGraph: {
        title: post.title || 'Untitled Post',
        description,
        type: 'article',
        publishedTime,
        modifiedTime,
        authors: ['Dev-eloper'],
        section: post.category?.name || 'General',
        tags: post.tags?.map(tag => tag.name) || [],
        images: post.cover_image_path ? [
          {
            url: post.cover_image_path,
            width: 1200,
            height: 630,
            alt: post.title || 'Post image',
          }
        ] : undefined,
      },
      twitter: {
        card: 'summary_large_image',
        title: post.title || 'Untitled Post',
        description,
        images: post.cover_image_path ? [post.cover_image_path] : undefined,
      },
    };
  } catch (error) {
    console.error('Error generating metadata:', error);
    return {
      title: 'Error Loading Post',
      description: 'An error occurred while loading the post metadata.',
    };
  }
}

export default async function PostPage({ params }: PostPageProps) {
  try {
    const { locale, slug } = await params;
    const post = await getPostBySlug(slug);

    if (!post) {
      notFound();
    }

    const t = await getTranslations({ locale, namespace: 'blog' });

    return (
      <>
        <JsonLd type="article" post={post} />
        <ViewTracker postId={post.id} />
        <article className="container py-6 lg:py-10">
          <div className="mx-auto max-w-4xl">
            <PostHeader post={post} />
            <PostContent post={post} />
            <PostFooter post={post} />
            
            {/* Comments Section */}
            <div className="mt-16">
              <EnhancedCommentSection postId={post.id} />
            </div>
          </div>
        </article>
      </>
    );
  } catch (error) {
    console.error('Error rendering post page:', error);
    notFound();
  }
}

// Generate static params for known posts (optional, for better performance)
export async function generateStaticParams() {
  // This could fetch popular posts or recent posts for pre-generation
  // For now, we'll let Next.js generate pages on-demand
  return [];
}
</file>

<file path="src/components/blog/post-card.tsx">
'use client';

import Link from 'next/link';
import { format } from 'date-fns';
import { useTranslations } from 'next-intl';
import { memo, useMemo } from 'react';
import { motion } from 'framer-motion';
import { Card, CardContent, CardFooter, CardHeader } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';
import { MotionBadge } from '@/components/ui/motion-badge';
import { LazyImage } from '@/components/ui/lazy-image';
import { HtmlPreview } from '@/components/blog/html-content';
import { getPostThumbnail } from '@/lib/utils/html-utils';
import { CalendarDays, Clock, User, ImageIcon } from 'lucide-react';
import { cardVariants, getReducedMotionVariants } from '@/lib/animations';
import type { PostWithRelations } from '@/lib/blog';

interface PostCardProps {
  post: any;
  priority?: boolean;
  index?: number;
}

export const PostCard = memo(function PostCard({ post, priority = false, index = 0 }: PostCardProps) {
  const t = useTranslations('blog');
  
  const { publishedDate, readingTime, thumbnailUrl } = useMemo(() => {
    const publishedDate = post.published_at 
      ? new Date(post.published_at) 
      : new Date(post.created_at);

    // Estimate reading time (average 200 words per minute)
    const textContent = post.content.replace(/<[^>]*>/g, ''); // Remove HTML tags
    const wordCount = textContent.split(/\s+/).length;
    const readingTime = Math.ceil(wordCount / 200);

    // Get thumbnail (cover image or first image from content)
    const thumbnailUrl = getPostThumbnail(post.cover_image_path, post.content);

    return { publishedDate, readingTime, thumbnailUrl };
  }, [post.content, post.published_at, post.created_at, post.cover_image_path]);

  const motionVariants = getReducedMotionVariants(cardVariants);

  return (
    <motion.div
      variants={motionVariants}
      initial="hidden"
      animate="visible"
      whileHover="hover"
      whileTap="tap"
      custom={index}
      transition={{
        delay: index * 0.1,
      }}
      className="h-full"
    >
      <Card className="h-full flex flex-col transition-all duration-500 hover:shadow-2xl hover:shadow-black/10 dark:hover:shadow-black/30 border-0 bg-white dark:bg-gray-900 hover:-translate-y-1 hover:scale-[1.02] group rounded-2xl overflow-hidden backdrop-blur-xl bg-white/90 dark:bg-gray-900/90">
        {/* Thumbnail Section */}
        <Link href={`/posts/${post.slug}`} className="block">
          <div className="aspect-[16/9] overflow-hidden relative">
            {thumbnailUrl ? (
              <motion.div
                className="h-full w-full"
                whileHover={{ scale: 1.08 }}
                transition={{ duration: 0.6, ease: [0.16, 1, 0.3, 1] }}
              >
                <LazyImage
                  src={thumbnailUrl}
                  alt={post.title}
                  className="h-full w-full object-cover"
                  width={400}
                  height={225}
                  priority={priority}
                />
              </motion.div>
            ) : (
              <div className="h-full w-full bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-800 dark:to-gray-700 flex items-center justify-center">
                <ImageIcon className="h-16 w-16 text-gray-400 dark:text-gray-500" />
              </div>
            )}
            {/* Overlay gradient */}
            <div className="absolute inset-0 bg-gradient-to-t from-black/40 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-all duration-500" />
          </div>
        </Link>
      
      <CardHeader className="flex-1 p-6 pb-0">
        <div className="space-y-4">
          {post.category && (
            <Link 
              href={`/categories/${post.category.slug}`}
              className="inline-block"
            >
              <MotionBadge variant="secondary" className="rounded-full px-3 py-1 text-xs font-medium bg-primary/10 text-primary hover:bg-primary/20 transition-all duration-300">
                {post.category.name}
              </MotionBadge>
            </Link>
          )}
          
          <Link href={`/posts/${post.slug}`} className="block group">
            <motion.h3 
              className="text-xl font-semibold line-clamp-2 group-hover:text-primary transition-all duration-300 leading-tight"
              layoutId={`title-${post.id}`}
            >
              {post.title}
            </motion.h3>
          </Link>
        </div>
      </CardHeader>

      <CardContent className="flex-1 px-6 py-4">
        <Link href={`/posts/${post.slug}`} className="block group">
          <HtmlPreview 
            content={post.content}
            maxLength={120}
            className="line-clamp-3 text-gray-600 dark:text-gray-400 group-hover:text-gray-800 dark:group-hover:text-gray-200 transition-all duration-300 leading-relaxed"
          />
        </Link>
      </CardContent>

      <CardFooter className="px-6 pb-6 pt-2">
        {post.tags && post.tags.length > 0 && (
          <div className="flex flex-wrap gap-2 w-full mb-4">
            {post.tags.slice(0, 3).map((tag) => (
              <Link key={tag.id} href={`/tags/${tag.slug}`}>
                <MotionBadge variant="outline" className="text-xs rounded-full px-2 py-1 border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-400 hover:border-primary hover:text-primary transition-all duration-300">
                  {tag.name}
                </MotionBadge>
              </Link>
            ))}
            {post.tags.length > 3 && (
              <MotionBadge variant="outline" className="text-xs rounded-full px-2 py-1 border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-400">
                +{post.tags.length - 3}
              </MotionBadge>
            )}
          </div>
        )}

        <div className="flex items-center justify-between w-full text-sm text-gray-500 dark:text-gray-400">
          <div className="flex items-center space-x-4">
            <div className="flex items-center space-x-2">
              <CalendarDays className="h-4 w-4" />
              <span className="font-medium">{format(publishedDate, 'MMM dd, yyyy')}</span>
            </div>
            <div className="flex items-center space-x-2">
              <Clock className="h-4 w-4" />
              <span className="font-medium">{t('readingTime', { minutes: readingTime })}</span>
            </div>
          </div>
        </div>
      </CardFooter>
      </Card>
    </motion.div>
  );
});
</file>

<file path=".claude/settings.local.json">
{
  "permissions": {
    "allow": [
      "mcp__vooster-ai__connect_project",
      "Bash(npx @vooster/cli@latest rules:init:*)",
      "Bash(find:*)",
      "mcp__vooster-ai__get_next_task",
      "mcp__vooster-ai__list_task",
      "mcp__vooster-ai__init_rules",
      "Bash(rm:*)",
      "Bash(npm run dev:*)",
      "Bash(ls:*)",
      "Bash(gemini:*)",
      "Bash(npm install:*)",
      "Bash(npm uninstall:*)",
      "Bash(npx:*)",
      "Bash(npm run build:*)",
      "Bash(timeout 20 npm run dev)",
      "Bash(timeout 30 npm run build)",
      "Bash(node:*)",
      "Bash(npm cache clean:*)",
      "Bash(curl:*)",
      "Bash(chmod:*)",
      "Bash(npm run lint)",
      "Bash(pkill:*)",
      "Bash(mkdir:*)",
      "Bash(touch:*)",
      "Bash(mv:*)",
      "Bash(npm audit:*)",
      "Bash(npm update:*)",
      "Bash(npm test:*)",
      "Bash(npm run:*)",
      "Bash(cp:*)",
      "Bash(timeout 5 npm run dev)",
      "Bash(timeout 10 npm run dev)",
      "Bash(timeout 20 npm run build)",
      "Bash(timeout 15 npm run dev)",
      "Bash(timeout 15 npm run build)",
      "Bash(git config:*)",
      "Bash(timeout 300 npm run build)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(git push:*)",
      "Bash(cat:*)",
      "Bash(true)"
    ],
    "deny": []
  }
}
</file>

</files>
